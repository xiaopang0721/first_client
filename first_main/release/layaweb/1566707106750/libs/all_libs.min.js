var Laya=window.Laya=function(l,t){var u={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:true,enumerable:false,configurable:true},__presubstr:String.prototype.substr,__substr:function(t,e){return arguments.length==1?u.__presubstr.call(this,t):u.__presubstr.call(this,t,e>0?e:this.length+e)},__init:function(t){t.forEach(function(t){t.__init$&&t.__init$()})},__isClass:function(t){return t&&(t.__isclass||t==Object||t==String||t==Array)},__newvec:function(t,e){var i=[];i.length=t;for(var n=0;n<t;n++)i[n]=e;return i},__extend:function(t,e){for(var i in e){if(!e.hasOwnProperty(i))continue;var n=Object.getOwnPropertyDescriptor(e,i);var r=n.get,s=n.set;if(r||s){if(r&&s)Object.defineProperty(t,i,n);else{r&&Object.defineProperty(t,i,r);s&&Object.defineProperty(t,i,s)}}else t[i]=e[i]}function a(){u.un(this,"constructor",t)}a.prototype=e.prototype;t.prototype=new a;u.un(t.prototype,"__imps",u.__copy({},e.prototype.__imps))},__copy:function(t,e){if(!e)return null;t=t||{};for(var i in e)t[i]=e[i];return t},__package:function(t,e){if(u.__packages[t])return;u.__packages[t]=true;var i=l,n=t.split(".");if(n.length>1){for(var r=0,s=n.length-1;r<s;r++){var a=i[n[r]];i=a?a:i[n[r]]={}}}i[n[n.length-1]]||(i[n[n.length-1]]=e||{})},__hasOwnProperty:function(t,e){e=e||this;function n(t,e){if(Object.hasOwnProperty.call(e.prototype,t))return true;var i=e.prototype.__super;return i==null?null:n(t,i)}return Object.hasOwnProperty.call(e,t)||n(t,e.__class)},__typeof:function(t,e){if(!t||!e)return false;if(e===String)return typeof t==="string";if(e===Number)return typeof t==="number";if(e.__interface__)e=e.__interface__;else if(typeof e!="string")return t instanceof e;return t.__imps&&t.__imps[e]||t.__class==e},__as:function(t,e){return this.__typeof(t,e)?t:null},__int:function(t){return t?parseInt(t):0},interface:function(t,e){u.__package(t,{});var i=u.__internals;var n=i[t]=i[t]||{self:t};if(e){var r=e.split(",");n.extend=[];for(var s=0;s<r.length;s++){var a=r[s];i[a]=i[a]||{self:a};n.extend.push(i[a])}}var o=l,h=t.split(".");for(var s=0;s<h.length-1;s++)o=o[h[s]];o[h[h.length-1]]={__interface__:t}},class:function(t,e,i,n){i&&u.__extend(t,i);if(e){u.__package(e,t);u.__classmap[e]=t;if(e.indexOf(".")>0){if(e.indexOf("laya.")==0){var r=e.split(".");n=n||r[r.length-1];if(u[n])console.log("Warning!,this class["+n+"] already exist:",u[n]);u[n]=t}}else{if(e=="Main")l.Main=t;else{if(u[e]){console.log("Error!,this class["+e+"] already exist:",u[e])}u[e]=t}}}var s=u.un,a=t.prototype;s(a,"hasOwnProperty",u.__hasOwnProperty);s(a,"__class",t);s(a,"__super",i);s(a,"__className",e);s(t,"__super",i);s(t,"__className",e);s(t,"__isclass",true);s(t,"super",function(t){this.__super.call(t)})},imps:function(t,e){if(!e)return null;var r=t.__imps||u.un(t,"__imps",{});function s(t){var e,i;if(!(e=u.__internals[t]))return;r[t]=true;if(!(i=e.extend))return;for(var n=0;n<i.length;n++){s(i[n].self)}}for(var i in e)s(i)},superSet:function(t,e,i,n){var r=t.prototype["_$set_"+i];r&&r.call(e,n)},superGet:function(t,e,i){var n=t.prototype["_$get_"+i];return n?n.call(e):null},getset:function(t,e,i,n,r){if(!t){n&&u.un(e,"_$get_"+i,n);r&&u.un(e,"_$set_"+i,r)}else{n&&(e["_$GET_"+i]=n);r&&(e["_$SET_"+i]=r)}if(n&&r)Object.defineProperty(e,i,{get:n,set:r,enumerable:false,configurable:true});else{n&&Object.defineProperty(e,i,{get:n,enumerable:false,configurable:true});r&&Object.defineProperty(e,i,{set:r,enumerable:false,configurable:true})}},static:function(i,n){for(var r=0,t=n.length;r<t;r+=2){if(n[r]=="length")i.length=n[r+1].call(i);else{function e(){var e=n[r];var t=n[r+1];Object.defineProperty(i,e,{get:function(){delete this[e];return this[e]=t.call(this)},set:function(t){delete this[e];this[e]=t},enumerable:true,configurable:true})}e()}}},un:function(t,e,i){i||(i=t[e]);u.__propun.value=i;Object.defineProperty(t,e,u.__propun);return i},uns:function(e,t){t.forEach(function(t){u.un(e,t)})}};l.console=l.console||{log:function(){}};l.trace=l.console.log;Error.prototype.throwError=function(){throw arguments};Object.defineProperty(Array.prototype,"fixed",{enumerable:false});return u}(window,document);(function(t,e,i){var n=i.un,r=i.uns,s=i.static,a=i.class,o=i.getset,h=i.__newvec})(window,document,Laya);(function(a,e,T){var t=T.un,i=T.uns,h=T.static,v=T.class,u=T.getset,n=T.__newvec;T.interface("laya.runtime.IMarket");T.interface("laya.filters.IFilter");T.interface("laya.display.ILayout");T.interface("laya.resource.IDispose");T.interface("laya.runtime.IPlatform");T.interface("laya.resource.IDestroy");T.interface("laya.runtime.IConchNode");T.interface("laya.filters.IFilterAction");T.interface("laya.runtime.ICPlatformClass");T.interface("laya.resource.ICreateResource");T.interface("laya.runtime.IConchRenderObject");T.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var I=function(){function s(){}v(s,"laya.utils.RunDriver");s.FILTER_ACTIONS=[];s.pixelRatio=-1;s._charSizeTestDiv=null;s.now=function(){return Date.now()};s.getWindow=function(){return a};s.getPixelRatio=function(){if(s.pixelRatio<0){var t=j.context;var e=t.backingStorePixelRatio||t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;s.pixelRatio=(j.window.devicePixelRatio||1)/e;if(s.pixelRatio<1)s.pixelRatio=1}return s.pixelRatio};s.getIncludeStr=function(t){return null};s.createShaderCondition=function(t){var e="(function() {return "+t+";})";return T._runScript(e)};s.fontMap=[];s.measureText=function(t,e){var i=s.hanzi.test(t);if(i&&s.fontMap[e]){return s.fontMap[e]}var n=j.context;n.font=e;var r=n.measureText(t);if(i)s.fontMap[e]=r;return r};s.getWebGLContext=function(t){};s.beginFlush=function(){};s.endFinish=function(){};s.addToAtlas=null;s.flashFlushImage=function(t){};s.drawToCanvas=function(t,e,i,n,r,s){var a=Ft.create("2D");var o=new V(i,n,a);W.renders[e]._fun(t,o,r,s);return a};s.createParticleTemplate2D=null;s.createGLTextur=null;s.createWebGLContext2D=null;s.changeWebGLSize=function(t,e){};s.createRenderSprite=function(t,e){return new W(t,e)};s.createFilterAction=function(t){return new C};s.createGraphics=function(){return new d};s.clear=function(t){G._context.ctx.clear()};s.cancelLoadByUrl=function(t){};s.clearAtlas=function(t){};s.isAtlas=function(t){return false};s.addTextureToAtlas=function(t){};s.getTexturePixels=function(t,e,i,n,r){return null};s.skinAniSprite=function(){return null};s.update3DLoop=function(){};h(s,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]);return s}();var r=function(){u(1,T,"alertGlobalError",null,function(t){var s=0;if(t){j.window.onerror=function(t,e,i,n,r){if(s++<5&&r)alert("出错啦，请把此信息截图给研发商\n"+t+"\n"+r.stack||r)}}else{j.window.onerror=null}});T.init=function(t,e,i){var n=[];for(var r=2,s=arguments.length;r<s;r++)n.push(arguments[r]);if(T._isinit)return;ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=T._arrayBufferSlice);T._isinit=true;j.__init__();z.__init__();d.__init__();T.timer=new ht;T.scaleTimer=new ht;T.loader=new wt;ft.__init__();for(var r=0,a=n.length;r<a;r++){if(n[r].enable)n[r].enable()}l.__init__();o.__init__();H.__init__();$.beginCheck();T._currentStage=T.stage=new Nt;T.stage.conchModel&&T.stage.conchModel.setRootNode();T._getUrlPath();T.render=new G(0,0);T.stage.size(t,e);W.__init__();y.__init__();x.instance.__init__(T.stage,G.canvas);Wt.__init__();N.autoStopMusic=true;O.__init__();return G.canvas};T._getUrlPath=function(){var t=j.window.location;var e=t.pathname;e=e.charAt(2)==":"?e.substring(1):e;U.rootPath=U.basePath=U.getPath(t.protocol=="file:"?e:t.protocol+"//"+t.host+t.pathname)};T._arrayBufferSlice=function(t,e){var i=this;var n=new Uint8Array(i,t,e-t);var r=new Uint8Array(n.length);r.set(n);return r.buffer};T._runScript=function(t){return j.window[T._evcode](t)};T.stage=null;T.timer=null;T.scaleTimer=null;T.loader=null;T.version="1.8.2beta";T.render=null;T._currentStage=null;T._isinit=false;T.MiniAdpter={init:function(){if(a.navigator&&a.navigator.userAgent&&a.navigator.userAgent.indexOf("MiniGame")>-1)console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}};h(T,["conchMarket",function(){return this.conchMarket=a.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=a.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(100+10+8)+"a"+"l"}]);return T}();var g=function(){function t(){}v(t,"Config");t.WebGLTextCacheCount=500;t.atlasEnable=false;t.showCanvasMark=false;t.animationInterval=50;t.isAntialias=false;t.isAlpha=false;t.premultipliedAlpha=true;t.isStencil=true;t.preserveDrawingBuffer=false;t.useRetinalCanvas=false;return t}();var s=function(){var h;function e(){this._events=null}v(e,"laya.events.EventDispatcher");var t=e.prototype;t.hasListener=function(t){var e=this._events&&this._events[t];return!!e};t.event=function(t,e){if(!this._events||!this._events[t])return false;var i=this._events[t];if(i.run){if(i.once)delete this._events[t];e!=null?i.runWith(e):i.run()}else{for(var n=0,r=i.length;n<r;n++){var s=i[n];if(s){e!=null?s.runWith(e):s.run()}if(!s||s.once){i.splice(n,1);n--;r--}}if(i.length===0&&this._events)delete this._events[t]}return true};t.on=function(t,e,i,n){return this._createListener(t,e,i,n,false)};t.once=function(t,e,i,n){return this._createListener(t,e,i,n,true)};t._createListener=function(t,e,i,n,r,s){s===void 0&&(s=true);s&&this.off(t,e,i,r);var a=h.create(e||this,i,n,r);this._events||(this._events={});var o=this._events;if(!o[t])o[t]=a;else{if(!o[t].run)o[t].push(a);else o[t]=[o[t],a]}return this};t.off=function(t,e,i,n){n===void 0&&(n=false);if(!this._events||!this._events[t])return this;var r=this._events[t];if(r!=null){if(r.run){if((!e||r.caller===e)&&r.method===i&&(!n||r.once)){delete this._events[t];r.recover()}}else{var s=0;for(var a=0,o=r.length;a<o;a++){var h=r[a];if(!h){s++;continue}if(h&&(!e||h.caller===e)&&h.method===i&&(!n||h.once)){s++;r[a]=null;h.recover()}}if(s===o)delete this._events[t]}}return this};t.offAll=function(t){var e=this._events;if(!e)return this;if(t){this._recoverHandlers(e[t]);delete e[t]}else{for(var i in e){this._recoverHandlers(e[i])}this._events=null}return this};t._recoverHandlers=function(t){if(!t)return;if(t.run){t.recover()}else{for(var e=t.length-1;e>-1;e--){if(t[e]){t[e].recover();t[e]=null}}}};t.isMouseEvent=function(t){return e.MOUSE_EVENTS[t]};e.MOUSE_EVENTS={rightmousedown:true,rightmouseup:true,rightclick:true,mousedown:true,mouseup:true,mousemove:true,mouseover:true,mouseout:true,click:true,doubleclick:true};e.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:false,writable:true});h=function(t){function r(t,e,i,n){r.__super.call(this,t,e,i,n)}v(r,"",t);var e=r.prototype;e.recover=function(){if(this._id>0){this._id=0;r._pool.push(this.clear())}};r.create=function(t,e,i,n){n===void 0&&(n=true);if(r._pool.length)return r._pool.pop().setTo(t,e,i,n);return new r(t,e,i,n)};r._pool=[];return r}(m)};return e}();var m=function(){function r(t,e,i,n){this.once=false;this._id=0;n===void 0&&(n=false);this.setTo(t,e,i,n)}v(r,"laya.utils.Handler");var t=r.prototype;t.setTo=function(t,e,i,n){this._id=r._gid++;this.caller=t;this.method=e;this.args=i;this.once=n;return this};t.run=function(){if(this.method==null)return null;var t=this._id;var e=this.method.apply(this.caller,this.args);this._id===t&&this.once&&this.recover();return e};t.runWith=function(t){if(this.method==null)return null;var e=this._id;if(t==null)var i=this.method.apply(this.caller,this.args);else if(!this.args&&!t.unshift)i=this.method.call(this.caller,t);else if(this.args)i=this.method.apply(this.caller,this.args.concat(t));else i=this.method.apply(this.caller,t);this._id===e&&this.once&&this.recover();return i};t.clear=function(){this.caller=null;this.method=null;this.args=null;return this};t.recover=function(){if(this._id>0){this._id=0;r._pool.push(this.clear())}};r.create=function(t,e,i,n){n===void 0&&(n=true);if(r._pool.length)return r._pool.pop().setTo(t,e,i,n);return new r(t,e,i,n)};r._pool=[];r._gid=1;return r}();var A=function(){function t(){this._texture=null;this._fontCharDic={};this._fontWidthMap={};this._complete=null;this._path=null;this._maxWidth=0;this._spaceWidth=10;this._padding=null;this.fontSize=12;this.autoScaleSize=false;this.letterSpacing=0}v(t,"laya.display.BitmapFont");var e=t.prototype;e.loadFont=function(t,e){this._path=t;this._complete=e;T.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],m.create(this,this.onLoaded))};e.onLoaded=function(){this.parseFont(xt.getRes(this._path),xt.getRes(this._path.replace(".fnt",".png")));this._complete&&this._complete.runWith(this._texture?this:null)};e.parseFont=function(t,e){if(t==null||e==null)return;this._texture=e;var i=0;var n=1;var r=t.getElementsByTagName("info");if(!r[0].getAttributeNode){return this.parseFont2(t,e)}this.fontSize=parseInt(r[0].getAttributeNode("size").nodeValue);var s=r[0].getAttributeNode("padding").nodeValue;var a=s.split(",");this._padding=[parseInt(a[0]),parseInt(a[1]),parseInt(a[2]),parseInt(a[3])];var o;o=t.getElementsByTagName("char");var h=0;for(h=0;h<o.length;h++){var l=o[h];var u=parseInt(l.getAttributeNode("id").nodeValue);var c=parseInt(l.getAttributeNode("xoffset").nodeValue)/n;var f=parseInt(l.getAttributeNode("yoffset").nodeValue)/n;var _=parseInt(l.getAttributeNode("xadvance").nodeValue)/n;var d=new R;d.x=parseInt(l.getAttributeNode("x").nodeValue);d.y=parseInt(l.getAttributeNode("y").nodeValue);d.width=parseInt(l.getAttributeNode("width").nodeValue);d.height=parseInt(l.getAttributeNode("height").nodeValue);var p=At.create(e,d.x,d.y,d.width,d.height,c,f);this._maxWidth=Math.max(this._maxWidth,_+this.letterSpacing);this._fontCharDic[u]=p;this._fontWidthMap[u]=_}};e.parseFont2=function(t,e){if(t==null||e==null)return;this._texture=e;var i=0;var n=1;var r=t.getElementsByTagName("info");this.fontSize=parseInt(r[0].attributes["size"].nodeValue);var s=r[0].attributes["padding"].nodeValue;var a=s.split(",");this._padding=[parseInt(a[0]),parseInt(a[1]),parseInt(a[2]),parseInt(a[3])];var o=t.getElementsByTagName("char");var h=0;for(h=0;h<o.length;h++){var l=o[h].attributes;var u=parseInt(l["id"].nodeValue);var c=parseInt(l["xoffset"].nodeValue)/n;var f=parseInt(l["yoffset"].nodeValue)/n;var _=parseInt(l["xadvance"].nodeValue)/n;var d=new R;d.x=parseInt(l["x"].nodeValue);d.y=parseInt(l["y"].nodeValue);d.width=parseInt(l["width"].nodeValue);d.height=parseInt(l["height"].nodeValue);var p=At.create(e,d.x,d.y,d.width,d.height,c,f);this._maxWidth=Math.max(this._maxWidth,_+this.letterSpacing);this._fontCharDic[u]=p;this._fontWidthMap[u]=_}};e.getCharTexture=function(t){return this._fontCharDic[t.charCodeAt(0)]};e.destroy=function(){if(this._texture){for(var t in this._fontCharDic){var e=this._fontCharDic[t];if(e)e.destroy()}this._texture.destroy();this._fontCharDic=null;this._fontWidthMap=null;this._texture=null}};e.setSpaceWidth=function(t){this._spaceWidth=t};e.getCharWidth=function(t){var e=t.charCodeAt(0);if(this._fontWidthMap[e])return this._fontWidthMap[e]+this.letterSpacing;if(t==" ")return this._spaceWidth+this.letterSpacing;return 0};e.getTextWidth=function(t){var e=0;for(var i=0,n=t.length;i<n;i++){e+=this.getCharWidth(t.charAt(i))}return e};e.getMaxWidth=function(){return this._maxWidth};e.getMaxHeight=function(){return this.fontSize};e.drawText=function(t,e,i,n,r,s){var a=this.getTextWidth(t);var o;var h=0;r==="center"&&(h=(s-a)/2);r==="right"&&(h=s-a);var l=0;for(var u=0,c=t.length;u<c;u++){o=this.getCharTexture(t.charAt(u));if(o){e.graphics.drawTexture(o,i+l+h,n);l+=this.getCharWidth(t.charAt(u))}}};return t}();var o=function(){function i(){this.alpha=1;this.visible=true;this.scrollRect=null;this.blendMode=null;this._type=0;this._tf=i._TF_EMPTY}v(i,"laya.display.css.Style");var t=i.prototype;t.getTransform=function(){return this._tf};t.setTransform=function(t){this._tf=t==="none"||!t?i._TF_EMPTY:t};t.setTranslateX=function(t){this._tf===i._TF_EMPTY&&(this._tf=new c);this._tf.translateX=t};t.setTranslateY=function(t){this._tf===i._TF_EMPTY&&(this._tf=new c);this._tf.translateY=t};t.setScaleX=function(t){this._tf===i._TF_EMPTY&&(this._tf=new c);this._tf.scaleX=t};t.setScale=function(t,e){this._tf===i._TF_EMPTY&&(this._tf=new c);this._tf.scaleX=t;this._tf.scaleY=e};t.setScaleY=function(t){this._tf===i._TF_EMPTY&&(this._tf=new c);this._tf.scaleY=t};t.setRotate=function(t){this._tf===i._TF_EMPTY&&(this._tf=new c);this._tf.rotate=t};t.setSkewX=function(t){this._tf===i._TF_EMPTY&&(this._tf=new c);this._tf.skewX=t};t.setSkewY=function(t){this._tf===i._TF_EMPTY&&(this._tf=new c);this._tf.skewY=t};t.destroy=function(){this.scrollRect=null};t.render=function(t,e,i,n){};t.getCSSStyle=function(){return pt.EMPTY};t._enableLayout=function(){return false};u(0,t,"scaleX",function(){return this._tf.scaleX},function(t){this.setScaleX(t)});u(0,t,"transform",function(){return this.getTransform()},function(t){this.setTransform(t)});u(0,t,"translateX",function(){return this._tf.translateX},function(t){this.setTranslateX(t)});u(0,t,"translateY",function(){return this._tf.translateY},function(t){this.setTranslateY(t)});u(0,t,"scaleY",function(){return this._tf.scaleY},function(t){this.setScaleY(t)});u(0,t,"block",function(){return(this._type&1)!=0});u(0,t,"skewY",function(){return this._tf.skewY},function(t){this.setSkewY(t)});u(0,t,"rotate",function(){return this._tf.rotate},function(t){this.setRotate(t)});u(0,t,"skewX",function(){return this._tf.skewX},function(t){this.setSkewX(t)});u(0,t,"paddingLeft",function(){return 0});u(0,t,"paddingTop",function(){return 0});u(0,t,"absolute",function(){return true});i.__init__=function(){i._TF_EMPTY=new c;i.EMPTY=new i};i.EMPTY=null;i._TF_EMPTY=null;return i}();var l=function(){function e(t){this._type=0;this._weight=0;this._decoration=null;this._text=null;this.indent=0;this._color=q.create(e.defaultColor);this.family=e.defaultFamily;this.stroke=e._STROKE;this.size=e.defaultSize;t&&t!==e.EMPTY&&t.copyTo(this)}v(e,"laya.display.css.Font");var t=e.prototype;t.set=function(t){this._text=null;var e=t.split(" ");for(var i=0,n=e.length;i<n;i++){var r=e[i];switch(r){case"italic":this.italic=true;continue;case"bold":this.bold=true;continue}if(r.indexOf("px")>0){this.size=parseInt(r);this.family=e[i+1];i++;continue}}};t.toString=function(){this._text="";this.italic&&(this._text+="italic ");this.bold&&(this._text+="bold ");return this._text+=this.size+"px "+this.family};t.copyTo=function(t){t._type=this._type;t._text=this._text;t._weight=this._weight;t._color=this._color;t.family=this.family;t.stroke=this.stroke!=e._STROKE?this.stroke.slice():e._STROKE;t.indent=this.indent;t.size=this.size};u(0,t,"password",function(){return(this._type&1024)!==0},function(t){t?this._type|=1024:this._type&=~1024});u(0,t,"color",function(){return this._color.strColor},function(t){this._color=q.create(t)});u(0,t,"italic",function(){return(this._type&512)!==0},function(t){t?this._type|=512:this._type&=~512});u(0,t,"bold",function(){return(this._type&2048)!==0},function(t){t?this._type|=2048:this._type&=~2048});u(0,t,"weight",function(){return""+this._weight},function(t){var e=0;switch(t){case"normal":break;case"bold":this.bold=true;e=700;break;case"bolder":e=800;break;case"lighter":e=100;break;default:e=parseInt(t)}this._weight=e;this._text=null});u(0,t,"decoration",function(){return this._decoration?this._decoration.value:null},function(t){var e=t.split(" ");this._decoration||(this._decoration={});switch(e[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=e[0]}e[1]&&(this._decoration.color=q.create(e));this._decoration.value=t});e.__init__=function(){e.EMPTY=new e(null)};e.EMPTY=null;e.defaultColor="#000000";e.defaultSize=12;e.defaultFamily="Arial";e.defaultFont="12px Arial";e._STROKE=[0,"#000000"];e._ITALIC=512;e._PASSWORD=1024;e._BOLD=2048;return e}();var c=function(){function t(){this.translateX=0;this.translateY=0;this.scaleX=1;this.scaleY=1;this.rotate=0;this.skewX=0;this.skewY=0}v(t,"laya.display.css.TransformInfo");return t}();var d=function(){function c(){this._one=null;this._cmds=null;this._render=this._renderEmpty;if(G.isConchNode){var t=this;t._nativeObj=new a._conchGraphics;t.id=t._nativeObj.conchID}}v(c,"laya.display.Graphics");var t=c.prototype;t.destroy=function(){this.clear();if(this._graphicBounds)this._graphicBounds.destroy();this._graphicBounds=null;this._vectorgraphArray=null;this._sp&&(this._sp._renderType=0);this._sp=null};t.clear=function(t){t===void 0&&(t=false);var e=0,i=0;if(t){var n=this._one;if(this._cmds){i=this._cmds.length;for(e=0;e<i;e++){n=this._cmds[e];if(n&&(n.callee===G._context._drawTexture||n.callee===G._context._drawTextureWithTransform)){n[0]=null;c._cache.push(n)}}this._cmds.length=0}else if(n){if(n&&(n.callee===G._context._drawTexture||n.callee===G._context._drawTextureWithTransform)){n[0]=null;c._cache.push(n)}}}else{this._cmds=null}this._one=null;this._render=this._renderEmpty;this._sp&&(this._sp._renderType&=~1&~512);this._repaint();if(this._vectorgraphArray){for(e=0,i=this._vectorgraphArray.length;e<i;e++){ct.getInstance().deleteShape(this._vectorgraphArray[e])}this._vectorgraphArray.length=0}};t._clearBoundsCache=function(){if(this._graphicBounds)this._graphicBounds.reset()};t._initGraphicBounds=function(){if(!this._graphicBounds){this._graphicBounds=new f;this._graphicBounds._graphics=this}};t._repaint=function(){this._clearBoundsCache();this._sp&&this._sp.repaint()};t._isOnlyOne=function(){return!this._cmds||this._cmds.length===0};t.getBounds=function(t){t===void 0&&(t=false);this._initGraphicBounds();return this._graphicBounds.getBounds(t)};t.getBoundPoints=function(t){t===void 0&&(t=false);this._initGraphicBounds();return this._graphicBounds.getBoundPoints(t)};t._addCmd=function(t){this._cmds=this._cmds||[];t.callee=t.shift();this._cmds.push(t)};t.setFilters=function(t){this._saveToCmd(G._context._setFilters,t)};t.drawTexture=function(t,e,i,n,r,s,a){e===void 0&&(e=0);i===void 0&&(i=0);n===void 0&&(n=0);r===void 0&&(r=0);a===void 0&&(a=1);if(!t||a<.01)return null;if(!n)n=t.sourceWidth;if(!r)r=t.sourceHeight;a=a<0?0:a>1?1:a;var o=!G.isWebGL&&(j.onFirefox||j.onEdge||j.onIE||j.onSafari)?.5:0;var h=n/t.sourceWidth;var l=r/t.sourceHeight;n=t.width*h;r=t.height*l;if(t.loaded&&(n<=0||r<=0))return null;e+=t.offsetX*h;i+=t.offsetY*l;this._sp&&(this._sp._renderType|=512);var u;e-=o;i-=o;n+=2*o;r+=2*o;if(c._cache.length){u=c._cache.pop();u[0]=t;u[1]=e;u[2]=i;u[3]=n;u[4]=r;u[5]=s;u[6]=a}else{u=[t,e,i,n,r,s,a]}u.callee=s||a!=1?G._context._drawTextureWithTransform:G._context._drawTexture;if(this._one==null&&!s&&a==1){this._one=u;this._render=this._renderOneImg}else{this._saveToCmd(u.callee,u)}if(!t.loaded){t.once("loaded",this,this._textureLoaded,[t,u])}this._repaint();return u};t.cleanByTexture=function(t,e,i,n,r){n===void 0&&(n=0);r===void 0&&(r=0);if(!t)return this.clear();if(this._one&&this._render===this._renderOneImg){if(!n)n=t.sourceWidth;if(!r)r=t.sourceHeight;var s=n/t.sourceWidth;var a=r/t.sourceHeight;n=t.width*s;r=t.height*a;e+=t.offsetX*s;i+=t.offsetY*a;this._one[0]=t;this._one[1]=e;this._one[2]=i;this._one[3]=n;this._one[4]=r;this._repaint()}else{this.clear();t&&this.drawTexture(t,e,i,n,r)}};t.drawTextures=function(t,e){if(!t)return;this._saveToCmd(G._context._drawTextures,[t,e])};t.fillTexture=function(t,e,i,n,r,s,a){n===void 0&&(n=0);r===void 0&&(r=0);s===void 0&&(s="repeat");if(!t)return;var o=[t,e,i,n,r,s,a||D.EMPTY,{}];if(!t.loaded){t.once("loaded",this,this._textureLoaded,[t,o])}this._saveToCmd(G._context._fillTexture,o)};t._textureLoaded=function(t,e){e[3]=e[3]||t.width;e[4]=e[4]||t.height;this._repaint()};t.fillCircle=function(t,e,i,n,r,s,a){i.bitmap.enableMerageInAtlas=false;var o=new Float32Array((a+1)*2);var h=new Float32Array((a+1)*2);var l=new Uint16Array(a*3);var u=2*Math.PI/a;var c=0;o[0]=n;o[1]=r;h[0]=n/i.width;h[1]=r/i.height;var f=2;for(var _=0;_<a;_++){var d=s*Math.cos(c)+n;var p=s*Math.sin(c)+r;o[f]=d;o[f+1]=p;h[f]=d/i.width;h[f+1]=p/i.height;c+=u;f+=2}f=0;for(_=0;_<a;_++){l[f++]=0;l[f++]=_+1;l[f++]=_+2>=a+1?1:_+2}this.drawTriangles(i,t,e,o,h,l)};t.drawTriangles=function(t,e,i,n,r,s,a,o,h,l){o===void 0&&(o=1);this._saveToCmd(G._context.drawTriangles,[t,e,i,n,r,s,a,o,h,l])};t._saveToCmd=function(t,e){this._sp&&(this._sp._renderType|=512);if(this._one==null){this._one=e;this._render=this._renderOne}else{this._sp&&(this._sp._renderType&=~1);this._render=this._renderAll;(this._cmds||(this._cmds=[])).length===0&&this._cmds.push(this._one);this._cmds.push(e)}e.callee=t;this._repaint();return e};t.clipRect=function(t,e,i,n){this._saveToCmd(G._context._clipRect,[t,e,i,n])};t.fillText=function(t,e,i,n,r,s,a){a===void 0&&(a=0);this._saveToCmd(G._context._fillText,[t,e,i,n||l.defaultFont,r,s])};t.fillBorderText=function(t,e,i,n,r,s,a,o){this._saveToCmd(G._context._fillBorderText,[t,e,i,n||l.defaultFont,r,s,a,o])};t.strokeText=function(t,e,i,n,r,s,a){this._saveToCmd(G._context._strokeText,[t,e,i,n||l.defaultFont,r,s,a])};t.alpha=function(t){t=t<0?0:t>1?1:t;this._saveToCmd(G._context._alpha,[t])};t.setAlpha=function(t){t=t<0?0:t>1?1:t;this._saveToCmd(G._context._setAlpha,[t])};t.transform=function(t,e,i){e===void 0&&(e=0);i===void 0&&(i=0);this._saveToCmd(G._context._transform,[t,e,i])};t.rotate=function(t,e,i){e===void 0&&(e=0);i===void 0&&(i=0);this._saveToCmd(G._context._rotate,[t,e,i])};t.scale=function(t,e,i,n){i===void 0&&(i=0);n===void 0&&(n=0);this._saveToCmd(G._context._scale,[t,e,i,n])};t.translate=function(t,e){this._saveToCmd(G._context._translate,[t,e])};t.save=function(){this._saveToCmd(G._context._save,[])};t.restore=function(){this._saveToCmd(G._context._restore,[])};t.replaceText=function(t){this._repaint();var e=this._cmds;if(!e){if(this._one&&this._isTextCmd(this._one.callee)){if(this._one[0].toUpperCase)this._one[0]=t;else this._one[0].setText(t);return true}}else{for(var i=e.length-1;i>-1;i--){if(this._isTextCmd(e[i].callee)){if(e[i][0].toUpperCase)e[i][0]=t;else e[i][0].setText(t);return true}}}return false};t._isTextCmd=function(t){return t===G._context._fillText||t===G._context._fillBorderText||t===G._context._strokeText};t.replaceTextColor=function(t){this._repaint();var e=this._cmds;if(!e){if(this._one&&this._isTextCmd(this._one.callee)){this._one[4]=t;if(!this._one[0].toUpperCase)this._one[0].changed=true}}else{for(var i=e.length-1;i>-1;i--){if(this._isTextCmd(e[i].callee)){e[i][4]=t;if(!e[i][0].toUpperCase)e[i][0].changed=true}}}};t.loadImage=function(t,e,i,n,r,s){var a=this;e===void 0&&(e=0);i===void 0&&(i=0);n===void 0&&(n=0);r===void 0&&(r=0);var o=xt.getRes(t);if(o)h(o);else T.loader.load(t,m.create(null,h),null,"image");function h(t){if(t){a.drawTexture(t,e,i,n,r);if(s!=null)s.call(a._sp,t)}}};t._renderEmpty=function(t,e,i,n){};t._renderAll=function(t,e,i,n){var r=this._cmds,s;for(var a=0,o=r.length;a<o;a++){(s=r[a]).callee.call(e,i,n,s)}};t._renderOne=function(t,e,i,n){this._one.callee.call(e,i,n,this._one)};t._renderOneImg=function(t,e,i,n){this._one.callee.call(e,i,n,this._one);if(t._renderType!==2305){t._renderType|=1}};t.drawLine=function(t,e,i,n,r,s){s===void 0&&(s=1);var a=0;if(G.isWebGL){a=ct.getInstance().getId();if(this._vectorgraphArray==null)this._vectorgraphArray=[];this._vectorgraphArray.push(a)}var o=s%2===0?0:.5;var h=[t+o,e+o,i+o,n+o,r,s,a];this._saveToCmd(G._context._drawLine,h)};t.drawLines=function(t,e,i,n,r){r===void 0&&(r=1);var s=0;if(!i||i.length<4)return;if(G.isWebGL){s=ct.getInstance().getId();if(this._vectorgraphArray==null)this._vectorgraphArray=[];this._vectorgraphArray.push(s)}var a=r%2===0?0:.5;var o=[t+a,e+a,i,n,r,s];this._saveToCmd(G._context._drawLines,o)};t.drawCurves=function(t,e,i,n,r){r===void 0&&(r=1);var s=[t,e,i,n,r];this._saveToCmd(G._context._drawCurves,s)};t.drawRect=function(t,e,i,n,r,s,a){a===void 0&&(a=1);var o=s?a/2:0;var h=s?a:0;var l=[t+o,e+o,i-h,n-h,r,s,a];this._saveToCmd(G._context._drawRect,l)};t.drawCircle=function(t,e,i,n,r,s){s===void 0&&(s=1);var a=r?s/2:0;var o=0;if(G.isWebGL){o=ct.getInstance().getId();if(this._vectorgraphArray==null)this._vectorgraphArray=[];this._vectorgraphArray.push(o)}var h=[t,e,i-a,n,r,s,o];this._saveToCmd(G._context._drawCircle,h)};t.drawPie=function(t,e,i,n,r,s,a,o){o===void 0&&(o=1);var h=a?o/2:0;var l=a?o:0;var u=0;if(G.isWebGL){u=ct.getInstance().getId();if(this._vectorgraphArray==null)this._vectorgraphArray=[];this._vectorgraphArray.push(u)}var c=[t+h,e+h,i-l,n,r,s,a,o,u];c[3]=ut.toRadian(n);c[4]=ut.toRadian(r);this._saveToCmd(G._context._drawPie,c)};t.drawPoly=function(t,e,i,n,r,s){s===void 0&&(s=1);var a=0;var o=false;if(G.isWebGL){a=ct.getInstance().getId();if(this._vectorgraphArray==null)this._vectorgraphArray=[];this._vectorgraphArray.push(a);if(i.length>6){o=false}else{o=true}}var h=r?s%2===0?0:.5:0;var l=[t+h,e+h,i,n,r,s,a,o];this._saveToCmd(G._context._drawPoly,l)};t.drawPath=function(t,e,i,n,r){var s=[t,e,i,n,r];this._saveToCmd(G._context._drawPath,s)};u(0,t,"cmds",function(){return this._cmds},function(t){this._sp&&(this._sp._renderType|=512);this._cmds=t;this._render=this._renderAll;this._repaint()});c.__init__=function(){if(G.isConchNode){var t=laya.display.Graphics.prototype;var e=j.window.ConchGraphics.prototype;var i=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"];for(var n=0,r=i.length;n<=r;n++){var s=i[n];t[s]=e[s]}t._saveToCmd=null;if(e.drawImageS){t.drawTextures=function(t,e){if(!t)return;if(!(t.loaded&&t.bitmap&&t.source)){return}var i=t.uv,n=t.bitmap.width,r=t.bitmap.height;this.drawImageS(t.bitmap.source,i[0]*n,i[1]*r,(i[2]-i[0])*n,(i[5]-i[3])*r,t.offsetX,t.offsetY,t.width,t.height,e)}}t.drawTexture=function(t,e,i,n,r,s,a){e===void 0&&(e=0);i===void 0&&(i=0);n===void 0&&(n=0);r===void 0&&(r=0);a===void 0&&(a=1);if(!t)return;if(!t.loaded){t.once("loaded",this,function(){this.drawTexture(t,e,i,n,r,s)});return}if(!(t.loaded&&t.bitmap&&t.source)){return}if(!n)n=t.sourceWidth;if(!r)r=t.sourceHeight;a=a<0?0:a>1?1:a;n=n-t.sourceWidth+t.width;r=r-t.sourceHeight+t.height;if(n<=0||r<=0)return;e+=t.offsetX;i+=t.offsetY;var o=t.uv,h=t.bitmap.width,l=t.bitmap.height;if(o[4]<o[0]&&o[5]<o[1]){this.drawImageM(t.bitmap.source,o[4]*h,o[5]*l,(o[0]-o[4])*h,(o[1]-o[5])*l,e,i,n,r,s,a)}else{this.drawImageM(t.bitmap.source,o[0]*h,o[1]*l,(o[2]-o[0])*h,(o[5]-o[3])*l,e,i,n,r,s,a)}this._repaint()};t.fillTexture=function(t,e,i,n,r,s,a){n===void 0&&(n=0);r===void 0&&(r=0);s===void 0&&(s="repeat");if(!t)return;if(t.loaded){var o=G._context.ctx;var h=t.bitmap.width,l=t.bitmap.height,u=t.uv;var c;if(t.uv!=At.DEF_UV){c=o.createPattern(t.bitmap.source,s,u[0]*h,u[1]*l,(u[2]-u[0])*h,(u[5]-u[3])*l)}else{c=o.createPattern(t.bitmap.source,s)}var f=0,_=0;if(a){e+=a.x%t.width;i+=a.y%t.height;f-=a.x%t.width;_-=a.y%t.height}this._fillImage(c,e,i,f,_,n,r)}}}};c._cache=[];return c}();var f=function(){function y(){this._cacheBoundsType=false}v(y,"laya.display.GraphicsBounds");var t=y.prototype;t.destroy=function(){this._graphics=null;this._temp=null;this._rstBoundPoints=null;this._bounds=null};t.reset=function(){this._temp&&(this._temp.length=0)};t.getBounds=function(t){t===void 0&&(t=false);if(!this._bounds||!this._temp||this._temp.length<1||t!=this._cacheBoundsType){this._bounds=R._getWrapRec(this.getBoundPoints(t),this._bounds)}this._cacheBoundsType=t;return this._bounds};t.getBoundPoints=function(t){t===void 0&&(t=false);if(!this._temp||this._temp.length<1||t!=this._cacheBoundsType)this._temp=this._getCmdPoints(t);this._cacheBoundsType=t;return this._rstBoundPoints=ut.copyArray(this._rstBoundPoints,this._temp)};t._getCmdPoints=function(t){t===void 0&&(t=false);var e=G._context;var i=this._graphics.cmds;var n;n=this._temp||(this._temp=[]);n.length=0;if(!i&&this._graphics._one!=null){y._tempCmds.length=0;y._tempCmds.push(this._graphics._one);i=y._tempCmds}if(!i)return n;var r;r=y._tempMatrixArrays;r.length=0;var s=y._initMatrix;s.identity();var a=y._tempMatrix;var o;var h;var l=NaN;var u=NaN;var c=NaN;var f=NaN;var _=NaN;var d=NaN;for(var p=0,v=i.length;p<v;p++){o=i[p];if(!o.callee)continue;switch(o.callee){case e._save:case 7:r.push(s);s=s.clone();break;case e._restore:case 8:s=r.pop();break;case e._scale:case 5:a.identity();a.translate(-o[2],-o[3]);a.scale(o[0],o[1]);a.translate(o[2],o[3]);this._switchMatrix(s,a);break;case e._rotate:case 3:a.identity();a.translate(-o[1],-o[2]);a.rotate(o[0]);a.translate(o[1],o[2]);this._switchMatrix(s,a);break;case e._translate:case 6:a.identity();a.translate(o[0],o[1]);this._switchMatrix(s,a);break;case e._transform:case 4:a.identity();a.translate(-o[1],-o[2]);a.concat(o[0]);a.translate(o[1],o[2]);this._switchMatrix(s,a);break;case 16:case 24:y._addPointArrToRst(n,R._getBoundPointS(o[0],o[1],o[2],o[3]),s);break;case 17:s.copyTo(a);a.concat(o[4]);y._addPointArrToRst(n,R._getBoundPointS(o[0],o[1],o[2],o[3]),a);break;case e._drawTexture:h=o[0];if(t){if(o[3]&&o[4]){y._addPointArrToRst(n,R._getBoundPointS(o[1],o[2],o[3],o[4]),s)}else{h=o[0];y._addPointArrToRst(n,R._getBoundPointS(o[1],o[2],h.width,h.height),s)}}else{l=(o[3]||h.sourceWidth)/h.width;u=(o[4]||h.sourceHeight)/h.height;c=l*h.sourceWidth;f=u*h.sourceHeight;_=h.offsetX>0?h.offsetX:0;d=h.offsetY>0?h.offsetY:0;_*=l;d*=u;y._addPointArrToRst(n,R._getBoundPointS(o[1]-_,o[2]-d,c,f),s)}break;case e._fillTexture:if(o[3]&&o[4]){y._addPointArrToRst(n,R._getBoundPointS(o[1],o[2],o[3],o[4]),s)}else{h=o[0];y._addPointArrToRst(n,R._getBoundPointS(o[1],o[2],h.width,h.height),s)}break;case e._drawTextureWithTransform:;var g;if(o[5]){s.copyTo(a);a.concat(o[5]);g=a}else{g=s}if(t){if(o[3]&&o[4]){y._addPointArrToRst(n,R._getBoundPointS(o[1],o[2],o[3],o[4]),g)}else{h=o[0];y._addPointArrToRst(n,R._getBoundPointS(o[1],o[2],h.width,h.height),g)}}else{h=o[0];l=(o[3]||h.sourceWidth)/h.width;u=(o[4]||h.sourceHeight)/h.height;c=l*h.sourceWidth;f=u*h.sourceHeight;_=h.offsetX>0?h.offsetX:0;d=h.offsetY>0?h.offsetY:0;_*=l;d*=u;y._addPointArrToRst(n,R._getBoundPointS(o[1]-_,o[2]-d,c,f),g)}break;case e._drawRect:case 13:y._addPointArrToRst(n,R._getBoundPointS(o[0],o[1],o[2],o[3]),s);break;case e._drawCircle:case e._fillCircle:case 14:y._addPointArrToRst(n,R._getBoundPointS(o[0]-o[2],o[1]-o[2],o[2]+o[2],o[2]+o[2]),s);break;case e._drawLine:case 20:y._tempPoints.length=0;var m=NaN;m=o[5]*.5;if(o[0]==o[2]){y._tempPoints.push(o[0]+m,o[1],o[2]+m,o[3],o[0]-m,o[1],o[2]-m,o[3])}else if(o[1]==o[3]){y._tempPoints.push(o[0],o[1]+m,o[2],o[3]+m,o[0],o[1]-m,o[2],o[3]-m)}else{y._tempPoints.push(o[0],o[1],o[2],o[3])}y._addPointArrToRst(n,y._tempPoints,s);break;case e._drawCurves:case 22:y._addPointArrToRst(n,M.I.getBezierPoints(o[2]),s,o[0],o[1]);break;case e._drawPoly:case e._drawLines:case 18:y._addPointArrToRst(n,o[2],s,o[0],o[1]);break;case e._drawPath:case 19:y._addPointArrToRst(n,this._getPathPoints(o[2]),s,o[0],o[1]);break;case e._drawPie:case 15:y._addPointArrToRst(n,this._getPiePoints(o[0],o[1],o[2],o[3],o[4]),s);break}}if(n.length>200){n=ut.copyArray(n,R._getWrapRec(n)._getBoundPoints())}else if(n.length>8)n=L.scanPList(n);return n};t._switchMatrix=function(t,e){e.concat(t);e.copyTo(t)};t._getPiePoints=function(t,e,i,n,r){var s=y._tempPoints;y._tempPoints.length=0;s.push(t,e);var a=(r-n)%(2*Math.PI);var o=10;var h=a/o;var l=NaN;var u=n;for(l=0;l<=o;l++){s.push(t+i*Math.cos(u),e+i*Math.sin(u));u+=h}return s};t._getPathPoints=function(t){var e=0,i=0;var n=y._tempPoints;n.length=0;i=t.length;var r;for(e=0;e<i;e++){r=t[e];if(r.length>1){n.push(r[1],r[2]);if(r.length>3){n.push(r[3],r[4])}}}return n};y._addPointArrToRst=function(t,e,i,n,r){n===void 0&&(n=0);r===void 0&&(r=0);var s=0,a=0;a=e.length;for(s=0;s<a;s+=2){y._addPointToRst(t,e[s]+n,e[s+1]+r,i)}};y._addPointToRst=function(t,e,i,n){var r=D.TEMP;r.setTo(e?e:0,i?i:0);n.transformPoint(r);t.push(r.x,r.y)};y._tempPoints=[];y._tempMatrixArrays=[];y._tempCmds=[];h(y,["_tempMatrix",function(){return this._tempMatrix=new k},"_initMatrix",function(){return this._initMatrix=new k}]);return y}();var _=function(){function t(){}v(t,"laya.events.Event");var e=t.prototype;e.setTo=function(t,e,i){this.type=t;this.currentTarget=e;this.target=i;return this};e.stopPropagation=function(){this._stoped=true};u(0,e,"stageY",function(){return T.stage.mouseY});u(0,e,"charCode",function(){return this.nativeEvent.charCode});u(0,e,"touches",function(){var t=this.nativeEvent.touches;if(t){var e=T.stage;for(var i=0,n=t.length;i<n;i++){var r=t[i];var s=D.TEMP;s.setTo(r.clientX,r.clientY);e._canvasTransform.invertTransformPoint(s);e.transform.invertTransformPoint(s);r.stageX=s.x;r.stageY=s.y}}return t});u(0,e,"keyLocation",function(){return this.nativeEvent.keyLocation});u(0,e,"ctrlKey",function(){return this.nativeEvent.ctrlKey});u(0,e,"altKey",function(){return this.nativeEvent.altKey});u(0,e,"shiftKey",function(){return this.nativeEvent.shiftKey});u(0,e,"stageX",function(){return T.stage.mouseX});t.EMPTY=new t;t.MOUSE_DOWN="mousedown";t.MOUSE_UP="mouseup";t.CLICK="click";t.RIGHT_MOUSE_DOWN="rightmousedown";t.RIGHT_MOUSE_UP="rightmouseup";t.RIGHT_CLICK="rightclick";t.MOUSE_MOVE="mousemove";t.MOUSE_OVER="mouseover";t.MOUSE_OUT="mouseout";t.MOUSE_WHEEL="mousewheel";t.ROLL_OVER="mouseover";t.ROLL_OUT="mouseout";t.DOUBLE_CLICK="doubleclick";t.CHANGE="change";t.CHANGED="changed";t.RESIZE="resize";t.ADDED="added";t.REMOVED="removed";t.DISPLAY="display";t.UNDISPLAY="undisplay";t.ERROR="error";t.COMPLETE="complete";t.LOADED="loaded";t.PROGRESS="progress";t.INPUT="input";t.RENDER="render";t.OPEN="open";t.MESSAGE="message";t.CLOSE="close";t.KEY_DOWN="keydown";t.KEY_PRESS="keypress";t.KEY_UP="keyup";t.FRAME="enterframe";t.DRAG_START="dragstart";t.DRAG_MOVE="dragmove";t.DRAG_END="dragend";t.ENTER="enter";t.SELECT="select";t.BLUR="blur";t.FOCUS="focus";t.VISIBILITY_CHANGE="visibilitychange";t.FOCUS_CHANGE="focuschange";t.PLAYED="played";t.PAUSED="paused";t.STOPPED="stopped";t.START="start";t.END="end";t.ENABLE_CHANGED="enablechanged";t.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged";t.COMPONENT_ADDED="componentadded";t.COMPONENT_REMOVED="componentremoved";t.LAYER_CHANGED="layerchanged";t.HIERARCHY_LOADED="hierarchyloaded";t.RECOVERED="recovered";t.RELEASED="released";t.LINK="link";t.LABEL="label";t.FULL_SCREEN_CHANGE="fullscreenchange";t.DEVICE_LOST="devicelost";t.MESH_CHANGED="meshchanged";t.MATERIAL_CHANGED="materialchanged";t.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged";t.ANIMATION_CHANGED="animationchanged";t.TRIGGER_ENTER="triggerenter";t.TRIGGER_STAY="triggerstay";t.TRIGGER_EXIT="triggerexit";t.TRAIL_FILTER_CHANGE="trailfilterchange";t.DOMINO_FILTER_CHANGE="dominofilterchange";return t}();var p=function(){function t(){}v(t,"laya.events.Keyboard");t.NUMBER_0=48;t.NUMBER_1=49;t.NUMBER_2=50;t.NUMBER_3=51;t.NUMBER_4=52;t.NUMBER_5=53;t.NUMBER_6=54;t.NUMBER_7=55;t.NUMBER_8=56;t.NUMBER_9=57;t.A=65;t.B=66;t.C=67;t.D=68;t.E=69;t.F=70;t.G=71;t.H=72;t.I=73;t.J=74;t.K=75;t.L=76;t.M=77;t.N=78;t.O=79;t.P=80;t.Q=81;t.R=82;t.S=83;t.T=84;t.U=85;t.V=86;t.W=87;t.X=88;t.Y=89;t.Z=90;t.F1=112;t.F2=113;t.F3=114;t.F4=115;t.F5=116;t.F6=117;t.F7=118;t.F8=119;t.F9=120;t.F10=121;t.F11=122;t.F12=123;t.F13=124;t.F14=125;t.F15=126;t.NUMPAD=21;t.NUMPAD_0=96;t.NUMPAD_1=97;t.NUMPAD_2=98;t.NUMPAD_3=99;t.NUMPAD_4=100;t.NUMPAD_5=101;t.NUMPAD_6=102;t.NUMPAD_7=103;t.NUMPAD_8=104;t.NUMPAD_9=105;t.NUMPAD_ADD=107;t.NUMPAD_DECIMAL=110;t.NUMPAD_DIVIDE=111;t.NUMPAD_ENTER=108;t.NUMPAD_MULTIPLY=106;t.NUMPAD_SUBTRACT=109;t.SEMICOLON=186;t.EQUAL=187;t.COMMA=188;t.MINUS=189;t.PERIOD=190;t.SLASH=191;t.BACKQUOTE=192;t.LEFTBRACKET=219;t.BACKSLASH=220;t.RIGHTBRACKET=221;t.QUOTE=222;t.ALTERNATE=18;t.BACKSPACE=8;t.CAPS_LOCK=20;t.COMMAND=15;t.CONTROL=17;t.DELETE=46;t.ENTER=13;t.ESCAPE=27;t.PAGE_UP=33;t.PAGE_DOWN=34;t.END=35;t.HOME=36;t.LEFT=37;t.UP=38;t.RIGHT=39;t.DOWN=40;t.SHIFT=16;t.SPACE=32;t.TAB=9;t.INSERT=45;return t}();var y=function(){function r(){}v(r,"laya.events.KeyBoardManager");r.__init__=function(){r._addEvent("keydown");r._addEvent("keypress");r._addEvent("keyup")};r._addEvent=function(e){j.document.addEventListener(e,function(t){laya.events.KeyBoardManager._dispatch(t,e)},true)};r._dispatch=function(t,e){if(!r.enabled)return;r._event._stoped=false;r._event.nativeEvent=t;r._event.keyCode=t.keyCode||t.which||t.charCode;if(e==="keydown")r._pressKeys[r._event.keyCode]=true;else if(e==="keyup")r._pressKeys[r._event.keyCode]=null;var i=T.stage.focus&&T.stage.focus.event!=null&&T.stage.focus.displayedInStage?T.stage.focus:T.stage;var n=i;while(n){n.event(e,r._event.setTo(e,n,i));n=n.parent}};r.hasKeyDown=function(t){return r._pressKeys[t]};r._pressKeys={};r.enabled=true;h(r,["_event",function(){return this._event=new _}]);return r}();var b=function(){function t(){}v(t,"laya.events.KeyLocation");t.STANDARD=0;t.LEFT=1;t.RIGHT=2;t.NUM_PAD=3;return t}();var x=function(){function c(){this.mouseX=0;this.mouseY=0;this.disableMouseEvent=false;this.mouseDownTime=0;this.mouseMoveAccuracy=2;this._stage=null;this._target=null;this._lastMoveTimer=0;this._isLeftMouse=false;this._eventList=[];this._touchIDs={};this._id=1;this._tTouchID=0;this._event=new _;this._matrix=new k;this._point=new D;this._rect=new R;this._prePoint=new D;this._curTouchID=NaN}v(c,"laya.events.MouseManager");var t=c.prototype;t.__init__=function(t,e){var i=this;this._stage=t;var n=this;var r=this._eventList;e.oncontextmenu=function(t){if(c.enabled)return false};e.addEventListener("mousedown",function(t){if(c.enabled){if(!j.onIE)t.preventDefault();r.push(t);n.mouseDownTime=j.now()}});e.addEventListener("mouseup",function(t){if(c.enabled){t.preventDefault();r.push(t);n.mouseDownTime=-j.now()}},true);e.addEventListener("mousemove",function(t){if(c.enabled){t.preventDefault();var e=j.now();if(e-n._lastMoveTimer<10)return;n._lastMoveTimer=e;r.push(t)}},true);e.addEventListener("mouseout",function(t){if(c.enabled)r.push(t)});e.addEventListener("mouseover",function(t){if(c.enabled)r.push(t)});e.addEventListener("touchstart",function(t){if(c.enabled){r.push(t);if(!c._isFirstTouch&&!Wt.isInputting)t.preventDefault();n.mouseDownTime=j.now()}});e.addEventListener("touchend",function(t){if(c.enabled){if(!c._isFirstTouch&&!Wt.isInputting)t.preventDefault();c._isFirstTouch=false;r.push(t);n.mouseDownTime=-j.now()}else{i._curTouchID=NaN}},true);e.addEventListener("touchmove",function(t){if(c.enabled){t.preventDefault();r.push(t)}},true);e.addEventListener("touchcancel",function(t){if(c.enabled){t.preventDefault();r.push(t)}else{i._curTouchID=NaN}},true);e.addEventListener("mousewheel",function(t){if(c.enabled)r.push(t)});e.addEventListener("DOMMouseScroll",function(t){if(c.enabled)r.push(t)})};t.initEvent=function(t,e){var i=this;i._event._stoped=false;i._event.nativeEvent=e||t;i._target=null;this._point.setTo(t.pageX||t.clientX,t.pageY||t.clientY);this._stage._canvasTransform.invertTransformPoint(this._point);i.mouseX=this._point.x;i.mouseY=this._point.y;i._event.touchId=t.identifier||0;this._tTouchID=i._event.touchId;var n;n=w.I._event;n._stoped=false;n.nativeEvent=i._event.nativeEvent;n.touchId=i._event.touchId};t.checkMouseWheel=function(t){this._event.delta=t.wheelDelta?t.wheelDelta*.025:-t.detail;var e=w.I.getLastOvers();for(var i=0,n=e.length;i<n;i++){var r=e[i];r.event("mousewheel",this._event.setTo("mousewheel",r,this._target))}};t.onMouseMove=function(t){w.I.onMouseMove(t,this._tTouchID)};t.onMouseDown=function(t){if(Wt.isInputting&&T.stage.focus&&T.stage.focus["focus"]&&!T.stage.focus.contains(this._target)){var e=T.stage.focus["_tf"]||T.stage.focus;var i=t["_tf"]||t;if(i instanceof laya.display.Input&&i.multiline==e.multiline)e["_focusOut"]();else e.focus=false}w.I.onMouseDown(t,this._tTouchID,this._isLeftMouse)};t.onMouseUp=function(t){w.I.onMouseUp(t,this._tTouchID,this._isLeftMouse)};t.check=function(t,e,i,n){this._point.setTo(e,i);t.fromParentPoint(this._point);e=this._point.x;i=this._point.y;var r=t.scrollRect;if(r){this._rect.setTo(r.x,r.y,r.width,r.height);if(!this._rect.contains(e,i))return false}if(!this.disableMouseEvent){if(t.hitTestPrior&&!t.mouseThrough&&!this.hitTest(t,e,i)){return false}for(var s=t._childs.length-1;s>-1;s--){var a=t._childs[s];if(!a.destroyed&&a.mouseEnabled&&a.visible){if(this.check(a,e,i,n))return true}}}var o=t.hitTestPrior&&!t.mouseThrough&&!this.disableMouseEvent?true:this.hitTest(t,e,i);if(o){this._target=t;n.call(this,t)}else if(n===this.onMouseUp&&t===this._stage){this._target=this._stage;n.call(this,this._target)}return o};t.hitTest=function(t,e,i){var n=false;if(t.scrollRect){e-=t.scrollRect.x;i-=t.scrollRect.y}if(t.hitArea instanceof laya.utils.HitArea){return t.hitArea.isHit(e,i)}if(t.width>0&&t.height>0||t.mouseThrough||t.hitArea){if(!t.mouseThrough){var r=this._rect;if(t.hitArea)r=t.hitArea;else r.setTo(0,0,t.width,t.height);n=r.contains(e,i)}else{n=t.getGraphicBounds().contains(e,i)}}return n};t.runEvent=function(){var t=this._eventList.length;if(!t)return;var e=this;var i=0,n=0,r=0,s;while(i<t){var a=this._eventList[i];if(a.type!=="mousemove")this._prePoint.x=this._prePoint.y=-1e6;switch(a.type){case"mousedown":this._touchIDs[0]=this._id++;if(!c._isTouchRespond){e._isLeftMouse=a.button===0;e.initEvent(a);e.check(e._stage,e.mouseX,e.mouseY,e.onMouseDown)}else c._isTouchRespond=false;break;case"mouseup":e._isLeftMouse=a.button===0;e.initEvent(a);e.check(e._stage,e.mouseX,e.mouseY,e.onMouseUp);break;case"mousemove":if(Math.abs(this._prePoint.x-a.clientX)+Math.abs(this._prePoint.y-a.clientY)>=this.mouseMoveAccuracy){this._prePoint.x=a.clientX;this._prePoint.y=a.clientY;e.initEvent(a);e.check(e._stage,e.mouseX,e.mouseY,e.onMouseMove)}break;case"touchstart":c._isTouchRespond=true;e._isLeftMouse=true;var o=a.changedTouches;for(n=0,r=o.length;n<r;n++){s=o[n];if(c.multiTouchEnabled||isNaN(this._curTouchID)){this._curTouchID=s.identifier;if(this._id%200===0)this._touchIDs={};this._touchIDs[s.identifier]=this._id++;e.initEvent(s,a);e.check(e._stage,e.mouseX,e.mouseY,e.onMouseDown)}}break;case"touchend":case"touchcancel":c._isTouchRespond=true;e._isLeftMouse=true;var h=a.changedTouches;for(n=0,r=h.length;n<r;n++){s=h[n];if(c.multiTouchEnabled||s.identifier==this._curTouchID){this._curTouchID=NaN;e.initEvent(s,a);var l=false;l=e.check(e._stage,e.mouseX,e.mouseY,e.onMouseUp);if(!l){e.onMouseUp(null)}}}break;case"touchmove":;var u=a.changedTouches;for(n=0,r=u.length;n<r;n++){s=u[n];if(c.multiTouchEnabled||s.identifier==this._curTouchID){e.initEvent(s,a);e.check(e._stage,e.mouseX,e.mouseY,e.onMouseMove)}}break;case"wheel":case"mousewheel":case"DOMMouseScroll":e.checkMouseWheel(a);break;case"mouseout":w.I.stageMouseOut();break;case"mouseover":e._stage.event("mouseover",e._event.setTo("mouseover",e._stage,e._stage));break}i++}this._eventList.length=0};c.enabled=true;c.multiTouchEnabled=true;c._isTouchRespond=false;c._isFirstTouch=true;h(c,["instance",function(){return this.instance=new c}]);return c}();var w=function(){function p(){this.preOvers=[];this.preDowns=[];this.preRightDowns=[];this.enable=true;this._lastClickTime=0;this._event=new _}v(p,"laya.events.TouchManager");var t=p.prototype;t._clearTempArrs=function(){p._oldArr.length=0;p._newArr.length=0;p._tEleArr.length=0};t.getTouchFromArr=function(t,e){var i=0,n=0;n=e.length;var r;for(i=0;i<n;i++){r=e[i];if(r.id==t){return r}}return null};t.removeTouchFromArr=function(t,e){var i=0;for(i=e.length-1;i>=0;i--){if(e[i].id==t){e.splice(i,1)}}};t.createTouchO=function(t,e){var i;i=rt.getItem("TouchData")||{};i.id=e;i.tar=t;return i};t.onMouseDown=function(t,e,i){i===void 0&&(i=false);if(!this.enable)return;var n;var r;var s;n=this.getTouchFromArr(e,this.preOvers);s=this.getEles(t,null,p._tEleArr);if(!n){r=this.createTouchO(t,e);this.preOvers.push(r)}else{n.tar=t}if(j.onMobile)this.sendEvents(s,"mouseover");var a;a=i?this.preDowns:this.preRightDowns;n=this.getTouchFromArr(e,a);if(!n){r=this.createTouchO(t,e);a.push(r)}else{n.tar=t}this.sendEvents(s,i?"mousedown":"rightmousedown");this._clearTempArrs()};t.sendEvents=function(t,e){var i=0,n=0;n=t.length;this._event._stoped=false;var r;r=t[0];var s;for(i=0;i<n;i++){s=t[i];if(s.destroyed)return;s.event(e,this._event.setTo(e,s,r));if(this._event._stoped)break}};t.getEles=function(t,e,i){if(!i){i=[]}else{i.length=0}while(t&&t!=e){i.push(t);t=t.parent}return i};t.checkMouseOutAndOverOfMove=function(t,e,i){i===void 0&&(i=0);if(e==t)return;var n;var r;var s=0,a=0;if(e.contains(t)){r=this.getEles(t,e,p._tEleArr);this.sendEvents(r,"mouseover")}else if(t.contains(e)){r=this.getEles(e,t,p._tEleArr);this.sendEvents(r,"mouseout")}else{r=p._tEleArr;r.length=0;var o;o=this.getEles(e,null,p._oldArr);var h;h=this.getEles(t,null,p._newArr);a=o.length;var l=0;for(s=0;s<a;s++){n=o[s];l=h.indexOf(n);if(l>=0){h.splice(l,h.length-l);break}else{r.push(n)}}if(r.length>0){this.sendEvents(r,"mouseout")}if(h.length>0){this.sendEvents(h,"mouseover")}}};t.onMouseMove=function(t,e){if(!this.enable)return;var i;i=this.getTouchFromArr(e,this.preOvers);var n;var r;if(!i){n=this.getEles(t,null,p._tEleArr);this.sendEvents(n,"mouseover");this.preOvers.push(this.createTouchO(t,e))}else{this.checkMouseOutAndOverOfMove(t,i.tar);i.tar=t;n=this.getEles(t,null,p._tEleArr)}this.sendEvents(n,"mousemove");this._clearTempArrs()};t.getLastOvers=function(){p._tEleArr.length=0;if(this.preOvers.length>0&&this.preOvers[0].tar){return this.getEles(this.preOvers[0].tar,null,p._tEleArr)}p._tEleArr.push(T.stage);return p._tEleArr};t.stageMouseOut=function(){var t;t=this.getLastOvers();this.preOvers.length=0;this.sendEvents(t,"mouseout")};t.onMouseUp=function(t,e,i){i===void 0&&(i=false);if(!this.enable)return;var n;var r;var s;var a;var o=0,h=0;var l;var u;var c=j.onMobile;s=this.getEles(t,null,p._tEleArr);this.sendEvents(s,i?"mouseup":"rightmouseup");var f;f=i?this.preDowns:this.preRightDowns;n=this.getTouchFromArr(e,f);if(!n){}else{var _=false;var d=j.now();_=d-this._lastClickTime<300;this._lastClickTime=d;if(t==n.tar){u=s}else{a=this.getEles(n.tar,null,p._oldArr);u=p._newArr;u.length=0;h=a.length;for(o=0;o<h;o++){l=a[o];if(s.indexOf(l)>=0){u.push(l)}}}if(u.length>0){this.sendEvents(u,i?"click":"rightclick")}if(i&&_){this.sendEvents(u,"doubleclick")}this.removeTouchFromArr(e,f);n.tar=null;rt.recover("TouchData",n)}n=this.getTouchFromArr(e,this.preOvers);if(!n){}else{if(c){u=this.getEles(n.tar,null,u);if(u&&u.length>0){this.sendEvents(u,"mouseout")}this.removeTouchFromArr(e,this.preOvers);n.tar=null;rt.recover("TouchData",n)}}this._clearTempArrs()};p._oldArr=[];p._newArr=[];p._tEleArr=[];h(p,["I",function(){return this.I=new p}]);return p}();var S=function(){function t(){this._action=null}v(t,"laya.filters.Filter");var e=t.prototype;T.imps(e,{"laya.filters.IFilter":true});e.callNative=function(t){};u(0,e,"type",function(){return-1});u(0,e,"action",function(){return this._action});t.BLUR=16;t.COLOR=32;t.GLOW=8;t._filterStart=null;t._filterEnd=null;t._EndTarget=null;t._recycleScope=null;t._filter=null;t._useSrc=null;t._endSrc=null;t._useOut=null;t._endOut=null;return t}();var C=function(){function t(){this.data=null}v(t,"laya.filters.ColorFilterAction");var e=t.prototype;T.imps(e,{"laya.filters.IFilterAction":true});e.apply=function(t){var e=t.ctx.ctx;var i=t.ctx.ctx.canvas;if(i.width==0||i.height==0)return i;var n=e.getImageData(0,0,i.width,i.height);var r=n.data;var s;for(var a=0,o=r.length;a<o;a+=4){s=this.getColor(r[a],r[a+1],r[a+2],r[a+3]);if(r[a+3]==0)continue;r[a]=s[0];r[a+1]=s[1];r[a+2]=s[2];r[a+3]=s[3]}e.putImageData(n,0,0);return t};e.getColor=function(t,e,i,n){var r=[];if(this.data._mat&&this.data._alpha){var s=this.data._mat;var a=this.data._alpha;r[0]=s[0]*t+s[1]*e+s[2]*i+s[3]*n+a[0];r[1]=s[4]*t+s[5]*e+s[6]*i+s[7]*n+a[1];r[2]=s[8]*t+s[9]*e+s[10]*i+s[11]*n+a[2];r[3]=s[12]*t+s[13]*e+s[14]*i+s[15]*n+a[3]}return r};return t}();var E=function(){function t(){}v(t,"laya.maths.Arith");t.formatR=function(t){if(t>Math.PI)t-=Math.PI*2;if(t<-Math.PI)t+=Math.PI*2;return t};t.isPOT=function(t,e){return t>0&&(t&t-1)===0&&e>0&&(e&e-1)===0};t.setMatToArray=function(t,e){t.a,t.b,0,0,t.c,t.d,0,0,0,0,1,0,t.tx+20,t.ty+20,0,1;e[0]=t.a;e[1]=t.b;e[4]=t.c;e[5]=t.d;e[12]=t.tx;e[13]=t.ty};return t}();var M=function(){function t(){this._controlPoints=[new D,new D,new D];this._calFun=this.getPoint2}v(t,"laya.maths.Bezier");var e=t.prototype;e._switchPoint=function(t,e){var i=this._controlPoints.shift();i.setTo(t,e);this._controlPoints.push(i)};e.getPoint2=function(t,e){var i=this._controlPoints[0];var n=this._controlPoints[1];var r=this._controlPoints[2];var s=Math.pow(1-t,2)*i.x+2*t*(1-t)*n.x+Math.pow(t,2)*r.x;var a=Math.pow(1-t,2)*i.y+2*t*(1-t)*n.y+Math.pow(t,2)*r.y;e.push(s,a)};e.getPoint3=function(t,e){var i=this._controlPoints[0];var n=this._controlPoints[1];var r=this._controlPoints[2];var s=this._controlPoints[3];var a=Math.pow(1-t,3)*i.x+3*n.x*t*(1-t)*(1-t)+3*r.x*t*t*(1-t)+s.x*Math.pow(t,3);var o=Math.pow(1-t,3)*i.y+3*n.y*t*(1-t)*(1-t)+3*r.y*t*t*(1-t)+s.y*Math.pow(t,3);e.push(a,o)};e.insertPoints=function(t,e){var i=NaN;t=t>0?t:5;var n=NaN;n=1/t;for(i=0;i<=1;i+=n){this._calFun(i,e)}};e.getBezierPoints=function(t,e,i){e===void 0&&(e=5);i===void 0&&(i=2);var n=0,r=0;r=t.length;if(r<(i+1)*2)return[];var s;s=[];switch(i){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}while(this._controlPoints.length<=i){this._controlPoints.push(new D)}for(n=0;n<i*2;n+=2){this._switchPoint(t[n],t[n+1])}for(n=i*2;n<r;n+=2){this._switchPoint(t[n],t[n+1]);if(n/2%i==0)this.insertPoints(e,s)}return s};h(t,["I",function(){return this.I=new t}]);return t}();var L=function(){function u(){}v(u,"laya.maths.GrahamScan");u.multiply=function(t,e,i){return(t.x-i.x)*(e.y-i.y)-(e.x-i.x)*(t.y-i.y)};u.dis=function(t,e){return(t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)};u._getPoints=function(t,e,i){e===void 0&&(e=false);if(!u._mPointList)u._mPointList=[];while(u._mPointList.length<t)u._mPointList.push(new D);if(!i)i=[];i.length=0;if(e){u.getFrom(i,u._mPointList,t)}else{u.getFromR(i,u._mPointList,t)}return i};u.getFrom=function(t,e,i){var n=0;for(n=0;n<i;n++){t.push(e[n])}return t};u.getFromR=function(t,e,i){var n=0;for(n=0;n<i;n++){t.push(e.pop())}return t};u.pListToPointList=function(t,e){e===void 0&&(e=false);var i=0,n=t.length/2,r=u._getPoints(n,e,u._tempPointList);for(i=0;i<n;i++){r[i].setTo(t[i+i],t[i+i+1])}return r};u.pointListToPlist=function(t){var e=0,i=t.length,n=u._temPList,r;n.length=0;for(e=0;e<i;e++){r=t[e];n.push(r.x,r.y)}return n};u.scanPList=function(t){return ut.copyArray(t,u.pointListToPlist(u.scan(u.pListToPointList(t,true))))};u.scan=function(t){var e=0,i=0,n=0,r=2,s,a=t.length,o;var h={};var l;o=u._temArr;o.length=0;a=t.length;for(e=a-1;e>=0;e--){s=t[e];l=s.x+"_"+s.y;if(!h.hasOwnProperty(l)){h[l]=true;o.push(s)}}a=o.length;ut.copyArray(t,o);for(e=1;e<a;e++)if(t[e].y<t[n].y||t[e].y==t[n].y&&t[e].x<t[n].x)n=e;s=t[0];t[0]=t[n];t[n]=s;for(e=1;e<a-1;e++){n=e;for(i=e+1;i<a;i++)if(u.multiply(t[i],t[n],t[0])>0||u.multiply(t[i],t[n],t[0])==0&&u.dis(t[0],t[i])<u.dis(t[0],t[n]))n=i;s=t[e];t[e]=t[n];t[n]=s}o=u._temArr;o.length=0;if(t.length<3){return ut.copyArray(o,t)}o.push(t[0],t[1],t[2]);for(e=3;e<a;e++){while(o.length>=2&&u.multiply(t[e],o[o.length-1],o[o.length-2])>=0)o.pop();t[e]&&o.push(t[e])}return o};u._mPointList=null;u._tempPointList=[];u._temPList=[];u._temArr=[];return u}();var P=function(){function r(){}v(r,"laya.maths.MathUtil");r.subtractVector3=function(t,e,i){i[0]=t[0]-e[0];i[1]=t[1]-e[1];i[2]=t[2]-e[2]};r.lerp=function(t,e,i){return t*(1-i)+e*i};r.scaleVector3=function(t,e,i){i[0]=t[0]*e;i[1]=t[1]*e;i[2]=t[2]*e};r.lerpVector3=function(t,e,i,n){var r=t[0],s=t[1],a=t[2];n[0]=r+i*(e[0]-r);n[1]=s+i*(e[1]-s);n[2]=a+i*(e[2]-a)};r.lerpVector4=function(t,e,i,n){var r=t[0],s=t[1],a=t[2],o=t[3];n[0]=r+i*(e[0]-r);n[1]=s+i*(e[1]-s);n[2]=a+i*(e[2]-a);n[3]=o+i*(e[3]-o)};r.slerpQuaternionArray=function(t,e,i,n,r,s,a){var o=t[e+0],h=t[e+1],l=t[e+2],u=t[e+3],c=i[n+0],f=i[n+1],_=i[n+2],d=i[n+3];var p,v,g,m,y;v=o*c+h*f+l*_+u*d;if(v<0){v=-v;c=-c;f=-f;_=-_;d=-d}if(1-v>1e-6){p=Math.acos(v);g=Math.sin(p);m=Math.sin((1-r)*p)/g;y=Math.sin(r*p)/g}else{m=1-r;y=r}s[a+0]=m*o+y*c;s[a+1]=m*h+y*f;s[a+2]=m*l+y*_;s[a+3]=m*u+y*d;return s};r.getRotation=function(t,e,i,n){return Math.atan2(n-e,i-t)/Math.PI*180};r.sortBigFirst=function(t,e){if(t==e)return 0;return e>t?1:-1};r.sortSmallFirst=function(t,e){if(t==e)return 0;return e>t?-1:1};r.sortNumBigFirst=function(t,e){return parseFloat(e)-parseFloat(t)};r.sortNumSmallFirst=function(t,e){return parseFloat(t)-parseFloat(e)};r.sortByKey=function(i,t,e){t===void 0&&(t=false);e===void 0&&(e=true);var n;if(t){n=e?r.sortNumBigFirst:r.sortBigFirst}else{n=e?r.sortNumSmallFirst:r.sortSmallFirst}return function(t,e){return n(t[i],e[i])}};return r}();var k=function(){function i(t,e,i,n,r,s){this.inPool=false;this.bTransform=false;t===void 0&&(t=1);e===void 0&&(e=0);i===void 0&&(i=0);n===void 0&&(n=1);r===void 0&&(r=0);s===void 0&&(s=0);this.a=t;this.b=e;this.c=i;this.d=n;this.tx=r;this.ty=s;this._checkTransform()}v(i,"laya.maths.Matrix");var t=i.prototype;t.identity=function(){this.a=this.d=1;this.b=this.tx=this.ty=this.c=0;this.bTransform=false;return this};t._checkTransform=function(){return this.bTransform=this.a!==1||this.b!==0||this.c!==0||this.d!==1};t.setTranslate=function(t,e){this.tx=t;this.ty=e;return this};t.translate=function(t,e){this.tx+=t;this.ty+=e;return this};t.scale=function(t,e){this.a*=t;this.d*=e;this.c*=t;this.b*=e;this.tx*=t;this.ty*=e;this.bTransform=true};t.rotate=function(t){var e=Math.cos(t);var i=Math.sin(t);var n=this.a;var r=this.c;var s=this.tx;this.a=n*e-this.b*i;this.b=n*i+this.b*e;this.c=r*e-this.d*i;this.d=r*i+this.d*e;this.tx=s*e-this.ty*i;this.ty=s*i+this.ty*e;this.bTransform=true};t.skew=function(t,e){var i=Math.tan(t);var n=Math.tan(e);var r=this.a;var s=this.b;this.a+=n*this.c;this.b+=n*this.d;this.c+=i*r;this.d+=i*s;return this};t.invertTransformPoint=function(t){var e=this.a;var i=this.b;var n=this.c;var r=this.d;var s=this.tx;var a=e*r-i*n;var o=r/a;var h=-i/a;var l=-n/a;var u=e/a;var c=(n*this.ty-r*s)/a;var f=-(e*this.ty-i*s)/a;return t.setTo(o*t.x+l*t.y+c,h*t.x+u*t.y+f)};t.transformPoint=function(t){return t.setTo(this.a*t.x+this.c*t.y+this.tx,this.b*t.x+this.d*t.y+this.ty)};t.transformPointN=function(t){return t.setTo(this.a*t.x+this.c*t.y,this.b*t.x+this.d*t.y)};t.transformPointArray=function(t,e){var i=t.length;for(var n=0;n<i;n+=2){var r=t[n],s=t[n+1];e[n]=this.a*r+this.c*s+this.tx;e[n+1]=this.b*r+this.d*s+this.ty}return e};t.transformPointArrayScale=function(t,e){var i=t.length;for(var n=0;n<i;n+=2){var r=t[n],s=t[n+1];e[n]=this.a*r+this.c*s;e[n+1]=this.b*r+this.d*s}return e};t.getScaleX=function(){return this.b===0?this.a:Math.sqrt(this.a*this.a+this.b*this.b)};t.getScaleY=function(){return this.c===0?this.d:Math.sqrt(this.c*this.c+this.d*this.d)};t.invert=function(){var t=this.a;var e=this.b;var i=this.c;var n=this.d;var r=this.tx;var s=t*n-e*i;this.a=n/s;this.b=-e/s;this.c=-i/s;this.d=t/s;this.tx=(i*this.ty-n*r)/s;this.ty=-(t*this.ty-e*r)/s;return this};t.setTo=function(t,e,i,n,r,s){this.a=t,this.b=e,this.c=i,this.d=n,this.tx=r,this.ty=s;return this};t.concat=function(t){var e=this.a;var i=this.c;var n=this.tx;this.a=e*t.a+this.b*t.c;this.b=e*t.b+this.b*t.d;this.c=i*t.a+this.d*t.c;this.d=i*t.b+this.d*t.d;this.tx=n*t.a+this.ty*t.c+t.tx;this.ty=n*t.b+this.ty*t.d+t.ty;return this};t.scaleEx=function(t,e){var i=this.a,n=this.b,r=this.c,s=this.d;if(n!==0||r!==0){this.a=t*i;this.b=t*n;this.c=e*r;this.d=e*s}else{this.a=t*i;this.b=0*s;this.c=0*i;this.d=e*s}this.bTransform=true};t.rotateEx=function(t){var e=Math.cos(t);var i=Math.sin(t);var n=this.a,r=this.b,s=this.c,a=this.d;if(r!==0||s!==0){this.a=e*n+i*s;this.b=e*r+i*a;this.c=-i*n+e*s;this.d=-i*r+e*a}else{this.a=e*n;this.b=i*a;this.c=-i*n;this.d=e*a}this.bTransform=true};t.clone=function(){var t=i.create();t.a=this.a;t.b=this.b;t.c=this.c;t.d=this.d;t.tx=this.tx;t.ty=this.ty;t.bTransform=this.bTransform;return t};t.copyTo=function(t){t.a=this.a;t.b=this.b;t.c=this.c;t.d=this.d;t.tx=this.tx;t.ty=this.ty;t.bTransform=this.bTransform;return t};t.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty};t.destroy=function(){if(this.inPool)return;var t=i._cache;this.inPool=true;t._length||(t._length=0);t[t._length++]=this;this.a=this.d=1;this.b=this.c=this.tx=this.ty=0;this.bTransform=false};i.mul=function(t,e,i){var n=t.a,r=t.b,s=t.c,a=t.d,o=t.tx,h=t.ty;var l=e.a,u=e.b,c=e.c,f=e.d,_=e.tx,d=e.ty;if(u!==0||c!==0){i.a=n*l+r*c;i.b=n*u+r*f;i.c=s*l+a*c;i.d=s*u+a*f;i.tx=l*o+c*h+_;i.ty=u*o+f*h+d}else{i.a=n*l;i.b=r*f;i.c=s*l;i.d=a*f;i.tx=l*o+_;i.ty=f*h+d}return i};i.mul16=function(t,e,i){var n=t.a,r=t.b,s=t.c,a=t.d,o=t.tx,h=t.ty;var l=e.a,u=e.b,c=e.c,f=e.d,_=e.tx,d=e.ty;if(u!==0||c!==0){i[0]=n*l+r*c;i[1]=n*u+r*f;i[4]=s*l+a*c;i[5]=s*u+a*f;i[12]=l*o+c*h+_;i[13]=u*o+f*h+d}else{i[0]=n*l;i[1]=r*f;i[4]=s*l;i[5]=a*f;i[12]=l*o+_;i[13]=f*h+d}return i};i.mulPre=function(t,e,i,n,r,s,a,o){var h=t.a,l=t.b,u=t.c,c=t.d,f=t.tx,_=t.ty;if(i!==0||n!==0){o.a=h*e+l*n;o.b=h*i+l*r;o.c=u*e+c*n;o.d=u*i+c*r;o.tx=e*f+n*_+s;o.ty=i*f+r*_+a}else{o.a=h*e;o.b=l*r;o.c=u*e;o.d=c*r;o.tx=e*f+s;o.ty=r*_+a}return o};i.mulPos=function(t,e,i,n,r,s,a,o){var h=t.a,l=t.b,u=t.c,c=t.d,f=t.tx,_=t.ty;if(l!==0||u!==0){o.a=e*h+i*u;o.b=e*l+i*c;o.c=n*h+r*u;o.d=n*l+r*c;o.tx=h*s+u*a+f;o.ty=l*s+c*a+_}else{o.a=e*h;o.b=i*c;o.c=n*h;o.d=r*c;o.tx=h*s+f;o.ty=c*a+_}return o};i.preMul=function(t,e,i){var n=t.a,r=t.b,s=t.c,a=t.d;var o=e.a,h=e.b,l=e.c,u=e.d,c=e.tx,f=e.ty;i.a=o*n;i.b=i.c=0;i.d=u*a;i.tx=c*n+t.tx;i.ty=f*a+t.ty;if(h!==0||l!==0||r!==0||s!==0){i.a+=h*s;i.d+=l*r;i.b+=o*r+h*a;i.c+=l*n+u*s;i.tx+=f*s;i.ty+=c*r}return i};i.preMulXY=function(t,e,i,n){var r=t.a,s=t.b,a=t.c,o=t.d;n.a=r;n.b=s;n.c=a;n.d=o;n.tx=e*r+t.tx+i*a;n.ty=i*o+t.ty+e*s;return n};i.create=function(){var t=i._cache;var e=!t._length?new i:t[--t._length];e.inPool=false;return e};i.EMPTY=new i;i.TEMP=new i;i._cache=[];return i}();var D=function(){function t(t,e){t===void 0&&(t=0);e===void 0&&(e=0);this.x=t;this.y=e}v(t,"laya.maths.Point");var e=t.prototype;e.setTo=function(t,e){this.x=t;this.y=e;return this};e.distance=function(t,e){return Math.sqrt((this.x-t)*(this.x-t)+(this.y-e)*(this.y-e))};e.toString=function(){return this.x+","+this.y};e.normalize=function(){var t=Math.sqrt(this.x*this.x+this.y*this.y);if(t>0){var e=1/t;this.x*=e;this.y*=e}};t.TEMP=new t;t.EMPTY=new t;return t}();var R=function(){function l(t,e,i,n){t===void 0&&(t=0);e===void 0&&(e=0);i===void 0&&(i=0);n===void 0&&(n=0);this.x=t;this.y=e;this.width=i;this.height=n}v(l,"laya.maths.Rectangle");var t=l.prototype;t.setTo=function(t,e,i,n){this.x=t;this.y=e;this.width=i;this.height=n;return this};t.copyFrom=function(t){this.x=t.x;this.y=t.y;this.width=t.width;this.height=t.height;return this};t.contains=function(t,e){if(this.width<=0||this.height<=0)return false;if(t>=this.x&&t<this.right){if(e>=this.y&&e<this.bottom){return true}}return false};t.intersects=function(t){return!(t.x>this.x+this.width||t.x+t.width<this.x||t.y>this.y+this.height||t.y+t.height<this.y)};t.intersection=function(t,e){if(!this.intersects(t))return null;e||(e=new l);e.x=Math.max(this.x,t.x);e.y=Math.max(this.y,t.y);e.width=Math.min(this.right,t.right)-e.x;e.height=Math.min(this.bottom,t.bottom)-e.y;return e};t.union=function(t,e){e||(e=new l);this.clone(e);if(t.width<=0||t.height<=0)return e;e.addPoint(t.x,t.y);e.addPoint(t.right,t.bottom);return this};t.clone=function(t){t||(t=new l);t.x=this.x;t.y=this.y;t.width=this.width;t.height=this.height;return t};t.toString=function(){return this.x+","+this.y+","+this.width+","+this.height};t.equals=function(t){if(!t||t.x!==this.x||t.y!==this.y||t.width!==this.width||t.height!==this.height)return false;return true};t.addPoint=function(t,e){this.x>t&&(this.width+=this.x-t,this.x=t);this.y>e&&(this.height+=this.y-e,this.y=e);if(this.width<t-this.x)this.width=t-this.x;if(this.height<e-this.y)this.height=e-this.y;return this};t._getBoundPoints=function(){var t=l._temB;t.length=0;if(this.width==0||this.height==0)return t;t.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height);return t};t.isEmpty=function(){if(this.width<=0||this.height<=0)return true;return false};u(0,t,"right",function(){return this.x+this.width});u(0,t,"bottom",function(){return this.y+this.height});l._getBoundPointS=function(t,e,i,n){var r=l._temA;r.length=0;if(i==0||n==0)return r;r.push(t,e,t+i,e,t,e+n,t+i,e+n);return r};l._getWrapRec=function(t,e){if(!t||t.length<1)return e?e.setTo(0,0,0,0):l.TEMP.setTo(0,0,0,0);e=e?e:new l;var i,n=t.length,r,s,a,o,h=D.TEMP;r=a=99999;s=o=-r;for(i=0;i<n;i+=2){h.x=t[i];h.y=t[i+1];r=r<h.x?r:h.x;a=a<h.y?a:h.y;s=s>h.x?s:h.x;o=o>h.y?o:h.y}return e.setTo(r,a,s-r,o-a)};l.EMPTY=new l;l.TEMP=new l;l._temB=[];l._temA=[];return l}();var N=function(){function h(){}v(h,"laya.media.SoundManager");u(1,h,"useAudioMusic",function(){return h._useAudioMusic},function(t){h._useAudioMusic=t;if(t){h._musicClass=vt}else{h._musicClass=null}});u(1,h,"autoStopMusic",function(){return h._autoStopMusic},function(t){T.stage.off("blur",null,h._stageOnBlur);T.stage.off("focus",null,h._stageOnFocus);T.stage.off("visibilitychange",null,h._visibilityChange);h._autoStopMusic=t;if(t){T.stage.on("blur",null,h._stageOnBlur);T.stage.on("focus",null,h._stageOnFocus);T.stage.on("visibilitychange",null,h._visibilityChange)}});u(1,h,"muted",function(){return h._muted},function(t){if(t==h._muted)return;if(t){h.stopAllSound()}h.musicMuted=t;h._muted=t});u(1,h,"musicMuted",function(){return h._musicMuted},function(t){if(t==h._musicMuted)return;if(t){if(h._tMusic){if(h._musicChannel&&!h._musicChannel.isStopped){if(G.isConchApp){if(h._musicChannel._audio)h._musicChannel._audio.muted=true}else{h._musicChannel.pause()}}else{h._musicChannel=null}}else{h._musicChannel=null}h._musicMuted=t}else{h._musicMuted=t;if(h._tMusic){if(h._musicChannel){if(G.isConchApp){if(h._musicChannel._audio)h._musicChannel._audio.muted=false}else{h._musicChannel.resume()}}}}});u(1,h,"soundMuted",function(){return h._soundMuted},function(t){h._soundMuted=t});h.addChannel=function(t){if(h._channels.indexOf(t)>=0)return;h._channels.push(t)};h.removeChannel=function(t){var e=0;for(e=h._channels.length-1;e>=0;e--){if(h._channels[e]==t){h._channels.splice(e,1)}}};h.disposeSoundIfNotUsed=function(t){var e=0;for(e=h._channels.length-1;e>=0;e--){if(h._channels[e].url==t){return}}h.destroySound(t)};h._visibilityChange=function(){if(T.stage.isVisibility){h._stageOnFocus()}else{h._stageOnBlur()}};h._stageOnBlur=function(){h._isActive=false;if(h._musicChannel){if(!h._musicChannel.isStopped){h._blurPaused=true;h._musicChannel.pause()}}h.stopAllSound();T.stage.once("mousedown",null,h._stageOnFocus)};h._recoverWebAudio=function(){if(yt.ctx&&yt.ctx.state!="running"&&yt.ctx.resume)yt.ctx.resume()};h._stageOnFocus=function(){h._isActive=true;h._recoverWebAudio();T.stage.off("mousedown",null,h._stageOnFocus);if(h._blurPaused){if(h._musicChannel&&h._musicChannel.isStopped){h._blurPaused=false;h._musicChannel.resume()}}};h.playSound=function(t,e,i,n,r){e===void 0&&(e=1);r===void 0&&(r=0);if(!h._isActive||!t)return null;if(h._muted)return null;h._recoverWebAudio();t=U.formatURL(t);if(t==h._tMusic){if(h._musicMuted)return null}else{if(G.isConchApp){var s=ut.getFileExtension(t);if(s!="wav"&&s!="ogg"){alert("The sound only supports wav or ogg format,for optimal performance reason,please refer to the official website document.");return null}}if(h._soundMuted)return null}var a;if(!j.onMiniGame&&!j.onKGMiniGame){a=T.loader.getRes(t)}if(!n)n=h._soundClass;if(!a){a=new n;a.load(t);if(!j.onMiniGame&&!j.onKGMiniGame){xt.cacheRes(t,a)}}var o;o=a.play(r,e);if(!o)return null;o.url=t;o.volume=t==h._tMusic?h.musicVolume:h.soundVolume;o.completeHandler=i;return o};h.destroySound=function(t){var e=T.loader.getRes(t);if(e){xt.clearRes(t);e.dispose()}};h.playMusic=function(t,e,i,n){e===void 0&&(e=0);n===void 0&&(n=0);t=U.formatURL(t);h._tMusic=t;if(h._musicChannel)h._musicChannel.stop();return h._musicChannel=h.playSound(t,e,i,h._musicClass,n)};h.stopSound=function(t){t=U.formatURL(t);var e=0;var i;for(e=h._channels.length-1;e>=0;e--){i=h._channels[e];if(i.url==t){i.stop()}}};h.stopAll=function(){h._tMusic=null;var t=0;var e;for(t=h._channels.length-1;t>=0;t--){e=h._channels[t];e.stop()}};h.stopAllSound=function(){var t=0;var e;for(t=h._channels.length-1;t>=0;t--){e=h._channels[t];if(e.url!=h._tMusic){e.stop()}}};h.stopMusic=function(){if(h._musicChannel)h._musicChannel.stop();h._tMusic=null};h.setSoundVolume=function(t,e){if(e){e=U.formatURL(e);h._setVolume(e,t)}else{h.soundVolume=t;var i=0;var n;for(i=h._channels.length-1;i>=0;i--){n=h._channels[i];if(n.url!=h._tMusic){n.volume=t}}}};h.setMusicVolume=function(t){h.musicVolume=t;h._setVolume(h._tMusic,t)};h._setVolume=function(t,e){t=U.formatURL(t);var i=0;var n;for(i=h._channels.length-1;i>=0;i--){n=h._channels[i];if(n.url==t){n.volume=e}}};h.musicVolume=1;h.soundVolume=1;h.playbackRate=1;h._useAudioMusic=true;h._muted=false;h._soundMuted=false;h._musicMuted=false;h._tMusic=null;h._musicChannel=null;h._channels=[];h._autoStopMusic=false;h._blurPaused=false;h._isActive=true;h._soundClass=null;h._musicClass=null;h.autoReleaseSound=true;return h}();var O=function(){var t;function i(){}v(i,"laya.net.LocalStorage");i.__init__=function(){if(!i._baseClass){i._baseClass=t;t.init()}i.items=i._baseClass.items;i.support=i._baseClass.support};i.setItem=function(t,e){i._baseClass.setItem(t,e)};i.getItem=function(t){return i._baseClass.getItem(t)};i.setJSON=function(t,e){i._baseClass.setJSON(t,e)};i.getJSON=function(t){return i._baseClass.getJSON(t)};i.removeItem=function(t){i._baseClass.removeItem(t)};i.clear=function(){i._baseClass.clear()};i._baseClass=null;i.items=null;i.support=false;i.__init$=function(){t=function(){function i(){}v(i,"");i.init=function(){try{i.support=true;i.items=a.localStorage;i.setItem("laya","1");i.removeItem("laya")}catch(t){i.support=false}if(!i.support)console.log("LocalStorage is not supprot or browser is private mode.")};i.setItem=function(t,e){try{i.support&&i.items.setItem(t,e)}catch(t){console.warn("set localStorage failed",t)}};i.getItem=function(t){return i.support?i.items.getItem(t):null};i.setJSON=function(t,e){try{i.support&&i.items.setItem(t,JSON.stringify(e))}catch(t){console.warn("set localStorage failed",t)}};i.getJSON=function(t){return JSON.parse(i.support?i.items.getItem(t):null)};i.removeItem=function(t){i.support&&i.items.removeItem(t)};i.clear=function(){i.support&&i.items.clear()};i.items=null;i.support=false;return i}()};return i}();var B=function(){function n(){}v(n,"laya.net.ResourceVersion");n.enable=function(t,e,i){i===void 0&&(i=2);laya.net.ResourceVersion.type=i;T.loader.load(t,m.create(null,n.onManifestLoaded,[e]),null,"json");U.customFormat=n.addVersionPrefix};n.onManifestLoaded=function(t,e){n.manifest=e;t.run();if(!e){console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")}};n.addVersionPrefix=function(t){if(n.manifest&&n.manifest[t]){if(n.type==2)return n.manifest[t];return n.manifest[t]+"/"+t}return t};n.FOLDER_VERSION=1;n.FILENAME_VERSION=2;n.manifest=null;n.type=1;return n}();var F=function(){function t(){this.fontName=null;this.complete=null;this.err=null;this._fontTxt=null;this._url=null;this._div=null;this._txtWidth=NaN;this._http=null}v(t,"laya.net.TTFLoader");var e=t.prototype;e.load=function(t){this._url=t;var e=t.split(".ttf")[0].split("/");this.fontName=e[e.length-1];if(j.window.conch){this._loadConch()}else if(j.window.FontFace){this._loadWithFontFace()}else{this._loadWithCSS()}};e._loadConch=function(){this._http=new bt;this._http.on("error",this,this._onErr);this._http.on("complete",this,this._onHttpLoaded);this._http.send(this._url,null,"get","arraybuffer")};e._onHttpLoaded=function(t){j.window.conch.setFontFaceFromBuffer(this.fontName,t);this._clearHttp();this._complete()};e._clearHttp=function(){if(this._http){this._http.off("error",this,this._onErr);this._http.off("complete",this,this._onHttpLoaded);this._http=null}};e._onErr=function(){this._clearHttp();if(this.err){this.err.runWith("fail:"+this._url);this.err=null}};e._complete=function(){T.timer.clear(this,this._complete);T.timer.clear(this,this._checkComplete);if(this._div&&this._div.parentNode){this._div.parentNode.removeChild(this._div);this._div=null}if(this.complete){this.complete.runWith(this);this.complete=null}};e._checkComplete=function(){if(I.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth){this._complete()}};e._loadWithFontFace=function(){var t=new j.window.FontFace(this.fontName,"url('"+this._url+"')");j.window.document.fonts.add(t);var e=this;t.loaded.then(function(){e._complete()});t.load()};e._createDiv=function(){this._div=j.createElement("div");this._div.innerHTML="laya";var t=this._div.style;t.fontFamily=this.fontName;t.position="absolute";t.left="-100px";t.top="-100px";j.document.body.appendChild(this._div)};e._loadWithCSS=function(){var t=this;var e=j.createElement("style");e.type="text/css";j.document.body.appendChild(e);e.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}";this._fontTxt="40px "+this.fontName;this._txtWidth=I.measureText("LayaTTFFont",this._fontTxt).width;var i=this;e.onload=function(){T.timer.once(1e4,i,t._complete)};T.timer.loop(20,this,this._checkComplete);this._createDiv()};t._testString="LayaTTFFont";return t}();var U=function(){function n(t){this._url=null;this._path=null;this._url=n.formatURL(t);this._path=n.getPath(t)}v(n,"laya.net.URL");var t=n.prototype;u(0,t,"path",function(){return this._path});u(0,t,"url",function(){return this._url});n.formatURL=function(t,e){if(!t)return"null path";if(t.indexOf(":")>0)return t;if(n.customFormat!=null)t=n.customFormat(t,e);var i=t.charAt(0);if(i==="."){return n.formatRelativePath((e||n.basePath)+t)}else if(i==="~"){return n.rootPath+t.substring(1)}else if(i==="d"){if(t.indexOf("data:image")===0)return t}else if(i==="/"){return t}return(e||n.basePath)+t};n.formatRelativePath=function(t){var e=t.split("/");for(var i=0,n=e.length;i<n;i++){if(e[i]==".."){e.splice(i-1,2);i-=2}}return e.join("/")};n.isAbsolute=function(t){return t.indexOf(":")>0||t.charAt(0)=="/"};n.getPath=function(t){var e=t.lastIndexOf("/");return e>0?t.substr(0,e+1):""};n.getFileName=function(t){var e=t.lastIndexOf("/");return e>0?t.substr(e+1):t};n.version={};n.basePath="";n.rootPath="";n.customFormat=function(t){var e=n.version[t];if(!G.isConchApp&&e)t+="?v="+e;return t};return n}();var G=function(){function s(t,e){this._timeId=0;var i=s._mainCanvas.source.style;i.position="absolute";i.top=i.left="0px";i.background="#000000";s._mainCanvas.source.id="layaCanvas";var n=laya.renders.Render.isWebGL;s._mainCanvas.source.width=t;s._mainCanvas.source.height=e;n&&s.WebGL.init(s._mainCanvas,t,e);if(!j.onKGMiniGame)j.container.appendChild(s._mainCanvas.source);s._context=new V(t,e,n?null:s._mainCanvas);s._context.ctx.setIsMainContext();j.window.requestAnimationFrame(r);function r(t){T.stage._loop();j.window.requestAnimationFrame(r)}T.stage.on("visibilitychange",this,this._onVisibilitychange)}v(s,"laya.renders.Render");var t=s.prototype;t._onVisibilitychange=function(){if(!T.stage.isVisibility){this._timeId=j.window.setInterval(this._enterFrame,1e3)}else if(this._timeId!=0){j.window.clearInterval(this._timeId)}};t._enterFrame=function(t){T.stage._loop()};u(1,s,"context",function(){return s._context});u(1,s,"canvas",function(){return s._mainCanvas.source});s._context=null;s._mainCanvas=null;s.WebGL=null;s.isConchNode=false;s.isConchApp=false;s.isConchWebGL=false;s.isWebGL=false;s.is3DMode=false;s.optimizeTextureMemory=function(t,e){return true};s.__init$=function(){a.ConchRenderType=a.ConchRenderType||1;a.ConchRenderType|=!a.conch?0:4;{s.isConchNode=(a.ConchRenderType&5)==5;s.isConchApp=(a.ConchRenderType&4)==4;s.isConchWebGL=a.ConchRenderType==6}};return s}();var V=function(){function a(t,e,i){this.x=0;this.y=0;this._drawTexture=function(t,e,i){if(i[0].loaded)this.ctx.drawTexture(i[0],i[1],i[2],i[3],i[4],t,e)};this._fillTexture=function(t,e,i){if(i[0].loaded)this.ctx.fillTexture(i[0],i[1]+t,i[2]+e,i[3],i[4],i[5],i[6],i[7])};this._drawTextureWithTransform=function(t,e,i){if(i[0].loaded)this.ctx.drawTextureWithTransform(i[0],i[1],i[2],i[3],i[4],i[5],t,e,i[6])};this._fillQuadrangle=function(t,e,i){this.ctx.fillQuadrangle(i[0],i[1],i[2],i[3],i[4])};this._drawRect=function(t,e,i){var n=this.ctx;if(i[4]!=null){n.fillStyle=i[4];n.fillRect(t+i[0],e+i[1],i[2],i[3],null)}if(i[5]!=null){n.strokeStyle=i[5];n.lineWidth=i[6];n.strokeRect(t+i[0],e+i[1],i[2],i[3],i[6])}};this._drawPie=function(t,e,i){var n=this.ctx;G.isWebGL&&n.setPathId(i[8]);n.beginPath();if(G.isWebGL){n.movePath(i[0]+t,i[1]+e);n.moveTo(0,0)}else{n.moveTo(t+i[0],e+i[1])}n.arc(t+i[0],e+i[1],i[2],i[3],i[4]);n.closePath();this._fillAndStroke(i[5],i[6],i[7],true)};this._clipRect=function(t,e,i){this.ctx.clipRect(t+i[0],e+i[1],i[2],i[3])};this._fillRect=function(t,e,i){this.ctx.fillRect(t+i[0],e+i[1],i[2],i[3],i[4])};this._drawCircle=function(t,e,i){var n=this.ctx;G.isWebGL&&n.setPathId(i[6]);at.drawCall++;n.beginPath();G.isWebGL&&n.movePath(i[0]+t,i[1]+e);n.arc(i[0]+t,i[1]+e,i[2],0,a.PI2);n.closePath();this._fillAndStroke(i[3],i[4],i[5],true)};this._fillCircle=function(t,e,i){at.drawCall++;var n=this.ctx;n.beginPath();n.fillStyle=i[3];n.arc(i[0]+t,i[1]+e,i[2],0,a.PI2);n.fill()};this._setShader=function(t,e,i){this.ctx.setShader(i[0])};this._drawLine=function(t,e,i){var n=this.ctx;G.isWebGL&&n.setPathId(i[6]);n.beginPath();n.strokeStyle=i[4];n.lineWidth=i[5];if(G.isWebGL){n.movePath(t,e);n.moveTo(i[0],i[1]);n.lineTo(i[2],i[3])}else{n.moveTo(t+i[0],e+i[1]);n.lineTo(t+i[2],e+i[3])}n.stroke()};this._drawLines=function(t,e,i){var n=this.ctx;G.isWebGL&&n.setPathId(i[5]);n.beginPath();t+=i[0],e+=i[1];G.isWebGL&&n.movePath(t,e);n.strokeStyle=i[3];n.lineWidth=i[4];var r=i[2];var s=2,a=r.length;if(G.isWebGL){n.moveTo(r[0],r[1]);while(s<a){n.lineTo(r[s++],r[s++])}}else{n.moveTo(t+r[0],e+r[1]);while(s<a){n.lineTo(t+r[s++],e+r[s++])}}n.stroke()};this._drawLinesWebGL=function(t,e,i){this.ctx.drawLines(t+this.x+i[0],e+this.y+i[1],i[2],i[3],i[4])};this._drawCurves=function(t,e,i){this.ctx.drawCurves(t,e,i)};this._draw=function(t,e,i){i[0].call(null,this,t,e)};this._transformByMatrix=function(t,e,i){this.ctx.transformByMatrix(i[0])};this._setTransform=function(t,e,i){this.ctx.setTransform(i[0],i[1],i[2],i[3],i[4],i[5])};this._setTransformByMatrix=function(t,e,i){this.ctx.setTransformByMatrix(i[0])};this._save=function(t,e,i){this.ctx.save()};this._restore=function(t,e,i){this.ctx.restore()};this._translate=function(t,e,i){this.ctx.translate(i[0],i[1])};this._transform=function(t,e,i){this.ctx.translate(i[1]+t,i[2]+e);var n=i[0];this.ctx.transform(n.a,n.b,n.c,n.d,n.tx,n.ty);this.ctx.translate(-t-i[1],-e-i[2])};this._rotate=function(t,e,i){this.ctx.translate(i[1]+t,i[2]+e);this.ctx.rotate(i[0]);this.ctx.translate(-t-i[1],-e-i[2])};this._scale=function(t,e,i){this.ctx.translate(i[2]+t,i[3]+e);this.ctx.scale(i[0],i[1]);this.ctx.translate(-t-i[2],-e-i[3])};this._alpha=function(t,e,i){this.ctx.globalAlpha*=i[0]};this._setAlpha=function(t,e,i){this.ctx.globalAlpha=i[0]};this._fillText=function(t,e,i){this.ctx.fillText(i[0],i[1]+t,i[2]+e,i[3],i[4],i[5])};this._strokeText=function(t,e,i){this.ctx.strokeText(i[0],i[1]+t,i[2]+e,i[3],i[4],i[5],i[6])};this._fillBorderText=function(t,e,i){this.ctx.fillBorderText(i[0],i[1]+t,i[2]+e,i[3],i[4],i[5],i[6],i[7])};this._blendMode=function(t,e,i){this.ctx.globalCompositeOperation=i[0]};this._beginClip=function(t,e,i){this.ctx.beginClip&&this.ctx.beginClip(t+i[0],e+i[1],i[2],i[3])};this._setIBVB=function(t,e,i){this.ctx.setIBVB(i[0]+t,i[1]+e,i[2],i[3],i[4],i[5],i[6],i[7])};this._fillTrangles=function(t,e,i){this.ctx.fillTrangles(i[0],i[1]+t,i[2]+e,i[3],i[4])};this._drawPath=function(t,e,i){var n=this.ctx;G.isWebGL&&n.setPathId(-1);n.beginPath();t+=i[0],e+=i[1];G.isWebGL&&n.movePath(t,e);var r=i[2];for(var s=0,a=r.length;s<a;s++){var o=r[s];switch(o[0]){case"moveTo":G.isWebGL?n.moveTo(o[1],o[2]):n.moveTo(t+o[1],e+o[2]);break;case"lineTo":G.isWebGL?n.lineTo(o[1],o[2]):n.lineTo(t+o[1],e+o[2]);break;case"arcTo":G.isWebGL?n.arcTo(o[1],o[2],o[3],o[4],o[5]):n.arcTo(t+o[1],e+o[2],t+o[3],e+o[4],o[5]);break;case"closePath":n.closePath();break}}var h=i[3];if(h!=null){n.fillStyle=h.fillStyle;n.fill()}var l=i[4];if(l!=null){n.strokeStyle=l.strokeStyle;n.lineWidth=l.lineWidth||1;n.lineJoin=l.lineJoin;n.lineCap=l.lineCap;n.miterLimit=l.miterLimit;n.stroke()}};this.drawPoly=function(t,e,i){this.ctx.drawPoly(t+this.x+i[0],e+this.y+i[1],i[2],i[3],i[4],i[5],i[6])};this._drawPoly=function(t,e,i){var n=this.ctx;var r=i[2];var s=2,a=r.length;if(G.isWebGL){n.setPathId(i[6]);n.beginPath();t+=i[0],e+=i[1];n.movePath(t,e);n.moveTo(r[0],r[1]);while(s<a){n.lineTo(r[s++],r[s++])}}else{n.beginPath();t+=i[0],e+=i[1];n.moveTo(t+r[0],e+r[1]);while(s<a){n.lineTo(t+r[s++],e+r[s++])}}n.closePath();this._fillAndStroke(i[3],i[4],i[5],i[7])};this._drawSkin=function(t,e,i){var n=i[0];if(n){var r=this.ctx;n.render(r,t,e)}};this._drawParticle=function(t,e,i){this.ctx.drawParticle(t+this.x,e+this.y,i[0])};this._setFilters=function(t,e,i){this.ctx.setFilters(i)};if(i){this.ctx=i.getContext("2d")}else{i=Ft.create("3D");this.ctx=I.createWebGLContext2D(i);i._setContext(this.ctx)}i.size(t,e);this.canvas=i}v(a,"laya.renders.RenderContext");var t=a.prototype;t.destroy=function(){if(this.canvas){this.canvas.destroy();this.canvas=null;this.ctx=null}if(this.ctx){this.ctx.destroy();this.ctx=null}};t.drawTexture=function(t,e,i,n,r){if(t.loaded)this.ctx.drawTexture(t,e,i,n,r,this.x,this.y)};t._drawTextures=function(t,e,i){if(i[0].loaded)this.ctx.drawTextures(i[0],i[1],t+this.x,e+this.y)};t.drawTextureWithTransform=function(t,e,i,n,r,s,a){if(t.loaded)this.ctx.drawTextureWithTransform(t,e,i,n,r,s,this.x,this.y,a)};t.fillQuadrangle=function(t,e,i,n,r){this.ctx.fillQuadrangle(t,e,i,n,r)};t.drawCanvas=function(t,e,i,n,r){this.ctx.drawCanvas(t,e+this.x,i+this.y,n,r)};t.drawRect=function(t,e,i,n,r,s){s===void 0&&(s=1);var a=this.ctx;a.strokeStyle=r;a.lineWidth=s;a.strokeRect(t+this.x,e+this.y,i,n,s)};t._fillAndStroke=function(t,e,i,n){n===void 0&&(n=false);var r=this.ctx;if(t!=null){r.fillStyle=t;if(G.isWebGL){r.fill(n)}else{r.fill()}}if(e!=null&&i>0){r.strokeStyle=e;r.lineWidth=i;r.stroke()}};t.clipRect=function(t,e,i,n){this.ctx.clipRect(t+this.x,e+this.y,i,n)};t.fillRect=function(t,e,i,n,r){this.ctx.fillRect(t+this.x,e+this.y,i,n,r)};t.drawCircle=function(t,e,i,n,r){r===void 0&&(r=1);at.drawCall++;var s=this.ctx;s.beginPath();s.strokeStyle=n;s.lineWidth=r;s.arc(t+this.x,e+this.y,i,0,a.PI2);s.stroke()};t.drawTriangles=function(t,e,i){if(G.isWebGL){this.ctx.drawTriangles(i[0],t+i[1],e+i[2],i[3],i[4],i[5],i[6],i[7],i[8],i[9])}else{var n=i[5];var r=0,s=n.length;var a=this.ctx;for(r=0;r<s;r+=3){var o=n[r]*2;var h=n[r+1]*2;var l=n[r+2]*2;a.drawTriangle(i[0],i[3],i[4],o,h,l,i[6],true)}}};t.fillCircle=function(t,e,i,n){at.drawCall++;var r=this.ctx;r.beginPath();r.fillStyle=n;r.arc(t+this.x,e+this.y,i,0,a.PI2);r.fill()};t.setShader=function(t){this.ctx.setShader(t)};t.drawLine=function(t,e,i,n,r,s){s===void 0&&(s=1);var a=this.ctx;a.beginPath();a.strokeStyle=r;a.lineWidth=s;a.moveTo(this.x+t,this.y+e);a.lineTo(this.x+i,this.y+n);a.stroke()};t.clear=function(){this.ctx.clear()};t.transformByMatrix=function(t){this.ctx.transformByMatrix(t)};t.setTransform=function(t,e,i,n,r,s){this.ctx.setTransform(t,e,i,n,r,s)};t.setTransformByMatrix=function(t){this.ctx.setTransformByMatrix(t)};t.save=function(){this.ctx.save()};t.restore=function(){this.ctx.restore()};t.translate=function(t,e){this.ctx.translate(t,e)};t.transform=function(t,e,i,n,r,s){this.ctx.transform(t,e,i,n,r,s)};t.rotate=function(t){this.ctx.rotate(t)};t.scale=function(t,e){this.ctx.scale(t,e)};t.alpha=function(t){this.ctx.globalAlpha*=t};t.setAlpha=function(t){this.ctx.globalAlpha=t};t.fillWords=function(t,e,i,n,r,s){s===void 0&&(s=0);this.ctx.fillWords(t,e,i,n,r,s)};t.fillBorderWords=function(t,e,i,n,r,s,a){this.ctx.fillBorderWords(t,e,i,n,r,s,a)};t.fillText=function(t,e,i,n,r,s){this.ctx.fillText(t,e+this.x,i+this.y,n,r,s)};t.strokeText=function(t,e,i,n,r,s,a){this.ctx.strokeText(t,e+this.x,i+this.y,n,r,s,a)};t.blendMode=function(t){this.ctx.globalCompositeOperation=t};t.flush=function(){this.ctx.flush&&this.ctx.flush()};t.addRenderObject=function(t){this.ctx.addRenderObject(t)};t.beginClip=function(t,e,i,n){this.ctx.beginClip&&this.ctx.beginClip(t,e,i,n)};t.endClip=function(){this.ctx.endClip&&this.ctx.endClip()};t.fillTrangles=function(t,e,i){this.ctx.fillTrangles(i[0],i[1],i[2],i[3],i.length>4?i[4]:null)};a.PI2=2*Math.PI;return a}();var W=function(){function a(t,e){this._next=e||a.NORENDER;switch(t){case 0:this._fun=this._no;return;case 1:this._fun=this._image;return;case 2:this._fun=this._alpha;return;case 4:this._fun=this._transform;return;case 8:this._fun=this._blend;return;case 16:this._fun=this._canvas;return;case 64:this._fun=this._mask;return;case 128:this._fun=this._clip;return;case 256:this._fun=this._style;return;case 512:this._fun=this._graphics;return;case 2048:this._fun=this._childs;return;case 1024:this._fun=this._custom;return;case 1|512:this._fun=this._image2;return;case 1|4|512:this._fun=this._image2;return;case 32:this._fun=S._filter;return;case 69905:this._fun=a._initRenderFun;return}this.onCreate(t)}v(a,"laya.renders.RenderSprite");var t=a.prototype;t.onCreate=function(t){};t._style=function(t,e,i,n){t._style.render(t,e,i,n);var r=this._next;r._fun.call(r,t,e,i,n)};t._no=function(t,e,i,n){};t._custom=function(t,e,i,n){t.customRender(e,i,n);var r=t._style._tf;this._next._fun.call(this._next,t,e,i-r.translateX,n-r.translateY)};t._clip=function(t,e,i,n){var r=this._next;if(r==a.NORENDER)return;var s=t._style.scrollRect;e.ctx.save();e.ctx.clipRect(i,n,s.width,s.height);r._fun.call(r,t,e,i-s.x,n-s.y);e.ctx.restore()};t._blend=function(t,e,i,n){var r=t._style;if(r.blendMode){e.ctx.globalCompositeOperation=r.blendMode}var s=this._next;s._fun.call(s,t,e,i,n);e.ctx.globalCompositeOperation="source-over"};t._mask=function(t,e,i,n){var r=this._next;r._fun.call(r,t,e,i,n);var s=t.mask;if(s){e.ctx.globalCompositeOperation="destination-in";if(s.numChildren>0||!s.graphics._isOnlyOne()){s.cacheAsBitmap=true}s.render(e,i-t.pivotX,n-t.pivotY)}e.ctx.globalCompositeOperation="source-over"};t._graphics=function(t,e,i,n){var r=t._style._tf;t._graphics&&t._graphics._render(t,e,i-r.translateX,n-r.translateY);var s=this._next;s._fun.call(s,t,e,i,n)};t._image=function(t,e,i,n){var r=t._style;e.ctx.drawTexture2(i,n,r._tf.translateX,r._tf.translateY,t.transform,r.alpha,r.blendMode,t._graphics._one)};t._image2=function(t,e,i,n){var r=t._style._tf;e.ctx.drawTexture2(i,n,r.translateX,r.translateY,t.transform,1,null,t._graphics._one)};t._alpha=function(t,e,i,n){var r=t._style;var s;if((s=r.alpha)>.01||t._needRepaint()){var a=e.ctx.globalAlpha;e.ctx.globalAlpha*=s;var o=this._next;o._fun.call(o,t,e,i,n);e.ctx.globalAlpha=a}};t._transform=function(t,e,i,n){var r=t.transform,s=this._next;if(r&&s!=a.NORENDER){e.save();e.transform(r.a,r.b,r.c,r.d,r.tx+i,r.ty+n);s._fun.call(s,t,e,0,0);e.restore()}else s._fun.call(s,t,e,i,n)};t._childs=function(t,e,i,n){var r=t._style;var s=r._tf;i=i-s.translateX+r.paddingLeft;n=n-s.translateY+r.paddingTop;if(r._calculation){var a=t._getWords();if(a){var o=r;if(o){if(o.stroke){e.fillBorderWords(a,i,n,o.font,o.color,o.strokeColor,o.stroke)}else{e.fillWords(a,i,n,o.font,o.color,o.textDecoration!="none"&&o.underLine?1:0)}}}}var h=t._childs,l=h.length,u;if(t.viewport||t.optimizeScrollRect&&t._style.scrollRect){var c=t.viewport||t._style.scrollRect;var f=c.x;var _=c.y;var d=c.right;var p=c.bottom;var v=NaN,g=NaN;for(m=0;m<l;++m){if((u=h[m]).visible&&((v=u._x)<d&&v+u.width>f&&(g=u._y)<p&&g+u.height>_)){u.render(e,i,n)}}}else{for(var m=0;m<l;++m)(u=h[m])._style.visible&&u.render(e,i,n)}};t._canvas=function(t,e,i,n){var r=t._$P.cacheCanvas;if(!r){this._next._fun.call(this._next,t,e,i,n);return}r.type==="bitmap"?at.canvasBitmap++:at.canvasNormal++;var s=r.ctx;if(t._needRepaint()||!s){this._canvas_repaint(t,e,i,n)}else{var a=r._cacheRec;e.drawCanvas(s.canvas,i+a.x,n+a.y,a.width,a.height)}};t._canvas_repaint=function(t,e,i,n){var r=t._$P.cacheCanvas;var s=this._next;if(!r){s._fun.call(s,t,a,i,n);return}var a=r.ctx;var o=t._needRepaint()||!a;var h;var l;var u;var c;var f=r.type;f==="bitmap"?at.canvasBitmap++:at.canvasNormal++;if(o){if(!r._cacheRec)r._cacheRec=new R;var _,d;if(!G.isWebGL||f==="bitmap"){c=t.getSelfBounds();c.x=c.x-t.pivotX;c.y=c.y-t.pivotY;c.x=c.x-16;c.y=c.y-16;c.width=c.width+32;c.height=c.height+32;c.x=Math.floor(c.x+i)-i;c.y=Math.floor(c.y+n)-n;c.width=Math.floor(c.width);c.height=Math.floor(c.height);r._cacheRec.copyFrom(c)}else{r._cacheRec.setTo(-t.pivotX,-t.pivotY,1,1)}c=r._cacheRec;var p=G.isWebGL?1:j.pixelRatio*T.stage.clientScaleX;var v=G.isWebGL?1:j.pixelRatio*T.stage.clientScaleY;if(!G.isWebGL){var g=1;var m=1;var y;y=t;while(y&&y!=T.stage){g*=y.scaleX;m*=y.scaleY;y=y.parent}if(G.isWebGL){if(g<1)p*=g;if(m<1)v*=m}else{if(g>1)p*=g;if(m>1)v*=m}}if(t.scrollRect){var b=t.scrollRect;c.x-=b.x;c.y-=b.y}_=c.width*p;d=c.height*v;l=c.x;u=c.y;if(G.isWebGL&&f==="bitmap"&&(_>2048||d>2048)){console.warn("cache bitmap size larger than 2048,cache ignored");if(r.ctx){rt.recover("RenderContext",r.ctx);r.ctx.canvas.size(0,0);r.ctx=null}s._fun.call(s,t,e,i,n);return}if(!a){a=r.ctx=rt.getItem("RenderContext")||new V(_,d,Ft.create("AUTO"))}a.ctx.sprite=t;h=a.canvas;h.clear();(h.width!=_||h.height!=d)&&h.size(_,d);if(f==="bitmap")h.context.asBitmap=true;else if(f==="normal")h.context.asBitmap=false;var x;if(p!=1||v!=1){var w=a.ctx;w.save();w.scale(p,v);if(!G.isConchWebGL&&G.isConchApp){x=t._$P.cf;x&&w.setFilterMatrix&&w.setFilterMatrix(x._mat,x._alpha)}s._fun.call(s,t,a,-l,-u);w.restore();if(!G.isConchApp||G.isConchWebGL)t._applyFilters()}else{w=a.ctx;if(!G.isConchWebGL&&G.isConchApp){x=t._$P.cf;x&&w.setFilterMatrix&&w.setFilterMatrix(x._mat,x._alpha)}s._fun.call(s,t,a,-l,-u);if(!G.isConchApp||G.isConchWebGL)t._applyFilters()}if(t._$P.staticCache)r.reCache=false;at.canvasReCache++}else{c=r._cacheRec;l=c.x;u=c.y;h=a.canvas}e.drawCanvas(h,i+l,n+u,c.width,c.height)};a.__init__=function(){var t=0,e=0;var i;i=I.createRenderSprite(69905,null);e=a.renders.length=2048*2;for(t=0;t<e;t++)a.renders[t]=i;a.renders[0]=I.createRenderSprite(0,null);function n(t,e){var i=0;for(var n=0;n<t.length;n++){i|=t[n];a.renders[i]=e}}n([1,512,4,2],new a(1,null));a.renders[1|512]=I.createRenderSprite(1|512,null);a.renders[1|4|512]=new a(1|4|512,null)};a._initRenderFun=function(t,e,i,n){var r=t._renderType;var s=a.renders[r]=a._getTypeRender(r);s._fun(t,e,i,n)};a._getTypeRender=function(t){var e=null;var i=2048;while(i>1){if(i&t)e=I.createRenderSprite(i,e);i=i>>1}return e};a.IMAGE=1;a.ALPHA=2;a.TRANSFORM=4;a.BLEND=8;a.CANVAS=16;a.FILTERS=32;a.MASK=64;a.CLIP=128;a.STYLE=256;a.GRAPHICS=512;a.CUSTOM=1024;a.CHILDS=2048;a.INIT=69905;a.renders=[];a.NORENDER=new a(0,null);return a}();var z=function(){function o(){this._repaint=false}v(o,"laya.resource.Context");var t=o.prototype;t.replaceReset=function(){var t=0,e=0;e=o.replaceKeys.length;var i;for(t=0;t<e;t++){i=o.replaceKeys[t];this[o.newKeys[t]]=this[i]}};t.replaceResotre=function(){this.__restore();this.__reset()};t.setIsMainContext=function(){};t.drawTextures=function(t,e,i,n){at.drawCall+=e.length/2;var r=t.width;var s=t.height;for(var a=0,o=e.length;a<o;a+=2){this.drawTexture(t,e[a],e[a+1],r,s,i,n)}};t.drawCanvas=function(t,e,i,n,r){at.drawCall++;this.drawImage(t.source,e,i,n,r)};t.fillRect=function(t,e,i,n,r){at.drawCall++;r&&(this.fillStyle=r);this.__fillRect(t,e,i,n)};t.fillText=function(t,e,i,n,r,s){at.drawCall++;if(arguments.length>3&&n!=null){this.font=n;this.fillStyle=r;this.textAlign=s;this.textBaseline="top"}this.__fillText(t,e,i)};t.fillBorderText=function(t,e,i,n,r,s,a,o){at.drawCall++;this.font=n;this.fillStyle=r;this.textBaseline="top";this.strokeStyle=s;this.lineWidth=a;this.textAlign=o;this.__strokeText(t,e,i);this.__fillText(t,e,i)};t.strokeText=function(t,e,i,n,r,s,a){at.drawCall++;if(arguments.length>3&&n!=null){this.font=n;this.strokeStyle=r;this.lineWidth=s;this.textAlign=a;this.textBaseline="top"}this.__strokeText(t,e,i)};t.transformByMatrix=function(t){this.transform(t.a,t.b,t.c,t.d,t.tx,t.ty)};t.setTransformByMatrix=function(t){this.setTransform(t.a,t.b,t.c,t.d,t.tx,t.ty)};t.clipRect=function(t,e,i,n){at.drawCall++;this.beginPath();this.rect(t,e,i,n);this.clip()};t.drawTexture=function(t,e,i,n,r,s,a){at.drawCall++;var o=t.uv,h=t.bitmap.width,l=t.bitmap.height;this.drawImage(t.source,o[0]*h,o[1]*l,(o[2]-o[0])*h,(o[5]-o[3])*l,e+s,i+a,n,r)};t.drawTextureWithTransform=function(t,e,i,n,r,s,a,o,h){at.drawCall++;var l=t.uv,u=t.bitmap.width,c=t.bitmap.height;this.save();h!=1&&(this.globalAlpha*=h);if(s){this.transform(s.a,s.b,s.c,s.d,s.tx+a,s.ty+o);this.drawImage(t.source,l[0]*u,l[1]*c,(l[2]-l[0])*u,(l[5]-l[3])*c,e,i,n,r)}else{this.drawImage(t.source,l[0]*u,l[1]*c,(l[2]-l[0])*u,(l[5]-l[3])*c,e+a,i+o,n,r)}this.restore()};t.drawTexture2=function(t,e,i,n,r,s,a,o){var h=o[0];if(!(h.loaded&&h.bitmap&&h.source)){return}at.drawCall++;var l=s!==1;if(l){var u=this.globalAlpha;this.globalAlpha*=s}var c=h.uv,f=h.bitmap.width,_=h.bitmap.height;if(r){this.save();this.transform(r.a,r.b,r.c,r.d,r.tx+t,r.ty+e);this.drawImage(h.source,c[0]*f,c[1]*_,(c[2]-c[0])*f,(c[5]-c[3])*_,o[1]-i,o[2]-n,o[3],o[4]);this.restore()}else{this.drawImage(h.source,c[0]*f,c[1]*_,(c[2]-c[0])*f,(c[5]-c[3])*_,o[1]-i+t,o[2]-n+e,o[3],o[4])}if(l)this.globalAlpha=u};t.fillTexture=function(t,e,i,n,r,s,a,o){if(!o.pat){if(t.uv!=At.DEF_UV){var h=new Ft("2D");h.getContext("2d");h.size(t.width,t.height);h.context.drawTexture(t,0,0,t.width,t.height,0,0);t=new At(h)}o.pat=this.createPattern(t.bitmap.source,s)}var l=e,u=i;var c=0,f=0;if(a){l+=a.x%t.width;u+=a.y%t.height;c-=a.x%t.width;f-=a.y%t.height}this.translate(l,u);this.fillRect(c,f,n,r,o.pat);this.translate(-l,-u)};t.drawTriangle=function(t,e,i,n,r,s,a,o){var h=t.bitmap;var l=h.source;var u=t.width;var c=t.height;var f=h.width;var _=h.height;var d=i[n]*f;var p=i[r]*f;var v=i[s]*f;var g=i[n+1]*_;var m=i[r+1]*_;var y=i[s+1]*_;var b=e[n];var x=e[r];var w=e[s];var T=e[n+1];var S=e[r+1];var C=e[s+1];if(o){var E=1;var A=1;var M=(b+x+w)/3;var I=(T+S+C)/3;var L=b-M;var P=T-I;var k=Math.sqrt(L*L+P*P);b=M+L/k*(k+E);T=I+P/k*(k+A);L=x-M;P=S-I;k=Math.sqrt(L*L+P*P);x=M+L/k*(k+E);S=I+P/k*(k+A);L=w-M;P=C-I;k=Math.sqrt(L*L+P*P);w=M+L/k*(k+E);C=I+P/k*(k+A)}this.save();if(a)this.transform(a.a,a.b,a.c,a.d,a.tx,a.ty);this.beginPath();this.moveTo(b,T);this.lineTo(x,S);this.lineTo(w,C);this.closePath();this.clip();var D=d*m+g*v+p*y-m*v-g*p-d*y;var R=1/D;var N=b*m+g*w+x*y-m*w-g*x-b*y;var O=d*x+b*v+p*w-x*v-b*p-d*w;var B=d*m*w+g*x*v+b*p*y-b*m*v-g*p*w-d*x*y;var F=T*m+g*C+S*y-m*C-g*S-T*y;var U=d*S+T*v+p*C-S*v-T*p-d*C;var G=d*m*C+g*S*v+T*p*y-T*m*v-g*p*C-d*S*y;this.transform(N*R,F*R,O*R,U*R,B*R,G*R);this.drawImage(l,t.uv[0]*f,t.uv[1]*_,u,c,t.uv[0]*f,t.uv[1]*_,u,c);this.restore()};t.flush=function(){return 0};t.fillWords=function(t,e,i,n,r,s){n&&(this.font=n);r&&(this.fillStyle=r);var a=this;this.textBaseline="top";this.textAlign="left";for(var o=0,h=t.length;o<h;o++){var l=t[o];this.__fillText(l.char,l.x+e,l.y+i);if(s===1){var u=l.height;var c=l.style.letterSpacing*.5;if(!c)c=0;this.beginPath();this.strokeStyle=r;this.lineWidth=1;this.moveTo(e+l.x-c+.5,i+l.y+u+.5);this.lineTo(e+l.x+l.width+c+.5,i+l.y+u+.5);this.stroke()}}};t.fillBorderWords=function(t,e,i,n,r,s,a){n&&(this.font=n);r&&(this.fillStyle=r);this.textBaseline="top";this.lineWidth=a;this.textAlign="left";this.strokeStyle=s;for(var o=0,h=t.length;o<h;o++){var l=t[o];this.__strokeText(l.char,l.x+e,l.y+i);this.__fillText(l.char,l.x+e,l.y+i)}};t.destroy=function(){this.canvas.width=this.canvas.height=0};t.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height);this._repaint=false};t.drawCurves=function(t,e,i){this.beginPath();this.strokeStyle=i[3];this.lineWidth=i[4];var n=i[2];t+=i[0],e+=i[1];this.moveTo(t+n[0],e+n[1]);var r=2,s=n.length;while(r<s){this.quadraticCurveTo(t+n[r++],e+n[r++],t+n[r++],e+n[r++])}this.stroke()};o.__init__=function(e){var i=laya.resource.Context.prototype;e=e||CanvasRenderingContext2D.prototype;if(e.inited)return;e.inited=true;e.__fillText=e.fillText;e.__fillRect=e.fillRect;e.__strokeText=e.strokeText;var t=["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"];t.forEach(function(t){e[t]=i[t]})};o.replaceCanvasGetSet=function(t,e){var i=Object.getOwnPropertyDescriptor(t,e);if(!i||!i.configurable)return false;var n={};var r;for(r in i){if(r!="set"){n[r]=i[r]}}var s=i["set"];n["set"]=function(t){var e=this;s.call(e,t);var i=e.getContext("2d");if(i&&"__reset"in i){i.__reset()}};Object.defineProperty(t,e,n);return true};o.replaceGetSet=function(t,e){var i=Object.getOwnPropertyDescriptor(t,e);if(!i||!i.configurable)return false;var n={};var r;for(r in i){if(r!="set"){n[r]=i[r]}}var s=i["set"];var a="___"+e+"__";o.newKeys.push(a);n["set"]=function(t){var e=this;if(t!=e[a]){e[a]=t;s.call(e,t)}};Object.defineProperty(t,e,n);return true};o._default=new o;o.newKeys=[];h(o,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]);return o}();var H=function(){function s(t){this._id=0;this._name=null;this._resources=null;this._memorySize=0;this._garbageCollectionRate=NaN;this._isOverflow=false;this.autoRelease=false;this.autoReleaseMaxSize=0;this._id=++s._uniqueIDCounter;this._name=t?t:"Content Manager";s._isResourceManagersSorted=false;this._memorySize=0;this._isOverflow=false;this.autoRelease=false;this.autoReleaseMaxSize=1024*1024*512;this._garbageCollectionRate=.2;s._resourceManagers.push(this);this._resources=[]}v(s,"laya.resource.ResourceManager");var t=s.prototype;T.imps(t,{"laya.resource.IDispose":true});t.getResourceByIndex=function(t){return this._resources[t]};t.getResourcesLength=function(){return this._resources.length};t.addResource=function(t){if(t.resourceManager)t.resourceManager.removeResource(t);var e=this._resources.indexOf(t);if(e===-1){t._resourceManager=this;this._resources.push(t);this.addSize(t.memorySize);return true}return false};t.removeResource=function(t){var e=this._resources.indexOf(t);if(e!==-1){this._resources.splice(e,1);t._resourceManager=null;this._memorySize-=t.memorySize;return true}return false};t.unload=function(){var t=this._resources.slice(0,this._resources.length);for(var e=0;e<t.length;e++){var i=t[e];i.destroy()}t.length=0};t.dispose=function(){if(this===s._systemResourceManager)throw new Error("systemResourceManager不能被释放！");s._resourceManagers.splice(s._resourceManagers.indexOf(this),1);s._isResourceManagersSorted=false;var t=this._resources.slice(0,this._resources.length);for(var e=0;e<t.length;e++){var i=t[e];i.resourceManager.removeResource(i);i.destroy()}t.length=0};t.addSize=function(t){if(t){if(this.autoRelease&&t>0)this._memorySize+t>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize);this._memorySize+=t}};t.garbageCollection=function(t){var e=this._resources;e=e.slice();e.sort(function(t,e){if(!t||!e)throw new Error("a或b不能为空！");if(t.released&&e.released)return 0;else if(t.released)return 1;else if(e.released)return-1;return t._lastUseFrameCount-e._lastUseFrameCount});var i=at.loopCount;for(var n=0,r=e.length;n<r;n++){var s=e[n];if(i-s._lastUseFrameCount>1){s.releaseResource()}else{if(this._memorySize>=t)this._isOverflow=true;return}if(this._memorySize<t){this._isOverflow=false;return}}};u(0,t,"id",function(){return this._id});u(0,t,"name",function(){return this._name},function(t){if((t||t!=="")&&this._name!==t){this._name=t;s._isResourceManagersSorted=false}});u(0,t,"memorySize",function(){return this._memorySize});u(1,s,"systemResourceManager",function(){return s._systemResourceManager});s.__init__=function(){s.currentResourceManager=s.systemResourceManager};s.getLoadedResourceManagerByIndex=function(t){return s._resourceManagers[t]};s.getLoadedResourceManagersCount=function(){return s._resourceManagers.length};s.recreateContentManagers=function(t){t===void 0&&(t=false);var e=s.currentResourceManager;for(var i=0;i<s._resourceManagers.length;i++){s.currentResourceManager=s._resourceManagers[i];for(var n=0;n<s.currentResourceManager._resources.length;n++){s.currentResourceManager._resources[n].releaseResource(t);s.currentResourceManager._resources[n].activeResource(t)}}s.currentResourceManager=e};s.releaseContentManagers=function(t){t===void 0&&(t=false);var e=s.currentResourceManager;for(var i=0;i<s._resourceManagers.length;i++){s.currentResourceManager=s._resourceManagers[i];for(var n=0;n<s.currentResourceManager._resources.length;n++){var r=s.currentResourceManager._resources[n];!r.released&&r.releaseResource(t)}}s.currentResourceManager=e};s._uniqueIDCounter=0;s._isResourceManagersSorted=false;s._resourceManagers=[];h(s,["_systemResourceManager",function(){return this._systemResourceManager=new s("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=s._systemResourceManager}]);return s}();var Y=function(){function t(){}v(t,"laya.system.System");t.changeDefinition=function(t,e){T[t]=e;var i=t+"=classObj";T._runScript(i)};t.__init__=function(){if(G.isConchApp){conch.disableConchResManager();conch.disableConchAutoRestoreLostedDevice()}};return t}();N;var j=function(){function i(){}v(i,"laya.utils.Browser");u(1,i,"pixelRatio",function(){i.__init__();if(i.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")>-1)return 2;return I.getPixelRatio()});u(1,i,"height",function(){i.__init__();return(T.stage&&T.stage.canvasRotation?i.clientWidth:i.clientHeight)*i.pixelRatio});u(1,i,"clientWidth",function(){i.__init__();return i.window.innerWidth||i.document.body.clientWidth});u(1,i,"window",function(){i.__init__();return i._window});u(1,i,"clientHeight",function(){i.__init__();return i.window.innerHeight||i.document.body.clientHeight||i.document.documentElement.clientHeight});u(1,i,"width",function(){i.__init__();return(T.stage&&T.stage.canvasRotation?i.clientHeight:i.clientWidth)*i.pixelRatio});u(1,i,"container",function(){i.__init__();if(!i._container){i._container=i.createElement("div");i._container.id="layaContainer";i.document.body.appendChild(i._container)}return i._container},function(t){i._container=t});u(1,i,"document",function(){i.__init__();return i._document});i.__init__=function(){N;if(i._window)return;i._window=I.getWindow();i._document=i.window.document;i._window.addEventListener("message",function(t){laya.utils.Browser._onMessage(t)},false);i.document.__createElement=i.document.createElement;a.requestAnimationFrame=a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame||function(t){return a.setTimeout(t,1e3/60)};var t=a.document.body.style;t["-webkit-user-select"]="none";t["-webkit-tap-highlight-color"]="rgba(200,200,200,0)";i.userAgent=i.window.navigator.userAgent;i.u=i.userAgent;i.onIOS=!!i.u.match(/\(i[^;]+;(U;)? CPU.+Mac OS X/);i.onMobile=i.u.indexOf("Mobile")>-1;i.onIPhone=i.u.indexOf("iPhone")>-1;i.onMac=i.u.indexOf("Mac OS X")>-1;i.onIPad=i.u.indexOf("iPad")>-1;i.onAndroid=i.u.indexOf("Android")>-1||i.u.indexOf("Adr")>-1;i.onWP=i.u.indexOf("Windows Phone")>-1;i.onQQBrowser=i.u.indexOf("QQBrowser")>-1;i.onMQQBrowser=i.u.indexOf("MQQBrowser")>-1||i.u.indexOf("Mobile")>-1&&i.u.indexOf("QQ")>-1;i.onIE=!!i.window.ActiveXObject||"ActiveXObject"in i.window;i.onWeiXin=i.u.indexOf("MicroMessenger")>-1;i.onPC=!i.onMobile;i.onSafari=i.u.indexOf("Safari")>-1;i.onFirefox=i.u.indexOf("Firefox")>-1;i.onEdge=i.u.indexOf("Edge")>-1;i.onMiniGame=i.u.indexOf("MiniGame")>-1;i.onTTMiniGame=i.u.indexOf("TTGame")>-1;i.onBDMiniGame=i.u.indexOf("SwanGame")>-1;i.onQGMiniGame=i.u.indexOf("QGGame")>-1;i.onKGMiniGame=i.u.indexOf("QuickGame")>-1;i.onLimixiu=i.u.indexOf("limixiu")>-1;i.onIPhoneX=/iPhone/gi.test(i.window.navigator.userAgent)&&(Math.min(i.clientHeight,i.clientWidth)==375&&Math.max(i.clientHeight,i.clientWidth)==812);i.httpProtocol=i.window.location.protocol=="http:";if(i.onMiniGame&&i.window.focus==null){console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}i.webAudioEnabled=i.window["AudioContext"]||i.window["webkitAudioContext"]||i.window["mozAudioContext"]?true:false;i.soundType=i.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND";mt=i.webAudioEnabled?yt:vt;if(i.webAudioEnabled)yt.initWebAudio();vt._initMusicAudio();i.enableTouch="ontouchstart"in a||a.DocumentTouch&&e instanceof DocumentTouch;a.focus();N._soundClass=mt;N._musicClass=vt;G._mainCanvas=G._mainCanvas||Ft.create("2D");if(i.canvas)return;i.canvas=Ft.create("2D");i.context=i.canvas.getContext("2d")};i._onMessage=function(t){if(!t.data)return;if(t.data.name=="size"){i.window.innerWidth=t.data.width;i.window.innerHeight=t.data.height;i.window.__innerHeight=t.data.clientHeight;if(!i.document.createEvent){console.warn("no document.createEvent");return}var e=i.document.createEvent("HTMLEvents");e.initEvent("resize",false,false);i.window.dispatchEvent(e);return}};i.createElement=function(t){i.__init__();return i.document.__createElement(t)};i.getElementById=function(t){i.__init__();return i.document.getElementById(t)};i.removeElement=function(t){if(t&&t.parentNode)t.parentNode.removeChild(t)};i.now=function(){return I.now()};i._window=null;i._document=null;i._container=null;i.userAgent=null;i.u=null;i.onIOS=false;i.onMac=false;i.onMobile=false;i.onIPhone=false;i.onIPad=false;i.onAndroid=false;i.onWP=false;i.onQQBrowser=false;i.onMQQBrowser=false;i.onSafari=false;i.onFirefox=false;i.onEdge=false;i.onIE=false;i.onWeiXin=false;i.onMiniGame=false;i.onTTMiniGame=false;i.onBDMiniGame=false;i.onKGMiniGame=false;i.onQGMiniGame=false;i.onLimixiu=false;i.onPC=false;i.httpProtocol=false;i.webAudioEnabled=false;i.soundType=null;i.enableTouch=false;i.canvas=null;i.context=null;i.onIPhoneX=false;i.__init$=function(){vt;yt};return i}();var X=function(){function e(t){this._xd_=true;this._allocated_=8;this._pos_=0;this._length=0;if(t){this._u8d_=new Uint8Array(t);this._d_=new DataView(this._u8d_.buffer);this._length=this._d_.byteLength}else{this.___resizeBuffer(this._allocated_)}}v(e,"laya.utils.Byte");var t=e.prototype;t.___resizeBuffer=function(e){try{var t=new Uint8Array(e);if(this._u8d_!=null){if(this._u8d_.length<=e)t.set(this._u8d_);else t.set(this._u8d_.subarray(0,e))}this._u8d_=t;this._d_=new DataView(t.buffer)}catch(t){throw"___resizeBuffer err:"+e}};t.getString=function(){return this.rUTF(this.getUint16())};t.getFloat32Array=function(t,e){var i=t+e;i=i>this._length?this._length:i;var n=new Float32Array(this._d_.buffer.slice(t,i));this._pos_=i;return n};t.getUint8Array=function(t,e){var i=t+e;i=i>this._length?this._length:i;var n=new Uint8Array(this._d_.buffer.slice(t,i));this._pos_=i;return n};t.getInt16Array=function(t,e){var i=t+e;i=i>this._length?this._length:i;var n=new Int16Array(this._d_.buffer.slice(t,i));this._pos_=i;return n};t.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var t=this._d_.getFloat32(this._pos_,this._xd_);this._pos_+=4;return t};t.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var t=this._d_.getFloat64(this._pos_,this._xd_);this._pos_+=8;return t};t.writeFloat32=function(t){this.ensureWrite(this._pos_+4);this._d_.setFloat32(this._pos_,t,this._xd_);this._pos_+=4};t.writeFloat64=function(t){this.ensureWrite(this._pos_+8);this._d_.setFloat64(this._pos_,t,this._xd_);this._pos_+=8};t.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var t=this._d_.getInt32(this._pos_,this._xd_);this._pos_+=4;return t};t.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var t=this._d_.getUint32(this._pos_,this._xd_);this._pos_+=4;return t};t.writeInt32=function(t){this.ensureWrite(this._pos_+4);this._d_.setInt32(this._pos_,t,this._xd_);this._pos_+=4};t.writeUint32=function(t){this.ensureWrite(this._pos_+4);this._d_.setUint32(this._pos_,t,this._xd_);this._pos_+=4};t.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var t=this._d_.getInt16(this._pos_,this._xd_);this._pos_+=2;return t};t.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var t=this._d_.getUint16(this._pos_,this._xd_);this._pos_+=2;return t};t.writeUint16=function(t){this.ensureWrite(this._pos_+2);this._d_.setUint16(this._pos_,t,this._xd_);this._pos_+=2};t.writeInt16=function(t){this.ensureWrite(this._pos_+2);this._d_.setInt16(this._pos_,t,this._xd_);this._pos_+=2};t.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)};t.writeUint8=function(t){this.ensureWrite(this._pos_+1);this._d_.setUint8(this._pos_,t);this._pos_++};t._getUInt8=function(t){return this._d_.getUint8(t)};t._getUint16=function(t){return this._d_.getUint16(t,this._xd_)};t._getMatrix=function(){var t=new k(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32());return t};t.rUTF=function(t){var e="",i=this._pos_+t,n=0,r=0,s=0,a=String.fromCharCode;var o=this._u8d_,h=0;while(this._pos_<i){n=o[this._pos_++];if(n<128){if(n!=0){e+=a(n)}}else if(n<224){e+=a((n&63)<<6|o[this._pos_++]&127)}else if(n<240){r=o[this._pos_++];e+=a((n&31)<<12|(r&127)<<6|o[this._pos_++]&127)}else{r=o[this._pos_++];s=o[this._pos_++];e+=a((n&15)<<18|(r&127)<<12|s<<6&127|o[this._pos_++]&127)}h++}return e};t.getCustomString=function(t){var e="",i=0,n=0,r=0,s=String.fromCharCode;var a=this._u8d_,o=0;while(t>0){n=a[this._pos_];if(n<128){e+=s(n);this._pos_++;t--}else{i=n-128;this._pos_++;t-=i;while(i>0){n=a[this._pos_++];r=a[this._pos_++];e+=s(r<<8|n);i--}}}return e};t.clear=function(){this._pos_=0;this.length=0};t.__getBuffer=function(){return this._d_.buffer};t.writeUTFBytes=function(t){t=t+"";for(var e=0,i=t.length;e<i;e++){var n=t.charCodeAt(e);if(n<=127){this.writeByte(n)}else if(n<=2047){this.ensureWrite(this._pos_+2);this._u8d_.set([192|n>>6,128|n&63],this._pos_);this._pos_+=2}else if(n<=65535){this.ensureWrite(this._pos_+3);this._u8d_.set([224|n>>12,128|n>>6&63,128|n&63],this._pos_);this._pos_+=3}else{this.ensureWrite(this._pos_+4);this._u8d_.set([240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63],this._pos_);this._pos_+=4}}};t.writeUTFString=function(t){var e=this.pos;this.writeUint16(1);this.writeUTFBytes(t);var i=this.pos-e-2;if(i>=65536){throw"writeUTFString byte len more than 65536"}this._d_.setUint16(e,i,this._xd_)};t.readUTFString=function(){return this.readUTFBytes(this.getUint16())};t.getUTFString=function(){return this.readUTFString()};t.readUTFBytes=function(t){t===void 0&&(t=-1);if(t==0)return"";var e=this.bytesAvailable;if(t>e)throw"readUTFBytes error - Out of bounds";t=t>0?t:e;return this.rUTF(t)};t.getUTFBytes=function(t){t===void 0&&(t=-1);return this.readUTFBytes(t)};t.writeByte=function(t){this.ensureWrite(this._pos_+1);this._d_.setInt8(this._pos_,t);this._pos_+=1};t.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)};t.getByte=function(){return this.readByte()};t.ensureWrite=function(t){if(this._length<t)this._length=t;if(this._allocated_<t)this.length=t};t.writeArrayBuffer=function(t,e,i){e===void 0&&(e=0);i===void 0&&(i=0);if(e<0||i<0)throw"writeArrayBuffer error - Out of bounds";if(i==0)i=t.byteLength-e;this.ensureWrite(this._pos_+i);var n=new Uint8Array(t);this._u8d_.set(n.subarray(e,e+i),this._pos_);this._pos_+=i};t.readArrayBuffer=function(t){var e;e=this._u8d_.buffer.slice(this._pos_,this._pos_+t);this._pos_=this._pos_+t;return e};u(0,t,"buffer",function(){var t=this._d_.buffer;if(t.byteLength==this.length)return t;return t.slice(0,this.length)});u(0,t,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function(t){this._xd_=t=="littleEndian"});u(0,t,"length",function(){return this._length},function(t){if(this._allocated_<t)this.___resizeBuffer(this._allocated_=Math.floor(Math.max(t,this._allocated_*2)));else if(this._allocated_>t)this.___resizeBuffer(this._allocated_=t);this._length=t});u(0,t,"pos",function(){return this._pos_},function(t){this._pos_=t});u(0,t,"bytesAvailable",function(){return this._length-this._pos_});e.getSystemEndian=function(){if(!e._sysEndian){var t=new ArrayBuffer(2);new DataView(t).setInt16(0,256,true);e._sysEndian=new Int16Array(t)[0]===256?"littleEndian":"bigEndian"}return e._sysEndian};e.BIG_ENDIAN="bigEndian";e.LITTLE_ENDIAN="littleEndian";e._sysEndian=null;return e}();var $=function(){function r(){}v(r,"laya.utils.CacheManager");r.regCacheByFunction=function(t,e){r.unRegCacheByFunction(t,e);var i;i={tryDispose:t,getCacheList:e};r._cacheList.push(i)};r.unRegCacheByFunction=function(t,e){var i=0,n=0;n=r._cacheList.length;for(i=0;i<n;i++){if(r._cacheList[i].tryDispose==t&&r._cacheList[i].getCacheList==e){r._cacheList.splice(i,1);return}}};r.forceDispose=function(){var t=0,e=r._cacheList.length;for(t=0;t<e;t++){r._cacheList[t].tryDispose(true)}};r.beginCheck=function(t){t===void 0&&(t=15e3);T.timer.loop(t,null,r._checkLoop)};r.stopCheck=function(){T.timer.clear(null,r._checkLoop)};r._checkLoop=function(){var t=r._cacheList;if(t.length<1)return;var e=j.now();var i=0;var n=0;n=i=t.length;while(i>0){r._index++;r._index=r._index%n;t[r._index].tryDispose(false);if(j.now()-e>r.loopTimeLimit)break;i--}};r.loopTimeLimit=2;r._cacheList=[];r._index=0;return r}();var K=function(){function _(){}v(_,"laya.utils.ClassUtils");_.regClass=function(t,e){_._classMap[t]=e};_.getRegClass=function(t){return _._classMap[t]};_.getInstance=function(t){var e=_.getClass(t);if(e)return new e;else console.warn("[error] Undefined class:",t);return null};_.createByJson=function(t,e,i,n,r){if(typeof t=="string")t=JSON.parse(t);var s=t.props;if(!e){e=r?r.runWith(t):_.getInstance(s.runtime||t.type);if(!e)return null}var a=t.child;if(a){for(var o=0,h=a.length;o<h;o++){var l=a[o];if((l.props.name==="render"||l.props.renderType==="render")&&e["_$set_itemRender"])e.itemRender=l;else{if(l.type=="Graphic"){_.addGraphicsToSprite(l,e)}else if(_.isDrawType(l.type)){_.addGraphicToSprite(l,e,true)}else{var u=_.createByJson(l,null,i,n,r);if(l.type=="Script"){if(u.hasOwnProperty("owner")){u["owner"]=e}else if(u.hasOwnProperty("target")){u["target"]=e}}else if(l.props.renderType=="mask"){e.mask=u}else{e.addChild(u)}}}}}if(s){for(var c in s){var f=s[c];if(c==="var"&&i){i[f]=e}else if(f instanceof Array&&typeof e[c]=="function"){e[c].apply(e,f)}else{e[c]=f}}}if(n&&t.customProps){n.runWith([e,t])}if(e["created"])e.created();return e};_.addGraphicsToSprite=function(t,e){var i;i=t.child;if(!i||i.length<1)return;var n;n=_._getGraphicsFromSprite(t,e);var r=0;var s=0;if(t.props){r=_._getObjVar(t.props,"x",0);s=_._getObjVar(t.props,"y",0)}if(r!=0&&s!=0){n.translate(r,s)}var a=0,o=0;o=i.length;for(a=0;a<o;a++){_._addGraphicToGraphics(i[a],n)}if(r!=0&&s!=0){n.translate(-r,-s)}};_.addGraphicToSprite=function(t,e,i){i===void 0&&(i=false);var n;n=i?_._getGraphicsFromSprite(t,e):e.graphics;_._addGraphicToGraphics(t,n)};_._getGraphicsFromSprite=function(t,e){var i;if(!t||!t.props)return e.graphics;var n;n=t.props.renderType;switch(n){case"hit":case"unHit":;var r;if(!e.hitArea){e.hitArea=new tt}r=e.hitArea;if(!r[n]){r[n]=new d}i=r[n];break;default:}if(!i)i=e.graphics;return i};_._getTransformData=function(t){var e;if(t.hasOwnProperty("pivotX")||t.hasOwnProperty("pivotY")){e=e||new k;e.translate(-_._getObjVar(t,"pivotX",0),-_._getObjVar(t,"pivotY",0))}var i=_._getObjVar(t,"scaleX",1),n=_._getObjVar(t,"scaleY",1);var r=_._getObjVar(t,"rotation",0);var s=_._getObjVar(t,"skewX",0);var a=_._getObjVar(t,"skewY",0);if(i!=1||n!=1||r!=0){e=e||new k;e.scale(i,n);e.rotate(r*.0174532922222222)}return e};_._addGraphicToGraphics=function(t,e){var i;i=t.props;if(!i)return;var n;n=_.DrawTypeDic[t.type];if(!n)return;var r;r=e;var s;var a=_._getParams(i,n[1],n[2],n[3]);s=_._tM;if(s||_._alpha!=1){r.save();if(s)r.transform(s);if(_._alpha!=1)r.alpha(_._alpha)}r[n[0]].apply(r,a);if(s||_._alpha!=1){r.restore()}};_._adptLineData=function(t){t[2]=parseFloat(t[0])+parseFloat(t[2]);t[3]=parseFloat(t[1])+parseFloat(t[3]);return t};_._adptTextureData=function(t){t[0]=xt.getRes(t[0]);return t};_._adptLinesData=function(t){t[2]=_._getPointListByStr(t[2]);return t};_.isDrawType=function(t){if(t=="Image")return false;return _.DrawTypeDic.hasOwnProperty(t)};_._getParams=function(t,e,i,n){i===void 0&&(i=0);var r;r=_._temParam;r.length=e.length;var s=0,a=0;a=e.length;for(s=0;s<a;s++){r[s]=_._getObjVar(t,e[s][0],e[s][1])}_._alpha=_._getObjVar(t,"alpha",1);var o;o=_._getTransformData(t);if(o){if(!i)i=0;o.translate(r[i],r[i+1]);r[i]=r[i+1]=0;_._tM=o}else{_._tM=null}if(n&&_[n]){r=_[n](r)}return r};_._getPointListByStr=function(t){var e;e=t.split(",");var i=0,n=0;n=e.length;for(i=0;i<n;i++){e[i]=parseFloat(e[i])}return e};_._getObjVar=function(t,e,i){if(t.hasOwnProperty(e)){return t[e]}return i};_._temParam=[];_._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"};_.getClass=function(t){var e=_._classMap[t]||t;if(typeof e=="string")return T["__classmap"][e];return e};_._tM=null;_._alpha=NaN;h(_,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]);return _}();var q=function(){function a(t){this._color=[];if(typeof t=="string"){this.strColor=t;if(t===null)t="#000000";t.charAt(0)=="#"&&(t=t.substr(1));var e=t.length;if(e==3||e==4){var i="";for(var n=0;n<e;n++){i+=t[n]+t[n]}t=i}var r=this.numColor=parseInt(t,16);var s=t.length==8;if(s){this._color=[parseInt(t.substr(0,2),16)/255,((16711680&r)>>16)/255,((65280&r)>>8)/255,(255&r)/255];return}}else{r=this.numColor=t;this.strColor=ut.toHexColor(r)}this._color=[((16711680&r)>>16)/255,((65280&r)>>8)/255,(255&r)/255,1];this._color.__id=++a._COLODID}v(a,"laya.utils.Color");a._initDefault=function(){a._DEFAULT={};for(var t in a._COLOR_MAP)a._SAVE[t]=a._DEFAULT[t]=new a(a._COLOR_MAP[t]);return a._DEFAULT};a._initSaveMap=function(){a._SAVE_SIZE=0;a._SAVE={};for(var t in a._DEFAULT)a._SAVE[t]=a._DEFAULT[t]};a.create=function(t){var e=a._SAVE[t+""];if(e!=null)return e;a._SAVE_SIZE<1e3||a._initSaveMap();return a._SAVE[t+""]=new a(t)};a._SAVE={};a._SAVE_SIZE=0;a._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"};a._DEFAULT=a._initDefault();a._COLODID=1;return a}();var Z=function(){function t(){this._values=[];this._keys=[]}v(t,"laya.utils.Dictionary");var e=t.prototype;e.set=function(t,e){var i=this.indexOf(t);if(i>=0){this._values[i]=e;return}this._keys.push(t);this._values.push(e)};e.indexOf=function(t){var e=this._keys.indexOf(t);if(e>=0)return e;t=typeof t=="string"?Number(t):typeof t=="number"?t.toString():t;return this._keys.indexOf(t)};e.get=function(t){var e=this.indexOf(t);return e<0?null:this._values[e]};e.remove=function(t){var e=this.indexOf(t);if(e>=0){this._keys.splice(e,1);this._values.splice(e,1);return true}return false};e.clear=function(){this._values.length=0;this._keys.length=0};u(0,e,"values",function(){return this._values});u(0,e,"keys",function(){return this._keys});return t}();var Q=function(){function t(){this.ratio=.92;this.maxOffset=60;this._dragging=false;this._clickOnly=true}v(t,"laya.utils.Dragging");var e=t.prototype;e.start=function(t,e,i,n,r,s,a,o){o===void 0&&(o=.92);this.clearTimer();this.target=t;this.area=e;this.hasInertia=i;this.elasticDistance=e?n:0;this.elasticBackTime=r;this.data=s;this._disableMouseEvent=a;this.ratio=o;this._parent=t.parent;this._clickOnly=true;this._dragging=true;this._elasticRateX=this._elasticRateY=1;this._lastX=this._parent.mouseX;this._lastY=this._parent.mouseY;T.stage.on("mouseup",this,this.onStageMouseUp);T.stage.on("mouseout",this,this.onStageMouseUp);T.timer.frameLoop(1,this,this.loop)};e.clearTimer=function(){T.timer.clear(this,this.loop);T.timer.clear(this,this.tweenMove);if(this._tween){this._tween.recover();this._tween=null}};e.stop=function(){if(this._dragging){x.instance.disableMouseEvent=false;T.stage.off("mouseup",this,this.onStageMouseUp);T.stage.off("mouseout",this,this.onStageMouseUp);this._dragging=false;this.target&&this.area&&this.backToArea();this.clear()}};e.loop=function(){var t=this._parent.getMousePoint();var e=t.x;var i=t.y;var n=e-this._lastX;var r=i-this._lastY;if(this._clickOnly){if(Math.abs(n*T.stage._canvasTransform.getScaleX())>1||Math.abs(r*T.stage._canvasTransform.getScaleY())>1){this._clickOnly=false;this._offsets||(this._offsets=[]);this._offsets.length=0;this.target.event("dragstart",this.data);x.instance.disableMouseEvent=this._disableMouseEvent;this.target._set$P("$_MOUSEDOWN",false)}else return}else{this._offsets.push(n,r)}if(n===0&&r===0)return;this._lastX=e;this._lastY=i;this.target.x+=n*this._elasticRateX;this.target.y+=r*this._elasticRateY;this.area&&this.checkArea();this.target.event("dragmove",this.data)};e.checkArea=function(){if(this.elasticDistance<=0){this.backToArea()}else{if(this.target.x<this.area.x){var t=this.area.x-this.target.x}else if(this.target.x>this.area.x+this.area.width){t=this.target.x-this.area.x-this.area.width}else{t=0}this._elasticRateX=Math.max(0,1-t/this.elasticDistance);if(this.target.y<this.area.y){var e=this.area.y-this.target.y}else if(this.target.y>this.area.y+this.area.height){e=this.target.y-this.area.y-this.area.height}else{e=0}this._elasticRateY=Math.max(0,1-e/this.elasticDistance)}};e.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width);this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)};e.onStageMouseUp=function(t){x.instance.disableMouseEvent=false;T.stage.off("mouseup",this,this.onStageMouseUp);T.stage.off("mouseout",this,this.onStageMouseUp);T.timer.clear(this,this.loop);if(this._clickOnly||!this.target)return;if(this.hasInertia){if(this._offsets.length<1){this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY)}this._offsetX=this._offsetY=0;var e=this._offsets.length;var i=Math.min(e,6);var n=this._offsets.length-i;for(var r=e-1;r>n;r--){this._offsetY+=this._offsets[r--];this._offsetX+=this._offsets[r]}this._offsetX=this._offsetX/i*2;this._offsetY=this._offsetY/i*2;if(Math.abs(this._offsetX)>this.maxOffset)this._offsetX=this._offsetX>0?this.maxOffset:-this.maxOffset;if(Math.abs(this._offsetY)>this.maxOffset)this._offsetY=this._offsetY>0?this.maxOffset:-this.maxOffset;T.timer.frameLoop(1,this,this.tweenMove)}else if(this.elasticDistance>0){this.checkElastic()}else{this.clear()}};e.checkElastic=function(){var t=NaN;var e=NaN;if(this.target.x<this.area.x)t=this.area.x;else if(this.target.x>this.area.x+this.area.width)t=this.area.x+this.area.width;if(this.target.y<this.area.y)e=this.area.y;else if(this.target.y>this.area.y+this.area.height)e=this.area.y+this.area.height;if(!isNaN(t)||!isNaN(e)){var i={};if(!isNaN(t))i.x=t;if(!isNaN(e))i.y=e;this._tween=lt.to(this.target,i,this.elasticBackTime,J.sineOut,m.create(this,this.clear),0,false,false)}else{this.clear()}};e.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX;this._offsetY*=this.ratio*this._elasticRateY;this.target.x+=this._offsetX;this.target.y+=this._offsetY;this.area&&this.checkArea();this.target.event("dragmove",this.data);if(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5){T.timer.clear(this,this.tweenMove);if(this.elasticDistance>0)this.checkElastic();else this.clear()}};e.clear=function(){if(this.target){this.clearTimer();var t=this.target;this.target=null;this._parent=null;t.event("dragend",this.data)}};return t}();var J=function(){function o(){}v(o,"laya.utils.Ease");o.linearNone=function(t,e,i,n){return i*t/n+e};o.linearIn=function(t,e,i,n){return i*t/n+e};o.linearInOut=function(t,e,i,n){return i*t/n+e};o.linearOut=function(t,e,i,n){return i*t/n+e};o.bounceIn=function(t,e,i,n){return i-o.bounceOut(n-t,0,i,n)+e};o.bounceInOut=function(t,e,i,n){if(t<n*.5)return o.bounceIn(t*2,0,i,n)*.5+e;else return o.bounceOut(t*2-n,0,i,n)*.5+i*.5+e};o.bounceOut=function(t,e,i,n){if((t/=n)<1/2.75)return i*(7.5625*t*t)+e;else if(t<2/2.75)return i*(7.5625*(t-=1.5/2.75)*t+.75)+e;else if(t<2.5/2.75)return i*(7.5625*(t-=2.25/2.75)*t+.9375)+e;else return i*(7.5625*(t-=2.625/2.75)*t+.984375)+e};o.backIn=function(t,e,i,n,r){r===void 0&&(r=1.70158);return i*(t/=n)*t*((r+1)*t-r)+e};o.backInOut=function(t,e,i,n,r){r===void 0&&(r=1.70158);if((t/=n*.5)<1)return i*.5*(t*t*(((r*=1.525)+1)*t-r))+e;return i/2*((t-=2)*t*(((r*=1.525)+1)*t+r)+2)+e};o.backOut=function(t,e,i,n,r){r===void 0&&(r=1.70158);return i*((t=t/n-1)*t*((r+1)*t+r)+1)+e};o.elasticIn=function(t,e,i,n,r,s){r===void 0&&(r=0);s===void 0&&(s=0);var a;if(t==0)return e;if((t/=n)==1)return e+i;if(!s)s=n*.3;if(!r||i>0&&r<i||i<0&&r<-i){r=i;a=s/4}else a=s/o.PI2*Math.asin(i/r);return-(r*Math.pow(2,10*(t-=1))*Math.sin((t*n-a)*o.PI2/s))+e};o.elasticInOut=function(t,e,i,n,r,s){r===void 0&&(r=0);s===void 0&&(s=0);var a;if(t==0)return e;if((t/=n*.5)==2)return e+i;if(!s)s=n*(.3*1.5);if(!r||i>0&&r<i||i<0&&r<-i){r=i;a=s/4}else a=s/o.PI2*Math.asin(i/r);if(t<1)return-.5*(r*Math.pow(2,10*(t-=1))*Math.sin((t*n-a)*o.PI2/s))+e;return r*Math.pow(2,-10*(t-=1))*Math.sin((t*n-a)*o.PI2/s)*.5+i+e};o.elasticOut=function(t,e,i,n,r,s){r===void 0&&(r=0);s===void 0&&(s=0);var a;if(t==0)return e;if((t/=n)==1)return e+i;if(!s)s=n*.3;if(!r||i>0&&r<i||i<0&&r<-i){r=i;a=s/4}else a=s/o.PI2*Math.asin(i/r);return r*Math.pow(2,-10*t)*Math.sin((t*n-a)*o.PI2/s)+i+e};o.strongIn=function(t,e,i,n){return i*(t/=n)*t*t*t*t+e};o.strongInOut=function(t,e,i,n){if((t/=n*.5)<1)return i*.5*t*t*t*t*t+e;return i*.5*((t-=2)*t*t*t*t+2)+e};o.strongOut=function(t,e,i,n){return i*((t=t/n-1)*t*t*t*t+1)+e};o.sineInOut=function(t,e,i,n){return-i*.5*(Math.cos(Math.PI*t/n)-1)+e};o.sineIn=function(t,e,i,n){return-i*Math.cos(t/n*o.HALF_PI)+i+e};o.sineOut=function(t,e,i,n){return i*Math.sin(t/n*o.HALF_PI)+e};o.quintIn=function(t,e,i,n){return i*(t/=n)*t*t*t*t+e};o.quintInOut=function(t,e,i,n){if((t/=n*.5)<1)return i*.5*t*t*t*t*t+e;return i*.5*((t-=2)*t*t*t*t+2)+e};o.quintOut=function(t,e,i,n){return i*((t=t/n-1)*t*t*t*t+1)+e};o.quartIn=function(t,e,i,n){return i*(t/=n)*t*t*t+e};o.quartInOut=function(t,e,i,n){if((t/=n*.5)<1)return i*.5*t*t*t*t+e;return-i*.5*((t-=2)*t*t*t-2)+e};o.quartOut=function(t,e,i,n){return-i*((t=t/n-1)*t*t*t-1)+e};o.cubicIn=function(t,e,i,n){return i*(t/=n)*t*t+e};o.cubicInOut=function(t,e,i,n){if((t/=n*.5)<1)return i*.5*t*t*t+e;return i*.5*((t-=2)*t*t+2)+e};o.cubicOut=function(t,e,i,n){return i*((t=t/n-1)*t*t+1)+e};o.quadIn=function(t,e,i,n){return i*(t/=n)*t+e};o.quadInOut=function(t,e,i,n){if((t/=n*.5)<1)return i*.5*t*t+e;return-i*.5*(--t*(t-2)-1)+e};o.quadOut=function(t,e,i,n){return-i*(t/=n)*(t-2)+e};o.expoIn=function(t,e,i,n){return t==0?e:i*Math.pow(2,10*(t/n-1))+e-i*.001};o.expoInOut=function(t,e,i,n){if(t==0)return e;if(t==n)return e+i;if((t/=n*.5)<1)return i*.5*Math.pow(2,10*(t-1))+e;return i*.5*(-Math.pow(2,-10*--t)+2)+e};o.expoOut=function(t,e,i,n){return t==n?e+i:i*(-Math.pow(2,-10*t/n)+1)+e};o.circIn=function(t,e,i,n){return-i*(Math.sqrt(1-(t/=n)*t)-1)+e};o.circInOut=function(t,e,i,n){if((t/=n*.5)<1)return-i*.5*(Math.sqrt(1-t*t)-1)+e;return i*.5*(Math.sqrt(1-(t-=2)*t)+1)+e};o.circOut=function(t,e,i,n){return i*Math.sqrt(1-(t=t/n-1)*t)+e};o.HALF_PI=Math.PI*.5;o.PI2=Math.PI*2;return o}();var tt=function(){function f(){this._hit=null;this._unHit=null}v(f,"laya.utils.HitArea");var t=f.prototype;t.isHit=function(t,e){if(!f.isHitGraphic(t,e,this.hit))return false;return!f.isHitGraphic(t,e,this.unHit)};t.contains=function(t,e){return this.isHit(t,e)};u(0,t,"hit",function(){if(!this._hit)this._hit=new d;return this._hit},function(t){this._hit=t});u(0,t,"unHit",function(){if(!this._unHit)this._unHit=new d;return this._unHit},function(t){this._unHit=t});f.isHitGraphic=function(t,e,i){if(!i)return false;var n;n=i.cmds;if(!n&&i._one){n=f._cmds;n.length=1;n[0]=i._one}if(!n)return false;var r=0,s=0;s=n.length;var a;for(r=0;r<s;r++){a=n[r];if(!a)continue;var o=G._context;switch(a.callee){case o._translate:case 6:t-=a[0];e-=a[1];default:}if(f.isHitCmd(t,e,a))return true}return false};f.isHitCmd=function(t,e,i){if(!i)return false;var n=G._context;var r=false;switch(i["callee"]){case n._drawRect:case 13:f._rec.setTo(i[0],i[1],i[2],i[3]);r=f._rec.contains(t,e);break;case n._drawCircle:case n._fillCircle:case 14:;var s=NaN;t-=i[0];e-=i[1];s=t*t+e*e;r=s<i[2]*i[2];break;case n._drawPoly:case 18:t-=i[0];e-=i[1];r=f.ptInPolygon(t,e,i[2]);break;default:break}return r};f.ptInPolygon=function(t,e,i){var n;n=f._ptPoint;n.setTo(t,e);var r=0;var s=NaN,a=NaN,o=NaN,h=NaN;var l=0;l=i.length;for(var u=0;u<l;u+=2){s=i[u];a=i[u+1];o=i[(u+2)%l];h=i[(u+3)%l];if(a==h)continue;if(n.y<Math.min(a,h))continue;if(n.y>=Math.max(a,h))continue;var c=(n.y-a)*(o-s)/(h-a)+s;if(c>n.x){r++}}return r%2==1};f._cmds=[];h(f,["_rec",function(){return this._rec=new R},"_ptPoint",function(){return this._ptPoint=new D}]);return f}();var et=function(){function r(t,e,i,n){this.char=t;this.charNum=t.charCodeAt(0);this._x=this._y=0;this.width=e;this.height=i;this.style=n;this.isWord=!r._isWordRegExp.test(t)}v(r,"laya.utils.HTMLChar");var t=r.prototype;T.imps(t,{"laya.display.ILayout":true});t.setSprite=function(t){this._sprite=t};t.getSprite=function(){return this._sprite};t._isChar=function(){return true};t._getCSSStyle=function(){return this.style};u(0,t,"width",function(){return this._w},function(t){this._w=t});u(0,t,"x",function(){return this._x},function(t){if(this._sprite){this._sprite.x=t}this._x=t});u(0,t,"y",function(){return this._y},function(t){if(this._sprite){this._sprite.y=t}this._y=t});u(0,t,"height",function(){return this._h},function(t){this._h=t});r._isWordRegExp=new RegExp("[\\w.]","");return r}();var it=function(){function e(){}v(e,"laya.utils.Log");e.enable=function(){if(!e._logdiv){e._logdiv=j.window.document.createElement("div");j.window.document.body.appendChild(e._logdiv);e._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;"}};e.toggle=function(){var t=e._logdiv.style;if(t.width=="1px"){t.width=t.height="50%"}else{t.width=t.height="1px"}};e.print=function(t){if(e._logdiv){if(e._count>=e.maxCount)e.clear();e._count++;e._logdiv.innerText+=t+"\n";e._logdiv.scrollTop=e._logdiv.scrollHeight}};e.clear=function(){e._logdiv.innerText="";e._count=0};e._logdiv=null;e._count=0;e.maxCount=20;return e}();var nt=function(){function e(){}v(e,"laya.utils.Mouse");u(1,e,"cursor",function(){return e._style.cursor},function(t){e._style.cursor=t});e.hide=function(){if(e.cursor!="none"){e._preCursor=e.cursor;e.cursor="none"}};e.show=function(){if(e.cursor=="none"){if(e._preCursor){e.cursor=e._preCursor}else{e.cursor="auto"}}};e._preCursor=null;h(e,["_style",function(){return this._style=j.document.body.style}]);return e}();var rt=function(){function s(){}v(s,"laya.utils.Pool");s.getPoolBySign=function(t){return s._poolDic[t]||(s._poolDic[t]=[])};s.clearBySign=function(t){if(s._poolDic[t])s._poolDic[t].length=0};s.recover=function(t,e){if(e["__InPool"])return;e["__InPool"]=true;s.getPoolBySign(t).push(e)};s.getItemByClass=function(t,e){var i=s.getPoolBySign(t);var n=i.length?i.pop():new e;n["__InPool"]=false;return n};s.getItemByCreateFun=function(t,e,i){var n=s.getPoolBySign(t);var r=n.length?n.pop():e.call(i);r["__InPool"]=false;return r};s.getItem=function(t){var e=s.getPoolBySign(t);var i=e.length?e.pop():null;if(i){i["__InPool"]=false}return i};s._poolDic={};s.InPoolSign="__InPool";return s}();var st=function(){function n(){this.sign=null;this.maxCount=1e3}v(n,"laya.utils.PoolCache");var t=n.prototype;t.getCacheList=function(){return rt.getPoolBySign(this.sign)};t.tryDispose=function(t){var e;e=rt.getPoolBySign(this.sign);if(e.length>this.maxCount){e.splice(this.maxCount,e.length-this.maxCount)}};n.addPoolCacheManager=function(t,e){e===void 0&&(e=100);var i;i=new n;i.sign=t;i.maxCount=e;$.regCacheByFunction(ut.bind(i.tryDispose,i),ut.bind(i.getCacheList,i))};return n}();var at=function(){function l(){}v(l,"laya.utils.Stat");u(1,l,"onclick",null,function(t){if(l._sp){l._sp.on("click",l._sp,t)}if(l._canvas){l._canvas.source.onclick=t;l._canvas.source.style.pointerEvents=""}});l.show=function(t,e){t===void 0&&(t=0);e===void 0&&(e=0);if(G.isConchApp&&!G.isConchWebGL){j.window.conch.showFPS&&j.window.conch.showFPS(t,e);return}if(!G.isConchWebGL&&!j.onMiniGame&&!j.onLimixiu&&!j.onKGMiniGame&&!j.onBDMiniGame&&!j.onTTMiniGame)l._useCanvas=true;l._show=true;l._fpsData.length=60;l._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"};l._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"};l._view[2]={title:"DrawCall",value:"drawCall",color:"white",units:"int"};l._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"};if(G.isWebGL){l._view[4]={title:"Shader",value:"shaderCall",color:"white",units:"int"};if(!G.is3DMode){l._view[0].title="FPS(WebGL)";l._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"}}else{l._view[0].title="FPS(3D)";l._view[5]={title:"TriFaces",value:"trianglesFaces",color:"white",units:"int"};l._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"};l._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"}}}else{l._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"}}if(l._useCanvas){l.createUIPre(t,e)}else l.createUI(t,e);l.enable()};l.createUIPre=function(t,e){var i=j.pixelRatio;l._width=i*130;l._vx=i*75;l._height=i*(l._view.length*12+3*i)+4;l._fontSize=12*i;for(var n=0;n<l._view.length;n++){l._view[n].x=4;l._view[n].y=n*l._fontSize+2*i}if(!l._canvas){l._canvas=new Ft("2D");l._canvas.size(l._width,l._height);l._ctx=l._canvas.getContext("2d");l._ctx.textBaseline="top";l._ctx.font=l._fontSize+"px Sans-serif";l._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+t+"px;top:"+e+"px;width:"+l._width/i+"px;height:"+l._height/i+"px;"}l._first=true;l.loop();l._first=false;if(!j.onKGMiniGame){j.container.appendChild(l._canvas.source)}};l.createUI=function(t,e){var i=l._sp;var n=j.pixelRatio;if(!i){i=new It;l._leftText=new Rt;l._leftText.pos(5,5);l._leftText.color="#ffffff";i.addChild(l._leftText);l._txt=new Rt;l._txt.pos(80*n,5);l._txt.color="#ffffff";i.addChild(l._txt);l._sp=i}i.pos(t,e);var r="";for(var s=0;s<l._view.length;s++){var a=l._view[s];r+=a.title+"\n"}l._leftText.text=r;var o=n*138;var h=n*(l._view.length*12+3*n)+4;l._txt.fontSize=l._fontSize*n;l._leftText.fontSize=l._fontSize*n;i.size(o,h);i.graphics.clear();i.graphics.setAlpha(.5);i.graphics.drawRect(0,0,o,h,"#999999");i.graphics.setAlpha(1);l.loop()};l.enable=function(){T.timer.frameLoop(1,l,l.loop)};l.hide=function(){l._show=false;T.timer.clear(l,l.loop);if(l._canvas){j.removeElement(l._canvas.source)}};l.clear=function(){l.trianglesFaces=l.drawCall=l.shaderCall=l.spriteCount=l.spriteRenderUseCacheCount=l.treeNodeCollision=l.treeSpriteCollision=l.canvasNormal=l.canvasBitmap=l.canvasReCache=0};l.loop=function(){l._count++;var t=j.now();if(t-l._timer<1e3)return;var e=l._count;l.FPS=Math.round(e*1e3/(t-l._timer));if(l._show){l.trianglesFaces=Math.round(l.trianglesFaces/e);if(!l._useCanvas){l.drawCall=Math.round(l.drawCall/e)-2;l.shaderCall=Math.round(l.shaderCall/e)-4;l.spriteCount=Math.round(l.spriteCount/e)-4}else{l.drawCall=Math.round(l.drawCall/e)-2;l.shaderCall=Math.round(l.shaderCall/e);l.spriteCount=Math.round(l.spriteCount/e)-1}l.spriteRenderUseCacheCount=Math.round(l.spriteRenderUseCacheCount/e);l.canvasNormal=Math.round(l.canvasNormal/e);l.canvasBitmap=Math.round(l.canvasBitmap/e);l.canvasReCache=Math.ceil(l.canvasReCache/e);l.treeNodeCollision=Math.round(l.treeNodeCollision/e);l.treeSpriteCollision=Math.round(l.treeSpriteCollision/e);var i=l.FPS>0?Math.floor(1e3/l.FPS).toString():" ";l._fpsStr=l.FPS+(l.renderSlow?" slow":"")+" "+i;l._spriteStr=l.spriteCount+(l.spriteRenderUseCacheCount?"/"+l.spriteRenderUseCacheCount:"");l._canvasStr=l.canvasReCache+"/"+l.canvasNormal+"/"+l.canvasBitmap;l.currentMemorySize=H.systemResourceManager.memorySize;if(l._useCanvas){l.renderInfoPre()}else l.renderInfo();l.clear()}l._count=0;l._timer=t};l.renderInfoPre=function(){if(l._canvas){var t=l._ctx;t.clearRect(l._first?0:l._vx,0,l._width,l._height);for(var e=0;e<l._view.length;e++){var i=l._view[e];if(l._first){t.fillStyle="white";t.fillText(i.title,i.x,i.y,null,null,null)}t.fillStyle=i.color;var n=l[i.value];i.units=="M"&&(n=Math.floor(n/(1024*1024)*100)/100+" M");t.fillText(n+"",i.x+l._vx,i.y,null,null,null)}}};l.renderInfo=function(){var t="";for(var e=0;e<l._view.length;e++){var i=l._view[e];var n=l[i.value];i.units=="M"&&(n=Math.floor(n/(1024*1024)*100)/100+" M");i.units=="K"&&(n=Math.floor(n/1024*100)/100+" K");t+=n+"\n"}l._txt.text=t};l.FPS=0;l.loopCount=0;l.shaderCall=0;l.drawCall=0;l.trianglesFaces=0;l.spriteCount=0;l.spriteRenderUseCacheCount=0;l.treeNodeCollision=0;l.treeSpriteCollision=0;l.canvasNormal=0;l.canvasBitmap=0;l.canvasReCache=0;l.renderSlow=false;l.currentMemorySize=0;l._fpsStr=null;l._canvasStr=null;l._spriteStr=null;l._fpsData=[];l._timer=0;l._count=0;l._view=[];l._fontSize=12;l._txt=null;l._leftText=null;l._sp=null;l._show=false;l._useCanvas=false;l._canvas=null;l._ctx=null;l._first=false;l._vx=NaN;l._width=0;l._height=100;return l}();var ot=function(){function t(){this._strsToID={};this._idToStrs=[];this._length=0}v(t,"laya.utils.StringKey");var e=t.prototype;e.add=function(t){var e=this._strsToID[t];if(e!=null)return e;this._idToStrs[this._length]=t;return this._strsToID[t]=this._length++};e.getID=function(t){var e=this._strsToID[t];return e==null?-1:e};e.getName=function(t){var e=this._idToStrs[t];return e==null?undefined:e};return t}();var ht=function(){var h;function l(){this._delta=0;this.scale=1;this.currFrame=0;this._mid=1;this._map=[];this._laters=[];this._handlers=[];this._temp=[];this._count=0;this.currTimer=this._now();this._lastTimer=this._now();this._init()}v(l,"laya.utils.Timer");var t=l.prototype;t._init=function(){T.timer&&T.timer.frameLoop(1,this,this._update)};t._now=function(){return Date.now()};t._update=function(){if(this.scale<=0){this._lastTimer=this._now();return}var t=this.currFrame=this.currFrame+this.scale;var e=this._now();this._delta=(e-this._lastTimer)*this.scale;var i=this.currTimer=this.currTimer+this._delta;this._lastTimer=e;var n=this._handlers;this._count=0;for(a=0,o=n.length;a<o;a++){h=n[a];if(h.method!==null){var r=h.userFrame?t:i;if(r>=h.exeTime){if(h.repeat){if(!h.jumpFrame){h.exeTime+=h.delay;h.run(false);if(r>h.exeTime){h.exeTime+=Math.ceil((r-h.exeTime)/h.delay)*h.delay}}else{while(r>=h.exeTime){h.exeTime+=h.delay;h.run(false)}}}else{h.run(true)}}}else{this._count++}}if(this._count>30||t%200===0)this._clearHandlers();var s=this._laters;for(var a=0,o=s.length-1;a<=o;a++){var h=s[a];if(h.method!==null){this._map[h.key]=null;h.run(false)}this._recoverHandler(h);a===o&&(o=s.length-1)}s.length=0};t._clearHandlers=function(){var t=this._handlers;for(var e=0,i=t.length;e<i;e++){var n=t[e];if(n.method!==null)this._temp.push(n);else this._recoverHandler(n)}this._handlers=this._temp;this._temp=t;this._temp.length=0};t._recoverHandler=function(t){if(this._map[t.key]==t)this._map[t.key]=null;t.clear();l._pool.push(t)};t._create=function(t,e,i,n,r,s,a){if(!i){r.apply(n,s);return null}if(a){var o=this._getHandler(n,r);if(o){o.repeat=e;o.userFrame=t;o.delay=i;o.caller=n;o.method=r;o.args=s;o.exeTime=i+(t?this.currFrame:this.currTimer+this._now()-this._lastTimer);return o}}o=l._pool.length>0?l._pool.pop():new h;o.repeat=e;o.userFrame=t;o.delay=i;o.caller=n;o.method=r;o.args=s;o.exeTime=i+(t?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1;this._indexHandler(o);this._handlers.push(o);return o};t._indexHandler=function(t){var e=t.caller;var i=t.method;var n=e?e.$_GID||(e.$_GID=ut.getGID()):0;var r=i.$_TID||(i.$_TID=this._mid++*1e5);t.key=n+r;this._map[t.key]=t};t.once=function(t,e,i,n,r){r===void 0&&(r=true);this._create(false,false,t,e,i,n,r)};t.loop=function(t,e,i,n,r,s){r===void 0&&(r=true);s===void 0&&(s=false);var a=this._create(false,true,t,e,i,n,r);if(a)a.jumpFrame=s};t.frameOnce=function(t,e,i,n,r){r===void 0&&(r=true);this._create(true,false,t,e,i,n,r)};t.frameLoop=function(t,e,i,n,r){r===void 0&&(r=true);this._create(true,true,t,e,i,n,r)};t.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+l._pool.length};t.clear=function(t,e){var i=this._getHandler(t,e);if(i){this._map[i.key]=null;i.key=0;i.clear()}};t.clearAll=function(t){if(!t)return;for(var e=0,i=this._handlers.length;e<i;e++){var n=this._handlers[e];if(n.caller===t){this._map[n.key]=null;n.key=0;n.clear()}}};t._getHandler=function(t,e){var i=t?t.$_GID||(t.$_GID=ut.getGID()):0;var n=e.$_TID||(e.$_TID=this._mid++*1e5);return this._map[i+n]};t.callLater=function(t,e,i){if(this._getHandler(t,e)==null){if(l._pool.length)var n=l._pool.pop();else n=new h;n.caller=t;n.method=e;n.args=i;this._indexHandler(n);this._laters.push(n)}};t.runCallLater=function(t,e){var i=this._getHandler(t,e);if(i&&i.method!=null){this._map[i.key]=null;i.run(true)}};t.runTimer=function(t,e){this.runCallLater(t,e)};u(0,t,"delta",function(){return this._delta});l._pool=[];l.__init$=function(){h=function(){function t(){this.key=0;this.repeat=false;this.delay=0;this.userFrame=false;this.exeTime=0;this.caller=null;this.method=null;this.args=null;this.jumpFrame=false}v(t,"");var e=t.prototype;e.clear=function(){this.caller=null;this.method=null;this.args=null};e.run=function(t){var e=this.caller;if(e&&e.destroyed)return this.clear();var i=this.method;var n=this.args;t&&this.clear();if(i==null)return;n?i.apply(e,n):i.call(e)};return t}()};return l}();var lt=function(){function c(){this.gid=0}v(c,"laya.utils.Tween");var t=c.prototype;t.to=function(t,e,i,n,r,s,a){s===void 0&&(s=0);a===void 0&&(a=false);return this._create(t,e,i,n,r,s,a,true,false,true)};t.from=function(t,e,i,n,r,s,a){s===void 0&&(s=0);a===void 0&&(a=false);return this._create(t,e,i,n,r,s,a,false,false,true)};t._create=function(t,e,i,n,r,s,a,o,h,l){if(!t)throw new Error("Tween:target is null");this._target=t;this._duration=i;this._ease=n||e.ease||c.easeNone;this._complete=r||e.complete;this._delay=s;this._props=[];this._usedTimer=0;this._startTimer=j.now();this._usedPool=h;this._delayParam=null;this.update=e.update;var u=t.$_GID||(t.$_GID=ut.getGID());if(!c.tweenMap[u]){c.tweenMap[u]=[this]}else{if(a)c.clearTween(t);c.tweenMap[u].push(this)}if(l){if(s<=0)this.firstStart(t,e,o);else{this._delayParam=[t,e,o];T.scaleTimer.once(s,this,this.firstStart,this._delayParam)}}else{this._initProps(t,e,o)}return this};t.firstStart=function(t,e,i){this._delayParam=null;if(t.destroyed){this.clear();return}this._initProps(t,e,i);this._beginLoop()};t._initProps=function(t,e,i){for(var n in e){if(typeof t[n]=="number"){var r=i?t[n]:e[n];var s=i?e[n]:t[n];this._props.push([n,r,s-r]);if(!i)t[n]=r}}};t._beginLoop=function(){T.scaleTimer.frameLoop(1,this,this._doEase)};t._doEase=function(){this._updateEase(j.now())};t._updateEase=function(t){var e=this._target;if(!e)return;if(e.destroyed)return c.clearTween(e);var i=this._usedTimer=t-this._startTimer-this._delay;if(i<0)return;if(i>=this._duration)return this.complete();var n=i>0?this._ease(i,0,1,this._duration):0;var r=this._props;for(var s=0,a=r.length;s<a;s++){var o=r[s];e[o[0]]=o[1]+n*o[2]}if(this.update)this.update.run()};t.complete=function(){if(!this._target)return;T.scaleTimer.runTimer(this,this.firstStart);var t=this._target;var e=this._props;var i=this._complete;for(var n=0,r=e.length;n<r;n++){var s=e[n];t[s[0]]=s[1]+s[2]}if(this.update)this.update.run();this.clear();i&&i.run()};t.pause=function(){T.scaleTimer.clear(this,this._beginLoop);T.scaleTimer.clear(this,this._doEase);T.scaleTimer.clear(this,this.firstStart);var t=j.now();var e=NaN;e=t-this._startTimer-this._delay;if(e<0){this._usedTimer=e}};t.setStartTime=function(t){this._startTimer=t};t.clear=function(){if(this._target){this._remove();this._clear()}};t._clear=function(){this.pause();T.scaleTimer.clear(this,this.firstStart);this._complete=null;this._target=null;this._ease=null;this._props=null;this._delayParam=null;if(this._usedPool){this.update=null;rt.recover("tween",this)}};t.recover=function(){this._usedPool=true;this._clear()};t._remove=function(){var t=c.tweenMap[this._target.$_GID];if(t){for(var e=0,i=t.length;e<i;e++){if(t[e]===this){t.splice(e,1);break}}}};t.restart=function(){this.pause();this._usedTimer=0;this._startTimer=j.now();if(this._delayParam){T.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);return}var t=this._props;for(var e=0,i=t.length;e<i;e++){var n=t[e];this._target[n[0]]=n[1]}T.scaleTimer.once(this._delay,this,this._beginLoop)};t.resume=function(){if(this._usedTimer>=this._duration)return;this._startTimer=j.now()-this._usedTimer-this._delay;if(this._delayParam){if(this._usedTimer<0){T.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam)}else{this.firstStart.apply(this,this._delayParam)}}else{this._beginLoop()}};u(0,t,"progress",null,function(t){var e=t*this._duration;this._startTimer=j.now()-this._delay-e});c.to=function(t,e,i,n,r,s,a,o){s===void 0&&(s=0);a===void 0&&(a=false);o===void 0&&(o=true);return rt.getItemByClass("tween",c)._create(t,e,i,n,r,s,a,true,o,true)};c.from=function(t,e,i,n,r,s,a,o){s===void 0&&(s=0);a===void 0&&(a=false);o===void 0&&(o=true);return rt.getItemByClass("tween",c)._create(t,e,i,n,r,s,a,false,o,true)};c.clearAll=function(t){if(!t||!t.$_GID)return;var e=c.tweenMap[t.$_GID];if(e){for(var i=0,n=e.length;i<n;i++){e[i]._clear()}e.length=0}};c.clear=function(t){t.clear()};c.clearTween=function(t){c.clearAll(t)};c.easeNone=function(t,e,i,n){return i*t/n+e};c.tweenMap={};return c}();var ut=function(){function o(){}v(o,"laya.utils.Utils");o.toRadian=function(t){return t*o._pi2};o.toAngle=function(t){return t*o._pi};o.toHexColor=function(t){if(t<0||isNaN(t))return null;var e=t.toString(16);while(e.length<6)e="0"+e;return"#"+e};o.getGID=function(){return o._gid++};o.concatArray=function(t,e){if(!e)return t;if(!t)return e;var i=0,n=e.length;for(i=0;i<n;i++){t.push(e[i])}return t};o.clearArray=function(t){if(!t)return t;t.length=0;return t};o.copyArray=function(t,e){t||(t=[]);if(!e)return t;t.length=e.length;var i=0,n=e.length;for(i=0;i<n;i++){t[i]=e[i]}return t};o.getGlobalRecByPoints=function(t,e,i,n,r){var s;s=new D(e,i);s=t.localToGlobal(s);var a;a=new D(n,r);a=t.localToGlobal(a);return R._getWrapRec([s.x,s.y,a.x,a.y])};o.getGlobalPosAndScale=function(t){return o.getGlobalRecByPoints(t,0,0,1,1)};o.bind=function(t,e){var i=t;i=t.bind(e);return i};o.measureText=function(t,e){return I.measureText(t,e)};o.updateOrder=function(t){if(!t||t.length<2)return false;var e=1,i=0,n=t.length,r=NaN,s;while(e<n){i=e;s=t[i];r=t[i]._zOrder;while(--i>-1){if(t[i]._zOrder>r)t[i+1]=t[i];else break}t[i+1]=s;e++}var a=s.parent.conchModel;if(a){if(a.updateZOrder!=null){a.updateZOrder()}else{for(e=0;e<n;e++){a.removeChild(t[e].conchModel)}for(e=0;e<n;e++){a.addChildAt(t[e].conchModel,e)}}}return true};o.transPointList=function(t,e,i){var n=0,r=t.length;for(n=0;n<r;n+=2){t[n]+=e;t[n+1]+=i}};o.parseInt=function(t,e){e===void 0&&(e=0);var i=j.window.parseInt(t,e);if(isNaN(i))return 0;return i};o.getFileExtension=function(t){o._extReg.lastIndex=t.lastIndexOf(".");var e=o._extReg.exec(t);if(e&&e.length>1){return e[1].toLowerCase()}return null};o.getTransformRelativeToWindow=function(t,e,i){var n=T.stage;var r=laya.utils.Utils.getGlobalPosAndScale(t);var s=n._canvasTransform.clone();var a=s.tx;var o=s.ty;s.rotate(-Math.PI/180*T.stage.canvasDegree);s.scale(T.stage.clientScaleX,T.stage.clientScaleY);var h=T.stage.canvasDegree%180!=0;var l=NaN,u=NaN;if(h){l=i+r.y;u=e+r.x;l*=s.d;u*=s.a;if(T.stage.canvasDegree==90){l=a-l;u+=o}else{l+=a;u=o-u}}else{l=e+r.x;u=i+r.y;l*=s.a;u*=s.d;l+=a;u+=o}var c=NaN,f=NaN;if(h){c=s.d*r.height;f=s.a*r.width}else{c=s.a*r.width;f=s.d*r.height}return{x:l,y:u,scaleX:c,scaleY:f}};o.fitDOMElementInArea=function(t,e,i,n,r,s){if(!t._fitLayaAirInitialized){t._fitLayaAirInitialized=true;t.style.transformOrigin=t.style.webKittransformOrigin="left top";t.style.position="absolute"}var a=o.getTransformRelativeToWindow(e,i,n);t.style.transform=t.style.webkitTransform="scale("+a.scaleX+","+a.scaleY+") rotate("+T.stage.canvasDegree+"deg)";t.style.width=r+"px";t.style.height=s+"px";t.style.left=a.x+"px";t.style.top=a.y+"px"};o.isOkTextureList=function(t){if(!t)return false;var e=0,i=t.length;var n;for(e=0;e<i;e++){n=t[e];if(!n||!n.source)return false}return true};o.isOKCmdList=function(t){if(!t)return false;var e=0,i=t.length;var n=G._context;var r;var s;for(e=0;e<i;e++){r=t[e];switch(r.callee){case n._drawTexture:case n._fillTexture:case n._drawTextureWithTransform:s=r[0];if(!s||!s.source)return false}}return true};o._gid=1;o._pi=180/Math.PI;o._pi2=Math.PI/180;o._extReg=/\.(\w+)\??/g;o.parseXMLFromString=function(t){var e;t=t.replace(/>\s+</g,"><");e=(new DOMParser).parseFromString(t,"text/xml");if(e.firstChild.textContent.indexOf("This page contains the following errors")>-1){throw new Error(e.firstChild.firstChild.textContent)}return e};return o}();var ct=function(){function t(){this.useDic={};this.shapeDic={};this.shapeLineDic={};this._id=0;this._checkKey=false;this._freeIdArray=[];if(G.isWebGL){$.regCacheByFunction(ut.bind(this.startDispose,this),ut.bind(this.getCacheList,this))}}v(t,"laya.utils.VectorGraphManager");var e=t.prototype;e.getId=function(){return this._id++};e.addShape=function(t,e){this.shapeDic[t]=e;if(!this.useDic[t]){this.useDic[t]=true}};e.addLine=function(t,e){this.shapeLineDic[t]=e;if(!this.shapeLineDic[t]){this.shapeLineDic[t]=true}};e.getShape=function(t){if(this._checkKey){if(this.useDic[t]!=null){this.useDic[t]=true}}};e.deleteShape=function(t){if(this.shapeDic[t]){this.shapeDic[t]=null;delete this.shapeDic[t]}if(this.shapeLineDic[t]){this.shapeLineDic[t]=null;delete this.shapeLineDic[t]}if(this.useDic[t]!=null){delete this.useDic[t]}};e.getCacheList=function(){var t;var e=[];for(t in this.shapeDic){e.push(this.shapeDic[t])}for(t in this.shapeLineDic){e.push(this.shapeLineDic[t])}return e};e.startDispose=function(t){var e;for(e in this.useDic){this.useDic[e]=false}this._checkKey=true};e.endDispose=function(){if(this._checkKey){var t;for(t in this.useDic){if(!this.useDic[t]){this.deleteShape(t)}}this._checkKey=false}};t.getInstance=function(){return t.instance=t.instance||new t};t.instance=null;return t}();var ft=function(){function n(){this._obj=null;this._obj=n.supportWeakMap?new j.window.WeakMap:{};if(!n.supportWeakMap)n._maps.push(this)}v(n,"laya.utils.WeakObject");var t=n.prototype;t.set=function(t,e){if(t==null)return;if(n.supportWeakMap){var i=t;if(typeof t=="string"||typeof t=="number"){i=n._keys[t];if(!i)i=n._keys[t]={k:t}}this._obj.set(i,e)}else{if(typeof t=="string"||typeof t=="number"){this._obj[t]=e}else{t.$_GID||(t.$_GID=ut.getGID());this._obj[t.$_GID]=e}}};t.get=function(t){if(t==null)return null;if(n.supportWeakMap){var e=typeof t=="string"||typeof t=="number"?n._keys[t]:t;if(!e)return null;return this._obj.get(e)}else{if(typeof t=="string"||typeof t=="number")return this._obj[t];return this._obj[t.$_GID]}};t.del=function(t){if(t==null)return;if(n.supportWeakMap){var e=typeof t=="string"||typeof t=="number"?n._keys[t]:t;if(!e)return;this._obj.delete(e)}else{if(typeof t=="string"||typeof t=="number")delete this._obj[t];else delete this._obj[this._obj.$_GID]}};t.has=function(t){if(t==null)return false;if(n.supportWeakMap){var e=typeof t=="string"||typeof t=="number"?n._keys[t]:t;return this._obj.has(e)}else{if(typeof t=="string"||typeof t=="number")return this._obj[t]!=null;return this._obj[this._obj.$_GID]!=null}};n.__init__=function(){n.supportWeakMap=j.window.WeakMap!=null;if(!n.supportWeakMap)T.timer.loop(n.delInterval,null,n.clearCache)};n.clearCache=function(){for(var t=0,e=n._maps.length;t<e;t++){var i=n._maps[t];i._obj={}}};n.supportWeakMap=false;n.delInterval=5*60*1e3;n._keys={};n._maps=[];h(n,["I",function(){return this.I=new n}]);return n}();var _t=function(){function t(){this.id=NaN;this.save=[];this.toUpperCase=null;this.changed=false;this._text=null}v(t,"laya.utils.WordText");var e=t.prototype;e.setText=function(t){this.changed=true;this._text=t};e.toString=function(){return this._text};e.charCodeAt=function(t){return this._text?this._text.charCodeAt(t):NaN};e.charAt=function(t){return this._text?this._text.charAt(t):null};u(0,e,"length",function(){return this._text?this._text.length:0});return t}();var dt=function(t){function a(){this._bits=0;this._displayedInStage=false;this._parent=null;this.conchModel=null;this.name="";this._destroyed=false;a.__super.call(this);this._childs=a.ARRAY_EMPTY;this._$P=a.PROP_EMPTY;this.timer=T.scaleTimer;this.conchModel=G.isConchNode?this.createConchModel():null}v(a,"laya.display.Node",t);var e=a.prototype;e._setBit=function(t,e){if(t==1){var i=this._getBit(t);if(i!=e){this._updateDisplayedInstage()}}if(e){this._bits|=t}else{this._bits&=~t}};e._getBit=function(t){return(this._bits&t)!=0};e._setUpNoticeChain=function(){if(this._getBit(1)){this._setUpNoticeType(1)}};e._setUpNoticeType=function(t){var e=this;e._setBit(t,true);e=e.parent;while(e){if(e._getBit(t))return;e._setBit(t,true);e=e.parent}};e.on=function(t,e,i,n){if(t==="display"||t==="undisplay"){if(!this._getBit(1)){this._setUpNoticeType(1)}}return this._createListener(t,e,i,n,false)};e.once=function(t,e,i,n){if(t==="display"||t==="undisplay"){if(!this._getBit(1)){this._setUpNoticeType(1)}}return this._createListener(t,e,i,n,true)};e.createConchModel=function(){return null};e.destroy=function(t){t===void 0&&(t=true);this._destroyed=true;this._parent&&this._parent.removeChild(this);if(this._childs){if(t)this.destroyChildren();else this.removeChildren()}this._childs=null;this._$P=null;this.offAll();this.timer.clearAll(this)};e.destroyChildren=function(){if(this._childs){for(var t=this._childs.length-1;t>-1;t--){this._childs[t].destroy(true)}}};e.addChild=function(t){if(!t||this.destroyed||t===this)return t;if(t.zOrder)this._set$P("hasZorder",true);if(t._parent===this){var e=this.getChildIndex(t);if(e!==this._childs.length-1){this._childs.splice(e,1);this._childs.push(t);if(this.conchModel){this.conchModel.removeChild(t.conchModel);this.conchModel.addChildAt(t.conchModel,this._childs.length-1)}this._childChanged()}}else{t.parent&&t.parent.removeChild(t);this._childs===a.ARRAY_EMPTY&&(this._childs=[]);this._childs.push(t);this.conchModel&&this.conchModel.addChildAt(t.conchModel,this._childs.length-1);t.parent=this;this._childChanged()}return t};e.addChildren=function(t){var e=arguments;var i=0,n=e.length;while(i<n){this.addChild(e[i++])}};e.addChildAt=function(t,e){if(!t||this.destroyed||t===this)return t;if(t.zOrder)this._set$P("hasZorder",true);if(e>=0&&e<=this._childs.length){if(t._parent===this){var i=this.getChildIndex(t);this._childs.splice(i,1);this._childs.splice(e,0,t);if(this.conchModel){this.conchModel.removeChild(t.conchModel);this.conchModel.addChildAt(t.conchModel,e)}this._childChanged()}else{t.parent&&t.parent.removeChild(t);this._childs===a.ARRAY_EMPTY&&(this._childs=[]);this._childs.splice(e,0,t);this.conchModel&&this.conchModel.addChildAt(t.conchModel,e);t.parent=this}return t}else{throw new Error("appendChildAt:The index is out of bounds")}};e.getChildIndex=function(t){return this._childs.indexOf(t)};e.getChildByName=function(t){var e=this._childs;if(e){for(var i=0,n=e.length;i<n;i++){var r=e[i];if(r.name===t)return r}}return null};e._get$P=function(t){return this._$P[t]};e._set$P=function(t,e){if(!this.destroyed){this._$P===a.PROP_EMPTY&&(this._$P={});this._$P[t]=e}return e};e.getChildAt=function(t){return this._childs[t]};e.setChildIndex=function(t,e){var i=this._childs;if(e<0||e>=i.length){throw new Error("setChildIndex:The index is out of bounds.")}var n=this.getChildIndex(t);if(n<0)throw new Error("setChildIndex:node is must child of this object.");i.splice(n,1);i.splice(e,0,t);if(this.conchModel){this.conchModel.removeChild(t.conchModel);this.conchModel.addChildAt(t.conchModel,e)}this._childChanged();return t};e._childChanged=function(t){};e.removeChild=function(t){if(!this._childs)return t;var e=this._childs.indexOf(t);return this.removeChildAt(e)};e.removeSelf=function(){this._parent&&this._parent.removeChild(this);return this};e.removeChildByName=function(t){var e=this.getChildByName(t);e&&this.removeChild(e);return e};e.removeChildAt=function(t){var e=this.getChildAt(t);if(e){this._childs.splice(t,1);this.conchModel&&this.conchModel.removeChild(e.conchModel);e.parent=null}return e};e.removeChildren=function(t,e){t===void 0&&(t=0);e===void 0&&(e=2147483647);if(this._childs&&this._childs.length>0){var i=this._childs;if(t===0&&e>=s){var n=i;this._childs=a.ARRAY_EMPTY}else{n=i.splice(t,e-t)}for(var r=0,s=n.length;r<s;r++){n[r].parent=null;this.conchModel&&this.conchModel.removeChild(n[r].conchModel)}}return this};e.replaceChild=function(t,e){var i=this._childs.indexOf(e);if(i>-1){this._childs.splice(i,1,t);if(this.conchModel){this.conchModel.removeChild(e.conchModel);this.conchModel.addChildAt(t.conchModel,i)}e.parent=null;t.parent=this;return t}return null};e._updateDisplayedInstage=function(){var t;t=this;var e=T.stage;this._displayedInStage=false;while(t){if(t._getBit(1)){this._displayedInStage=t._displayedInStage;break}if(t==e||t._displayedInStage){this._displayedInStage=true;break}t=t.parent}};e._setDisplay=function(t){if(this._displayedInStage!==t){this._displayedInStage=t;if(t)this.event("display");else this.event("undisplay")}};e._displayChild=function(t,e){var i=t._childs;if(i){for(var n=0,r=i.length;n<r;n++){var s=i[n];if(!s._getBit(1))continue;if(s._childs.length>0){this._displayChild(s,e)}else{s._setDisplay(e)}}}t._setDisplay(e)};e.contains=function(t){if(t===this)return true;while(t){if(t.parent===this)return true;t=t.parent}return false};e.timerLoop=function(t,e,i,n,r,s){r===void 0&&(r=true);s===void 0&&(s=false);this.timer.loop(t,e,i,n,r,s)};e.timerOnce=function(t,e,i,n,r){r===void 0&&(r=true);this.timer._create(false,false,t,e,i,n,r)};e.frameLoop=function(t,e,i,n,r){r===void 0&&(r=true);this.timer._create(true,true,t,e,i,n,r)};e.frameOnce=function(t,e,i,n,r){r===void 0&&(r=true);this.timer._create(true,false,t,e,i,n,r)};e.clearTimer=function(t,e){this.timer.clear(t,e)};u(0,e,"numChildren",function(){return this._childs.length});u(0,e,"destroyed",function(){return this._destroyed});u(0,e,"parent",function(){return this._parent},function(t){if(this._parent!==t){if(t){this._parent=t;this.event("added");if(this._getBit(1)){this._setUpNoticeChain();t.displayedInStage&&this._displayChild(this,true)}t._childChanged(this)}else{this.event("removed");this._parent._childChanged();if(this._getBit(1))this._displayChild(this,false);this._parent=t}}});u(0,e,"displayedInStage",function(){if(this._getBit(1))return this._displayedInStage;this._setUpNoticeType(1);return this._displayedInStage});a.ARRAY_EMPTY=[];a.PROP_EMPTY={};a.NOTICE_DISPLAY=1;a.MOUSEENABLE=2;return a}(s);var pt=function(t){function f(t){this._bgground=null;this._border=null;this._rect=null;this.underLine=0;this.lineHeight=0;f.__super.call(this);this._padding=f._PADDING;this._spacing=f._SPACING;this._aligns=f._ALIGNS;this._font=l.EMPTY;this._ower=t}v(f,"laya.display.css.CSSStyle",t);var e=f.prototype;e.destroy=function(){this._ower=null;this._font=null;this._rect=null};e.inherit=function(t){this._font=t._font;this._spacing=t._spacing===f._SPACING?f._SPACING:t._spacing.slice();this.lineHeight=t.lineHeight};e._widthAuto=function(){return(this._type&262144)!==0};e.widthed=function(t){return(this._type&8)!=0};e._calculation=function(t,e){if(e.indexOf("%")<0)return false;var n=this._ower;var r=n.parent;var s=this._rect;function a(t,e,i){return t*i[0]+e*i[1]+i[2]}function i(t){var e=r.width,i=n.width;s.width&&(n.width=a(e,i,s.width));s.height&&(n.height=a(e,i,s.height));s.left&&(n.x=a(e,i,s.left));s.top&&(n.y=a(e,i,s.top))}if(s===null){r._getCSSStyle()._type|=524288;r.on("resize",this,i);this._rect=s={input:{}}}var o=e.split(" ");o[0]=parseFloat(o[0])/100;if(o.length==1)o[1]=o[2]=0;else{o[1]=parseFloat(o[1])/100;o[2]=parseFloat(o[2])}s[t]=o;s.input[t]=e;i(t);return true};e.heighted=function(t){return(this._type&8192)!=0};e.size=function(t,e){var i=this._ower;var n=false;if(t!==-1&&t!=this._ower.width){this._type|=8;this._ower.width=t;n=true}if(e!==-1&&e!=this._ower.height){this._type|=8192;this._ower.height=e;n=true}if(n){i._layoutLater();this._type&524288&&i.event("resize",this)}};e._getAlign=function(){return this._aligns[0]};e._getValign=function(){return this._aligns[1]};e._getCssFloat=function(){return(this._type&32768)!=0?32768:0};e._createFont=function(){return this._type&4096?this._font:(this._type|=4096,this._font=new l(this._font))};e.render=function(t,e,i,n){var r=t.width;var s=t.height;i-=t.pivotX;n-=t.pivotY;this._bgground&&this._bgground.color!=null&&e.ctx.fillRect(i,n,r,s,this._bgground.color);this._border&&this._border.color&&e.drawRect(i,n,r,s,this._border.color.strColor,this._border.size)};e.getCSSStyle=function(){return this};e.cssText=function(t){this.attrs(f.parseOneCSS(t,";"))};e.attrs=function(t){if(t){for(var e=0,i=t.length;e<i;e++){var n=t[e];this[n[0]]=n[1]}}};e.setTransform=function(t){t==="none"?this._tf=o._TF_EMPTY:this.attrs(f.parseOneCSS(t,","))};e.translate=function(t,e){this._tf===o._TF_EMPTY&&(this._tf=new c);this._tf.translateX=t;this._tf.translateY=e};e.scale=function(t,e){this._tf===o._TF_EMPTY&&(this._tf=new c);this._tf.scaleX=t;this._tf.scaleY=e};e._enableLayout=function(){return(this._type&2)===0&&(this._type&4)===0};u(0,e,"block",t.prototype._$get_block,function(t){t?this._type|=1:this._type&=~1});u(0,e,"valign",function(){return f._valigndef[this._aligns[1]]},function(t){this._aligns===f._ALIGNS&&(this._aligns=[0,0,0]);this._aligns[1]=f._valigndef[t]});u(0,e,"height",null,function(t){this._type|=8192;if(typeof t=="string"){if(this._calculation("height",t))return;t=parseInt(t)}this.size(-1,t)});u(0,e,"width",null,function(t){this._type|=8;if(typeof t=="string"){var e=t.indexOf("auto");if(e>=0){this._type|=262144;t=t.substr(0,e)}if(this._calculation("width",t))return;t=parseInt(t)}this.size(t,-1)});u(0,e,"fontWeight",function(){return this._font.weight},function(t){this._createFont().weight=t});u(0,e,"left",null,function(t){var e=this._ower;if(typeof t=="string"){if(t==="center")t="50% -50% 0";else if(t==="right")t="100% -100% 0";if(this._calculation("left",t))return;t=parseInt(t)}e.x=t});u(0,e,"_translate",null,function(t){this.translate(t[0],t[1])});u(0,e,"absolute",function(){return(this._type&4)!==0});u(0,e,"top",null,function(t){var e=this._ower;if(typeof t=="string"){if(t==="middle")t="50% -50% 0";else if(t==="bottom")t="100% -100% 0";if(this._calculation("top",t))return;t=parseInt(t)}e.y=t});u(0,e,"align",function(){return f._aligndef[this._aligns[0]]},function(t){this._aligns===f._ALIGNS&&(this._aligns=[0,0,0]);this._aligns[0]=f._aligndef[t]});u(0,e,"bold",function(){return this._font.bold},function(t){this._createFont().bold=t});u(0,e,"padding",function(){return this._padding},function(t){this._padding=t});u(0,e,"leading",function(){return this._spacing[1]},function(t){typeof t=="string"&&(t=parseInt(t+""));this._spacing===f._SPACING&&(this._spacing=[0,0]);this._spacing[1]=t});u(0,e,"lineElement",function(){return(this._type&65536)!=0},function(t){t?this._type|=65536:this._type&=~65536});u(0,e,"cssFloat",function(){return(this._type&32768)!=0?"right":"left"},function(t){this.lineElement=false;t==="right"?this._type|=32768:this._type&=~32768});u(0,e,"textDecoration",function(){return this._font.decoration},function(t){this._createFont().decoration=t});u(0,e,"whiteSpace",function(){return this._type&131072?"nowrap":""},function(t){t==="nowrap"&&(this._type|=131072);t==="none"&&(this._type&=~131072)});u(0,e,"background",null,function(t){if(!t){this._bgground=null;return}this._bgground||(this._bgground={});this._bgground.color=t;this._ower.conchModel&&this._ower.conchModel.bgColor(t);this._type|=16384;this._ower._renderType|=256});u(0,e,"wordWrap",function(){return(this._type&131072)===0},function(t){t?this._type&=~131072:this._type|=131072});u(0,e,"color",function(){return this._font.color},function(t){this._createFont().color=t});u(0,e,"password",function(){return this._font.password},function(t){this._createFont().password=t});u(0,e,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function(t){if(t==="none")this._bgground=null;else this._bgground||(this._bgground={}),this._bgground.color=t;this._ower.conchModel&&this._ower.conchModel.bgColor(t);this._ower._renderType|=256});u(0,e,"font",function(){return this._font.toString()},function(t){this._createFont().set(t)});u(0,e,"weight",null,function(t){this._createFont().weight=t});u(0,e,"letterSpacing",function(){return this._spacing[0]},function(t){typeof t=="string"&&(t=parseInt(t+""));this._spacing===f._SPACING&&(this._spacing=[0,0]);this._spacing[0]=t});u(0,e,"fontSize",function(){return this._font.size},function(t){this._createFont().size=t});u(0,e,"italic",function(){return this._font.italic},function(t){this._createFont().italic=t});u(0,e,"fontFamily",function(){return this._font.family},function(t){this._createFont().family=t});u(0,e,"stroke",function(){return this._font.stroke[0]},function(t){if(this._createFont().stroke===l._STROKE)this._font.stroke=[0,"#000000"];this._font.stroke[0]=t});u(0,e,"strokeColor",function(){return this._font.stroke[1]},function(t){if(this._createFont().stroke===l._STROKE)this._font.stroke=[0,"#000000"];this._font.stroke[1]=t});u(0,e,"border",function(){return this._border?this._border.value:""},function(t){if(t=="none"){this._border=null;return}this._border||(this._border={});this._border.value=t;var e=t.split(" ");this._border.color=q.create(e[e.length-1]);if(e.length==1){this._border.size=1;this._border.type="solid";return}var i=0;if(e[0].indexOf("px")>0){this._border.size=parseInt(e[0]);i++}else this._border.size=1;this._border.type=e[i];this._ower._renderType|=256});u(0,e,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function(t){if(!t){this._border=null;return}this._border||(this._border={size:1,type:"solid"});this._border.color=t==null?null:q.create(t);this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor);this._ower._renderType|=256});u(0,e,"position",function(){return this._type&4?"absolute":""},function(t){t=="absolute"?this._type|=4:this._type&=~4});u(0,e,"display",null,function(t){switch(t){case"":this._type&=~2;this.visible=true;break;case"none":this._type|=2;this.visible=false;this._ower._layoutLater();break}});u(0,e,"paddingLeft",function(){return this.padding[3]});u(0,e,"paddingTop",function(){return this.padding[0]});u(0,e,"_scale",null,function(t){this._ower.scale(t[0],t[1])});u(0,e,"_rotate",null,function(t){this._ower.rotation=t});f.parseOneCSS=function(t,e){var i=[];var n=t.split(e);var r;for(var s=0,a=n.length;s<a;s++){var o=n[s];var h=o.indexOf(":");var l=o.substr(0,h).replace(/^\s+|\s+$/g,"");if(l.length==0)continue;var u=o.substr(h+1).replace(/^\s+|\s+$/g,"");var c=[l,u];switch(l){case"italic":case"bold":c[1]=u=="true";break;case"line-height":c[0]="lineHeight";c[1]=parseInt(u);break;case"font-size":c[0]="fontSize";c[1]=parseInt(u);break;case"padding":r=u.split(" ");r.length>1||(r[1]=r[2]=r[3]=r[0]);c[1]=[parseInt(r[0]),parseInt(r[1]),parseInt(r[2]),parseInt(r[3])];break;case"rotate":c[0]="_rotate";c[1]=parseFloat(u);break;case"scale":r=u.split(" ");c[0]="_scale";c[1]=[parseFloat(r[0]),parseFloat(r[1])];break;case"translate":r=u.split(" ");c[0]="_translate";c[1]=[parseInt(r[0]),parseInt(r[1])];break;default:(c[0]=f._CSSTOVALUE[l])||(c[0]=l)}i.push(c)}return i};f.parseCSS=function(t,e){var i;while((i=f._parseCSSRegExp.exec(t))!=null){f.styleSheets[i[1]]=f.parseOneCSS(i[2],";")}};f.EMPTY=new f(null);f._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"};f._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g");f._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"};f._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"};f.styleSheets={};f.ALIGN_CENTER=1;f.ALIGN_RIGHT=2;f.VALIGN_MIDDLE=1;f.VALIGN_BOTTOM=2;f._CSS_BLOCK=1;f._DISPLAY_NONE=2;f._ABSOLUTE=4;f._WIDTH_SET=8;f._PADDING=[0,0,0,0];f._RECT=[-1,-1,-1,-1];f._SPACING=[0,0];f._ALIGNS=[0,0,0];f.ADDLAYOUTED=512;f._NEWFONT=4096;f._HEIGHT_SET=8192;f._BACKGROUND_SET=16384;f._FLOAT_RIGHT=32768;f._LINE_ELEMENT=65536;f._NOWARP=131072;f._WIDTHAUTO=262144;f._LISTERRESZIE=524288;return f}(o);var vt=function(t){function a(){this.url=null;this.audio=null;this.loaded=false;a.__super.call(this)}v(a,"laya.media.h5audio.AudioSound",t);var e=a.prototype;e.dispose=function(){var t=a._audioCache[this.url];rt.clearBySign("audio:"+this.url);if(t){if(!G.isConchApp){t.src=""}delete a._audioCache[this.url]}};e.load=function(t){t=U.formatURL(t);this.url=t;var e;if(t==N._tMusic){a._initMusicAudio();e=a._musicAudio;if(e.src!=t){a._audioCache[e.src]=null;e=null}}else{e=a._audioCache[t]}if(e&&e.readyState>=2){this.event("complete");return}if(!e){if(t==N._tMusic){a._initMusicAudio();e=a._musicAudio}else{e=j.createElement("audio")}a._audioCache[t]=e;e.src=t}e.addEventListener("canplaythrough",n);e.addEventListener("error",r);var i=this;function n(){s();i.loaded=true;i.event("complete")}function r(){e.load=null;s();i.event("error")}function s(){e.removeEventListener("canplaythrough",n);e.removeEventListener("error",r)}this.audio=e;if(e.load){e.load()}else{r()}};e.play=function(t,e){t===void 0&&(t=0);e===void 0&&(e=0);if(!this.url)return null;var i;if(this.url==N._tMusic){i=a._musicAudio}else{i=a._audioCache[this.url]}if(!i)return null;var n;n=rt.getItem("audio:"+this.url);if(G.isConchApp){if(!n){n=j.createElement("audio");n.src=this.url}}else{if(this.url==N._tMusic){a._initMusicAudio();n=a._musicAudio;n.src=this.url}else{n=n?n:i.cloneNode(true)}}var r=new Lt(n);r.url=this.url;r.loops=e;r.startTime=t;r.play();N.addChannel(r);return r};u(0,e,"duration",function(){var t;t=a._audioCache[this.url];if(!t)return 0;return t.duration});a._initMusicAudio=function(){if(a._musicAudio)return;if(!a._musicAudio)a._musicAudio=j.createElement("audio");if(!G.isConchApp){j.document.addEventListener("mousedown",a._makeMusicOK)}};a._makeMusicOK=function(){j.document.removeEventListener("mousedown",a._makeMusicOK);if(!a._musicAudio.src){a._musicAudio.src="";a._musicAudio.load()}else{a._musicAudio.play()}};a._audioCache={};a._musicAudio=null;return a}(s);var gt=function(t){function e(){this.url=null;this.loops=0;this.startTime=NaN;this.isStopped=false;this.completeHandler=null;e.__super.call(this)}v(e,"laya.media.SoundChannel",t);var i=e.prototype;i.play=function(){};i.stop=function(){};i.pause=function(){};i.resume=function(){};i.__runComplete=function(t){if(t){t.run()}};u(0,i,"volume",function(){return 1},function(t){});u(0,i,"position",function(){return 0});u(0,i,"duration",function(){return 0});return e}(s);var mt=function(t){function e(){e.__super.call(this)}v(e,"laya.media.Sound",t);var i=e.prototype;i.load=function(t){};i.play=function(t,e){t===void 0&&(t=0);e===void 0&&(e=0);return null};i.dispose=function(){};u(0,i,"duration",function(){return 0});return e}(s);var yt=function(t){function r(){this.url=null;this.loaded=false;this.data=null;this.audioBuffer=null;this.__toPlays=null;this._disposed=false;r.__super.call(this)}v(r,"laya.media.webaudio.WebAudioSound",t);var e=r.prototype;e.load=function(t){var e=this;t=U.formatURL(t);this.url=t;this.audioBuffer=r._dataCache[t];if(this.audioBuffer){this._loaded(this.audioBuffer);return}r.e.on("loaded:"+t,this,this._loaded);r.e.on("err:"+t,this,this._err);if(r.__loadingSound[t]){return}r.__loadingSound[t]=true;var i=new j.window.XMLHttpRequest;i.open("GET",t,true);i.responseType="arraybuffer";i.onload=function(){if(e._disposed){e._removeLoadEvents();return}e.data=i.response;r.buffs.push({buffer:e.data,url:e.url});r.decode()};i.onerror=function(t){e._err()};i.send()};e._err=function(){this._removeLoadEvents();r.__loadingSound[this.url]=false;this.event("error");if(!this.__toPlays)return;var t=0,e=0;var i;i=this.__toPlays;e=i.length;var n;for(t=0;t<e;t++){n=i[t];if(n[2]&&!n[2].isStopped){n[2].event("error")}}this.__toPlays.length=0};e._loaded=function(t){this._removeLoadEvents();if(this._disposed){return}this.audioBuffer=t;r._dataCache[this.url]=this.audioBuffer;this.loaded=true;this.event("complete")};e._removeLoadEvents=function(){r.e.off("loaded:"+this.url,this,this._loaded);r.e.off("err:"+this.url,this,this._err)};e.__playAfterLoaded=function(){if(!this.__toPlays)return;var t=0,e=0;var i;i=this.__toPlays;e=i.length;var n;for(t=0;t<e;t++){n=i[t];if(n[2]&&!n[2].isStopped){this.play(n[0],n[1],n[2])}}this.__toPlays.length=0};e.play=function(t,e,i){t===void 0&&(t=0);e===void 0&&(e=0);i=i?i:new Pt;if(!this.audioBuffer){if(this.url){if(!this.__toPlays)this.__toPlays=[];this.__toPlays.push([t,e,i]);this.once("complete",this,this.__playAfterLoaded);this.load(this.url)}}i.url=this.url;i.loops=e;i["audioBuffer"]=this.audioBuffer;i.startTime=t;i.play();N.addChannel(i);return i};e.dispose=function(){this._disposed=true;delete r._dataCache[this.url];delete r.__loadingSound[this.url];this.audioBuffer=null;this.data=null;this.__toPlays=[]};u(0,e,"duration",function(){if(this.audioBuffer){return this.audioBuffer.duration}return 0});r.decode=function(){if(r.buffs.length<=0||r.isDecoding){return}r.isDecoding=true;r.tInfo=r.buffs.shift();r.ctx.decodeAudioData(r.tInfo["buffer"],r._done,r._fail)};r._done=function(t){r.e.event("loaded:"+r.tInfo.url,t);r.isDecoding=false;r.decode()};r._fail=function(){r.e.event("err:"+r.tInfo.url,null);r.isDecoding=false;r.decode()};r._playEmptySound=function(){if(r.ctx==null){return}var t=r.ctx.createBufferSource();t.buffer=r._miniBuffer;t.connect(r.ctx.destination);t.start(0,0,0)};r._unlock=function(){if(r._unlocked){return}r._playEmptySound();if(r.ctx.state=="running"){j.document.removeEventListener("mousedown",r._unlock,true);j.document.removeEventListener("touchend",r._unlock,true);j.document.removeEventListener("touchstart",r._unlock,true);r._unlocked=true}};r.initWebAudio=function(){if(r.ctx.state!="running"){r._unlock();j.document.addEventListener("mousedown",r._unlock,true);j.document.addEventListener("touchend",r._unlock,true);j.document.addEventListener("touchstart",r._unlock,true)}};r._dataCache={};r.buffs=[];r.isDecoding=false;r._unlocked=false;r.tInfo=null;r.__loadingSound={};h(r,["window",function(){return this.window=j.window},"webAudioEnabled",function(){return this.webAudioEnabled=r.window["AudioContext"]||r.window["webkitAudioContext"]||r.window["mozAudioContext"]},"ctx",function(){return this.ctx=r.webAudioEnabled?new(r.window["AudioContext"]||r.window["webkitAudioContext"]||r.window["mozAudioContext"]):undefined},"_miniBuffer",function(){return this._miniBuffer=r.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new s}]);return r}(s);var bt=function(t){function e(){this._responseType=null;this._data=null;e.__super.call(this);this._http=new j.window.XMLHttpRequest}v(e,"laya.net.HttpRequest",t);var i=e.prototype;i.send=function(t,e,i,n,r){i===void 0&&(i="get");n===void 0&&(n="text");this._responseType=n;this._data=null;var s=this;var a=this._http;a.open(i,t,true);if(r){for(var o=0;o<r.length;o++){a.setRequestHeader(r[o++],r[o])}}else if(!G.isConchApp){if(!e||typeof e=="string")a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");else a.setRequestHeader("Content-Type","application/json")}a.responseType=n!=="arraybuffer"?"text":"arraybuffer";a.onerror=function(t){s._onError(t)};a.onabort=function(t){s._onAbort(t)};a.onprogress=function(t){s._onProgress(t)};a.onload=function(t){s._onLoad(t)};a.send(e)};i._onProgress=function(t){if(t&&t.lengthComputable)this.event("progress",t.loaded/t.total)};i._onAbort=function(t){this.error("Request was aborted by user")};i._onError=function(t){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)};i._onLoad=function(t){var e=this._http;var i=e.status!==undefined?e.status:200;if(i===200||i===204||i===0){this.complete()}else{this.error("["+e.status+"]"+e.statusText+":"+e.responseURL)}};i.error=function(t){this.clear();this.event("error",t)};i.complete=function(){this.clear();var e=true;try{if(this._responseType==="json"){this._data=JSON.parse(this._http.responseText)}else if(this._responseType==="xml"){this._data=ut.parseXMLFromString(this._http.responseText)}else{this._data=this._http.response||this._http.responseText}}catch(t){e=false;this.error(t.message)}e&&this.event("complete",this._data instanceof Array?[this._data]:this._data)};i.clear=function(){var t=this._http;t.onerror=t.onabort=t.onprogress=t.onload=null};u(0,i,"url",function(){return this._http.responseURL});u(0,i,"http",function(){return this._http});u(0,i,"data",function(){return this._data});return e}(s);var xt=function(t){function E(){this._data=null;this._class=null;this._url=null;this._type=null;this._cache=false;this._http=null;this._customParse=false;E.__super.call(this)}v(E,"laya.net.Loader",t);var e=E.prototype;e.load=function(t,e,i,n,r){i===void 0&&(i=true);r===void 0&&(r=false);this._url=t;if(t.indexOf("data:image")===0)this._type=e="image";else{this._type=e||(e=this.getTypeFromUrl(t));t=U.formatURL(t)}this._cache=i;this._data=null;if(!r&&E.loadedMap[t]){this._data=E.loadedMap[t];this.event("progress",1);this.event("complete",this._data);return}if(n)E.setGroup(t,n);if(E.parserMap[e]!=null){this._customParse=true;if(E.parserMap[e]instanceof laya.utils.Handler)E.parserMap[e].runWith(this);else E.parserMap[e].call(null,this);return}if(e==="image"||e==="htmlimage"||e==="nativeimage")return this._loadImage(t);if(e==="sound")return this._loadSound(t);if(e==="ttf")return this._loadTTF(t);var s;switch(e){case"atlas":case"plf":s="json";break;case"font":s="xml";break;case"pkm":s="arraybuffer";break;default:s=e}if(E.preLoadedMap[t]){this.onLoaded(E.preLoadedMap[t])}else{if(!this._http){this._http=new bt;this._http.on("progress",this,this.onProgress);this._http.on("error",this,this.onError);this._http.on("complete",this,this.onLoaded)}this._http.send(t,null,"get",s)}};e.getTypeFromUrl=function(t){var e=ut.getFileExtension(t);if(e)return E.typeMap[e];console.warn("Not recognize the resources suffix",t);return"text"};e._loadTTF=function(t){t=U.formatURL(t);var e=new F;e.complete=m.create(this,this.onLoaded);e.load(t)};e._loadImage=function(e){e=U.formatURL(e);var t=this;var i;function n(){i.onload=null;i.onerror=null;delete E.imgCache[e]}var r=function(){n();t.onLoaded(i)};var s=function(){n();t.event("error","Load image failed")};if(this._type==="nativeimage"){i=new j.window.Image;i.crossOrigin="";i.onload=r;i.onerror=s;i.src=e;E.imgCache[e]=i}else{new zt.create(e,{onload:r,onerror:s,onCreate:function(t){i=t;E.imgCache[e]=t}})}};e._loadSound=function(t){var e=new N._soundClass;var i=this;e.on("complete",this,n);e.on("error",this,r);e.load(t);function n(){s();i.onLoaded(e)}function r(){s();e.dispose();i.event("error","Load sound failed")}function s(){e.offAll()}};e.onProgress=function(t){if(this._type==="atlas")this.event("progress",t*.3);else this.event("progress",t)};e.onError=function(t){this.event("error",t)};e.onLoaded=function(t){var e=this._type;if(e=="plf"){this.parsePLFData(t);this.complete(t)}else if(e==="image"){var i=new At(t);i.url=this._url;this.complete(i)}else if(e==="sound"||e==="htmlimage"||e==="nativeimage"){this.complete(t)}else if(e==="atlas"){if(!t.src&&!t._setContext){if(!this._data){this._data=t;if(t.meta&&t.meta.image){var n=t.meta.image.split(",");var r=this._url.indexOf("/")>=0?"/":"\\";var s=this._url.lastIndexOf(r);var a=s>=0?this._url.substr(0,s+1):"";for(var o=0,h=n.length;o<h;o++){n[o]=a+n[o]}}else{n=[this._url.replace(".json",".png")]}n.reverse();t.toLoads=n;t.pics=[]}this.event("progress",.3+1/n.length*.6);return this._loadImage(n.pop())}else{this._data.pics.push(t);if(this._data.toLoads.length>0){this.event("progress",.3+1/this._data.toLoads.length*.6);return this._loadImage(this._data.toLoads.pop())}var l=this._data.frames;var u=this._url.split("?")[0];var c=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:u.substring(0,u.lastIndexOf("."))+"/";var f=this._data.pics;var _=U.formatURL(this._url);var d=E.atlasMap[_]||(E.atlasMap[_]=[]);d.dir=c;var p=1;if(this._data.meta&&this._data.meta.scale&&this._data.meta.scale!=1){p=parseFloat(this._data.meta.scale);for(var v in l){var g=l[v];var m=f[g.frame.idx?g.frame.idx:0];var y=U.formatURL(c+v);m.scaleRate=p;var b;b=At.create(m,g.frame.x,g.frame.y,g.frame.w,g.frame.h,g.spriteSourceSize.x,g.spriteSourceSize.y,g.sourceSize.w,g.sourceSize.h);E.cacheRes(y,b);b.url=y;d.push(y)}}else{for(v in l){g=l[v];m=f[g.frame.idx?g.frame.idx:0];y=U.formatURL(c+v);E.cacheRes(y,At.create(m,g.frame.x,g.frame.y,g.frame.w,g.frame.h,g.spriteSourceSize.x,g.spriteSourceSize.y,g.sourceSize.w,g.sourceSize.h));E.loadedMap[y].url=y;d.push(y)}}delete this._data.pics;this.complete(this._data)}}else if(e=="font"){if(!t.src){this._data=t;this.event("progress",.5);return this._loadImage(this._url.replace(".fnt",".png"))}else{var x=new A;x.parseFont(this._data,t);var w=this._url.split(".fnt")[0].split("/");var T=w[w.length-1];Rt.registerBitmapFont(T,x);this._data=x;this.complete(this._data)}}else if(e=="pkm"){var S=zt.create(t,this._url);var C=new At(S);C.url=this._url;this.complete(C)}else{this.complete(t)}};e.parsePLFData=function(t){var e;var i;var n;for(e in t){n=t[e];switch(e){case"json":case"text":for(i in n){E.preLoadedMap[U.formatURL(i)]=n[i]}break;default:for(i in n){E.preLoadedMap[U.formatURL(i)]=n[i]}}}};e.complete=function(t){this._data=t;if(this._customParse){this.event("loaded",t instanceof Array?[t]:t)}else{E._loaders.push(this);if(!E._isWorking)E.checkNext()}};e.endLoad=function(t){t&&(this._data=t);if(this._cache)E.cacheRes(this._url,this._data);this.event("progress",1);this.event("complete",this.data instanceof Array?[this.data]:this.data)};u(0,e,"url",function(){return this._url});u(0,e,"data",function(){return this._data});u(0,e,"cache",function(){return this._cache});u(0,e,"type",function(){return this._type});E.checkNext=function(){E._isWorking=true;var t=j.now();var e=t;while(E._startIndex<E._loaders.length){e=j.now();E._loaders[E._startIndex].endLoad();E._startIndex++;if(j.now()-t>E.maxTimeOut){console.warn("loader callback cost a long time:"+(j.now()-t)+" url="+E._loaders[E._startIndex-1].url);T.timer.frameOnce(1,null,E.checkNext);return}}E._loaders.length=0;E._startIndex=0;E._isWorking=false};E.clearRes=function(t,e){e===void 0&&(e=false);t=U.formatURL(t);var i=E.getAtlas(t);if(i){for(var n=0,r=i.length;n<r;n++){var s=i[n];var a=E.getRes(s);delete E.loadedMap[s];if(a)a.destroy(e)}i.length=0;delete E.atlasMap[t];delete E.loadedMap[t]}else{var o=E.loadedMap[t];if(o){delete E.loadedMap[t];if(o instanceof laya.resource.Texture&&o.bitmap)o.destroy(e)}}};E.clearTextureRes=function(t){t=U.formatURL(t);var e=laya.net.Loader.getAtlas(t);var i=e&&e.length>0?laya.net.Loader.getRes(e[0]):laya.net.Loader.getRes(t);if(i&&i.bitmap){if(G.isConchApp&&!G.isConchWebGL){if(i.bitmap.source.releaseTexture){i.bitmap.source.releaseTexture()}}else if(i.bitmap._atlaser==null){i.bitmap.releaseResource(true)}}};E.getRes=function(t){return E.loadedMap[U.formatURL(t)]};E.getAtlas=function(t){return E.atlasMap[U.formatURL(t)]};E.cacheRes=function(t,e){t=U.formatURL(t);if(E.loadedMap[t]!=null){console.warn("Resources already exist,is repeated loading:",t)}else{E.loadedMap[t]=e}};E.setGroup=function(t,e){if(!E.groupMap[e])E.groupMap[e]=[];E.groupMap[e].push(t)};E.clearResByGroup=function(t){if(!E.groupMap[t])return;var e=E.groupMap[t],i=0,n=e.length;for(i=0;i<n;i++){E.clearRes(e[i])}e.length=0};E.TEXT="text";E.JSON="json";E.XML="xml";E.BUFFER="arraybuffer";E.IMAGE="image";E.SOUND="sound";E.ATLAS="atlas";E.FONT="font";E.TTF="ttf";E.PLF="plf";E.PKM="pkm";E.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf",ani:"json",sk:"arraybuffer"};E.parserMap={};E.groupMap={};E.maxTimeOut=100;E.loadedMap={};E.preLoadedMap={};E.atlasMap={};E._loaders=[];E._isWorking=false;E._startIndex=0;E.imgCache={};return E}(s);var wt=function(t){var f;function d(){this.retryNum=1;this.retryDelay=0;this.maxLoader=5;this._loaders=[];this._loaderCount=0;this._resInfos=[];this._infoPool=[];this._maxPriority=5;this._failRes={};d.__super.call(this);for(var t=0;t<this._maxPriority;t++)this._resInfos[t]=[]}v(d,"laya.net.LoaderManager",t);var e=d.prototype;e.create=function(t,i,e,n,r,s,a,o){s===void 0&&(s=1);a===void 0&&(a=true);if(t instanceof Array){var h=t;var l=h.length;var u=0;if(e){var c=m.create(e.caller,e.method,e.args,false)}for(var f=0;f<l;f++){var _=h[f];if(typeof _=="string")_=h[f]={url:_};_.progress=0}for(f=0;f<l;f++){_=h[f];var d=e?m.create(null,g,[_],false):null;var p=e||i?m.create(null,v,[_]):null;this._create(_.url,p,d,_.clas||n,_.params||r,_.priority||s,a,_.group||o)}function v(t,e){u++;t.progress=1;if(u===l&&i){i.run()}}function g(t,e){t.progress=e;var i=0;for(var n=0;n<l;n++){var r=h[n];i+=r.progress}var s=i/l;c.runWith(s)}return true}else return this._create(t,i,e,n,r,s,a,o)};e._create=function(e,i,t,n,r,s,a,o){s===void 0&&(s=1);a===void 0&&(a=true);var h=U.formatURL(e);var l=this.getRes(h);if(!l){var u=ut.getFileExtension(e);var c=d.createMap[u];if(!c)throw new Error("LoaderManager:unknown file("+e+") extension with: "+u+".");if(!n)n=c[0];var f=c[1];if(u=="atlas"){this.load(e,i,t,f,s,a)}else{if(n===At)f="htmlimage";l=n?new n:null;if(l.hasOwnProperty("_loaded"))l._loaded=false;l._setUrl(e);o&&l._setGroup(o);this._createLoad(l,e,m.create(null,_),t,f,s,false,o,true);function _(t){l&&!l.destroyed&&t&&l.onAsynLoaded.call(l,e,t,r);if(i)i.run();T.loader.event(e)}a&&this.cacheRes(h,l)}}else{if(!l.hasOwnProperty("loaded")||l.loaded){t&&t.runWith(1);i&&i.run()}else if(i){T.loader._createListener(e,i.caller,i.method,i.args,true,false)}}return l};e.load=function(t,e,i,n,r,s,a,o){var h=this;r===void 0&&(r=1);s===void 0&&(s=true);o===void 0&&(o=false);if(t instanceof Array)return this._loadAssets(t,e,i,n,r,s,a);var l=xt.getRes(t);if(l!=null){T.timer.frameOnce(1,null,function(){i&&i.runWith(1);e&&e.runWith(l);h._loaderCount||h.event("complete")})}else{var u=d._resMap[t];if(!u){u=this._infoPool.length?this._infoPool.pop():new f;u.url=t;u.type=n;u.cache=s;u.group=a;u.ignoreCache=o;e&&u.on("complete",e.caller,e.method,e.args);i&&u.on("progress",i.caller,i.method,i.args);d._resMap[t]=u;r=r<this._maxPriority?r:this._maxPriority-1;this._resInfos[r].push(u);this._next()}else{e&&u._createListener("complete",e.caller,e.method,e.args,false,false);i&&u._createListener("progress",i.caller,i.method,i.args,false,false)}}return this};e._createLoad=function(t,e,i,n,r,s,a,o,h){var l=this;s===void 0&&(s=1);a===void 0&&(a=true);h===void 0&&(h=false);if(e instanceof Array)return this._loadAssets(e,i,n,r,s,a,o);var u=xt.getRes(e);if(u!=null){T.timer.frameOnce(1,null,function(){n&&n.runWith(1);i&&i.runWith(u);l._loaderCount||l.event("complete")})}else{var c=d._resMap[e];if(!c){c=this._infoPool.length?this._infoPool.pop():new f;c.url=e;c.clas=t;c.type=r;c.cache=a;c.group=o;c.ignoreCache=h;i&&c.on("complete",i.caller,i.method,i.args);n&&c.on("progress",n.caller,n.method,n.args);d._resMap[e]=c;s=s<this._maxPriority?s:this._maxPriority-1;this._resInfos[s].push(c);this._next()}else{i&&c._createListener("complete",i.caller,i.method,i.args,false,false);n&&c._createListener("progress",n.caller,n.method,n.args,false,false)}}return this};e._next=function(){if(this._loaderCount>=this.maxLoader)return;for(var t=0;t<this._maxPriority;t++){var e=this._resInfos[t];while(e.length>0){var i=e.shift();if(i)return this._doLoad(i)}}this._loaderCount||this.event("complete")};e._doLoad=function(e){this._loaderCount++;var i=this._loaders.length?this._loaders.pop():new xt;i.on("complete",null,r);i.on("progress",null,function(t){e.event("progress",t)});i.on("error",null,function(t){r(null)});var n=this;function r(t){i.offAll();i._data=null;i._customParse=false;n._loaders.push(i);n._endLoad(e,t instanceof Array?[t]:t);n._loaderCount--;n._next()}i._class=e.clas;i.load(e.url,e.type,e.cache,e.group,e.ignoreCache)};e._endLoad=function(t,e){var i=t.url;if(e==null){var n=this._failRes[i]||0;if(n<this.retryNum){console.warn("[warn]Retry to load:",i);this._failRes[i]=n+1;T.timer.once(this.retryDelay,this,this._addReTry,[t],false);return}else{console.warn("[error]Failed to load:",i);this.event("error",i)}}if(this._failRes[i])this._failRes[i]=0;delete d._resMap[i];t.event("complete",e);t.offAll();this._infoPool.push(t)};e._addReTry=function(t){this._resInfos[this._maxPriority-1].push(t);this._next()};e.clearRes=function(t,e){e===void 0&&(e=false);xt.clearRes(t,e)};e.getRes=function(t){return xt.getRes(t)};e.cacheRes=function(t,e){xt.cacheRes(t,e)};e.clearTextureRes=function(t){xt.clearTextureRes(t)};e.setGroup=function(t,e){xt.setGroup(t,e)};e.clearResByGroup=function(t){xt.clearResByGroup(t)};e.clearUnLoaded=function(){for(var t=0;t<this._maxPriority;t++){var e=this._resInfos[t];for(var i=e.length-1;i>-1;i--){var n=e[i];if(n){n.offAll();this._infoPool.push(n)}}e.length=0}this._loaderCount=0;d._resMap={}};e.cancelLoadByUrls=function(t){if(!t)return;for(var e=0,i=t.length;e<i;e++){this.cancelLoadByUrl(t[e])}};e.cancelLoadByUrl=function(t){for(var e=0;e<this._maxPriority;e++){var i=this._resInfos[e];for(var n=i.length-1;n>-1;n--){var r=i[n];if(r&&r.url===t){i[n]=null;r.offAll();this._infoPool.push(r)}}}if(d._resMap[t])delete d._resMap[t]};e._loadAssets=function(t,i,a,e,n,r,s){n===void 0&&(n=1);r===void 0&&(r=true);var o=t.length;var h=0;var l=0;var u=[];var c=true;for(var f=0;f<o;f++){var _=t[f];if(typeof _=="string")_={url:_,type:e,size:1,priority:n};if(!_.size)_.size=1;_.progress=0;l+=_.size;u.push(_);var d=a?m.create(null,g,[_],false):null;var p=i||a?m.create(null,v,[_]):null;this.load(_.url,p,d,_.type,_.priority||1,r,_.group||s)}function v(t,e){h++;t.progress=1;if(!e)c=false;if(h===o&&i){i.runWith(c)}}function g(t,e){if(a!=null){t.progress=e;var i=0;for(var n=0;n<u.length;n++){var r=u[n];i+=r.size*r.progress}var s=i/l;a.runWith(s)}}return this};d.cacheRes=function(t,e){xt.cacheRes(t,e)};d._resMap={};h(d,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]);d.__init$=function(){f=function(t){function e(){this.url=null;this.type=null;this.cache=false;this.group=null;this.ignoreCache=false;this.clas=null;e.__super.call(this)}v(e,"",t);return e}(s)};return d}(s);var Tt=function(t){function r(t){r.__super.call(this);if(!t){t=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]}this._mat=new Float32Array(16);this._alpha=new Float32Array(4);var e=0;var i=0;for(var n=0;n<20;n++){if(n%5!=4){this._mat[e++]=t[n]}else{this._alpha[i++]=t[n]}}this._action=I.createFilterAction(32);this._action.data=this}v(r,"laya.filters.ColorFilter",t);var e=r.prototype;T.imps(e,{"laya.filters.IFilter":true});e.callNative=function(t){var e=t._$P.cf=this;t.conchModel&&t.conchModel.setFilterMatrix&&t.conchModel.setFilterMatrix(this._mat,this._alpha)};u(0,e,"type",function(){return 32});u(0,e,"action",function(){return this._action});return r}(S);var St=function(t){function n(t,e,i){this._endian=null;this._stamp=NaN;this._socket=null;this._connected=false;this._addInputPosition=0;this._input=null;this._output=null;this.timeout=0;this.objectEncoding=0;this.disableInput=false;this._byteClass=null;this.protocols=[];e===void 0&&(e=0);n.__super.call(this);this._byteClass=i?i:X;this.endian="bigEndian";this.timeout=2e4;this._addInputPosition=0;if(t&&e>0&&e<65535)this.connect(t,e)}v(n,"laya.net.Socket",t);var e=n.prototype;e.connect=function(t,e){var i=t+":"+e;if(i.indexOf("ws")==-1){i="ws://"+t+":"+e}this.connectByUrl(i)};e.connectByUrl=function(t){var e=this;if(this._socket!=null)this.close();this._socket&&this.cleanSocket();if(!this.protocols||this.protocols.length==0){this._socket=new j.window.WebSocket(t)}else{this._socket=new j.window.WebSocket(t,this.protocols)}this._socket.binaryType="arraybuffer";this._output=new this._byteClass;this._output.endian=this.endian;this._input=new this._byteClass;this._input.endian=this.endian;this._addInputPosition=0;this._socket.onopen=function(t){e._onOpen(t)};this._socket.onmessage=function(t){e._onMessage(t)};this._socket.onclose=function(t){e._onClose(t)};this._socket.onerror=function(t){e._onError(t)}};e.cleanSocket=function(){try{this._socket.close()}catch(t){}this._connected=false;this._socket.onopen=null;this._socket.onmessage=null;this._socket.onclose=null;this._socket.onerror=null;this._socket=null};e.close=function(){if(this._socket!=null){try{this._socket.close()}catch(t){}}};e._onOpen=function(t){this._connected=true;this.event("open",t)};e._onMessage=function(t){if(!t||!t.data)return;var e=t.data;if(this.disableInput&&e){this.event("message",e);return}if(this._input.length>0&&this._input.bytesAvailable<1){this._input.clear();this._addInputPosition=0}var i=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0);this._input.pos=this._addInputPosition;if(e){if(typeof e=="string"){this._input.writeUTFBytes(e)}else{this._input.writeArrayBuffer(e)}this._addInputPosition=this._input.pos;this._input.pos=i}this.event("message",e)};e._onClose=function(t){this._connected=false;this.event("close",t)};e._onError=function(t){this.event("error",t)};e.send=function(t){this._socket.send(t)};e.flush=function(){if(this._output&&this._output.length>0){var e;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(t){e=t}this._output.endian=this.endian;this._output.clear();if(e)this.event("error",e)}};u(0,e,"input",function(){return this._input});u(0,e,"output",function(){return this._output});u(0,e,"connected",function(){return this._connected});u(0,e,"endian",function(){return this._endian},function(t){this._endian=t;if(this._input!=null)this._input.endian=t;if(this._output!=null)this._output.endian=t});n.LITTLE_ENDIAN="littleEndian";n.BIG_ENDIAN="bigEndian";return n}(s);var Ct=function(t){function r(){this.worker=null;r.__super.call(this);var e=this;this.worker=new j.window.Worker(r.workerPath);this.worker.onmessage=function(t){e.workerMessage(t.data)}}v(r,"laya.net.WorkerLoader",t);var e=r.prototype;e.workerMessage=function(t){if(t){switch(t.type){case"Image":this.imageLoaded(t);break;case"Msg":this.event("image_msg",t.msg);break}}};e.imageLoaded=function(t){if(t&&t.buffer&&t.buffer.length<10){r._enable=false;this._myTrace("buffer lost when postmessage ,disable workerloader");this.event(t.url,null);this.event("image_err",t.url+"\n"+t.msg);return}if(!t.dataType){this.event(t.url,null);this.event("image_err",t.url+"\n"+t.msg);return}var e,i;var n;switch(t.dataType){case"buffer":e=new Ft("2D");i=e.source.getContext("2d");n=i.createImageData(t.width,t.height);n.data.set(t.buffer);e.size(n.width,n.height);i.putImageData(n,0,0);e.memorySize=0;break;case"imagedata":e=new Ft("2D");i=e.source.getContext("2d");n=t.imagedata;e.size(n.width,n.height);i.putImageData(n,0,0);n=t.imagedata;e.memorySize=0;break;case"imageBitmap":n=t.imageBitmap;if(!G.isWebGL){e=new Ft("2D");i=e.source.getContext("2d");e.size(n.width,n.height);i.drawImage(n,0,0);e.src=t.url}else e=n;break}if(G.isWebGL)e=new laya.webgl.resource.WebGLImage(e,t.url);this.event(t.url,e)};e._myTrace=function(t){var e=arguments;var i=[];var n=0,r=e.length;for(n=0;n<r;n++){i.push(e[n])}this.event("image_msg",i.join(" "))};e.loadImage=function(t){var e;e={};e.type="load";e.url=t;this.worker.postMessage(e)};e._loadImage=function(e){var i=this;if(!r._enable||e.toLowerCase().indexOf(".png")<0){r._preLoadFun.call(i,e);return}e=U.formatURL(e);function n(){laya.net.WorkerLoader.I.off(e,i,t)}var t=function(t){n();if(t){i["onLoaded"](t)}else{r._preLoadFun.call(i,e)}};laya.net.WorkerLoader.I.on(e,i,t);laya.net.WorkerLoader.I.loadImage(e)};u(1,r,"enable",function(){return r._enable},function(t){if(r.disableJSDecode&&!j.window.createImageBitmap)return;r._enable=t;if(r._enable&&r._preLoadFun==null)r._enable=r.__init__()});r.__init__=function(){if(r._preLoadFun!=null)return false;if(!j.window.Worker)return false;r._preLoadFun=xt["prototype"]["_loadImage"];xt["prototype"]["_loadImage"]=r["prototype"]["_loadImage"];if(!r.I)r.I=new r;return true};r.workerSupported=function(){return j.window.Worker?true:false};r.IMAGE_LOADED="image_loaded";r.IMAGE_ERR="image_err";r.IMAGE_MSG="image_msg";r.I=null;r._preLoadFun=null;r._enable=false;r.workerPath="libs/worker.js";r.disableJSDecode=true;return r}(s);var Et=function(t){function o(){o.__super.call(this);this._$1__id=++o._uniqueIDCounter;this.__loaded=true;this._destroyed=false;this._referenceCount=0;o._idResourcesMap[this.id]=this;this._released=true;this.lock=false;this._memorySize=0;this._lastUseFrameCount=-1;H.currentResourceManager&&H.currentResourceManager.addResource(this)}v(o,"laya.resource.Resource",t);var e=o.prototype;T.imps(e,{"laya.resource.ICreateResource":true,"laya.resource.IDispose":true});e._setUrl=function(t){if(this._url!==t){var e;if(this._url){e=o._urlResourcesMap[this._url];e.splice(e.indexOf(this),1);e.length===0&&delete o._urlResourcesMap[this._url]}if(t){e=o._urlResourcesMap[t];e||(o._urlResourcesMap[t]=e=[]);e.push(this)}this._url=t}};e._getGroup=function(){return this._group};e._setGroup=function(t){if(this._group!==t){var e;if(this._group){e=o._groupResourcesMap[this._group];e.splice(e.indexOf(this),1);e.length===0&&delete o._groupResourcesMap[this._group]}if(t){e=o._groupResourcesMap[t];e||(o._groupResourcesMap[t]=e=[]);e.push(this)}this._group=t}};e._addReference=function(){this._referenceCount++};e._removeReference=function(){this._referenceCount--};e._clearReference=function(){this._referenceCount=0};e._endLoaded=function(){this.__loaded=true;this.event("loaded",this)};e.recreateResource=function(){this.completeCreate()};e.disposeResource=function(){};e.activeResource=function(t){t===void 0&&(t=false);this._lastUseFrameCount=at.loopCount;if(!this._destroyed&&this.__loaded&&(this._released||t))this.recreateResource()};e.releaseResource=function(t){t===void 0&&(t=false);if(!t&&this.lock)return false;if(!this._released||t){this.disposeResource();this._released=true;this._lastUseFrameCount=-1;this.event("released",this);return true}else{return false}};e.onAsynLoaded=function(t,e,i){throw new Error("Resource: must override this function!")};e.destroy=function(){if(this._destroyed)return;if(this._resourceManager!==null)this._resourceManager.removeResource(this);this._destroyed=true;this.lock=false;this.releaseResource();delete o._idResourcesMap[this.id];var t;if(this._url){t=o._urlResourcesMap[this._url];if(t){t.splice(t.indexOf(this),1);t.length===0&&delete o._urlResourcesMap[this.url]}xt.clearRes(this._url);this.__loaded||I.cancelLoadByUrl(this._url)}if(this._group){t=o._groupResourcesMap[this._group];t.splice(t.indexOf(this),1);t.length===0&&delete o._groupResourcesMap[this.url]}};e.completeCreate=function(){this._released=false;this.event("recovered",this)};e.dispose=function(){this.destroy()};u(0,e,"memorySize",function(){return this._memorySize},function(t){var e=t-this._memorySize;this._memorySize=t;this.resourceManager&&this.resourceManager.addSize(e)});u(0,e,"_loaded",null,function(t){this.__loaded=t});u(0,e,"loaded",function(){return this.__loaded});u(0,e,"id",function(){return this._$1__id});u(0,e,"destroyed",function(){return this._destroyed});u(0,e,"group",function(){return this._getGroup()},function(t){this._setGroup(t)});u(0,e,"resourceManager",function(){return this._resourceManager});u(0,e,"url",function(){return this._url});u(0,e,"released",function(){return this._released});u(0,e,"referenceCount",function(){return this._referenceCount});o.getResourceByID=function(t){return o._idResourcesMap[t]};o.getResourceByURL=function(t,e){e===void 0&&(e=0);return o._urlResourcesMap[t][e]};o.getResourceCountByURL=function(t){return o._urlResourcesMap[t].length};o.destroyUnusedResources=function(t){var e;if(t){var i=o._groupResourcesMap[t];if(i){var n=i.slice();for(var r=0,s=n.length;r<s;r++){e=n[r];if(!e.lock&&e._referenceCount===0)e.destroy()}}}else{for(var a in o._idResourcesMap){e=o._idResourcesMap[a];if(!e.lock&&e._referenceCount===0)e.destroy()}}};o._uniqueIDCounter=0;o._idResourcesMap={};o._urlResourcesMap={};o._groupResourcesMap={};return o}(s);var At=function(t){function E(t,e){this.offsetX=0;this.offsetY=0;this.sourceWidth=0;this.sourceHeight=0;this._w=0;this._h=0;this._uvID=0;this._atlasID=-1;this.scaleRate=1;E.__super.call(this);if(t&&t._addReference!=null){t._addReference()}this.setTo(t,e)}v(E,"laya.resource.Texture",t);var e=E.prototype;e._setUrl=function(t){this.url=t};e.setTo=function(t,e){if(t instanceof a.HTMLElement){var i=Ft.create("2D",t);this.bitmap=i}else{this.bitmap=t}this.uv=e||E.DEF_UV;if(t){this._w=t.width;this._h=t.height;this.sourceWidth=this.sourceWidth||this._w;this.sourceHeight=this.sourceHeight||this._h;this._loaded=this._w>0;var n=this;if(this._loaded){I.addToAtlas&&I.addToAtlas(n)}else{var r=t;if(r instanceof laya.resource.HTMLImage&&r.image)r.image.addEventListener("load",function(t){I.addToAtlas&&I.addToAtlas(n)},false)}}};e.active=function(){if(this.bitmap)this.bitmap.activeResource()};e.destroy=function(t){t===void 0&&(t=false);if(this.bitmap&&this.bitmap.referenceCount>0){var e=this.bitmap;if(t){if(G.isConchApp&&e.source&&e.source.conchDestroy){this.bitmap.source.conchDestroy()}this.bitmap=null;e.dispose();e._clearReference()}else{e._removeReference();if(e.referenceCount==0){if(G.isConchApp&&e.source&&e.source.conchDestroy){this.bitmap.source.conchDestroy()}this.bitmap=null;e.dispose()}}if(this.url&&this===T.loader.getRes(this.url))T.loader.clearRes(this.url,t);this._loaded=false}};e.load=function(t){var e=this;this._loaded=false;t=U.customFormat(t);var i=this.bitmap||(this.bitmap=zt.create(t));if(i)i._addReference();var n=this;i.onload=function(){i.onload=null;n._loaded=true;e.sourceWidth=e._w=i.width;e.sourceHeight=e._h=i.height;n.event("loaded",this);I.addToAtlas&&I.addToAtlas(n)}};e.addTextureToAtlas=function(t){I.addTextureToAtlas(this)};e.getPixels=function(t,e,i,n){if(G.isConchApp){var r=this.bitmap;if(r.source&&r.source.getImageData){var s=r.source.getImageData(t,e,i,n);var a=new Uint8Array(s);return Array.from(a)}return null}else if(G.isWebGL){return I.getTexturePixels(this,t,e,i,n)}else{j.canvas.size(i,n);j.canvas.clear();j.context.drawTexture(this,-t,-e,this.width,this.height,0,0);var o=j.context.getImageData(0,0,i,n)}return o.data};e.onAsynLoaded=function(t,e){if(e)e._addReference();this.setTo(e,this.uv)};u(0,e,"source",function(){if(!this.bitmap)return null;this.bitmap.activeResource();return this.bitmap.source});u(0,e,"loaded",function(){return this._loaded});u(0,e,"released",function(){if(!this.bitmap)return true;return this.bitmap.released});u(0,e,"width",function(){if(this._w)return this._w;return this.uv&&this.uv!==E.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function(t){this._w=t;this.sourceWidth||(this.sourceWidth=t)});u(0,e,"repeat",function(){if(G.isWebGL&&this.bitmap){return this.bitmap.repeat}return true},function(t){if(t){if(G.isWebGL&&this.bitmap){this.bitmap.repeat=t;if(t){this.bitmap.enableMerageInAtlas=false}}}});u(0,e,"height",function(){if(this._h)return this._h;return this.uv&&this.uv!==E.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function(t){this._h=t;this.sourceHeight||(this.sourceHeight=t)});u(0,e,"isLinearSampling",function(){return G.isWebGL?this.bitmap.minFifter!=9728:true},function(t){if(!t&&G.isWebGL){if(!t&&this.bitmap.minFifter==-1&&this.bitmap.magFifter==-1){this.bitmap.minFifter=9728;this.bitmap.magFifter=9728;this.bitmap.enableMerageInAtlas=false}}});E.moveUV=function(t,e,i){for(var n=0;n<8;n+=2){i[n]+=t;i[n+1]+=e}return i};E.create=function(t,e,i,n,r,s,a,o,h){s===void 0&&(s=0);a===void 0&&(a=0);o===void 0&&(o=0);h===void 0&&(h=0);var l=t instanceof laya.resource.Texture;var u=l?t.uv:E.DEF_UV;var c=l?t.bitmap:t;var f=I.isAtlas(c);if(f){var _=c._atlaser;var d=t._atlasID;if(d==-1){throw new Error("create texture error")}c=_._inAtlasTextureBitmapValue[d];u=_._inAtlasTextureOriUVValue[d]}var p=new E(c,null);if(c.width&&e+n>c.width)n=c.width-e;if(c.height&&i+r>c.height)r=c.height-i;p.width=n;p.height=r;p.offsetX=s;p.offsetY=a;p.sourceWidth=o||n;p.sourceHeight=h||r;var v=1/c.width;var g=1/c.height;e*=v;i*=g;n*=v;r*=g;var m=p.uv[0],y=p.uv[1],b=p.uv[4],x=p.uv[5];var w=b-m,T=x-y;var S=E.moveUV(u[0],u[1],[e,i,e+n,i,e+n,i+r,e,i+r]);p.uv=[m+S[0]*w,y+S[1]*T,b-(1-S[2])*w,y+S[3]*T,b-(1-S[4])*w,x-(1-S[5])*T,m+S[6]*w,x-(1-S[7])*T];if(f){p.addTextureToAtlas()}var C=c.scaleRate;if(C&&C!=1){p.sourceWidth/=C;p.sourceHeight/=C;p.width/=C;p.height/=C;p.scaleRate=C;p.offsetX/=C;p.offsetY/=C}else{p.scaleRate=1}return p};E.createFromTexture=function(t,e,i,n,r){var s=t.scaleRate;if(s!=1){e*=s;i*=s;n*=s;r*=s}var a=R.TEMP.setTo(e-t.offsetX,i-t.offsetY,n,r);var o=a.intersection(E._rect1.setTo(0,0,t.width,t.height),E._rect2);if(o)var h=E.create(t,o.x,o.y,o.width,o.height,o.x-a.x,o.y-a.y,n,r);else return null;h.bitmap._removeReference();return h};E.DEF_UV=[0,0,1,0,1,1,0,1];E.INV_UV=[0,1,1,1,1,0,0,0];E._rect1=new R;E._rect2=new R;return E}(s);var Mt=function(t){var o;function s(){this._labelDic=null;this._tweenDic={};this._tweenDataList=[];this._endTweenDataList=null;this._currTime=0;this._lastTime=0;this._startTime=0;this._index=0;this._gidIndex=0;this._firstTweenDic={};this._startTimeSort=false;this._endTimeSort=false;this._loopKey=false;this.scale=1;this._frameRate=60;this._frameIndex=0;this._total=0;s.__super.call(this)}v(s,"laya.utils.TimeLine",t);var e=s.prototype;e.to=function(t,e,i,n,r){r===void 0&&(r=0);return this._create(t,e,i,n,r,true)};e.from=function(t,e,i,n,r){r===void 0&&(r=0);return this._create(t,e,i,n,r,false)};e._create=function(t,e,i,n,r,s){var a=rt.getItemByClass("tweenData",o);a.isTo=s;a.type=0;a.target=t;a.duration=i;a.data=e;a.startTime=this._startTime+r;a.endTime=a.startTime+a.duration;a.ease=n;this._startTime=Math.max(a.endTime,this._startTime);this._tweenDataList.push(a);this._startTimeSort=true;this._endTimeSort=true;return this};e.addLabel=function(t,e){var i=rt.getItemByClass("tweenData",o);i.type=1;i.data=t;i.endTime=i.startTime=this._startTime+e;this._labelDic||(this._labelDic={});this._labelDic[t]=i;this._tweenDataList.push(i);return this};e.removeLabel=function(t){if(this._labelDic&&this._labelDic[t]){var e=this._labelDic[t];if(e){var i=this._tweenDataList.indexOf(e);if(i>-1){this._tweenDataList.splice(i,1)}}delete this._labelDic[t]}};e.gotoTime=function(t){if(this._tweenDataList==null||this._tweenDataList.length==0)return;var e;var i;for(var n in this._firstTweenDic){i=this._firstTweenDic[n];if(i){for(var r in i){if(i.diyTarget.hasOwnProperty(r)){i.diyTarget[r]=i[r]}}}}for(n in this._tweenDic){e=this._tweenDic[n];e.clear();delete this._tweenDic[n]}this._index=0;this._gidIndex=0;this._currTime=t;this._lastTime=j.now();var s;if(this._endTweenDataList==null||this._endTimeSort){this._endTimeSort=false;this._endTweenDataList=s=this._tweenDataList.concat();function a(t,e){if(t.endTime>e.endTime){return 1}else if(t.endTime<e.endTime){return-1}else{return 0}}s.sort(a)}else{s=this._endTweenDataList}var o;for(var h=0,l=s.length;h<l;h++){o=s[h];if(o.type==0){if(t>=o.endTime){this._index=Math.max(this._index,h+1);var u=o.data;if(o.isTo){for(var c in u){o.target[c]=u[c]}}}else{break}}}for(h=0,l=this._tweenDataList.length;h<l;h++){o=this._tweenDataList[h];if(o.type==0){if(t>=o.startTime&&t<o.endTime){this._index=Math.max(this._index,h+1);this._gidIndex++;e=rt.getItemByClass("tween",lt);e._create(o.target,o.data,o.duration,o.ease,m.create(this,this._animComplete,[this._gidIndex]),0,false,o.isTo,true,false);e.setStartTime(this._currTime-(t-o.startTime));e._updateEase(this._currTime);e.gid=this._gidIndex;this._tweenDic[this._gidIndex]=e}}}};e.gotoLabel=function(t){if(this._labelDic==null)return;var e=this._labelDic[t];if(e)this.gotoTime(e.startTime)};e.pause=function(){T.timer.clear(this,this._update)};e.resume=function(){this.play(this._currTime,this._loopKey)};e.play=function(t,e){t===void 0&&(t=0);e===void 0&&(e=false);if(!this._tweenDataList)return;if(this._startTimeSort){this._startTimeSort=false;function i(t,e){if(t.startTime>e.startTime){return 1}else if(t.startTime<e.startTime){return-1}else{return 0}}this._tweenDataList.sort(i);for(var n=0,r=this._tweenDataList.length;n<r;n++){var s=this._tweenDataList[n];if(s!=null&&s.type==0){var a=s.target;var o=a.$_GID||(a.$_GID=ut.getGID());var h=null;if(this._firstTweenDic[o]==null){h={};h.diyTarget=a;this._firstTweenDic[o]=h}else{h=this._firstTweenDic[o]}for(var l in s.data){if(h[l]==null){h[l]=a[l]}}}}}if(typeof t=="string"){this.gotoLabel(t)}else{this.gotoTime(t)}this._loopKey=e;this._lastTime=j.now();T.timer.frameLoop(1,this,this._update)};e._update=function(){if(this._currTime>=this._startTime){if(this._loopKey){this._complete();if(!this._tweenDataList)return;this.gotoTime(0)}else{for(var t in this._tweenDic){r=this._tweenDic[t];r.complete()}this._complete();this.pause();return}}var e=j.now();var i=e-this._lastTime;var n=this._currTime+=i*this.scale;this._lastTime=e;for(t in this._tweenDic){r=this._tweenDic[t];r._updateEase(n)}var r;if(this._tweenDataList.length!=0&&this._index<this._tweenDataList.length){var s=this._tweenDataList[this._index];if(n>=s.startTime){this._index++;if(s.type==0){this._gidIndex++;r=rt.getItemByClass("tween",lt);r._create(s.target,s.data,s.duration,s.ease,m.create(this,this._animComplete,[this._gidIndex]),0,false,s.isTo,true,false);r.setStartTime(n);r.gid=this._gidIndex;this._tweenDic[this._gidIndex]=r;r._updateEase(n)}else{this.event("label",s.data)}}}};e._animComplete=function(t){var e=this._tweenDic[t];if(e)delete this._tweenDic[t]};e._complete=function(){this.event("complete")};e.reset=function(){var t;if(this._labelDic){for(t in this._labelDic){delete this._labelDic[t]}}var e;for(t in this._tweenDic){e=this._tweenDic[t];e.clear();delete this._tweenDic[t]}for(t in this._firstTweenDic){delete this._firstTweenDic[t]}this._endTweenDataList=null;if(this._tweenDataList&&this._tweenDataList.length){var i=0,n=0;n=this._tweenDataList.length;for(i=0;i<n;i++){if(this._tweenDataList[i])this._tweenDataList[i].destroy()}}this._tweenDataList.length=0;this._currTime=0;this._lastTime=0;this._startTime=0;this._index=0;this._gidIndex=0;this.scale=1;T.timer.clear(this,this._update)};e.destroy=function(){this.reset();this._labelDic=null;this._tweenDic=null;this._tweenDataList=null;this._firstTweenDic=null};u(0,e,"index",function(){return this._frameIndex},function(t){this._frameIndex=t;this.gotoTime(this._frameIndex/this._frameRate*1e3)});u(0,e,"total",function(){this._total=Math.floor(this._startTime/1e3*this._frameRate);return this._total});s.to=function(t,e,i,n,r){r===void 0&&(r=0);return(new s).to(t,e,i,n,r)};s.from=function(t,e,i,n,r){r===void 0&&(r=0);return(new s).from(t,e,i,n,r)};s.__init$=function(){o=function(){function t(){this.type=0;this.isTo=true;this.startTime=NaN;this.endTime=NaN;this.target=null;this.duration=NaN;this.ease=null;this.data=null}v(t,"");var e=t.prototype;e.destroy=function(){this.target=null;this.ease=null;this.data=null;this.isTo=true;this.type=0;rt.recover("tweenData",this)};return t}()};return s}(s);var It=function(r){function i(){this._transform=null;this._tfChanged=false;this._x=0;this._y=0;this._width=0;this._height=0;this._repaint=1;this._mouseEnableState=0;this._zOrder=0;this._graphics=null;this._renderType=0;this._optimizeScrollRect=false;this._texture=null;this.mouseThrough=false;this.autoSize=false;this.hitTestPrior=false;this.viewport=null;i.__super.call(this);this._style=o.EMPTY}v(i,"laya.display.Sprite",r);var t=i.prototype;T.imps(t,{"laya.display.ILayout":true});t.createConchModel=function(){return new ConchNode};t.destroy=function(t){t===void 0&&(t=true);this._releaseMem();r.prototype.destroy.call(this,t);this._style&&this._style.destroy();this._transform&&this._transform.destroy();this._transform=null;this._style=null;this._graphics=null};t.updateZOrder=function(){ut.updateOrder(this._childs)&&this.repaint()};t.reCache=function(){if(this._$P.cacheCanvas)this._$P.cacheCanvas.reCache=true;this._repaint=1};t.setBounds=function(t){this._set$P("uBounds",t)};t.getBounds=function(){if(!this._$P.mBounds)this._set$P("mBounds",new R);return R._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)};t.getSelfBounds=function(){if(this._$P.uBounds)return this._$P.uBounds;if(!this._$P.mBounds)this._set$P("mBounds",new R);return R._getWrapRec(this._getBoundPointsM(false),this._$P.mBounds)};t._boundPointsToParent=function(t){t===void 0&&(t=false);var e=0,i=0;if(this._style){e=this._style._tf.translateX;i=this._style._tf.translateY;t=t||this._style._tf.rotate!==0;if(this._style.scrollRect){e+=this._style.scrollRect.x;i+=this._style.scrollRect.y}}var n=this._getBoundPointsM(t);if(!n||n.length<1)return n;if(n.length!=8){n=t?L.scanPList(n):R._getWrapRec(n,R.TEMP)._getBoundPoints()}if(!this.transform){ut.transPointList(n,this._x-e,this._y-i);return n}var r=D.TEMP;var s=0,a=n.length;for(s=0;s<a;s+=2){r.x=n[s];r.y=n[s+1];this.toParentPoint(r);n[s]=r.x;n[s+1]=r.y}return n};t.getGraphicBounds=function(t){t===void 0&&(t=false);if(!this._graphics)return R.TEMP.setTo(0,0,0,0);return this._graphics.getBounds(t)};t._getBoundPointsM=function(t){t===void 0&&(t=false);if(this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(!this._$P.temBM)this._set$P("temBM",[]);if(this.scrollRect){var e=ut.clearArray(this._$P.temBM);var i=R.TEMP;i.copyFrom(this.scrollRect);ut.concatArray(e,i._getBoundPoints());return e}var n=this._graphics?this._graphics.getBoundPoints():ut.clearArray(this._$P.temBM);var r;var s;var a;a=this._childs;for(var o=0,h=a.length;o<h;o++){r=a[o];if(r instanceof laya.display.Sprite&&r.visible==true){s=r._boundPointsToParent(t);if(s)n=n?ut.concatArray(n,s):s}}return n};t.getStyle=function(){this._style===o.EMPTY&&(this._style=new o);return this._style};t.setStyle=function(t){this._style=t};t._adjustTransform=function(){this._tfChanged=false;var t=this._style;var e=t._tf;var i=e.scaleX,n=e.scaleY;var r;if(e.rotate||i!==1||n!==1||e.skewX||e.skewY){r=this._transform||(this._transform=k.create());r.bTransform=true;var s=(e.rotate-e.skewX)*.0174532922222222;var a=(e.rotate+e.skewY)*.0174532922222222;var o=Math.cos(a);var h=Math.sin(a);var l=Math.sin(s);var u=Math.cos(s);r.a=i*o;r.b=i*h;r.c=-n*l;r.d=n*u;r.tx=r.ty=0;return r}else{this._transform&&this._transform.destroy();this._transform=null;this._renderType&=~4}return r};t.pos=function(t,e,i){i===void 0&&(i=false);if(this._x!==t||this._y!==e){if(this.destroyed)return this;if(i){this._x=t;this._y=e;this.conchModel&&this.conchModel.pos(this._x,this._y);var n=this._parent;if(n&&n._repaint===0){n._repaint=1;n.parentRepaint()}if(this._$P.maskParent&&this._$P.maskParent._repaint===0){this._$P.maskParent._repaint=1;this._$P.maskParent.parentRepaint()}}else{this.x=t;this.y=e}}return this};t.pivot=function(t,e){this.pivotX=t;this.pivotY=e;return this};t.size=function(t,e){this.width=t;this.height=e;return this};t.scale=function(t,e,i){i===void 0&&(i=false);var n=this.getStyle();var r=n._tf;if(r.scaleX!=t||r.scaleY!=e){if(this.destroyed)return this;if(i){n.setScale(t,e);this._tfChanged=true;this.conchModel&&this.conchModel.scale(t,e);this._renderType|=4;var s=this._parent;if(s&&s._repaint===0){s._repaint=1;s.parentRepaint()}}else{this.scaleX=t;this.scaleY=e}}return this};t.skew=function(t,e){this.skewX=t;this.skewY=e;return this};t.render=function(t,e,i){at.spriteCount++;W.renders[this._renderType]._fun(this,t,e+this._x,i+this._y);this._repaint=0};t.drawToCanvas=function(t,e,i,n){if(G.isConchNode){var r=Ft.create("2D");var s=new V(t,e,r);s.ctx.setCanvasType(1);this.conchModel.drawToCanvas(r.source,i,n);return r}else{return I.drawToCanvas(this,this._renderType,t,e,i,n)}};t.customRender=function(t,e,i){this._renderType|=1024};t._applyFilters=function(){if(G.isWebGL)return;var t;t=this._$P.filters;if(!t||t.length<1)return;for(var e=0,i=t.length;e<i;e++){t[e].action.apply(this._$P.cacheCanvas)}};t._isHaveGlowFilter=function(){var t=0,e=0;if(this.filters){for(t=0;t<this.filters.length;t++){if(this.filters[t].type==8){return true}}}for(t=0,e=this._childs.length;t<e;t++){if(this._childs[t]._isHaveGlowFilter()){return true}}return false};t.localToGlobal=function(t,e){e===void 0&&(e=false);if(e===true){t=new D(t.x,t.y)}var i=this;while(i){if(i==T.stage)break;t=i.toParentPoint(t);i=i.parent}return t};t.globalToLocal=function(t,e){e===void 0&&(e=false);if(e){t=new D(t.x,t.y)}var i=this;var n=[];while(i){if(i==T.stage)break;n.push(i);i=i.parent}var r=n.length-1;while(r>=0){i=n[r];t=i.fromParentPoint(t);r--}return t};t.toParentPoint=function(t){if(!t)return t;t.x-=this.pivotX;t.y-=this.pivotY;if(this.transform){this._transform.transformPoint(t)}t.x+=this._x;t.y+=this._y;var e=this._style.scrollRect;if(e){t.x-=e.x;t.y-=e.y}return t};t.fromParentPoint=function(t){if(!t)return t;t.x-=this._x;t.y-=this._y;var e=this._style.scrollRect;if(e){t.x+=e.x;t.y+=e.y}if(this.transform){this._transform.invertTransformPoint(t)}t.x+=this.pivotX;t.y+=this.pivotY;return t};t.on=function(t,e,i,n){if(this._mouseEnableState!==1&&this.isMouseEvent(t)){this.mouseEnabled=true;this._setBit(2,true);if(this._parent){this._$2__onDisplay()}return this._createListener(t,e,i,n,false)}return r.prototype.on.call(this,t,e,i,n)};t.once=function(t,e,i,n){if(this._mouseEnableState!==1&&this.isMouseEvent(t)){this.mouseEnabled=true;this._setBit(2,true);if(this._parent){this._$2__onDisplay()}return this._createListener(t,e,i,n,true)}return r.prototype.once.call(this,t,e,i,n)};t._$2__onDisplay=function(){if(this._mouseEnableState!==1){var t=this;t=t.parent;while(t&&t._mouseEnableState!==1){if(t._getBit(2))break;t.mouseEnabled=true;t._setBit(2,true);t=t.parent}}};t.loadImage=function(t,e,i,n,r,s){var a=this;e===void 0&&(e=0);i===void 0&&(i=0);n===void 0&&(n=0);r===void 0&&(r=0);function o(t){if(!a.destroyed){a.size(e+(n||t.width),i+(r||t.height));a.repaint();s&&s.runWith(t)}}this.graphics.loadImage(t,e,i,n,r,o);return this};t.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint();if(this._repaint===0){this._repaint=1;this.parentRepaint()}if(this._$P&&this._$P.maskParent){this._$P.maskParent.repaint()}};t._needRepaint=function(){return this._repaint!==0&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache};t._childChanged=function(t){if(this._childs.length)this._renderType|=2048;else this._renderType&=~2048;if(t&&this._get$P("hasZorder"))T.timer.callLater(this,this.updateZOrder);this.repaint()};t.parentRepaint=function(){var t=this._parent;if(t&&t._repaint===0){t._repaint=1;t.parentRepaint()}};t.startDrag=function(t,e,i,n,r,s,a){e===void 0&&(e=false);i===void 0&&(i=0);n===void 0&&(n=300);s===void 0&&(s=false);a===void 0&&(a=.92);this._$P.dragging||this._set$P("dragging",new Q);this._$P.dragging.start(this,t,e,i,n,r,s,a)};t.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()};t._releaseMem=function(){if(!this._$P)return;var t=this._$P.cacheCanvas;if(t&&t.ctx){rt.recover("RenderContext",t.ctx);t.ctx.canvas.size(0,0);t.ctx=null}var e=this._$P._filterCache;if(e){e.destroy();e.recycle();this._set$P("_filterCache",null)}this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",false);this._$P._isHaveGlowFilter=null};t._setDisplay=function(t){if(!t)this._releaseMem();r.prototype._setDisplay.call(this,t)};t.hitTestPoint=function(t,e){var i=this.globalToLocal(D.TEMP.setTo(t,e));t=i.x;e=i.y;var n=this._$P.hitArea?this._$P.hitArea:this._width>0&&this._height>0?R.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds();return n.contains(t,e)};t.getMousePoint=function(){return this.globalToLocal(D.TEMP.setTo(T.stage.mouseX,T.stage.mouseY))};t._getWords=function(){return null};t._addChildsToLayout=function(n){var t=this._getWords();if(t==null&&this._childs.length==0)return false;if(t){for(var e=0,i=t.length;e<i;e++){n.push(t[e])}}this._childs.forEach(function(t,e,i){t._style._enableLayout()&&t._addToLayout(n)});return true};t._addToLayout=function(t){if(this._style.absolute)return;this._style.block?t.push(this):this._addChildsToLayout(t)&&(this.x=this.y=0)};t._isChar=function(){return false};t._getCSSStyle=function(){return this._style.getCSSStyle()};t._setAttributes=function(t,e){switch(t){case"x":this.x=parseFloat(e);break;case"y":this.y=parseFloat(e);break;case"width":this.width=parseFloat(e);break;case"height":this.height=parseFloat(e);break;default:this[t]=e}};t._layoutLater=function(){this.parent&&this.parent._layoutLater()};u(0,t,"optimizeScrollRect",function(){return this._optimizeScrollRect},function(t){if(this._optimizeScrollRect!=t){this._optimizeScrollRect=t;this.conchModel&&this.conchModel.optimizeScrollRect(t)}});u(0,t,"customRenderEnable",null,function(t){if(t){this._renderType|=1024;if(G.isConchNode){i.CustomList.push(this);var e=new Ft("2d");e._setContext(new CanvasRenderingContext2D);this.customContext=new V(0,0,e);e.context.setCanvasType&&e.context.setCanvasType(2);this.conchModel.custom(e.context)}}});u(0,t,"cacheAsBitmap",function(){return this.cacheAs!=="none"},function(t){this.cacheAs=t?this._$P["hasFilter"]?"none":"normal":"none"});u(0,t,"cacheAs",function(){return this._$P.cacheCanvas==null?"none":this._$P.cacheCanvas.type},function(t){var e=this._$P.cacheCanvas;if(t===(e?e.type:"none"))return;if(t!=="none"){if(!this._getBit(1))this._setUpNoticeType(1);e||(e=this._set$P("cacheCanvas",rt.getItemByClass("cacheCanvas",Object)));e.type=t;e.reCache=true;this._renderType|=16;if(t=="bitmap")this.conchModel&&this.conchModel.cacheAs(1);this._set$P("cacheForFilters",false)}else{if(this._$P["_mask"]){}else if(this._$P["hasFilter"]){this._set$P("cacheForFilters",true)}else{if(e){var i=e;if(i&&i.ctx){rt.recover("RenderContext",i.ctx);i.ctx.canvas.size(0,0);i.ctx=null}rt.recover("cacheCanvas",e)}this._$P.cacheCanvas=null;this._renderType&=~16;this.conchModel&&this.conchModel.cacheAs(0)}}this.repaint()});u(0,t,"zOrder",function(){return this._zOrder},function(t){if(this._zOrder!=t){this._zOrder=t;this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder(t);if(this._parent){t&&this._parent._set$P("hasZorder",true);T.timer.callLater(this._parent,this.updateZOrder)}}});u(0,t,"rotation",function(){return this._style._tf.rotate},function(t){var e=this.getStyle();if(e._tf.rotate!==t){e.setRotate(t);this._tfChanged=true;this.conchModel&&this.conchModel.rotate(t);this._renderType|=4;var i=this._parent;if(i&&i._repaint===0){i._repaint=1;i.parentRepaint()}}});u(0,t,"width",function(){if(!this.autoSize)return this._width;return this.getSelfBounds().width},function(t){if(this._width!==t){this._width=t;this.conchModel&&this.conchModel.size(t,this._height);this.repaint()}});u(0,t,"x",function(){return this._x},function(t){if(this._x!==t){if(this.destroyed)return;this._x=t;this.conchModel&&this.conchModel.pos(t,this._y);var e=this._parent;if(e&&e._repaint===0){e._repaint=1;e.parentRepaint()}if(this._$P.maskParent&&this._$P.maskParent._repaint===0){this._$P.maskParent._repaint=1;this._$P.maskParent.parentRepaint()}}});u(0,t,"globalScaleY",function(){var t=1;var e=this;while(e){if(e===T.stage)break;t*=e.scaleY;e=e.parent}return t});u(0,t,"hitArea",function(){return this._$P.hitArea},function(t){this._set$P("hitArea",t)});u(0,t,"staticCache",function(){return this._$P.staticCache},function(t){this._set$P("staticCache",t);if(!t)this.reCache()});u(0,t,"texture",function(){return this._texture},function(t){if(this._texture!=t){this._texture=t;this.graphics.cleanByTexture(t,0,0)}});u(0,t,"y",function(){return this._y},function(t){if(this._y!==t){if(this.destroyed)return;this._y=t;this.conchModel&&this.conchModel.pos(this._x,t);var e=this._parent;if(e&&e._repaint===0){e._repaint=1;e.parentRepaint()}if(this._$P.maskParent&&this._$P.maskParent._repaint===0){this._$P.maskParent._repaint=1;this._$P.maskParent.parentRepaint()}}});u(0,t,"height",function(){if(!this.autoSize)return this._height;return this.getSelfBounds().height},function(t){if(this._height!==t){this._height=t;this.conchModel&&this.conchModel.size(this._width,t);this.repaint()}});u(0,t,"blendMode",function(){return this._style.blendMode},function(t){this.getStyle().blendMode=t;this.conchModel&&this.conchModel.blendMode(t);if(t&&t!="source-over")this._renderType|=8;else this._renderType&=~8;this.parentRepaint()});u(0,t,"scaleX",function(){return this._style._tf.scaleX},function(t){var e=this.getStyle();if(e._tf.scaleX!==t){e.setScaleX(t);this._tfChanged=true;this.conchModel&&this.conchModel.scale(t,e._tf.scaleY);this._renderType|=4;var i=this._parent;if(i&&i._repaint===0){i._repaint=1;i.parentRepaint()}}});u(0,t,"scaleY",function(){return this._style._tf.scaleY},function(t){var e=this.getStyle();if(e._tf.scaleY!==t){e.setScaleY(t);this._tfChanged=true;this.conchModel&&this.conchModel.scale(e._tf.scaleX,t);this._renderType|=4;var i=this._parent;if(i&&i._repaint===0){i._repaint=1;i.parentRepaint()}}});u(0,t,"stage",function(){return T.stage});u(0,t,"skewX",function(){return this._style._tf.skewX},function(t){var e=this.getStyle();if(e._tf.skewX!==t){e.setSkewX(t);this._tfChanged=true;this.conchModel&&this.conchModel.skew(t,e._tf.skewY);this._renderType|=4;var i=this._parent;if(i&&i._repaint===0){i._repaint=1;i.parentRepaint()}}});u(0,t,"scrollRect",function(){return this._style.scrollRect},function(t){this.getStyle().scrollRect=t;this.repaint();if(t){this._renderType|=128;this.conchModel&&this.conchModel.scrollRect(t.x,t.y,t.width,t.height)}else{this._renderType&=~128;if(this.conchModel){if(i.RUNTIMEVERION<"0.9.1")this.conchModel.removeType(64);else this.conchModel.removeType(128)}}});u(0,t,"skewY",function(){return this._style._tf.skewY},function(t){var e=this.getStyle();if(e._tf.skewY!==t){e.setSkewY(t);this._tfChanged=true;this.conchModel&&this.conchModel.skew(e._tf.skewX,t);this._renderType|=4;var i=this._parent;if(i&&i._repaint===0){i._repaint=1;i.parentRepaint()}}});u(0,t,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(t){this._tfChanged=false;this._transform=t;if(t){this._x=t.tx;this._y=t.ty;t.tx=t.ty=0;this.conchModel&&this.conchModel.transform(t.a,t.b,t.c,t.d,this._x,this._y)}if(t)this._renderType|=4;else{this._renderType&=~4;this.conchModel&&this.conchModel.removeType(4)}this.parentRepaint()});u(0,t,"pivotX",function(){return this._style._tf.translateX},function(t){this.getStyle().setTranslateX(t);this.conchModel&&this.conchModel.pivot(t,this._style._tf.translateY);this.repaint()});u(0,t,"pivotY",function(){return this._style._tf.translateY},function(t){this.getStyle().setTranslateY(t);this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,t);this.repaint()});u(0,t,"alpha",function(){return this._style.alpha},function(t){if(this._style&&this._style.alpha!==t){t=t<0?0:t>1?1:t;this.getStyle().alpha=t;this.conchModel&&this.conchModel.alpha(t);if(t!==1)this._renderType|=2;else this._renderType&=~2;this.parentRepaint()}});u(0,t,"visible",function(){return this._style.visible},function(t){if(this._style&&this._style.visible!==t){this.getStyle().visible=t;this.conchModel&&this.conchModel.visible(t);this.parentRepaint()}});u(0,t,"graphics",function(){return this._graphics||(this.graphics=I.createGraphics())},function(t){if(this._graphics)this._graphics._sp=null;this._graphics=t;if(t){this._renderType&=~1;this._renderType|=512;t._sp=this;this.conchModel&&this.conchModel.graphics(this._graphics)}else{this._renderType&=~512;this._renderType&=~1;if(this.conchModel){if(i.RUNTIMEVERION<"0.9.1")this.conchModel.removeType(256);else this.conchModel.removeType(512)}}this.repaint()});u(0,t,"filters",function(){return this._$P.filters},function(t){t&&t.length===0&&(t=null);if(this._$P.filters==t)return;this._set$P("filters",t?t.slice():null);if(G.isConchApp){if(this.conchModel){if(i.RUNTIMEVERION<"0.9.1")this.conchModel.removeType(16);else this.conchModel.removeType(32)}if(this._$P.filters&&this._$P.filters.length==1){this._$P.filters[0].callNative(this)}}if(G.isWebGL){if(t&&t.length){this._renderType|=32}else{this._renderType&=~32}}if(t&&t.length>0){if(!this._getBit(1))this._setUpNoticeType(1);if(!(G.isWebGL&&t.length==1&&t[0]instanceof laya.filters.ColorFilter)){if(this.cacheAs!="bitmap"){if(!G.isConchNode)this.cacheAs="bitmap";this._set$P("cacheForFilters",true)}this._set$P("hasFilter",true)}}else{this._set$P("hasFilter",false);if(this._$P["cacheForFilters"]&&this.cacheAs=="bitmap"){this.cacheAs="none"}}this.repaint()});u(0,t,"parent",r.prototype._$get_parent,function(t){T.superSet(dt,this,"parent",t);if(t&&this._getBit(2)){this._$2__onDisplay()}});u(0,t,"mask",function(){return this._$P._mask},function(t){if(t&&this.mask&&this.mask._$P.maskParent)return;if(t){this.cacheAs="bitmap";this._set$P("_mask",t);t._set$P("maskParent",this)}else{this.mask&&this.mask._set$P("maskParent",null);this._set$P("_mask",t);this.cacheAs="none"}this.conchModel&&this.conchModel.mask(t?t.conchModel:null);this._renderType|=64;this.parentRepaint()});u(0,t,"mouseEnabled",function(){return this._mouseEnableState>1},function(t){this._mouseEnableState=t?2:1});u(0,t,"globalScaleX",function(){var t=1;var e=this;while(e){if(e===T.stage)break;t*=e.scaleX;e=e.parent}return t});u(0,t,"mouseX",function(){return this.getMousePoint().x});u(0,t,"mouseY",function(){return this.getMousePoint().y});i.fromImage=function(t){return(new i).loadImage(t)};i.CustomList=[];h(i,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=a.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]);return i}(dt);var Lt=function(t){function e(t){this._audio=null;this._onEnd=null;this._resumePlay=null;e.__super.call(this);this._onEnd=ut.bind(this.__onEnd,this);this._resumePlay=ut.bind(this.__resumePlay,this);t.addEventListener("ended",this._onEnd);this._audio=t}v(e,"laya.media.h5audio.AudioSoundChannel",t);var i=e.prototype;i.__onEnd=function(){if(this.loops==1){if(this.completeHandler){T.timer.once(10,this,this.__runComplete,[this.completeHandler],false);this.completeHandler=null}this.stop();this.event("complete");return}if(this.loops>0){this.loops--}this.startTime=0;this.play()};i.__resumePlay=function(){if(this._audio)this._audio.removeEventListener("canplay",this._resumePlay);if(this.isStopped)return;try{this._audio.currentTime=this.startTime;j.container.appendChild(this._audio);this._audio.play()}catch(t){this.event("error")}};i.play=function(){this.isStopped=false;if(!this._audio)return;try{this._audio.playbackRate=N.playbackRate;this._audio.currentTime=this.startTime}catch(t){this._audio.addEventListener("canplay",this._resumePlay);return}N.addChannel(this);j.container.appendChild(this._audio);if("play"in this._audio)this._audio.play()};i.stop=function(){this.isStopped=true;N.removeChannel(this);this.completeHandler=null;if(!this._audio)return;if("pause"in this._audio)if(G.isConchApp){this._audio.stop()}this._audio.pause();this._audio.removeEventListener("ended",this._onEnd);this._audio.removeEventListener("canplay",this._resumePlay);if(!j.onIE){if(this._audio!=vt._musicAudio){rt.recover("audio:"+this.url,this._audio)}}j.removeElement(this._audio);this._audio=null};i.pause=function(){this.isStopped=true;N.removeChannel(this);if("pause"in this._audio)this._audio.pause()};i.resume=function(){if(!this._audio)return;this.isStopped=false;N.addChannel(this);if("play"in this._audio)this._audio.play()};u(0,i,"position",function(){if(!this._audio)return 0;return this._audio.currentTime});u(0,i,"duration",function(){if(!this._audio)return 0;return this._audio.duration});u(0,i,"volume",function(){if(!this._audio)return 1;return this._audio.volume},function(t){if(!this._audio)return;this._audio.volume=t});return e}(gt);var Pt=function(t){function e(){this.audioBuffer=null;this.gain=null;this.bufferSource=null;this._currentTime=0;this._volume=1;this._startTime=0;this._pauseTime=0;this._onPlayEnd=null;this.context=yt.ctx;e.__super.call(this);this._onPlayEnd=ut.bind(this.__onPlayEnd,this);if(this.context["createGain"]){this.gain=this.context["createGain"]()}else{this.gain=this.context["createGainNode"]()}}v(e,"laya.media.webaudio.WebAudioSoundChannel",t);var i=e.prototype;i.play=function(){N.addChannel(this);this.isStopped=false;this._clearBufferSource();if(!this.audioBuffer)return;var t=this.context;var e=this.gain;var i=t.createBufferSource();this.bufferSource=i;i.buffer=this.audioBuffer;i.connect(e);if(e)e.disconnect();e.connect(t.destination);i.onended=this._onPlayEnd;if(this.startTime>=this.duration)this.startTime=0;this._startTime=j.now();if(this.gain.gain.setTargetAtTime){this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.001)}else this.gain.gain.value=this._volume;if(this.loops==0){i.loop=true}if(i.playbackRate.setTargetAtTime){i.playbackRate.setTargetAtTime(N.playbackRate,this.context.currentTime,.001)}else i.playbackRate.value=N.playbackRate;i.start(0,this.startTime);this._currentTime=0};i.__onPlayEnd=function(){if(this.loops==1){if(this.completeHandler){T.timer.once(10,this,this.__runComplete,[this.completeHandler],false);this.completeHandler=null}this.stop();this.event("complete");return}if(this.loops>0){this.loops--}this.startTime=0;this.play()};i._clearBufferSource=function(){if(this.bufferSource){var t=this.bufferSource;if(t.stop){t.stop(0)}else{t.noteOff(0)}t.disconnect(0);t.onended=null;if(!e._tryCleanFailed)this._tryClearBuffer(t);this.bufferSource=null}};i._tryClearBuffer=function(t){if(!j.onMac){try{t.buffer=null}catch(t){e._tryCleanFailed=true}return}try{t.buffer=yt._miniBuffer}catch(t){e._tryCleanFailed=true}};i.stop=function(){this._clearBufferSource();this.audioBuffer=null;if(this.gain)this.gain.disconnect();this.isStopped=true;N.removeChannel(this);this.completeHandler=null;if(N.autoReleaseSound)T.timer.once(5e3,null,N.disposeSoundIfNotUsed,[this.url],false)};i.pause=function(){if(!this.isStopped){this._pauseTime=this.position}this._clearBufferSource();if(this.gain)this.gain.disconnect();this.isStopped=true;N.removeChannel(this);if(N.autoReleaseSound)T.timer.once(5e3,null,N.disposeSoundIfNotUsed,[this.url],false)};i.resume=function(){this.startTime=this._pauseTime;this.play()};u(0,i,"position",function(){if(this.bufferSource){return(j.now()-this._startTime)/1e3+this.startTime}return 0});u(0,i,"duration",function(){if(this.audioBuffer){return this.audioBuffer.duration}return 0});u(0,i,"volume",function(){return this._volume},function(t){if(this.isStopped){return}this._volume=t;if(this.gain.gain.setTargetAtTime){this.gain.gain.setTargetAtTime(t,this.context.currentTime,.001)}else this.gain.gain.value=t});e._tryCleanFailed=false;e.SetTargetDelay=.001;return e}(gt);var kt=function(t){function e(){e.__super.call(this);this._w=0;this._h=0}v(e,"laya.resource.Bitmap",t);var i=e.prototype;u(0,i,"width",function(){return this._w});u(0,i,"height",function(){return this._h});u(0,i,"source",function(){return this._source});return e}(Et);var Dt=function(e){function t(){this.loop=false;this.wrapMode=0;this._index=0;this._count=0;this._isPlaying=false;this._labels=null;this._isReverse=false;this._frameRateChanged=false;this._controlNode=null;this._actionName=null;t.__super.call(this);this._interval=g.animationInterval;this._setUpNoticeType(1)}v(t,"laya.display.AnimationPlayerBase",e);var i=t.prototype;i.play=function(t,e,i,n){t===void 0&&(t=0);e===void 0&&(e=true);i===void 0&&(i="");n===void 0&&(n=true);this._isPlaying=true;this.index=typeof t=="string"?this._getFrameByLabel(t):t;this.loop=e;this._actionName=i;this._isReverse=this.wrapMode==1;if(this.interval>0){this.timerLoop(this.interval,this,this._frameLoop,null,true,true)}};i._getFrameByLabel=function(t){var e=0;for(e=0;e<this._count;e++){if(this._labels[e]&&this._labels[e].indexOf(t)>=0)return e}return 0};i._frameLoop=function(){if(this._isReverse){this._index--;if(this._index<0){if(this.loop){if(this.wrapMode==2){this._index=this._count>0?1:0;this._isReverse=false}else{this._index=this._count-1}this.event("complete")}else{this._index=0;this.stop();this.event("complete");return}}}else{this._index++;if(this._index>=this._count){if(this.loop){if(this.wrapMode==2){this._index=this._count-2>=0?this._count-2:0;this._isReverse=true}else{this._index=0}this.event("complete")}else{this._index--;this.stop();this.event("complete");return}}}this.index=this._index};i._setControlNode=function(t){if(this._controlNode){this._controlNode.off("display",this,this._checkResumePlaying);this._controlNode.off("undisplay",this,this._checkResumePlaying)}this._controlNode=t;if(t&&t!=this){t.on("display",this,this._checkResumePlaying);t.on("undisplay",this,this._checkResumePlaying)}};i._setDisplay=function(t){e.prototype._setDisplay.call(this,t);this._checkResumePlaying()};i._checkResumePlaying=function(){if(this._isPlaying){if(this._controlNode.displayedInStage)this.play(this._index,this.loop,this._actionName);else this.clearTimer(this,this._frameLoop)}};i.stop=function(){this._isPlaying=false;this.clearTimer(this,this._frameLoop)};i.addLabel=function(t,e){if(!this._labels)this._labels={};if(!this._labels[e])this._labels[e]=[];this._labels[e].push(t)};i.removeLabel=function(t){if(!t)this._labels=null;else if(this._labels){for(var e in this._labels){this._removeLabelFromLabelList(this._labels[e],t)}}};i._removeLabelFromLabelList=function(t,e){if(!t)return;for(var i=t.length-1;i>=0;i--){if(t[i]==e){t.splice(i,1)}}};i.gotoAndStop=function(t){this.index=typeof t=="string"?this._getFrameByLabel(t):t;this.stop()};i._displayToIndex=function(t){};i.clear=function(){this.stop();this._labels=null};u(0,i,"interval",function(){return this._interval},function(t){if(this._interval!=t){this._frameRateChanged=true;this._interval=t;if(this._isPlaying&&t>0){this.timerLoop(t,this,this._frameLoop,null,true,true)}}});u(0,i,"isPlaying",function(){return this._isPlaying});u(0,i,"index",function(){return this._index},function(t){this._index=t;this._displayToIndex(t);if(this._labels&&this._labels[t]){var e=this._labels[t];for(var i=0,n=e.length;i<n;i++){this.event("label",e[i])}}});u(0,i,"count",function(){return this._count});t.WRAP_POSITIVE=0;t.WRAP_REVERSE=1;t.WRAP_PINGPONG=2;return t}(It);var Rt=function(e){function _(){this._clipPoint=null;this._currBitmapFont=null;this._text=null;this._isChanged=false;this._textWidth=0;this._textHeight=0;this._lines=[];this._lineWidths=[];this._startX=NaN;this._startY=NaN;this._lastVisibleLineIndex=-1;this._words=null;this._charSize={};this.underline=false;this._underlineColor=null;_.__super.call(this);this.overflow=_.VISIBLE;this._style=new pt(this);this._style.wordWrap=false}v(_,"laya.display.Text",e);var t=_.prototype;t.destroy=function(t){t===void 0&&(t=true);e.prototype.destroy.call(this,t);this._lines=null;if(this._words){this._words.length=0;this._words=null}};t._getBoundPointsM=function(t){t===void 0&&(t=false);var e=R.TEMP;e.setTo(0,0,this.width,this.height);return e._getBoundPoints()};t.getGraphicBounds=function(t){t===void 0&&(t=false);var e=R.TEMP;e.setTo(0,0,this.width,this.height);return e};t._getCSSStyle=function(){return this._style};t.lang=function(t,e,i,n,r,s,a,o,h,l,u){t=_.langPacks&&_.langPacks[t]?_.langPacks[t]:t;if(arguments.length<2){this._text=t}else{for(var c=0,f=arguments.length;c<f;c++){t=t.replace("{"+c+"}",arguments[c+1])}this._text=t}};t._isPassWordMode=function(){var t=this._style;var e=t.password;if("prompt"in this&&this["prompt"]==this._text)e=false;return e};t._getPassWordTxt=function(t){var e=t.length;var i;i="";for(var n=e;n>0;n--){i+="●"}return i};t.renderText=function(t,e){var i=this.graphics;i.clear(true);var n=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(j.onIPhone?laya.display.Text._fontFamilyMap[this.font]||this.font:this.font);j.context.font=n;var r=this.padding;var s=r[3];var a="left";var o=this._lines;var h=this.leading+this._charSize.height;var l=this._currBitmapFont;if(l){h=this.leading+l.getMaxHeight()}var u=r[0];if(!l&&this._width>0&&this._textWidth<=this._width){if(this.align=="right"){a="right";s=this._width-r[1]}else if(this.align=="center"){a="center";s=this._width*.5+r[3]-r[1]}}if(this._height>0){var c=this._textHeight>this._height?"top":this.valign;if(c==="middle")u=(this._height-e*h)*.5+r[0]-r[2];else if(c==="bottom")u=this._height-e*h-r[2]}var f=this._style;if(l&&l.autoScaleSize){var _=l.fontSize/this.fontSize}if(this._clipPoint){i.save();if(l&&l.autoScaleSize){var d=0;var p=0;this._width?d=this._width-r[3]-r[1]:d=this._textWidth;this._height?p=this._height-r[0]-r[2]:p=this._textHeight;d*=_;p*=_;i.clipRect(r[3],r[0],d,p)}else{i.clipRect(r[3],r[0],this._width?this._width-r[3]-r[1]:this._textWidth,this._height?this._height-r[0]-r[2]:this._textHeight)}}var v=f.password;if("prompt"in this&&this["prompt"]==this._text)v=false;var g=0,m=0;var y=Math.min(this._lines.length,e+t)||1;for(var b=t;b<y;b++){var x=o[b];var w;if(v){var T=x.length;x="";for(var S=T;S>0;S--){x+="●"}}if(x===undefined)x="";g=s-(this._clipPoint?this._clipPoint.x:0);m=u+h*b-(this._clipPoint?this._clipPoint.y:0);this.underline&&this.drawUnderline(a,g,m,b);if(l){var C=this.width;if(l.autoScaleSize){C=this.width*_}l.drawText(x,this,g,m,this.align,C)}else{if(G.isWebGL){this._words||(this._words=[]);w=this._words.length>b-t?this._words[b-t]:new _t;w.setText(x)}else{w=x}f.stroke?i.fillBorderText(w,g,m,n,this.color,f.strokeColor,f.stroke,a):i.fillText(w,g,m,n,this.color,a)}}if(l&&l.autoScaleSize){var E=1/_;this.scale(E,E)}if(this._clipPoint)i.restore();this._startX=s;this._startY=u};t.drawUnderline=function(t,e,i,n){var r=this._lineWidths[n];switch(t){case"center":e-=r/2;break;case"right":e-=r;break;case"left":default:break}i+=this._charSize.height;this._graphics.drawLine(e,i,e+r,i,this.underlineColor||this.color,1)};t.typeset=function(){this._isChanged=false;if(!this._text){this._clipPoint=null;this._textWidth=this._textHeight=0;this.graphics.clear(true);return}if(G.isConchApp){var t=""+this._getCSSStyle().font;var e=this._getCSSStyle();if(e.stroke){if(this._getCSSStyle().strokeColor){t+=" "+1+" "+this._getCSSStyle().strokeColor}}j.context.font=t}else{j.context.font=this._getCSSStyle().font}this._lines.length=0;this._lineWidths.length=0;if(this._isPassWordMode()){this.parseLines(this._getPassWordTxt(this._text))}else this.parseLines(this._text);this.evalTextSize();if(this.checkEnabledViewportOrNot())this._clipPoint||(this._clipPoint=new D(0,0));else this._clipPoint=null;var i=this._lines.length;if(this.overflow!=_.VISIBLE){var n=this.overflow==_.HIDDEN?Math.floor:Math.ceil;i=Math.min(i,n((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var r=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText(r,i);this.repaint()};t.evalTextSize=function(){var t=NaN,e=NaN;t=Math.max.apply(this,this._lineWidths);if(this._currBitmapFont)e=this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2];else e=this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2];if(t!=this._textWidth||e!=this._textHeight){this._textWidth=t;this._textHeight=e;if(!this._width||!this._height)this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight)}};t.checkEnabledViewportOrNot=function(){return this.overflow==_.SCROLL&&(this._width>0&&this._textWidth>this._width||this._height>0&&this._textHeight>this._height)};t.changeText=function(t){if(this._text!==t){this.lang(t+"");if(this._graphics&&this._graphics.replaceText(this._text)){}else{this.typeset()}}};t.parseLines=function(t){var e=this.wordWrap||this.overflow==_.HIDDEN;if(e){var i=this.getWordWrapWidth()}if(this._currBitmapFont){this._charSize.width=this._currBitmapFont.getMaxWidth();this._charSize.height=this._currBitmapFont.getMaxHeight()}else{var n=j.context.measureText(_._testWord);if(G.isConchApp&&n.width===0&&n.height===0){n=j.context.measureText("W")}this._charSize.width=n.width;this._charSize.height=n.height||this.fontSize}var r=t.replace(/\r\n/g,"\n").split("\n");for(var s=0,a=r.length;s<a;s++){var o=r[s];if(e)this.parseLine(o,i);else{this._lineWidths.push(this.getTextWidth(o));this._lines.push(o)}}};t.parseLine=function(t,e){var i=j.context;var n=this._lines;var r=0;var s;var a=NaN;var o=NaN;var h=0;a=this.getTextWidth(t);if(a<=e){n.push(t);this._lineWidths.push(a);return}a=this._charSize.width;r=Math.floor(e/a);r==0&&(r=1);a=this.getTextWidth(t.substring(0,r));o=a;for(var l=r,u=t.length;l<u;l++){a=this.getTextWidth(t.charAt(l));o+=a;if(o>e){if(this.wordWrap){var c=t.substring(h,l);if(c.charCodeAt(c.length-1)<255){s=/(?:\w|-)+$/.exec(c);if(s){l=s.index+h;if(s.index==0)l+=c.length;else c=t.substring(h,l)}}else if(_.RightToLeft){s=/([\u0600-\u06FF])+$/.exec(c);if(s){l=s.index+h;if(s.index==0)l+=c.length;else c=t.substring(h,l)}}n.push(c);this._lineWidths.push(o-a);h=l;if(l+r<u){l+=r;a=this.getTextWidth(t.substring(h,l));o=a;l--}else{n.push(t.substring(h,u));this._lineWidths.push(this.getTextWidth(n[n.length-1]));h=-1;break}}else if(this.overflow==_.HIDDEN){n.push(t.substring(0,l));this._lineWidths.push(this.getTextWidth(n[n.length-1]));return}}}if(this.wordWrap&&h!=-1){n.push(t.substring(h,u));this._lineWidths.push(this.getTextWidth(n[n.length-1]))}};t.getTextWidth=function(t){if(this._currBitmapFont)return this._currBitmapFont.getTextWidth(t);else return j.context.measureText(t).width};t.getWordWrapWidth=function(){var t=this.padding;var e=NaN;if(this._currBitmapFont&&this._currBitmapFont.autoScaleSize)e=this._width*(this._currBitmapFont.fontSize/this.fontSize);else e=this._width;if(e<=0){e=this.wordWrap?100:j.width}e<=0&&(e=100);return e-t[3]-t[1]};t.getCharPoint=function(t,e){this._isChanged&&T.timer.runCallLater(this,this.typeset);var i=0,n=this._lines,r=0;for(var s=0,a=n.length;s<a;s++){i+=n[s].length;if(t<i){var o=s;break}r=i}var h=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;j.context.font=h;var l=this.getTextWidth(this._text.substring(r,t));var u=e||new D;return u.setTo(this._startX+l-(this._clipPoint?this._clipPoint.x:0),this._startY+o*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))};u(0,t,"width",function(){if(this._width)return this._width;return this.textWidth+this.padding[1]+this.padding[3]},function(t){if(t!=this._width){T.superSet(It,this,"width",t);this.isChanged=true}});u(0,t,"textWidth",function(){this._isChanged&&T.timer.runCallLater(this,this.typeset);return this._textWidth});u(0,t,"height",function(){if(this._height)return this._height;return this.textHeight},function(t){if(t!=this._height){T.superSet(It,this,"height",t);this.isChanged=true}});u(0,t,"textHeight",function(){this._isChanged&&T.timer.runCallLater(this,this.typeset);return this._textHeight});u(0,t,"padding",function(){return this._getCSSStyle().padding},function(t){this._getCSSStyle().padding=t;this.isChanged=true});u(0,t,"bold",function(){return this._getCSSStyle().bold},function(t){this._getCSSStyle().bold=t;this.isChanged=true});u(0,t,"text",function(){return this._text||""},function(t){if(this._text!==t){this.lang(t+"");this.isChanged=true;this.event("change")}});u(0,t,"color",function(){return this._getCSSStyle().color},function(t){if(this._getCSSStyle().color!=t){this._getCSSStyle().color=t;if(!this._isChanged&&this._graphics){this._graphics.replaceTextColor(this.color)}else{this.isChanged=true}}});u(0,t,"font",function(){return this._getCSSStyle().fontFamily},function(t){if(this._currBitmapFont){this._currBitmapFont=null;this.scale(1,1)}if(_._bitmapFonts&&_._bitmapFonts[t]){this._currBitmapFont=_._bitmapFonts[t]}this._getCSSStyle().fontFamily=t;this.isChanged=true});u(0,t,"fontSize",function(){return this._getCSSStyle().fontSize},function(t){this._getCSSStyle().fontSize=t;this.isChanged=true});u(0,t,"italic",function(){return this._getCSSStyle().italic},function(t){this._getCSSStyle().italic=t;this.isChanged=true});u(0,t,"align",function(){return this._getCSSStyle().align},function(t){this._getCSSStyle().align=t;this.isChanged=true});u(0,t,"valign",function(){return this._getCSSStyle().valign},function(t){this._getCSSStyle().valign=t;this.isChanged=true});u(0,t,"wordWrap",function(){return this._getCSSStyle().wordWrap},function(t){this._getCSSStyle().wordWrap=t;this.isChanged=true});u(0,t,"leading",function(){return this._getCSSStyle().leading},function(t){this._getCSSStyle().leading=t;this.isChanged=true});u(0,t,"bgColor",function(){return this._getCSSStyle().backgroundColor},function(t){this._getCSSStyle().backgroundColor=t;this.isChanged=true});u(0,t,"borderColor",function(){return this._getCSSStyle().borderColor},function(t){this._getCSSStyle().borderColor=t;this.isChanged=true});u(0,t,"stroke",function(){return this._getCSSStyle().stroke},function(t){this._getCSSStyle().stroke=t;this.isChanged=true});u(0,t,"strokeColor",function(){return this._getCSSStyle().strokeColor},function(t){this._getCSSStyle().strokeColor=t;this.isChanged=true});u(0,t,"isChanged",null,function(t){if(this._isChanged!==t){this._isChanged=t;t&&T.timer.callLater(this,this.typeset)}});u(0,t,"scrollX",function(){if(!this._clipPoint)return 0;return this._clipPoint.x},function(t){if(this.overflow!=_.SCROLL||(this.textWidth<this._width||!this._clipPoint))return;t=t<this.padding[3]?this.padding[3]:t;var e=this._textWidth-this._width;t=t>e?e:t;var i=this._height/(this._charSize.height+this.leading)|0+1;this._clipPoint.x=t;this.renderText(this._lastVisibleLineIndex,i)});u(0,t,"scrollY",function(){if(!this._clipPoint)return 0;return this._clipPoint.y},function(t){if(this.overflow!=_.SCROLL||(this.textHeight<this._height||!this._clipPoint))return;t=t<this.padding[0]?this.padding[0]:t;var e=this._textHeight-this._height;t=t>e?e:t;var i=t/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=i;var n=(this._height/(this._charSize.height+this.leading)|0)+1;this._clipPoint.y=t;this.renderText(i,n)});u(0,t,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width});u(0,t,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height});u(0,t,"lines",function(){if(this._isChanged)this.typeset();return this._lines});u(0,t,"underlineColor",function(){return this._underlineColor},function(t){this._underlineColor=t;this._isChanged=true;this.typeset()});_.registerBitmapFont=function(t,e){_._bitmapFonts||(_._bitmapFonts={});_._bitmapFonts[t]=e};_.unregisterBitmapFont=function(t,e){e===void 0&&(e=true);if(_._bitmapFonts&&_._bitmapFonts[t]){var i=_._bitmapFonts[t];if(e){i.destroy()}delete _._bitmapFonts[t]}};_.setTextRightToLeft=function(){var t;t=j.canvas.source.style;t.display="none";t.position="absolute";t.direction="rtl";G._mainCanvas.source.style.direction="rtl";laya.display.Text.RightToLeft=true;j.document.body.appendChild(j.canvas.source)};_.supportFont=function(t){j.context.font="10px sans-serif";var e=j.context.measureText("abcji").width;j.context.font="10px "+t;var i=j.context.measureText("abcji").width;console.log(e,i);if(e===i)return false;else return true};_._testWord="游";_.langPacks=null;_.VISIBLE="visible";_.SCROLL="scroll";_.HIDDEN="hidden";_.CharacterCache=true;_.RightToLeft=false;_._bitmapFonts=null;h(_,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]);return _}(It);var Nt=function(f){function l(){this.focus=null;this.designWidth=0;this.designHeight=0;this.canvasRotation=false;this.canvasDegree=0;this.renderingEnabled=true;this.screenAdaptationEnabled=true;this._screenMode="none";this._scaleMode="noscale";this._alignV="top";this._alignH="left";this._bgColor="black";this._mouseMoveTime=0;this._renderCount=0;this._frameStartTime=NaN;this._isFocused=false;this._isVisibility=false;this._scenes=null;this._frameRate="fast";this.useRetinalCanvas=false;l.__super.call(this);this.offset=new D;this._canvasTransform=new k;this._previousOrientation=j.window.orientation;var e=this;this.transform=k.create();this._scenes=[];this.mouseEnabled=true;this.hitTestPrior=true;this.autoSize=false;this._displayedInStage=true;this._isFocused=true;this._isVisibility=true;this.useRetinalCanvas=g.useRetinalCanvas;var t=j.window;var i=this;t.addEventListener("focus",function(){e._isFocused=true;i.event("focus");i.event("focuschange")});t.addEventListener("blur",function(){e._isFocused=false;i.event("blur");i.event("focuschange");if(i._isInputting())Wt["inputElement"].target.focus=false});var n="hidden",r="visibilityState",s="visibilitychange";var a=t.document;if(typeof a.hidden!=="undefined"){s="visibilitychange";r="visibilityState"}else if(typeof a.mozHidden!=="undefined"){s="mozvisibilitychange";r="mozVisibilityState"}else if(typeof a.msHidden!=="undefined"){s="msvisibilitychange";r="msVisibilityState"}else if(typeof a.webkitHidden!=="undefined"){s="webkitvisibilitychange";r="webkitVisibilityState"}t.document.addEventListener(s,o);function o(){if(j.document[r]=="hidden"){i._setStageVisible(false)}else{i._setStageVisible(true)}}t.document.addEventListener("qbrowserVisibilityChange",h);function h(t){i._setStageVisible(!t.hidden)}t.addEventListener("resize",function(){var t=j.window.orientation;if(t!=null&&t!=e._previousOrientation&&i._isInputting()){Wt["inputElement"].target.focus=false}e._previousOrientation=t;if(i._isInputting())return;i._resetCanvas()});t.addEventListener("orientationchange",function(t){i._resetCanvas()});this.on("mousemove",this,this._onmouseMove);if(j.onMobile)this.on("mousedown",this,this._onmouseMove)}v(l,"laya.display.Stage",f);var t=l.prototype;t._setStageVisible=function(t){if(this._isVisibility==t)return;this._isVisibility=t;if(!this._isVisibility)if(this._isInputting())Wt["inputElement"].target.focus=false;this.event("visibilitychange")};t._isInputting=function(){return j.onMobile&&Wt.isInputting};t._changeCanvasSize=function(){this.setScreenSize(j.clientWidth*j.pixelRatio,j.clientHeight*j.pixelRatio)};t._resetCanvas=function(){if(!this.screenAdaptationEnabled)return;var t=G._mainCanvas;var e=t.source.style;t.size(1,1);T.timer.once(100,this,this._changeCanvasSize)};t.setScreenSize=function(t,e){var i=false;if(this._screenMode!=="none"){var n=t/e<1?"vertical":"horizontal";i=n!==this._screenMode;if(i){var r=e;e=t;t=r}}this.canvasRotation=i;var s=G._mainCanvas;var a=s.source.style;var o=this._canvasTransform.identity();var h=this._scaleMode;var l=t/this.designWidth;var u=e/this.designHeight;var c=g.useRetinalCanvas?t:this.designWidth;var f=g.useRetinalCanvas?e:this.designHeight;var _=t;var d=e;var p=j.pixelRatio;this._width=this.designWidth;this._height=this.designHeight;switch(h){case"noscale":l=u=1;_=this.designWidth;d=this.designHeight;break;case"showall":l=u=Math.min(l,u);c=_=Math.round(this.designWidth*l);f=d=Math.round(this.designHeight*u);break;case"noborder":l=u=Math.max(l,u);_=Math.round(this.designWidth*l);d=Math.round(this.designHeight*u);break;case"full":l=u=1;this._width=c=t;this._height=f=e;break;case"fixedwidth":u=l;this._height=f=Math.round(e/l);break;case"fixedheight":l=u;this._width=c=Math.round(t/u);break;case"fixedauto":if(t/e<this.designWidth/this.designHeight){u=l;this._height=f=Math.round(e/l)}else{l=u;this._width=c=Math.round(t/u)}break}if(this.conchModel)this.conchModel.size(this._width,this._height);if(g.useRetinalCanvas){c=t;f=e}l*=this.scaleX;u*=this.scaleY;if(l===1&&u===1){this.transform.identity()}else{this.transform.a=this._formatData(l/(_/c));this.transform.d=this._formatData(u/(d/f));this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)}s.size(c,f);I.changeWebGLSize(c,f);o.scale(_/c/p,d/f/p);if(this._alignH==="left")this.offset.x=0;else if(this._alignH==="right")this.offset.x=(t-_)/p;else this.offset.x=(t-_)*.5/p;if(this._alignV==="top")this.offset.y=0;else if(this._alignV==="bottom")this.offset.y=(e-d)/p;else this.offset.y=(e-d)*.5/p;this.offset.x=Math.round(this.offset.x);this.offset.y=Math.round(this.offset.y);o.translate(this.offset.x,this.offset.y);this.canvasDegree=0;if(i){if(this._screenMode==="horizontal"){o.rotate(Math.PI/2);o.translate(e/p,0);this.canvasDegree=90}else{o.rotate(-Math.PI/2);o.translate(0,t/p);this.canvasDegree=-90}}o.a=this._formatData(o.a);o.d=this._formatData(o.d);o.tx=this._formatData(o.tx);o.ty=this._formatData(o.ty);a.transformOrigin=a.webkitTransformOrigin=a.msTransformOrigin=a.mozTransformOrigin=a.oTransformOrigin="0px 0px 0px";a.transform=a.webkitTransform=a.msTransform=a.mozTransform=a.oTransform="matrix("+o.toString()+")";o.translate(parseInt(a.left)||0,parseInt(a.top)||0);this.visible=true;this._repaint=1;this.event("resize")};t._formatData=function(t){if(Math.abs(t)<1e-6)return 0;if(Math.abs(1-t)<.001)return t>0?1:-1;return t};t.getMousePoint=function(){return D.TEMP.setTo(this.mouseX,this.mouseY)};t.repaint=function(){this._repaint=1};t.parentRepaint=function(){};t._loop=function(){this.render(G.context,0,0);return true};t._onmouseMove=function(t){this._mouseMoveTime=j.now()};t.getTimeFromFrameStart=function(){return j.now()-this._frameStartTime};t.render=function(t,e,i){if(this._frameRate==="sleep"&&!G.isConchApp){var n=j.now();if(n-this._frameStartTime>=1e3)this._frameStartTime=n;else return}this._renderCount++;G.isFlash&&this.repaint();if(!this._style.visible){if(this._renderCount%5===0){at.loopCount++;x.instance.runEvent();T.timer._update()}return}this._frameStartTime=j.now();var r=this._frameRate==="mouse"?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate;var s=r!=="slow";var a=this._renderCount%2===0;at.renderSlow=!s;if(s||a||G.isConchApp){at.loopCount++;x.instance.runEvent();T.timer._update();I.update3DLoop();var o;var h=0,l=0;if(G.isConchNode){for(h=0,l=this._scenes.length;h<l;h++){o=this._scenes[h];o&&o._updateSceneConch()}}else{for(h=0,l=this._scenes.length;h<l;h++){o=this._scenes[h];o&&o._updateScene()}}if(G.isConchNode){var u=It["CustomList"];for(h=0,l=u.length;h<l;h++){var c=u[h];c.customRender(c.customContext,0,0)}return}}if(G.isConchNode)return;if(this.renderingEnabled&&(s||!a||G.isConchWebGL)){if(G.isWebGL){t.clear();f.prototype.render.call(this,t,e,i);at._show&&at._sp&&at._sp.render(t,e,i);I.clear(this._bgColor);I.beginFlush();t.flush();I.endFinish();ct.instance&&ct.getInstance().endDispose()}else{I.clear(this._bgColor);f.prototype.render.call(this,t,e,i);at._show&&at._sp&&at._sp.render(t,e,i)}}};t._requestFullscreen=function(){var t=j.document.documentElement;if(t.requestFullscreen){t.requestFullscreen()}else if(t.mozRequestFullScreen){t.mozRequestFullScreen()}else if(t.webkitRequestFullscreen){t.webkitRequestFullscreen()}else if(t.msRequestFullscreen){t.msRequestFullscreen()}};t._fullScreenChanged=function(){T.stage.event("fullscreenchange")};t.exitFullscreen=function(){var t=j.document;if(t.exitFullscreen){t.exitFullscreen()}else if(t.mozCancelFullScreen){t.mozCancelFullScreen()}else if(t.webkitExitFullscreen){t.webkitExitFullscreen()}};u(0,t,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1});u(0,t,"desginHeight",function(){console.debug("desginHeight已经弃用，请使用designHeight代替");return this.designHeight});u(0,t,"frameRate",function(){return this._frameRate},function(t){this._frameRate=t;if(G.isConchApp){switch(this._frameRate){case"slow":j.window.conch&&j.window.conchConfig.setSlowFrame&&j.window.conchConfig.setSlowFrame(true);break;case"fast":j.window.conch&&j.window.conchConfig.setSlowFrame&&j.window.conchConfig.setSlowFrame(false);break;case"mouse":j.window.conch&&j.window.conchConfig.setMouseFrame&&j.window.conchConfig.setMouseFrame(2e3);break;case"sleep":j.window.conch&&j.window.conchConfig.setLimitFPS&&j.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.");break}}});u(0,t,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1});u(0,t,"width",f.prototype._$get_width,function(t){this.designWidth=t;T.superSet(It,this,"width",t);T.timer.callLater(this,this._changeCanvasSize)});u(0,t,"alignH",function(){return this._alignH},function(t){this._alignH=t;T.timer.callLater(this,this._changeCanvasSize)});u(0,t,"isFocused",function(){return this._isFocused});u(0,t,"height",f.prototype._$get_height,function(t){this.designHeight=t;T.superSet(It,this,"height",t);T.timer.callLater(this,this._changeCanvasSize)});u(0,t,"transform",function(){if(this._tfChanged)this._adjustTransform();return this._transform=this._transform||k.create()},f.prototype._$set_transform);u(0,t,"isVisibility",function(){return this._isVisibility});u(0,t,"desginWidth",function(){console.debug("desginWidth已经弃用，请使用designWidth代替");return this.designWidth});u(0,t,"scaleMode",function(){return this._scaleMode},function(t){this._scaleMode=t;T.timer.callLater(this,this._changeCanvasSize)});u(0,t,"alignV",function(){return this._alignV},function(t){this._alignV=t;T.timer.callLater(this,this._changeCanvasSize)});u(0,t,"bgColor",function(){return this._bgColor},function(t){this._bgColor=t;this.conchModel&&this.conchModel.bgColor(t);if(G.isWebGL){if(t){l._wgColor=q.create(t)._color}else{if(!j.onMiniGame)l._wgColor=null}}if(j.onLimixiu){l._wgColor=q.create(t)._color}else if(t){G.canvas.style.background=t}else{G.canvas.style.background="none"}});u(0,t,"mouseX",function(){return Math.round(x.instance.mouseX/this.clientScaleX)});u(0,t,"mouseY",function(){return Math.round(x.instance.mouseY/this.clientScaleY)});u(0,t,"screenMode",function(){return this._screenMode},function(t){this._screenMode=t});u(0,t,"visible",f.prototype._$get_visible,function(t){if(this.visible!==t){T.superSet(It,this,"visible",t);var e=G._mainCanvas.source.style;e.visibility=t?"visible":"hidden"}});u(0,t,"fullScreenEnabled",null,function(t){var e=j.document;var i=G.canvas;if(t){i.addEventListener("mousedown",this._requestFullscreen);i.addEventListener("touchstart",this._requestFullscreen);e.addEventListener("fullscreenchange",this._fullScreenChanged);e.addEventListener("mozfullscreenchange",this._fullScreenChanged);e.addEventListener("webkitfullscreenchange",this._fullScreenChanged);e.addEventListener("msfullscreenchange",this._fullScreenChanged)}else{i.removeEventListener("mousedown",this._requestFullscreen);i.removeEventListener("touchstart",this._requestFullscreen);e.removeEventListener("fullscreenchange",this._fullScreenChanged);e.removeEventListener("mozfullscreenchange",this._fullScreenChanged);e.removeEventListener("webkitfullscreenchange",this._fullScreenChanged);e.removeEventListener("msfullscreenchange",this._fullScreenChanged)}});l.SCALE_NOSCALE="noscale";l.SCALE_EXACTFIT="exactfit";l.SCALE_SHOWALL="showall";l.SCALE_NOBORDER="noborder";l.SCALE_FULL="full";l.SCALE_FIXED_WIDTH="fixedwidth";l.SCALE_FIXED_HEIGHT="fixedheight";l.SCALE_FIXED_AUTO="fixedauto";l.ALIGN_LEFT="left";l.ALIGN_RIGHT="right";l.ALIGN_CENTER="center";l.ALIGN_TOP="top";l.ALIGN_MIDDLE="middle";l.ALIGN_BOTTOM="bottom";l.SCREEN_NONE="none";l.SCREEN_HORIZONTAL="horizontal";l.SCREEN_VERTICAL="vertical";l.FRAME_FAST="fast";l.FRAME_SLOW="slow";l.FRAME_MOUSE="mouse";l.FRAME_SLEEP="sleep";l.FRAME_MOUSE_THREDHOLD=2e3;h(l,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]);return l}(It);var Ot=function(t){function e(){this.url=null;this._channel=null;this._tar=null;this._playEvents=null;this._stopEvents=null;e.__super.call(this);this.visible=false;this.on("added",this,this._onParentChange);this.on("removed",this,this._onParentChange)}v(e,"laya.media.SoundNode",t);var i=e.prototype;i._onParentChange=function(){this.target=this.parent};i.play=function(t,e){t===void 0&&(t=1);if(isNaN(t)){t=1}if(!this.url)return;this.stop();this._channel=N.playSound(this.url,t,e)};i.stop=function(){if(this._channel&&!this._channel.isStopped){this._channel.stop()}this._channel=null};i._setPlayAction=function(t,e,i,n){n===void 0&&(n=true);if(!this[i])return;if(!t)return;if(n){t.on(e,this,this[i])}else{t.off(e,this,this[i])}};i._setPlayActions=function(t,e,i,n){n===void 0&&(n=true);if(!t)return;if(!e)return;var r=e.split(",");var s=0,a=0;a=r.length;for(s=0;s<a;s++){this._setPlayAction(t,r[s],i,n)}};u(0,i,"playEvent",null,function(t){this._playEvents=t;if(!t)return;if(this._tar){this._setPlayActions(this._tar,t,"play")}});u(0,i,"target",null,function(t){if(this._tar){this._setPlayActions(this._tar,this._playEvents,"play",false);this._setPlayActions(this._tar,this._stopEvents,"stop",false)}this._tar=t;if(this._tar){this._setPlayActions(this._tar,this._playEvents,"play",true);this._setPlayActions(this._tar,this._stopEvents,"stop",true)}});u(0,i,"stopEvent",null,function(t){this._stopEvents=t;if(!t)return;if(this._tar){this._setPlayActions(this._tar,t,"stop")}});return e}(It);var Bt=function(t){function e(){this._src=null;this._onload=null;this._onerror=null;e.__super.call(this)}v(e,"laya.resource.FileBitmap",t);var i=e.prototype;u(0,i,"src",function(){return this._src},function(t){this._src=t});u(0,i,"onload",null,function(t){});u(0,i,"onerror",null,function(t){});return e}(kt);var Ft=function(t){function i(t,e){this._is2D=false;i.__super.call(this);var n=this;this._source=this;if(t==="2D"||t==="AUTO"&&!G.isWebGL){this._is2D=true;this._source=e||j.createElement("canvas");this._w=this._source.width;this._h=this._source.height;var r=this;r.getContext=function(t,e){if(n._ctx)return n._ctx;var i=n._ctx=n._source.getContext(t,e);if(i){i._canvas=r;if(!G.isFlash&&!j.onLimixiu)i.size=function(t,e){}}return i}}this.lock=true}v(i,"laya.resource.HTMLCanvas",t);var e=i.prototype;e.clear=function(){this._ctx&&this._ctx.clear()};e.destroy=function(){this._ctx&&this._ctx.destroy();this._ctx=null;laya.resource.Resource.prototype.destroy.call(this)};e.release=function(){};e._setContext=function(t){this._ctx=t};e.getContext=function(t,e){return this._ctx?this._ctx:this._ctx=i._createContext(this)};e.getMemSize=function(){return 0};e.size=function(t,e){if(this._w!=t||this._h!=e||this._source&&(this._source.width!=t||this._source.height!=e)){this._w=t;this._h=e;this.memorySize=this._w*this._h*4;this._ctx&&this._ctx.size(t,e);this._source&&(this._source.height=e,this._source.width=t)}};e.getCanvas=function(){return this._source};e.toBase64=function(t,e,i){if(this._source){if(G.isConchApp&&this._source.toBase64){this._source.toBase64(t,e,i)}else{var n=this._source.toDataURL(t,e);i.call(this,n)}}};u(0,e,"context",function(){return this._ctx});u(0,e,"asBitmap",null,function(t){});i.create=function(t,e){return new i(t,e)};i.TYPE2D="2D";i.TYPE3D="3D";i.TYPEAUTO="AUTO";i._createContext=null;return i}(kt);var Ut=function(t){function h(t,e,i,n,r,s,a,o){h.__super.call(this);throw new Error("不允许new！")}v(h,"laya.resource.HTMLSubImage",t);h.create=function(t,e,i,n,r,s,a,o){o===void 0&&(o=false);return new h(t,e,i,n,r,s,a,o)};return h}(kt);var Gt=function(t){function c(){this._frames=null;this._url=null;c.__super.call(this);this._setControlNode(this)}v(c,"laya.display.Animation",t);var e=c.prototype;e.destroy=function(t){t===void 0&&(t=true);this.stop();laya.display.Sprite.prototype.destroy.call(this,t);this._frames=null;this._labels=null};e.play=function(t,e,i,n){t===void 0&&(t=0);e===void 0&&(e=true);i===void 0&&(i="");n===void 0&&(n=true);if(i)this._setFramesFromCache(i,n);this._isPlaying=true;this.index=typeof t=="string"?this._getFrameByLabel(t):t;this.loop=e;this._actionName=i;this._isReverse=this.wrapMode==1;if(this._frames&&this.interval>0){this.timerLoop(this.interval,this,this._frameLoop,null,true,true)}};e._setFramesFromCache=function(t,e){e===void 0&&(e=false);if(this._url)t=this._url+"#"+t;if(t&&c.framesMap[t]){var i;i=c.framesMap[t];if(i instanceof Array){this._frames=c.framesMap[t];this._count=this._frames.length}else{if(i.nodeRoot){c.framesMap[t]=this._parseGraphicAnimationByData(i);i=c.framesMap[t]}this._frames=i.frames;this._count=this._frames.length;if(!this._frameRateChanged)this._interval=i.interval;this._labels=this._copyLabels(i.labels)}return true}else{if(e)console.log("ani not found:",t)}return false};e._copyLabels=function(t){if(!t)return null;var e;e={};var i;for(i in t){e[i]=ut.copyArray([],t[i])}return e};e._frameLoop=function(){if(this._style.visible&&this._style.alpha>.01){t.prototype._frameLoop.call(this)}};e._displayToIndex=function(t){if(this._frames)this.graphics=this._frames[t]};e.clear=function(){this.stop();this.graphics=null;this._frames=null;this._labels=null};e.loadImages=function(t,e){e===void 0&&(e="");this._url="";if(!this._setFramesFromCache(e)){this.frames=c.framesMap[e]?c.framesMap[e]:c.createFrames(t,e)}return this};e.loadAtlas=function(e,i,n){n===void 0&&(n="");this._url="";var r=this;function t(t){if(e===t){r.frames=c.framesMap[n]?c.framesMap[n]:c.createFrames(e,n);if(i)i.run()}}if(!r._setFramesFromCache(n)){if(xt.getAtlas(e))t(e);else T.loader.load(e,m.create(null,t,[e]),null,"atlas")}return this};e.loadAnimation=function(t,e,i){this._url=t;var n=this;if(!this._actionName)this._actionName="";if(!n._setFramesFromCache(this._actionName)){if(!i||xt.getAtlas(i)){this._loadAnimationData(t,e,i)}else{T.loader.load(i,m.create(this,this._loadAnimationData,[t,e,i]),null,"atlas")}}else{n._setFramesFromCache(this._actionName,true);this.index=0;if(e)e.run()}return this};e._loadAnimationData=function(o,h,t){var l=this;if(t&&!xt.getAtlas(t)){console.warn("atlas load fail:"+t);return}var u=this;function e(t){if(!xt.getRes(t))return;if(o===t){var e;if(!c.framesMap[o+"#"]){var i=u._parseGraphicAnimation(xt.getRes(o));if(!i)return;var n=i.animationList;var r=0,s=n.length;var a;for(r=0;r<s;r++){e=n[r];c.framesMap[o+"#"+e.name]=e;if(!a)a=e}if(a){c.framesMap[o+"#"]=a;u._setFramesFromCache(l._actionName,true);l.index=0}l._checkResumePlaying()}else{u._setFramesFromCache(l._actionName,true);l.index=0;l._checkResumePlaying()}if(h)h.run()}}if(xt.getRes(o))e(o);else T.loader.load(o,m.create(null,e,[o]),null,"json");xt.clearRes(o)};e._parseGraphicAnimation=function(t){return Yt.parseAnimationData(t)};e._parseGraphicAnimationByData=function(t){return Yt.parseAnimationByData(t)};u(0,e,"frames",function(){return this._frames},function(t){this._frames=t;if(t){this._count=t.length;if(this._isPlaying)this.play(this._index,this.loop,this._actionName);else this.index=this._index}});u(0,e,"autoPlay",null,function(t){if(t)this.play();else this.stop()});u(0,e,"source",null,function(t){if(t.indexOf(".ani")>-1)this.loadAnimation(t);else if(t.indexOf(".json")>-1||t.indexOf("als")>-1||t.indexOf("atlas")>-1)this.loadAtlas(t);else this.loadImages(t.split(","))});u(0,e,"autoAnimation",null,function(t){this.play(0,true,t,false)});c.createFrames=function(t,e){var i,n=0,r=0,s;if(typeof t=="string"){var a=xt.getAtlas(t);if(a&&a.length){i=[];for(n=0,r=a.length;n<r;n++){s=new I.createGraphics;s.drawTexture(xt.getRes(a[n]),0,0);i.push(s)}}}else if(t instanceof Array){i=[];for(n=0,r=t.length;n<r;n++){s=new I.createGraphics;s.loadImage(t[n],0,0);i.push(s)}}if(e)c.framesMap[e]=i;return i};c.clearCache=function(t){var e=c.framesMap;var i;var n=t+"#";for(i in e){if(i===t||i.indexOf(n)==0){delete c.framesMap[i]}}};c.framesMap={};return c}(Dt);var Vt=function(t){function s(){this._targetDic=null;this._animationData=null;this._animationNewFrames=null;s.__super.call(this);if(s._sortIndexFun==null){s._sortIndexFun=P.sortByKey("index",false,true)}}v(s,"laya.display.FrameAnimation",t);var e=s.prototype;e._setUp=function(t,e){this._labels=null;this._animationNewFrames=null;this._targetDic=t;this._animationData=e;this.interval=1e3/e.frameRate;if(e.parsed){this._count=e.count;this._labels=e.labels;this._animationNewFrames=e.animationNewFrames}else{this._animationNewFrames=[];this._calculateDatas()}e.parsed=true;e.labels=this._labels;e.count=this._count;e.animationNewFrames=this._animationNewFrames};e.clear=function(){t.prototype.clear.call(this);this._targetDic=null;this._animationData=null};e._displayToIndex=function(t){if(!this._animationData)return;if(t<0)t=0;if(t>this._count)t=this._count;var e=this._animationData.nodes,i=0,n=e.length;for(i=0;i<n;i++){this._displayNodeToFrame(e[i],t)}};e._displayNodeToFrame=function(t,e,i){if(!i)i=this._targetDic;var n=i[t.target];if(!n){return}var r=t.frames,s,a,o;var h=t.keys,l=0,u=h.length;for(l=0;l<u;l++){s=h[l];a=r[s];if(a.length>e){o=a[e]}else{o=a[a.length-1]}n[s]=o}};e._calculateDatas=function(){if(!this._animationData)return;var t=this._animationData.nodes,e=0,i=t.length,n;this._count=0;for(e=0;e<i;e++){n=t[e];this._calculateNodeKeyFrames(n)}this._count+=1};e._calculateNodeKeyFrames=function(t){var e=t.keyframes,i,n,r=t.target;if(!t.frames){t.frames={}}if(!t.keys){t.keys=[]}else{t.keys.length=0}if(!t.initValues){t.initValues={}}for(i in e){n=e[i];if(!t.frames[i]){t.frames[i]=[]}if(this._targetDic&&this._targetDic[r]){t.initValues[i]=this._targetDic[r][i]}n.sort(s._sortIndexFun);t.keys.push(i);this._calculateNodePropFrames(n,t.frames[i],i,r)}};e.resetToInitState=function(){if(!this._targetDic)return;if(!this._animationData)return;var t=this._animationData.nodes,e=0,i=t.length;var n;var r;for(e=0;e<i;e++){n=t[e];r=n.initValues;if(!r)continue;var s=this._targetDic[n.target];if(!s)continue;var a;for(a in r){s[a]=r[a]}}};e._calculateNodePropFrames=function(t,e,i,n){var r=0,s=t.length-1;e.length=t[s].index+1;for(r=0;r<s;r++){this._dealKeyFrame(t[r]);this._calculateFrameValues(t[r],t[r+1],e)}if(s==0){e[t[0].index]=t[0].value;if(this._animationNewFrames)this._animationNewFrames[t[0].index]=true}this._dealKeyFrame(t[r])};e._dealKeyFrame=function(t){if(t.label&&t.label!="")this.addLabel(t.label,t.index)};e._calculateFrameValues=function(t,e,i){var n=0,r;var s=t.index,a=e.index;var o=t.value;var h=e.value-t.value;var l=a-s;if(a>this._count)this._count=a;if(t.tween){r=J[t.tweenMethod];if(r==null){r=J.linearNone}for(n=s;n<a;n++){i[n]=r(n-s,o,h,l);if(this._animationNewFrames){this._animationNewFrames[n]=true}}}else{for(n=s;n<a;n++){i[n]=o}}if(this._animationNewFrames){this._animationNewFrames[t.index]=true;this._animationNewFrames[e.index]=true}i[e.index]=e.value};s._sortIndexFun=null;return s}(Dt);var Wt=function(e){function r(){this._focus=false;this._multiline=false;this._editable=true;this._restrictPattern=null;this._type="text";this._prompt="";this._promptColor="#A9A9A9";this._originColor="#000000";this._content="";r.__super.call(this);this._maxChars=1e5;this._width=100;this._height=20;this.multiline=false;this.overflow=Rt.SCROLL;this.on("mousedown",this,this._onMouseDown);this.on("undisplay",this,this._onUnDisplay)}v(r,"laya.display.Input",e);var t=r.prototype;t.setSelection=function(t,e){this.focus=true;laya.display.Input.inputElement.selectionStart=t;laya.display.Input.inputElement.selectionEnd=e};t._onUnDisplay=function(t){this.focus=false};t._onMouseDown=function(t){this.focus=true};t._syncInputTransform=function(){var t=this.nativeInput;var e=ut.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]);var i=this._width-this.padding[1]-this.padding[3];var n=this._height-this.padding[0]-this.padding[2];if(G.isConchApp){t.setScale(e.scaleX,e.scaleY);t.setSize(i,n);t.setPos(e.x,e.y)}else{r.inputContainer.style.transform=r.inputContainer.style.webkitTransform="scale("+e.scaleX+","+e.scaleY+") rotate("+T.stage.canvasDegree+"deg)";t.style.width=i+"px";t.style.height=n+"px";r.inputContainer.style.left=e.x+"px";r.inputContainer.style.top=e.y+"px"}};t.select=function(){this.nativeInput.select()};t._setInputMethod=function(){r.input.parentElement&&r.inputContainer.removeChild(r.input);r.area.parentElement&&r.inputContainer.removeChild(r.area);r.inputElement=this._multiline?r.area:r.input;r.inputContainer.appendChild(r.inputElement);if(Rt.RightToLeft){r.inputElement.style.direction="rtl"}};t._focusIn=function(){laya.display.Input.isInputting=true;var t=this.nativeInput;this._focus=true;var e=t.style;e.whiteSpace=this.wordWrap?"pre-wrap":"nowrap";this._setPromptColor();t.readOnly=!this._editable;if(G.isConchApp){t.setType(this._type);t.setForbidEdit(!this._editable)}t.maxLength=this._maxChars;var i=this.padding;t.type=this._type;t.value=this._content;t.placeholder=this._prompt;T.stage.off("keydown",this,this._onKeyDown);T.stage.on("keydown",this,this._onKeyDown);T.stage.focus=this;this.event("focus");if(j.onPC)t.focus();if(!j.onMiniGame&&!j.onBDMiniGame&&!j.onTTMiniGame){var n=this._text;this._text=null}this.typeset();t.setColor(this._originColor);if(t.setBgColor)t.setBgColor(this.bgColor);t.setFontSize(this.fontSize);t.setFontFace(j.onIPhone?Rt._fontFamilyMap[this.font]||this.font:this.font);if(G.isConchApp){t.setMultiAble&&t.setMultiAble(this._multiline)}e.lineHeight=this.leading+this.fontSize+"px";e.fontStyle=this.italic?"italic":"normal";e.fontWeight=this.bold?"bold":"normal";e.textAlign=this.align;e.padding="0 0";this._syncInputTransform();if(!G.isConchApp&&j.onPC)T.timer.frameLoop(1,this,this._syncInputTransform)};t._setPromptColor=function(){r.promptStyleDOM=j.getElementById("promptStyle");if(!r.promptStyleDOM){r.promptStyleDOM=j.createElement("style");r.promptStyleDOM.setAttribute("id","promptStyle");j.document.head.appendChild(r.promptStyleDOM)}r.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {"+"color:"+this._promptColor+"}"+"input:-moz-placeholder, textarea:-moz-placeholder {"+"color:"+this._promptColor+"}"+"input::-moz-placeholder, textarea::-moz-placeholder {"+"color:"+this._promptColor+"}"+"input:-ms-input-placeholder, textarea:-ms-input-placeholder {"+"color:"+this._promptColor+"}"};t._focusOut=function(){laya.display.Input.isInputting=false;this._focus=false;this._text=null;this._content=this.nativeInput.value;if(!this._content){T.superSet(Rt,this,"text",this._prompt);T.superSet(Rt,this,"color",this._promptColor)}else{T.superSet(Rt,this,"text",this._content);T.superSet(Rt,this,"color",this._originColor)}T.stage.off("keydown",this,this._onKeyDown);T.stage.focus=null;this.event("blur");if(G.isConchApp)this.nativeInput.blur();j.onPC&&T.timer.clear(this,this._syncInputTransform)};t._onKeyDown=function(t){if(t.keyCode===13){if(j.onMobile&&!this._multiline)this.focus=false;this.event("enter")}};t.changeText=function(t){this._content=t;if(this._focus){this.nativeInput.value=t||"";this.event("change")}else e.prototype.changeText.call(this,t)};u(0,t,"color",e.prototype._$get_color,function(t){if(this._focus)this.nativeInput.setColor(t);T.superSet(Rt,this,"color",this._content?t:this._promptColor);this._originColor=t});u(0,t,"inputElementYAdjuster",function(){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。");return 0},function(t){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")});u(0,t,"multiline",function(){return this._multiline},function(t){this._multiline=t;this.valign=t?"top":"middle"});u(0,t,"maxChars",function(){return this._maxChars},function(t){if(t<=0)t=1e5;this._maxChars=t});u(0,t,"text",function(){if(this._focus)return this.nativeInput.value;else return this._content||""},function(t){T.superSet(Rt,this,"color",this._originColor);t+="";if(this._focus){this.nativeInput.value=t||"";this.event("change")}else{if(!this._multiline)t=t.replace(/\r?\n/g,"");this._content=t;if(t)T.superSet(Rt,this,"text",t);else{T.superSet(Rt,this,"text",this._prompt);T.superSet(Rt,this,"color",this.promptColor)}}});u(0,t,"nativeInput",function(){return this._multiline?r.area:r.input});u(0,t,"prompt",function(){return this._prompt},function(t){if(!this._text&&t)T.superSet(Rt,this,"color",this._promptColor);this.promptColor=this._promptColor;if(this._text)T.superSet(Rt,this,"text",this._text==this._prompt?t:this._text);else T.superSet(Rt,this,"text",t);this._prompt=Rt.langPacks&&Rt.langPacks[t]?Rt.langPacks[t]:t});u(0,t,"focus",function(){return this._focus},function(t){var e=this.nativeInput;if(this._focus!==t){if(t){if(e.target){e.target._focusOut()}else{this._setInputMethod()}e.target=this;this._focusIn()}else{e.target=null;this._focusOut();j.document.body.scrollTop=0;e.blur();if(G.isConchApp){e.setPos(-1e4,-1e4)}else if(r.inputContainer.contains(e))r.inputContainer.removeChild(e)}}});u(0,t,"restrict",function(){if(this._restrictPattern){return this._restrictPattern.source}return""},function(t){if(t){t="[^"+t+"]";if(t.indexOf("^^")>-1)t=t.replace("^^","");this._restrictPattern=new RegExp(t,"g")}else this._restrictPattern=null});u(0,t,"editable",function(){return this._editable},function(t){this._editable=t;if(G.isConchApp){r.input.setForbidEdit(!t)}});u(0,t,"promptColor",function(){return this._promptColor},function(t){this._promptColor=t;if(!this._content)T.superSet(Rt,this,"color",t)});u(0,t,"type",function(){return this._type},function(t){if(t=="password")this._getCSSStyle().password=true;else this._getCSSStyle().password=false;this._type=t;if(G.isConchApp){this.nativeInput.setType(t)}});u(0,t,"inputElementXAdjuster",function(){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。");return 0},function(t){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")});u(0,t,"asPassword",function(){return this._getCSSStyle().password},function(t){this._getCSSStyle().password=t;this._type="password";console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去');this.isChanged=true});r.__init__=function(){r._createInputElement();if(j.onMobile){var t=false;if(j.onMiniGame||j.onBDMiniGame||j.onKGMiniGame||j.onTTMiniGame){t=true}G.canvas.addEventListener(r.IOS_IFRAME?t?"touchend":"click":"touchend",r._popupInputMethod)}};r._popupInputMethod=function(t){if(!laya.display.Input.isInputting)return;var e=laya.display.Input.inputElement;e.focus()};r._createInputElement=function(){r._initInput(r.area=j.createElement("textarea"));r._initInput(r.input=j.createElement("input"));r.inputContainer=j.createElement("div");r.inputContainer.style.position="absolute";r.inputContainer.style.zIndex=1e5;j.container.appendChild(r.inputContainer);r.inputContainer.setPos=function(t,e){r.inputContainer.style.left=t+"px";r.inputContainer.style.top=e+"px"}};r._initInput=function(e){var t=e.style;t.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;";t.resize="none";t.backgroundColor="transparent";t.border="none";t.outline="none";t.zIndex=1;e.addEventListener("input",r._processInputting);e.addEventListener("mousemove",r._stopEvent);e.addEventListener("mousedown",r._stopEvent);e.addEventListener("touchmove",r._stopEvent);e.setFontFace=function(t){e.style.fontFamily=t};if(!G.isConchApp){e.setColor=function(t){e.style.color=t};e.setFontSize=function(t){e.style.fontSize=t+"px"}}};r._processInputting=function(t){var e=laya.display.Input.inputElement.target;if(!e)return;var i=laya.display.Input.inputElement.value;if(e._restrictPattern){i=i.replace(/\u2006|\x27/g,"");if(e._restrictPattern.test(i)){i=i.replace(e._restrictPattern,"");laya.display.Input.inputElement.value=i}}e._text=i;e.event("input")};r._stopEvent=function(t){if(t.type=="touchmove")t.preventDefault();t.stopPropagation&&t.stopPropagation()};r.TYPE_TEXT="text";r.TYPE_PASSWORD="password";r.TYPE_EMAIL="email";r.TYPE_URL="url";r.TYPE_NUMBER="number";r.TYPE_RANGE="range";r.TYPE_DATE="date";r.TYPE_MONTH="month";r.TYPE_WEEK="week";r.TYPE_TIME="time";r.TYPE_DATE_TIME="datetime";r.TYPE_DATE_TIME_LOCAL="datetime-local";r.TYPE_SEARCH="search";r.input=null;r.area=null;r.inputElement=null;r.inputContainer=null;r.confirmButton=null;r.promptStyleDOM=null;r.inputHeight=45;r.isInputting=false;r.stageMatrix=null;h(r,["IOS_IFRAME",function(){return this.IOS_IFRAME=j.onIOS&&j.window.top!=j.window.self}]);return r}(Rt);var zt=function(t){function i(t,e){this._recreateLock=false;this._needReleaseAgain=false;this._enableMerageInAtlas=true;i.__super.call(this);this._init_(t,e)}v(i,"laya.resource.HTMLImage",t);var e=i.prototype;e._init_=function(t,e){this._src=t;this._source=new j.window.Image;if(e){e.onload&&(this.onload=e.onload);e.onerror&&(this.onerror=e.onerror);e.onCreate&&e.onCreate(this)}if(t.indexOf("data:image")!=0)this._source.crossOrigin="";t&&(this._source.src=t)};e.recreateResource=function(){var t=this;if(this._src==="")throw new Error("src no null！");this._needReleaseAgain=false;if(!this._source){this._recreateLock=true;var e=this;this._source=new j.window.Image;this._source.crossOrigin="";this._source.onload=function(){if(e._needReleaseAgain){e._needReleaseAgain=false;e._source.onload=null;e._source=null;return}e._source.onload=null;e.memorySize=t._w*t._h*4;e._recreateLock=false;e.completeCreate()};this._source.src=this._src}else{if(this._recreateLock)return;this.memorySize=this._w*this._h*4;this._recreateLock=false;this.completeCreate()}};e.disposeResource=function(){if(this._recreateLock)this._needReleaseAgain=true;this._source&&(this._source=null,this.memorySize=0)};e.onresize=function(){this._w=this._source.width;this._h=this._source.height};u(0,e,"onload",null,function(t){var e=this;this._onload=t;this._source&&(this._source.onload=this._onload!=null?function(){e.onresize();e._onload()}:null)});u(0,e,"onerror",null,function(t){var e=this;this._onerror=t;this._source&&(this._source.onerror=this._onerror!=null?function(){e._onerror()}:null)});u(0,e,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(t){this._enableMerageInAtlas=t;if(G.isConchApp){if(this._source)this._source.enableMerageInAtlas=t}});i.create=function(t,e){return new i(t,e)};return i}(Bt);var Ht=function(a){function t(){this._target=null;this._playEvents=null;this._initData={};this._aniKeys=null;this._effectClass=null;t.__super.call(this)}v(t,"laya.display.EffectAnimation",a);var e=t.prototype;e._onOtherBegin=function(t){if(t==this)return;this.stop()};e.addEvent=function(){if(!this._target||!this._playEvents)return;this._setControlNode(this._target);this._target.on(this._playEvents,this,this._onPlayAction)};e._onPlayAction=function(){this.play(0,false)};e.play=function(t,e,i,n){t===void 0&&(t=0);e===void 0&&(e=true);i===void 0&&(i="");n===void 0&&(n=true);if(!this._target)return;this._target.event("effectanimationbegin",[this]);this._recordInitData();laya.display.AnimationPlayerBase.prototype.play.call(this,t,e,i,n)};e._recordInitData=function(){if(!this._aniKeys)return;var t=0,e=0;e=this._aniKeys.length;var i;for(t=0;t<e;t++){i=this._aniKeys[t];this._initData[i]=this._target[i]}};e._displayToIndex=function(t){if(!this._animationData)return;if(t<0)t=0;if(t>this._count)t=this._count;var e=this._animationData.nodes,i=0,n=e.length;n=n>1?1:n;for(i=0;i<n;i++){this._displayNodeToFrame(e[i],t)}};e._displayNodeToFrame=function(t,e,i){if(!this._target)return;var n;n=this._target;var r=t.frames,s,a,o;var h=t.keys,l=0,u=h.length;var c;c=t.secondFrames;var f=0;var _;var d;var p;var v;for(l=0;l<u;l++){s=h[l];a=r[s];f=c[s];if(f==-1){o=this._initData[s]}else{if(e<f){d=t.keyframes[s];p=d[0];if(p.tween){_=J[p.tweenMethod];if(_==null){_=J.linearNone}v=d[1];o=_(e,this._initData[s],v.value-this._initData[s],v.index)}else{o=this._initData[s]}}else{if(a.length>e){o=a[e]}else{o=a[a.length-1]}}}n[s]=o}};e._calculateNodeKeyFrames=function(t){a.prototype._calculateNodeKeyFrames.call(this,t);var e=t.keyframes,i,n,r=t.target;var s;s={};t.secondFrames=s;for(i in e){n=e[i];if(n.length<=1){s[i]=-1}else{s[i]=n[1].index}}};u(0,e,"target",function(){return this._target},function(t){if(this._target){this._target.off("effectanimationbegin",this,this._onOtherBegin)}this._target=t;if(this._target){this._target.on("effectanimationbegin",this,this._onOtherBegin)}this.addEvent()});u(0,e,"playEvent",null,function(t){this._playEvents=t;if(!t)return;this.addEvent()});u(0,e,"effectData",null,function(t){if(t){var e;e=t["animations"];if(e&&e[0]){this._setUp({},e[0]);if(e[0].nodes&&e[0].nodes[0]){this._aniKeys=e[0].nodes[0].keys}}}});u(0,e,"effectClass",null,function(t){this._effectClass=K.getClass(t);if(this._effectClass){var e;e=this._effectClass["uiView"];if(e){var i;i=e["animations"];if(i&&i[0]){this._setUp({},i[0]);if(i[0].nodes&&i[0].nodes[0]){this._aniKeys=i[0].nodes[0].keys}}}}});t.EffectAnimationBegin="effectanimationbegin";return t}(Vt);var Yt=function(e){var A;function M(){this.animationList=null;this.animationDic=null;this._nodeList=null;this._nodeDefaultProps=null;this._gList=null;this._nodeIDAniDic={};this._rootNode=null;this._nodeGDic=null;M.__super.call(this)}v(M,"laya.utils.GraphicAnimation",e);var t=M.prototype;t._parseNodeList=function(t){if(!this._nodeList){this._nodeList=[]}this._nodeDefaultProps[t.compId]=t.props;if(t.compId)this._nodeList.push(t.compId);var e=t.child;if(e){var i=0,n=e.length;for(i=0;i<n;i++){this._parseNodeList(e[i])}}};t._calGraphicData=function(t){this._setUp(null,t);this._createGraphicData();if(this._nodeIDAniDic){var e;for(e in this._nodeIDAniDic){this._nodeIDAniDic[e]=null}}};t._createGraphicData=function(){var t=[];var e=0,i=this.count;var n=this._animationNewFrames;if(!n)n=[];var r;for(e=0;e<i;e++){if(n[e]||!r){r=this._createFrameGraphic(e)}t.push(r)}this._gList=t};t._createFrameGraphic=function(t){var e=I.createGraphics();if(!M._rootMatrix)M._rootMatrix=new k;this._updateNodeGraphic(this._rootNode,t,M._rootMatrix,e);return e};t._updateNodeGraphic=function(t,e,i,n,r){r===void 0&&(r=1);var s;s=this._nodeGDic[t.compId]=this._getNodeGraphicData(t.compId,e,this._nodeGDic[t.compId]);var a=s.alpha*r;if(a<.01)return;if(!s.resultTransform){s.resultTransform=k.create()}var o;o=s.resultTransform;k.mul(s.transform,i,o);var h;if(s.skin){h=this._getTextureByUrl(s.skin);if(h){if(o._checkTransform()){n.drawTexture(h,0,0,s.width,s.height,o,a);s.resultTransform=null}else{n.drawTexture(h,o.tx,o.ty,s.width,s.height,null,a)}}}var l;l=t.child;if(!l)return;var u=0,c=0;c=l.length;for(u=0;u<c;u++){this._updateNodeGraphic(l[u],e,o,n,a)}};t._updateNoChilds=function(t,e){if(!t.skin)return;var i=this._getTextureByUrl(t.skin);if(!i)return;var n=t.transform;n._checkTransform();var r=false;r=!n.bTransform;if(!r){e.drawTexture(i,0,0,t.width,t.height,n.clone(),t.alpha)}else{e.drawTexture(i,n.tx,n.ty,t.width,t.height,null,t.alpha)}};t._updateNodeGraphic2=function(t,e,i){var n;n=this._nodeGDic[t.compId]=this._getNodeGraphicData(t.compId,e,this._nodeGDic[t.compId]);if(!t.child){this._updateNoChilds(n,i);return}var r=n.transform;r._checkTransform();var s=false;s=!r.bTransform;var a=false;a=s&&(r.tx!=0||r.ty!=0);var o=false;o=r.bTransform||n.alpha!=1;if(o){i.save()}if(n.alpha!=1){i.alpha(n.alpha)}if(!s){i.transform(r.clone())}else if(a){i.translate(r.tx,r.ty)}var h;h=t.child;var l;if(n.skin){l=this._getTextureByUrl(n.skin);if(l){i.drawTexture(l,0,0,n.width,n.height)}}if(h){var u=0,c=0;c=h.length;for(u=0;u<c;u++){this._updateNodeGraphic2(h[u],e,i)}}if(o){i.restore()}else{if(!s){i.transform(r.clone().invert())}else if(a){i.translate(-r.tx,-r.ty)}}};t._calculateNodeKeyFrames=function(t){e.prototype._calculateNodeKeyFrames.call(this,t);this._nodeIDAniDic[t.target]=t};t.getNodeDataByID=function(t){return this._nodeIDAniDic[t]};t._getParams=function(t,e,i,n){var r=M._temParam;r.length=e.length;var s=0,a=e.length;for(s=0;s<a;s++){r[s]=this._getObjVar(t,e[s][0],i,e[s][1],n)}return r};t._getObjVar=function(t,e,i,n,r){if(t.hasOwnProperty(e)){var s=t[e];if(i>=s.length)i=s.length-1;if(t[e][i]!=undefined)return t[e][i]}if(r.hasOwnProperty(e)){return r[e]}return n};t._getNodeGraphicData=function(t,e,i){if(!i)i=A.create();if(!i.transform){i.transform=k.create()}else{i.transform.identity()}var n=this.getNodeDataByID(t);if(!n)return i;var r=n.frames;var s=this._getParams(r,M._drawTextureCmd,e,this._nodeDefaultProps[t]);var a=s[0];var o=NaN,h=NaN;var l=s[5],u=s[6];var c=s[13],f=s[14];var _=s[7],d=s[8];var p=s[9];var v=s[11],g=s[12];o=s[3];h=s[4];if(o==0||h==0)a=null;if(o==-1)o=0;if(h==-1)h=0;var m;i.skin=a;i.width=o;i.height=h;if(a){m=this._getTextureByUrl(a);if(m){if(!o)o=m.sourceWidth;if(!h)h=m.sourceHeight}else{console.warn("lost skin:",a,",you may load pics first")}}i.alpha=s[10];var y;y=i.transform;if(c!=0){l=c*o}if(f!=0){u=f*h}if(l!=0||u!=0){y.translate(-l,-u)}var b=null;if(p||_!==1||d!==1||v||g){b=M._tempMt;b.identity();b.bTransform=true;var x=(p-v)*.0174532922222222;var w=(p+g)*.0174532922222222;var T=Math.cos(w);var S=Math.sin(w);var C=Math.sin(x);var E=Math.cos(x);b.a=_*T;b.b=_*S;b.c=-d*C;b.d=d*E;b.tx=b.ty=0}if(b){y=k.mul(y,b,y)}y.translate(s[1],s[2]);return i};t._getTextureByUrl=function(t){return xt.getRes(t)};t.setAniData=function(t,e){if(t.animations){this._nodeDefaultProps={};this._nodeGDic={};if(this._nodeList)this._nodeList.length=0;this._rootNode=t;this._parseNodeList(t);var i={};var n=[];var r=t.animations;var s=0,a=r.length;var o;for(s=0;s<a;s++){o=r[s];this._labels=null;if(e&&e!=o.name){continue}if(!o)continue;try{this._calGraphicData(o)}catch(t){console.warn("parse animation fail:"+o.name+",empty animation created");this._gList=[]}var h={};h.interval=1e3/o["frameRate"];h.frames=this._gList;h.labels=this._labels;h.name=o.name;n.push(h);i[o.name]=h}this.animationList=n;this.animationDic=i}M._temParam.length=0};t.parseByData=function(t){var e,i;e=t.nodeRoot;i=t.aniO;delete t.nodeRoot;delete t.aniO;this._nodeDefaultProps={};this._nodeGDic={};if(this._nodeList)this._nodeList.length=0;this._rootNode=e;this._parseNodeList(e);this._labels=null;try{this._calGraphicData(i)}catch(t){console.warn("parse animation fail:"+i.name+",empty animation created");this._gList=[]}var n=t;n.interval=1e3/i["frameRate"];n.frames=this._gList;n.labels=this._labels;n.name=i.name;return n};t.setUpAniData=function(t){if(t.animations){var e={};var i=[];var n=t.animations;var r=0,s=n.length;var a;for(r=0;r<s;r++){a=n[r];if(!a)continue;var o={};o.name=a.name;o.aniO=a;o.nodeRoot=t;i.push(o);e[a.name]=o}this.animationList=i;this.animationDic=e}};t._clear=function(){this.animationList=null;this.animationDic=null;this._gList=null;if(this._nodeGDic){var t;var e;for(t in this._nodeGDic){e=this._nodeGDic[t];if(e)e.recover()}}this._nodeGDic=null};M.parseAnimationByData=function(t){if(!M._I)M._I=new M;var e;e=M._I.parseByData(t);M._I._clear();return e};M.parseAnimationData=function(t){if(!M._I)M._I=new M;M._I.setUpAniData(t);var e;e={};e.animationList=M._I.animationList;e.animationDic=M._I.animationDic;M._I._clear();return e};M._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]];M._temParam=[];M._I=null;M._rootMatrix=null;h(M,["_tempMt",function(){return this._tempMt=new k}]);M.__init$=function(){A=function(){function t(){this.skin=null;this.transform=null;this.resultTransform=null;this.width=NaN;this.height=NaN;this.alpha=1}v(t,"");var e=t.prototype;e.recover=function(){this.skin=null;this.width=0;this.height=0;this.alpha=1;if(this.transform){this.transform.destroy();this.transform=null}if(this.resultTransform){this.resultTransform.destroy();this.resultTransform=null}rt.recover("GraphicNode",this)};t.create=function(){return rt.getItemByClass("GraphicNode",t)};return t}()};return M}(Vt);T.__init([s,wt,Yt,G,j,ht,O,Mt])})(window,document,Laya);(function(t,e,i){var n=i.un,r=i.uns,s=i.static,a=i.class,o=i.getset,h=i.__newvec;var l=function(){function t(){}a(t,"LayaMain");return t}();new l})(window,document,Laya);if(typeof define==="function"&&define.amd){define("laya.core",["require","exports"],function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:true});for(var i in Laya){var n=Laya[i];n&&n.__isclass&&(e[i]=n)}})}(function(t,e,w){var i=w.un,n=w.uns,a=w.static,v=w.class,h=w.getset,s=w.__newvec;var c=laya.maths.Arith,f=laya.maths.Bezier,r=laya.resource.Bitmap,_=laya.utils.Browser;var d=laya.utils.Byte,p=laya.utils.Color,o=laya.filters.ColorFilter,T=w.Config,l=laya.resource.Context;var u=laya.events.Event,S=laya.filters.Filter,g=laya.display.Graphics,m=laya.resource.HTMLCanvas;var y=laya.utils.HTMLChar,b=laya.resource.HTMLImage,x=laya.resource.HTMLSubImage;var C=laya.utils.Handler,E=laya.net.Loader,A=laya.maths.Matrix,M=laya.maths.Point,I=laya.maths.Rectangle;var L=laya.renders.Render,P=laya.renders.RenderContext,k=laya.renders.RenderSprite;var D=laya.resource.Resource,R=laya.resource.ResourceManager,N=laya.utils.RunDriver;var O=laya.display.Sprite,B=laya.display.Stage,F=laya.utils.Stat,U=laya.utils.StringKey;var G=laya.display.css.Style,V=laya.system.System,W=laya.display.Text,z=laya.resource.Texture;var H=laya.display.css.TransformInfo,Y=laya.net.URL,j=laya.utils.Utils,X=laya.utils.VectorGraphManager;var $=laya.utils.WordText;w.interface("laya.webgl.shapes.IShape");w.interface("laya.webgl.submit.ISubmit");w.interface("laya.webgl.text.ICharSegment");w.interface("laya.webgl.canvas.save.ISaveData");w.interface("laya.webgl.resource.IMergeAtlasBitmap");w.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var K=function(){function t(){}v(t,"laya.filters.webgl.FilterActionGL");var e=t.prototype;w.imps(e,{"laya.filters.IFilterActionGL":true});e.setValue=function(t){};e.setValueMix=function(t){};e.apply3d=function(t,e,i,n,r){return null};e.apply=function(t){return null};h(0,e,"typeMix",function(){return 0});return t}();var q=function(){function t(){}v(t,"laya.webgl.shader.ShaderValue");return t}();var Z=function(){var n,r;function t(t,e,i){this._atlasID=0;this._width=0;this._height=0;this._texCount=0;this._rowInfo=null;this._cells=null;this._failSize=new r;t===void 0&&(t=0);e===void 0&&(e=0);i===void 0&&(i=0);this._cells=null;this._rowInfo=null;this._init(t,e);this._atlasID=i}v(t,"laya.webgl.atlas.AtlasGrid");var e=t.prototype;e.getAltasID=function(){return this._atlasID};e.setAltasID=function(t){if(t>=0){this._atlasID=t}};e.addTex=function(t,e,i){var n=this._get(e,i);if(n.ret==false){return n}this._fill(n.x,n.y,e,i,t);this._texCount++;return n};e._release=function(){if(this._cells!=null){this._cells.length=0;this._cells=null}if(this._rowInfo){this._rowInfo.length=0;this._rowInfo=null}};e._init=function(t,e){this._width=t;this._height=e;this._release();if(this._width==0)return false;this._cells=new Uint8Array(this._width*this._height*3);this._rowInfo=s(this._height);for(var i=0;i<this._height;i++){this._rowInfo[i]=new n}this._clear();return true};e._get=function(t,e){var i=new J;if(t>=this._failSize.width&&e>=this._failSize.height){return i}var n=-1;var r=-1;var s=this._width;var a=this._height;var o=this._cells;for(var h=0;h<a;h++){if(this._rowInfo[h].spaceCount<t)continue;for(var l=0;l<s;){var u=(h*s+l)*3;if(o[u]!=0||o[u+1]<t||o[u+2]<e){l+=o[u+1];continue}n=l;r=h;for(var c=0;c<t;c++){if(o[3*c+u+2]<e){n=-1;break}}if(n<0){l+=o[u+1];continue}i.ret=true;i.x=n;i.y=r;return i}}return i};e._fill=function(t,e,i,n,r){var s=this._width;var a=this._height;this._check(t+i<=s&&e+n<=a);for(var o=e;o<n+e;++o){this._check(this._rowInfo[o].spaceCount>=i);this._rowInfo[o].spaceCount-=i;for(var h=0;h<i;h++){var l=(t+o*s+h)*3;this._check(this._cells[l]==0);this._cells[l]=r;this._cells[l+1]=i;this._cells[l+2]=n}}if(t>0){for(o=0;o<n;++o){var u=0;for(h=t-1;h>=0;--h,++u){if(this._cells[((e+o)*s+h)*3]!=0)break}for(h=u;h>0;--h){this._cells[((e+o)*s+t-h)*3+1]=h;this._check(h>0)}}}if(e>0){for(h=t;h<t+i;++h){u=0;for(o=e-1;o>=0;--o,u++){if(this._cells[(h+o*s)*3]!=0)break}for(o=u;o>0;--o){this._cells[(h+(e-o)*s)*3+2]=o;this._check(o>0)}}}};e._check=function(t){if(t==false){console.log("xtexMerger 错误啦")}};e._clear=function(){this._texCount=0;for(var t=0;t<this._height;t++){this._rowInfo[t].spaceCount=this._width}for(var e=0;e<this._height;e++){for(var i=0;i<this._width;i++){var n=(e*this._width+i)*3;this._cells[n]=0;this._cells[n+1]=this._width-i;this._cells[n+2]=this._width-e}}this._failSize.width=this._width+1;this._failSize.height=this._height+1};t.__init$=function(){n=function(){function t(){this.spaceCount=0}v(t,"");return t}();r=function(){function t(){this.width=0;this.height=0}v(t,"");return t}()};return t}();var Q=function(){function y(t,e,i,n){this._currentAtlasCount=0;this._maxAtlaserCount=0;this._width=0;this._height=0;this._gridSize=0;this._gridNumX=0;this._gridNumY=0;this._init=false;this._curAtlasIndex=0;this._setAtlasParam=false;this._atlaserArray=null;this._needGC=false;this._setAtlasParam=true;this._width=t;this._height=e;this._gridSize=i;this._maxAtlaserCount=n;this._gridNumX=t/i;this._gridNumY=e/i;this._curAtlasIndex=0;this._atlaserArray=[]}v(y,"laya.webgl.atlas.AtlasResourceManager");var t=y.prototype;t.setAtlasParam=function(t,e,i,n){if(this._setAtlasParam==true){y._sid_=0;this._width=t;this._height=e;this._gridSize=i;this._maxAtlaserCount=n;this._gridNumX=t/i;this._gridNumY=e/i;this._curAtlasIndex=0;this.freeAll();return true}else{console.log("设置大图合集参数错误，只能在开始页面设置各种参数");throw-1;return false}return false};t.pushData=function(t){var e=t.bitmap;var i=-1;var n=null;var r=0,s=0,a=0;for(r=0,s=this._atlaserArray.length;r<s;r++){a=(this._curAtlasIndex+r)%s;n=this._atlaserArray[a];i=n.findBitmapIsExist(e);if(i!=-1){break}}if(i!=-1){var o=n.InAtlasWebGLImagesOffsetValue[i];v=o[0];g=o[1];n.addToAtlas(t,v,g);return true}else{var h=t;this._setAtlasParam=false;var l=false;var u=Math.ceil((t.bitmap.width+2)/this._gridSize);var c=Math.ceil((t.bitmap.height+2)/this._gridSize);var f=false;for(var _=0;_<2;_++){var d=this._maxAtlaserCount;for(r=0;r<d;r++){a=(this._curAtlasIndex+r)%d;this._atlaserArray.length-1>=a||this._atlaserArray.push(new Wt(this._gridNumX,this._gridNumY,this._width,this._height,y._sid_++));var p=this._atlaserArray[a];var v=0,g=0;var m=p.addTex(1,u,c);if(m.ret){v=m.x*this._gridSize+1;g=m.y*this._gridSize+1;e.lock=true;p.addToAtlasTexture(e,v,g);p.addToAtlas(t,v,g);f=true;this._curAtlasIndex=a;break}}if(f)break;this._atlaserArray.push(new Wt(this._gridNumX,this._gridNumY,this._width,this._height,y._sid_++));this._needGC=true;this.garbageCollection();this._curAtlasIndex=this._atlaserArray.length-1}if(!f){console.log(">>>AtlasManager pushData error")}return f}};t.addToAtlas=function(t){laya.webgl.atlas.AtlasResourceManager.instance.pushData(t)};t.garbageCollection=function(){if(this._needGC===true){var t=this._atlaserArray.length-this._maxAtlaserCount;for(var e=0;e<t;e++){this._atlaserArray[e].dispose();console.log("AtlasResourceManager:Dispose the inner Atlas。")}console.log(">>>>altas garbageCollection ="+t);this._atlaserArray.splice(0,t);this._needGC=false}return true};t.freeAll=function(){for(var t=0,e=this._atlaserArray.length;t<e;t++){this._atlaserArray[t].dispose()}this._atlaserArray.length=0;this._curAtlasIndex=0};t.getAtlaserCount=function(){return this._atlaserArray.length};t.getAtlaserByIndex=function(t){return this._atlaserArray[t]};h(1,y,"instance",function(){if(!y._Instance){y._Instance=new y(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)}return y._Instance});h(1,y,"enabled",function(){return T.atlasEnable});h(1,y,"atlasLimitWidth",function(){return y._atlasLimitWidth},function(t){y._atlasLimitWidth=t});h(1,y,"atlasLimitHeight",function(){return y._atlasLimitHeight},function(t){y._atlasLimitHeight=t});y._enable=function(){T.atlasEnable=true};y._disable=function(){T.atlasEnable=false};y.__init__=function(){y.atlasTextureWidth=2048;y.atlasTextureHeight=2048;y.maxTextureCount=6;y.atlasLimitWidth=512;y.atlasLimitHeight=512};y._atlasLimitWidth=0;y._atlasLimitHeight=0;y.gridSize=16;y.atlasTextureWidth=0;y.atlasTextureHeight=0;y.maxTextureCount=0;y._atlasRestore=0;y.BOARDER_TYPE_NO=0;y.BOARDER_TYPE_RIGHT=1;y.BOARDER_TYPE_LEFT=2;y.BOARDER_TYPE_BOTTOM=4;y.BOARDER_TYPE_TOP=8;y.BOARDER_TYPE_ALL=15;y._sid_=0;y._Instance=null;return y}();var J=function(){function t(){this.x=0;this.y=0;this.ret=false;this.ret=false;this.x=0;this.y=0}v(t,"laya.webgl.atlas.MergeFillInfo");return t}();var tt=function(){function e(){}v(e,"laya.webgl.canvas.BlendMode");e._init_=function(t){e.fns=[e.BlendNormal,e.BlendAdd,e.BlendMultiply,e.BlendScreen,e.BlendOverlay,e.BlendLight,e.BlendMask,e.BlendDestinationOut];e.targetFns=[e.BlendNormalTarget,e.BlendAddTarget,e.BlendMultiplyTarget,e.BlendScreenTarget,e.BlendOverlayTarget,e.BlendLightTarget,e.BlendMask,e.BlendDestinationOut]};e.BlendNormal=function(t){t.blendFunc(1,771)};e.BlendAdd=function(t){t.blendFunc(1,772)};e.BlendMultiply=function(t){t.blendFunc(774,771)};e.BlendScreen=function(t){t.blendFunc(1,1)};e.BlendOverlay=function(t){t.blendFunc(1,769)};e.BlendLight=function(t){t.blendFunc(1,1)};e.BlendNormalTarget=function(t){t.blendFunc(1,771)};e.BlendAddTarget=function(t){t.blendFunc(1,772)};e.BlendMultiplyTarget=function(t){t.blendFunc(774,771)};e.BlendScreenTarget=function(t){t.blendFunc(1,1)};e.BlendOverlayTarget=function(t){t.blendFunc(1,769)};e.BlendLightTarget=function(t){t.blendFunc(1,1)};e.BlendMask=function(t){t.blendFunc(0,770)};e.BlendDestinationOut=function(t){t.blendFunc(0,0)};e.activeBlendFunction=null;e.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"];e.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7};e.NORMAL="normal";e.ADD="add";e.MULTIPLY="multiply";e.SCREEN="screen";e.LIGHT="light";e.OVERLAY="overlay";e.DESTINATIONOUT="destination-out";e.fns=[];e.targetFns=[];return e}();var et=function(){function i(t){this._color=p.create("black");this.setValue(t)}v(i,"laya.webgl.canvas.DrawStyle");var t=i.prototype;t.setValue=function(t){if(t){if(typeof t=="string"){this._color=p.create(t);return}if(t instanceof laya.utils.Color){this._color=t;return}}};t.reset=function(){this._color=p.create("black")};t.equal=function(t){if(typeof t=="string")return this._color.strColor===t;if(t instanceof laya.utils.Color)return this._color.numColor===t.numColor;return false};t.toColorStr=function(){return this._color.strColor};i.create=function(t){if(t){var e;if(typeof t=="string")e=p.create(t);else if(t instanceof laya.utils.Color)e=t;if(e){return e._drawStyle||(e._drawStyle=new i(t))}}return laya.webgl.canvas.DrawStyle.DEFAULT};a(i,["DEFAULT",function(){return this.DEFAULT=new i("#000000")}]);return i}();var it=function(){function t(){this._x=0;this._y=0;this.dirty=false;this.offset=0;this.count=0;this.geoStart=0;this.tempArray=[];this.closePath=false;this.geomatrys=[];var t=Nt.mainContext;this.ib=pe.create(35048);this.vb=ve.create(5)}v(t,"laya.webgl.canvas.Path");var e=t.prototype;e.addPoint=function(t,e){this.tempArray.push(t,e)};e.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]};e.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]};e.polygon=function(t,e,i,n,r,s){var a;this.geomatrys.push(this._curGeomatry=a=new Xt(t,e,i,n,r,s));if(!n)a.fill=false;if(s==undefined)a.borderWidth=0;return a};e.setGeomtry=function(t){this.geomatrys.push(this._curGeomatry=t)};e.drawLine=function(t,e,i,n,r){var s;if(this.closePath){this.geomatrys.push(this._curGeomatry=s=new jt(t,e,i,n,r))}else{this.geomatrys.push(this._curGeomatry=s=new Yt(t,e,i,n,r))}s.fill=false;return s};e.update=function(){var t=this.ib._byteLength;var e=this.geomatrys.length;this.offset=t;for(var i=this.geoStart;i<e;i++){this.geomatrys[i].getData(this.ib,this.vb,this.vb._byteLength/20)}this.geoStart=e;this.count=(this.ib._byteLength-t)/It.BYTES_PIDX};e.reset=function(){this.vb.clear();this.ib.clear();this.offset=this.count=this.geoStart=0;this.geomatrys.length=0};e.recover=function(){this._curGeomatry=null;this.vb.destory();this.vb=null;this.ib.destory();this.ib=null};return t}();var nt=function(){function o(){}v(o,"laya.webgl.canvas.save.SaveBase");var t=o.prototype;w.imps(t,{"laya.webgl.canvas.save.ISaveData":true});t.isSaveMark=function(){return false};t.restore=function(t){this._dataObj[this._valueName]=this._value;o._cache[o._cache._length++]=this;this._newSubmit&&(t._curSubmit=yt.RENDERBASE,t._renderKey=0)};o._createArray=function(){var t=[];t._length=0;return t};o._init=function(){var t=o._namemap={};t[1]="ALPHA";t[2]="fillStyle";t[8]="font";t[256]="lineWidth";t[512]="strokeStyle";t[8192]="_mergeID";t[1024]=t[2048]=t[4096]=[];t[16384]="textBaseline";t[32768]="textAlign";t[65536]="_nBlendType";t[1048576]="shader";t[2097152]="filters";return t};o.save=function(t,e,i,n){if((t._saveMark._saveuse&e)!==e){t._saveMark._saveuse|=e;var r=o._cache;var s=r._length>0?r[--r._length]:new o;s._value=i[s._valueName=o._namemap[e]];s._dataObj=i;s._newSubmit=n;var a=t._save;a[a._length++]=s}};o._cache=laya.webgl.canvas.save.SaveBase._createArray();o._namemap=o._init();return o}();var rt=function(){function s(){this._clipRect=new I}v(s,"laya.webgl.canvas.save.SaveClipRect");var t=s.prototype;w.imps(t,{"laya.webgl.canvas.save.ISaveData":true});t.isSaveMark=function(){return false};t.restore=function(t){t._clipRect=this._clipSaveRect;s._cache[s._cache._length++]=this;this._submitScissor.submitLength=t._submits._length-this._submitScissor.submitIndex;t._curSubmit=yt.RENDERBASE;t._renderKey=0};s.save=function(t,e){if((t._saveMark._saveuse&131072)==131072)return;t._saveMark._saveuse|=131072;var i=s._cache;var n=i._length>0?i[--i._length]:new s;n._clipSaveRect=t._clipRect;t._clipRect=n._clipRect.copyFrom(t._clipRect);n._submitScissor=e;var r=t._save;r[r._length++]=n};a(s,["_cache",function(){return this._cache=nt._createArray()}]);return s}();var st=function(){function _(){this._contextX=0;this._contextY=0;this._clipRect=new I;this._rect=new I;this._matrix=new A}v(_,"laya.webgl.canvas.save.SaveClipRectStencil");var t=_.prototype;w.imps(t,{"laya.webgl.canvas.save.ISaveData":true});t.isSaveMark=function(){return false};t.restore=function(t){St.restore(t,this._rect,this._saveMatrix,this._contextX,this._contextY);t._clipRect=this._clipSaveRect;t._curMat=this._saveMatrix;t._x=this._contextX;t._y=this._contextY;_._cache[_._cache._length++]=this;t._curSubmit=yt.RENDERBASE};_.save=function(t,e,i,n,r,s,a,o,h,l){if((t._saveMark._saveuse&262144)==262144)return;t._saveMark._saveuse|=262144;var u=_._cache;var c=u._length>0?u[--u._length]:new _;c._clipSaveRect=t._clipRect;c._clipRect.setTo(a,o,h,l);t._clipRect=c._clipRect;c._rect.x=i;c._rect.y=n;c._rect.width=r;c._rect.height=s;c._contextX=t._x;c._contextY=t._y;c._saveMatrix=t._curMat;t._curMat.copyTo(c._matrix);t._curMat=c._matrix;c._submitStencil=e;var f=t._save;f[f._length++]=c};a(_,["_cache",function(){return this._cache=nt._createArray()}]);return _}();var at=function(){function n(){this._saveuse=0}v(n,"laya.webgl.canvas.save.SaveMark");var t=n.prototype;w.imps(t,{"laya.webgl.canvas.save.ISaveData":true});t.isSaveMark=function(){return true};t.restore=function(t){t._saveMark=this._preSaveMark;n._no[n._no._length++]=this};n.Create=function(t){var e=n._no;var i=e._length>0?e[--e._length]:new n;i._saveuse=0;i._preSaveMark=t._saveMark;t._saveMark=i;return i};a(n,["_no",function(){return this._no=nt._createArray()}]);return n}();var ot=function(){function s(){this._matrix=new A}v(s,"laya.webgl.canvas.save.SaveTransform");var t=s.prototype;w.imps(t,{"laya.webgl.canvas.save.ISaveData":true});t.isSaveMark=function(){return false};t.restore=function(t){t._curMat=this._savematrix;s._no[s._no._length++]=this};s.save=function(t){var e=t._saveMark;if((e._saveuse&2048)===2048)return;e._saveuse|=2048;var i=s._no;var n=i._length>0?i[--i._length]:new s;n._savematrix=t._curMat;t._curMat=t._curMat.copyTo(n._matrix);var r=t._save;r[r._length++]=n};a(s,["_no",function(){return this._no=nt._createArray()}]);return s}();var ht=function(){function r(){}v(r,"laya.webgl.canvas.save.SaveTranslate");var t=r.prototype;w.imps(t,{"laya.webgl.canvas.save.ISaveData":true});t.isSaveMark=function(){return false};t.restore=function(t){var e=t._curMat;t._x=this._x;t._y=this._y;r._no[r._no._length++]=this};r.save=function(t){var e=r._no;var i=e._length>0?e[--e._length]:new r;i._x=t._x;i._y=t._y;var n=t._save;n[n._length++]=i};a(r,["_no",function(){return this._no=nt._createArray()}]);return r}();var lt=function(){function t(){this.target=null;this.repaint=false;this._width=NaN;this._height=NaN;this._sp=null;this._clipRect=new I}v(t,"laya.webgl.resource.RenderTargetMAX");var e=t.prototype;e.setSP=function(t){this._sp=t};e.size=function(t,e){var i=this;if(this._width===t&&this._height===e){this.target.size(t,e);return}this.repaint=true;this._width=t;this._height=e;if(!this.target)this.target=Qt.create(t,e);else this.target.size(t,e);if(!this.target.hasListener("recovered")){this.target.on("recovered",this,function(t){w.timer.callLater(i._sp,i._sp.repaint)})}};e._flushToTarget=function(t,e){if(e._destroy)return;var i=Dt.worldScissorTest;var n=Dt.worldClipRect;Dt.worldClipRect=this._clipRect;this._clipRect.x=this._clipRect.y=0;this._clipRect.width=this._width;this._clipRect.height=this._height;Dt.worldScissorTest=false;Nt.mainContext.disable(3089);var r=Dt.worldAlpha;var s=Dt.worldMatrix4;var a=Dt.worldMatrix;var o=Dt.worldFilters;var h=Dt.worldShaderDefines;Dt.worldMatrix=A.EMPTY;Dt.restoreTempArray();Dt.worldMatrix4=Dt.TEMPMAT4_ARRAY;Dt.worldAlpha=1;Dt.worldFilters=null;Dt.worldShaderDefines=null;Zt.activeShader=null;e.start();T.showCanvasMark?e.clear(0,1,0,.3):e.clear(0,0,0,0);t.flush();e.end();Zt.activeShader=null;Dt.worldAlpha=r;Dt.worldMatrix4=s;Dt.worldMatrix=a;Dt.worldFilters=o;Dt.worldShaderDefines=h;Dt.worldScissorTest=i;if(i){var l=Dt.height-n.y-n.height;Nt.mainContext.scissor(n.x,l,n.width,n.height);Nt.mainContext.enable(3089)}Dt.worldClipRect=n};e.flush=function(t){if(this.repaint){this._flushToTarget(t,this.target);this.repaint=false}};e.drawTo=function(t,e,i,n,r){t.drawTexture(this.target.getTexture(),e,i,n,r,0,0)};e.destroy=function(){if(this.target){this.target.destroy();this.target=null;this._sp=null}};return t}();var ut=function(){function t(){this.ALPHA=1;this.shaderType=0;this.defines=new zt}v(t,"laya.webgl.shader.d2.Shader2D");var e=t.prototype;e.destroy=function(){this.defines=null;this.filters=null;this.glTexture=null;this.strokeStyle=null;this.fillStyle=null};t.__init__=function(){ue.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;");ue.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n");ue.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;");ue.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4Color += texture2D(texture, v_texcoord + vec2FilterDir + vec2Off)/floatIterationTotalTime;\n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;");ue.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;");ue.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4Color += texture2D(texture, ctexcoord)*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}");ue.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n");ue.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;");var t,e;t="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}";e='precision mediump float;\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}';ue.preCompile2D(0,1,t,e,null);t="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}";e='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}';ue.preCompile2D(0,2,t,e,null);t="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}";e="precision mediump float;\n//precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}";ue.preCompile2D(0,4,t,e,null);t="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}";e='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}';ue.preCompile2D(0,256,t,e,null);t="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}";e="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}";ue.preCompile2D(0,512,t,e,null)};return t}();var ct=function(){function e(t,e,i){this._value=0;this._name2int=t;this._int2name=e;this._int2nameMap=i}v(e,"laya.webgl.shader.ShaderDefines");var t=e.prototype;t.add=function(t){if(typeof t=="string")t=this._name2int[t];this._value|=t;return this._value};t.addInt=function(t){this._value|=t;return this._value};t.remove=function(t){if(typeof t=="string")t=this._name2int[t];this._value&=~t;return this._value};t.isDefine=function(t){return(this._value&t)===t};t.getValue=function(){return this._value};t.setValue=function(t){this._value=t};t.toNameDic=function(){var t=this._int2nameMap[this._value];return t?t:e._toText(this._value,this._int2name,this._int2nameMap)};e._reg=function(t,e,i,n){i[t]=e;n[e]=t};e._toText=function(t,e,i){var n=i[t];if(n)return n;var r={};var s=1;for(var a=0;a<32;a++){s=1<<a;if(s>t)break;if(t&s){var o=e[s];o&&(r[o]="")}}i[t]=r;return r};e._toInt=function(t,e){var i=t.split(".");var n=0;for(var r=0,s=i.length;r<s;r++){var a=e[i[r]];if(!a)throw new Error("Defines to int err:"+t+"/"+i[r]);n|=a}return n};return e}();var ft=function(){function l(){this.mVBBuffer=null;this.mIBBuffer=null;this.mVBData=null;this.mIBData=null;this.mEleNum=0;this.mTexture=null;this.transform=null;this._vs=null;this._ps=null;this._indexStart=-1;this._verticles=null;this._uvs=null;this._tempMatrix=new A}v(l,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var t=l.prototype;t.init=function(t,e,i){if(e){this._vs=e}else{this._vs=[];var n=t.width;var r=t.height;var s=1;var a=1;var o=1;var h=1;this._vs.push(0,0,0,0,s,a,o,h);this._vs.push(n,0,1,0,s,a,o,h);this._vs.push(n,r,1,1,s,a,o,h);this._vs.push(0,r,0,1,s,a,o,h)}if(i){this._ps=i}else{if(!l._defaultPS){l._defaultPS=[];l._defaultPS.push(0,1,3,3,1,2)}this._ps=l._defaultPS}this.mVBData=new Float32Array(this._vs);this.mIBData=new Uint16Array(this._ps.length);this.mIBData["start"]=-1;this.mEleNum=this._ps.length;this.mTexture=t};t.init2=function(t,e,i,n,r){if(this.transform)this.transform=null;if(i){this._ps=i}else{this._ps=[];this._ps.push(0,1,3,3,1,2)}this._verticles=n;this._uvs=r;this.mEleNum=this._ps.length;this.mTexture=t;if(L.isConchNode||L.isConchApp){this._initMyData();this.mVBData=new Float32Array(this._vs)}};t._initMyData=function(){var t=0;var e=0;var i=this._verticles.length;var n=i*4;this._vs=l._tempVS;var r=false;if(L.isConchNode||L.isConchApp){this._vs.length=n;r=true}else{if(this._vs.length<n){this._vs.length=n;r=true}}l._tVSLen=n;if(r){while(t<n){this._vs[t]=this._verticles[e];this._vs[t+1]=this._verticles[e+1];this._vs[t+2]=this._uvs[e];this._vs[t+3]=this._uvs[e+1];this._vs[t+4]=1;this._vs[t+5]=1;this._vs[t+6]=1;this._vs[t+7]=1;t+=8;e+=2}}else{while(t<n){this._vs[t]=this._verticles[e];this._vs[t+1]=this._verticles[e+1];this._vs[t+2]=this._uvs[e];this._vs[t+3]=this._uvs[e+1];t+=8;e+=2}}};t.getData2=function(t,e,i){this.mVBBuffer=t;this.mIBBuffer=e;this._initMyData();t.appendEx2(this._vs,Float32Array,l._tVSLen,4);this._indexStart=e._byteLength;var n;n=l._tempIB;if(n.length<this._ps.length){n.length=this._ps.length}for(var r=0,s=this._ps.length;r<s;r++){n[r]=this._ps[r]+i}e.appendEx2(n,Uint16Array,this._ps.length,2)};t.getData=function(t,e,i){this.mVBBuffer=t;this.mIBBuffer=e;t.append(this.mVBData);this._indexStart=e._byteLength;if(this.mIBData["start"]!=i){for(var n=0,r=this._ps.length;n<r;n++){this.mIBData[n]=this._ps[n]+i}this.mIBData["start"]=i}e.append(this.mIBData)};t.render=function(t,e,i){if(L.isWebGL&&this.mTexture){t._renderKey=0;t._shader2D.glTexture=null;_t.getInstance().addSkinMesh(this);var n=yt.createShape(t,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,Ut.create(512,0));this.transform||(this.transform=A.EMPTY);this.transform.translate(e,i);A.mul(this.transform,t._curMat,this._tempMatrix);this.transform.translate(-e,-i);var r=n.shaderValue;var s=r.u_mmat2||Dt.getMatrArray();Dt.mat2MatArray(this._tempMatrix,s);r.textureHost=this.mTexture;r.offsetX=0;r.offsetY=0;r.u_mmat2=s;r.ALPHA=t._shader2D.ALPHA;t._submits[t._submits._length++]=n}else if(L.isConchApp&&this.mTexture){this.transform||(this.transform=A.EMPTY);t.setSkinMesh&&t.setSkinMesh(e,i,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform)}};l._tempVS=[];l._tempIB=[];l._defaultPS=null;l._tVSLen=0;return l}();var _t=function(){function t(){this.ib=null;this.vb=null;var t=Nt.mainContext;this.ib=pe.create(35048);this.vb=ve.create(8)}v(t,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var e=t.prototype;e.addSkinMesh=function(t){t.getData2(this.vb,this.ib,this.vb._byteLength/32)};e.reset=function(){this.vb.clear();this.ib.clear()};t.getInstance=function(){return t.instance=t.instance||new t};t.instance=null;return t}();var dt=function(){function t(t,e,i,n,r,s,a,o,h){this.r0=0;this.fill=true;this.r1=Math.PI/2;h===void 0&&(h=0);this.x=t;this.y=e;this.width=i;this.height=n;this.edges=r;this.color=s;this.borderWidth=a;this.borderColor=o}v(t,"laya.webgl.shapes.BasePoly");var e=t.prototype;w.imps(e,{"laya.webgl.shapes.IShape":true});e.getData=function(t,e,i){};e.rebuild=function(t){};e.setMatrix=function(t){};e.needUpdate=function(t){return true};e.sector=function(t,e,i){var n=this.x,r=this.y,s=this.edges,a=(this.r1-this.r0)/s;var o=this.width,h=this.height,l=this.color;var u=(l>>16&255)/255,c=(l>>8&255)/255,f=(l&255)/255;t.push(n,r,u,c,f);for(var _=0;_<s+1;_++){t.push(n+Math.sin(a*_+this.r0)*o,r+Math.cos(a*_+this.r0)*h);t.push(u,c,f)}for(_=0;_<s;_++){e.push(i,i+_+1,i+_+2)}};e.createLine2=function(t,e,i,n,r,s){var a=t.concat();var o=r;var h=this.borderColor;var l=(h>>16&255)/255,u=(h>>8&255)/255,c=(h&255)/255;var f=a.length/2;var _=n,d=i/2;var p,v,g,m,y,b,x,w;var T,S,C,E,A,M;var I,L,P,k,D,R;var N,O,B;g=a[0];m=a[1];y=a[2];b=a[3];T=-(m-b);S=g-y;B=Math.sqrt(T*T+S*S);T=T/B*d;S=S/B*d;o.push(g-T+this.x,m-S+this.y,l,u,c,g+T+this.x,m+S+this.y,l,u,c);for(var F=1;F<f-1;F++){g=a[(F-1)*2];m=a[(F-1)*2+1];y=a[F*2];b=a[F*2+1];x=a[(F+1)*2];w=a[(F+1)*2+1];T=-(m-b);S=g-y;B=Math.sqrt(T*T+S*S);T=T/B*d;S=S/B*d;C=-(b-w);E=y-x;B=Math.sqrt(C*C+E*E);C=C/B*d;E=E/B*d;I=-S+m-(-S+b);L=-T+y-(-T+g);P=(-T+g)*(-S+b)-(-T+y)*(-S+m);k=-E+w-(-E+b);D=-C+y-(-C+x);R=(-C+x)*(-E+b)-(-C+y)*(-E+w);N=I*D-k*L;if(Math.abs(N)<.1){N+=10.1;o.push(y-T+this.x,b-S+this.y,l,u,c,y+T+this.x,b+S+this.y,l,u,c);continue}p=(L*R-D*P)/N;v=(k*P-I*R)/N;O=(p-y)*(p-y)+(v-b)+(v-b);o.push(p+this.x,v+this.y,l,u,c,y-(p-y)+this.x,b-(v-b)+this.y,l,u,c)}g=a[a.length-4];m=a[a.length-3];y=a[a.length-2];b=a[a.length-1];T=-(m-b);S=g-y;B=Math.sqrt(T*T+S*S);T=T/B*d;S=S/B*d;o.push(y-T+this.x,b-S+this.y,l,u,c,y+T+this.x,b+S+this.y,l,u,c);var U=s;for(F=1;F<U;F++){e.push(_+(F-1)*2,_+(F-1)*2+1,_+F*2+1,_+F*2+1,_+F*2,_+(F-1)*2)}return o};e.createLine=function(t,e,i,n){var r=t.concat();var s=t;var a=this.borderColor;var o=(a>>16&255)/255,h=(a>>8&255)/255,l=(a&255)/255;r.splice(0,5);var u=r.length/5;var c=n,f=i/2;var _,d,p,v,g,m,y,b;var x,w,T,S,C,E;var A,M,I,L,P,k;var D,R,N;p=r[0];v=r[1];g=r[5];m=r[6];x=-(v-m);w=p-g;N=Math.sqrt(x*x+w*w);x=x/N*f;w=w/N*f;s.push(p-x,v-w,o,h,l,p+x,v+w,o,h,l);for(var O=1;O<u-1;O++){p=r[(O-1)*5];v=r[(O-1)*5+1];g=r[O*5];m=r[O*5+1];y=r[(O+1)*5];b=r[(O+1)*5+1];x=-(v-m);w=p-g;N=Math.sqrt(x*x+w*w);x=x/N*f;w=w/N*f;T=-(m-b);S=g-y;N=Math.sqrt(T*T+S*S);T=T/N*f;S=S/N*f;A=-w+v-(-w+m);M=-x+g-(-x+p);I=(-x+p)*(-w+m)-(-x+g)*(-w+v);L=-S+b-(-S+m);P=-T+g-(-T+y);k=(-T+y)*(-S+m)-(-T+g)*(-S+b);D=A*P-L*M;if(Math.abs(D)<.1){D+=10.1;s.push(g-x,m-w,o,h,l,g+x,m+w,o,h,l);continue}_=(M*k-P*I)/D;d=(L*I-A*k)/D;R=(_-g)*(_-g)+(d-m)+(d-m);s.push(_,d,o,h,l,g-(_-g),m-(d-m),o,h,l)}p=r[r.length-10];v=r[r.length-9];g=r[r.length-5];m=r[r.length-4];x=-(v-m);w=p-g;N=Math.sqrt(x*x+w*w);x=x/N*f;w=w/N*f;s.push(g-x,m-w,o,h,l,g+x,m+w,o,h,l);var B=this.edges+1;for(O=1;O<B;O++){e.push(c+(O-1)*2,c+(O-1)*2+1,c+O*2+1,c+O*2+1,c+O*2,c+(O-1)*2)}return s};e.createLoopLine=function(t,e,i,n,r,s){var a=t.concat();var o=r?r:t;var h=this.borderColor;var l=(h>>16&255)/255,u=(h>>8&255)/255,c=(h&255)/255;a.splice(0,5);var f=[a[0],a[1]];var _=[a[a.length-5],a[a.length-4]];var d=_[0]+(f[0]-_[0])*.5;var p=_[1]+(f[1]-_[1])*.5;a.unshift(d,p,0,0,0);a.push(d,p,0,0,0);var v=a.length/5;var g=n,m=i/2;var y,b,x,w,T,S,C,E;var A,M,I,L,P,k;var D,R,N,O,B,F;var U,G,V;x=a[0];w=a[1];T=a[5];S=a[6];A=-(w-S);M=x-T;V=Math.sqrt(A*A+M*M);A=A/V*m;M=M/V*m;o.push(x-A,w-M,l,u,c,x+A,w+M,l,u,c);for(var W=1;W<v-1;W++){x=a[(W-1)*5];w=a[(W-1)*5+1];T=a[W*5];S=a[W*5+1];C=a[(W+1)*5];E=a[(W+1)*5+1];A=-(w-S);M=x-T;V=Math.sqrt(A*A+M*M);A=A/V*m;M=M/V*m;I=-(S-E);L=T-C;V=Math.sqrt(I*I+L*L);I=I/V*m;L=L/V*m;D=-M+w-(-M+S);R=-A+T-(-A+x);N=(-A+x)*(-M+S)-(-A+T)*(-M+w);O=-L+E-(-L+S);B=-I+T-(-I+C);F=(-I+C)*(-L+S)-(-I+T)*(-L+E);U=D*B-O*R;if(Math.abs(U)<.1){U+=10.1;o.push(T-A,S-M,l,u,c,T+A,S+M,l,u,c);continue}y=(R*F-B*N)/U;b=(O*N-D*F)/U;G=(y-T)*(y-T)+(b-S)+(b-S);o.push(y,b,l,u,c,T-(y-T),S-(b-S),l,u,c)}if(s){e=s}var z=this.edges+1;for(W=1;W<z;W++){e.push(g+(W-1)*2,g+(W-1)*2+1,g+W*2+1,g+W*2+1,g+W*2,g+(W-1)*2)}e.push(g+(W-1)*2,g+(W-1)*2+1,g+1,g+1,g,g+(W-1)*2);return o};return t}();var pt=function(){function p(){}v(p,"laya.webgl.shapes.Earcut");p.earcut=function(t,e,i){i=i||2;var n=e&&e.length,r=n?e[0]*i:t.length,s=p.linkedList(t,0,r,i,true),a=[];if(!s)return a;var o,h,l,u,c,f,_;if(n)s=p.eliminateHoles(t,e,s,i);if(t.length>80*i){o=l=t[0];h=u=t[1];for(var d=i;d<r;d+=i){c=t[d];f=t[d+1];if(c<o)o=c;if(f<h)h=f;if(c>l)l=c;if(f>u)u=f}_=Math.max(l-o,u-h);_=_!==0?1/_:0}p.earcutLinked(s,a,i,o,h,_);return a};p.linkedList=function(t,e,i,n,r){var s,a;if(r===p.signedArea(t,e,i,n)>0){for(s=e;s<i;s+=n)a=p.insertNode(s,t[s],t[s+1],a)}else{for(s=i-n;s>=e;s-=n)a=p.insertNode(s,t[s],t[s+1],a)}if(a&&p.equals(a,a.next)){p.removeNode(a);a=a.next}return a};p.filterPoints=function(t,e){if(!t)return t;if(!e)e=t;var i=t,n;do{n=false;if(!i.steiner&&(p.equals(i,i.next)||p.area(i.prev,i,i.next)===0)){p.removeNode(i);i=e=i.prev;if(i===i.next)break;n=true}else{i=i.next}}while(n||i!==e);return e};p.earcutLinked=function(t,e,i,n,r,s,a){if(!t)return;if(!a&&s)p.indexCurve(t,n,r,s);var o=t,h,l;while(t.prev!==t.next){h=t.prev;l=t.next;if(s?p.isEarHashed(t,n,r,s):p.isEar(t)){e.push(h.i/i);e.push(t.i/i);e.push(l.i/i);p.removeNode(t);t=l.next;o=l.next;continue}t=l;if(t===o){if(!a){p.earcutLinked(p.filterPoints(t,null),e,i,n,r,s,1)}else if(a===1){t=p.cureLocalIntersections(t,e,i);p.earcutLinked(t,e,i,n,r,s,2)}else if(a===2){p.splitEarcut(t,e,i,n,r,s)}break}}};p.isEar=function(t){var e=t.prev,i=t,n=t.next;if(p.area(e,i,n)>=0)return false;var r=t.next.next;while(r!==t.prev){if(p.pointInTriangle(e.x,e.y,i.x,i.y,n.x,n.y,r.x,r.y)&&p.area(r.prev,r,r.next)>=0)return false;r=r.next}return true};p.isEarHashed=function(t,e,i,n){var r=t.prev,s=t,a=t.next;if(p.area(r,s,a)>=0)return false;var o=r.x<s.x?r.x<a.x?r.x:a.x:s.x<a.x?s.x:a.x,h=r.y<s.y?r.y<a.y?r.y:a.y:s.y<a.y?s.y:a.y,l=r.x>s.x?r.x>a.x?r.x:a.x:s.x>a.x?s.x:a.x,u=r.y>s.y?r.y>a.y?r.y:a.y:s.y>a.y?s.y:a.y;var c=p.zOrder(o,h,e,i,n),f=p.zOrder(l,u,e,i,n);var _=t.nextZ;while(_&&_.z<=f){if(_!==t.prev&&_!==t.next&&p.pointInTriangle(r.x,r.y,s.x,s.y,a.x,a.y,_.x,_.y)&&p.area(_.prev,_,_.next)>=0)return false;_=_.nextZ}_=t.prevZ;while(_&&_.z>=c){if(_!==t.prev&&_!==t.next&&p.pointInTriangle(r.x,r.y,s.x,s.y,a.x,a.y,_.x,_.y)&&p.area(_.prev,_,_.next)>=0)return false;_=_.prevZ}return true};p.cureLocalIntersections=function(t,e,i){var n=t;do{var r=n.prev,s=n.next.next;if(!p.equals(r,s)&&p.intersects(r,n,n.next,s)&&p.locallyInside(r,s)&&p.locallyInside(s,r)){e.push(r.i/i);e.push(n.i/i);e.push(s.i/i);p.removeNode(n);p.removeNode(n.next);n=t=s}n=n.next}while(n!==t);return n};p.splitEarcut=function(t,e,i,n,r,s){var a=t;do{var o=a.next.next;while(o!==a.prev){if(a.i!==o.i&&p.isValidDiagonal(a,o)){var h=p.splitPolygon(a,o);a=p.filterPoints(a,a.next);h=p.filterPoints(h,h.next);p.earcutLinked(a,e,i,n,r,s);p.earcutLinked(h,e,i,n,r,s);return}o=o.next}a=a.next}while(a!==t)};p.eliminateHoles=function(t,e,i,n){var r=[],s,a,o,h,l;for(s=0,a=e.length;s<a;s++){o=e[s]*n;h=s<a-1?e[s+1]*n:t.length;l=p.linkedList(t,o,h,n,false);if(l===l.next)l.steiner=true;r.push(p.getLeftmost(l))}r.sort(p.compareX);for(s=0;s<r.length;s++){p.eliminateHole(r[s],i);i=p.filterPoints(i,i.next)}return i};p.compareX=function(t,e){return t.x-e.x};p.eliminateHole=function(t,e){e=p.findHoleBridge(t,e);if(e){var i=p.splitPolygon(e,t);p.filterPoints(i,i.next)}};p.findHoleBridge=function(t,e){var i=e,n=t.x,r=t.y,s=-Infinity,a;do{if(r<=i.y&&r>=i.next.y&&i.next.y!==i.y){var o=i.x+(r-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(o<=n&&o>s){s=o;if(o===n){if(r===i.y)return i;if(r===i.next.y)return i.next}a=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!a)return null;if(n===s)return a.prev;var h=a,l=a.x,u=a.y,c=Infinity,f;i=a.next;while(i!==h){if(n>=i.x&&i.x>=l&&n!==i.x&&p.pointInTriangle(r<u?n:s,r,l,u,r<u?s:n,r,i.x,i.y)){f=Math.abs(r-i.y)/(n-i.x);if((f<c||f===c&&i.x>a.x)&&p.locallyInside(i,t)){a=i;c=f}}i=i.next}return a};p.indexCurve=function(t,e,i,n){var r=t;do{if(r.z===null)r.z=p.zOrder(r.x,r.y,e,i,n);r.prevZ=r.prev;r.nextZ=r.next;r=r.next}while(r!==t);r.prevZ.nextZ=null;r.prevZ=null;p.sortLinked(r)};p.sortLinked=function(t){var e,i,n,r,s,a,o,h,l=1;do{i=t;t=null;s=null;a=0;while(i){a++;n=i;o=0;for(e=0;e<l;e++){o++;n=n.nextZ;if(!n)break}h=l;while(o>0||h>0&&n){if(o!==0&&(h===0||!n||i.z<=n.z)){r=i;i=i.nextZ;o--}else{r=n;n=n.nextZ;h--}if(s)s.nextZ=r;else t=r;r.prevZ=s;s=r}i=n}s.nextZ=null;l*=2}while(a>1);return t};p.zOrder=function(t,e,i,n,r){t=32767*(t-i)*r;e=32767*(e-n)*r;t=(t|t<<8)&16711935;t=(t|t<<4)&252645135;t=(t|t<<2)&858993459;t=(t|t<<1)&1431655765;e=(e|e<<8)&16711935;e=(e|e<<4)&252645135;e=(e|e<<2)&858993459;e=(e|e<<1)&1431655765;return t|e<<1};p.getLeftmost=function(t){var e=t,i=t;do{if(e.x<i.x)i=e;e=e.next}while(e!==t);return i};p.pointInTriangle=function(t,e,i,n,r,s,a,o){return(r-a)*(e-o)-(t-a)*(s-o)>=0&&(t-a)*(n-o)-(i-a)*(e-o)>=0&&(i-a)*(s-o)-(r-a)*(n-o)>=0};p.isValidDiagonal=function(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!p.intersectsPolygon(t,e)&&p.locallyInside(t,e)&&p.locallyInside(e,t)&&p.middleInside(t,e)};p.area=function(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)};p.equals=function(t,e){return t.x===e.x&&t.y===e.y};p.intersects=function(t,e,i,n){if(p.equals(t,e)&&p.equals(i,n)||p.equals(t,n)&&p.equals(i,e))return true;return p.area(t,e,i)>0!==p.area(t,e,n)>0&&p.area(i,n,t)>0!==p.area(i,n,e)>0};p.intersectsPolygon=function(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&p.intersects(i,i.next,t,e))return true;i=i.next}while(i!==t);return false};p.locallyInside=function(t,e){return p.area(t.prev,t,t.next)<0?p.area(t,e,t.next)>=0&&p.area(t,t.prev,e)>=0:p.area(t,e,t.prev)<0||p.area(t,t.next,e)<0};p.middleInside=function(t,e){var i=t,n=false,r=(t.x+e.x)/2,s=(t.y+e.y)/2;do{if(i.y>s!==i.next.y>s&&i.next.y!==i.y&&r<(i.next.x-i.x)*(s-i.y)/(i.next.y-i.y)+i.x)n=!n;i=i.next}while(i!==t);return n};p.splitPolygon=function(t,e){var i=new vt(t.i,t.x,t.y),n=new vt(e.i,e.x,e.y),r=t.next,s=e.prev;t.next=e;e.prev=t;i.next=r;r.prev=i;n.next=i;i.prev=n;s.next=n;n.prev=s;return n};p.insertNode=function(t,e,i,n){var r=new vt(t,e,i);if(!n){r.prev=r;r.next=r}else{r.next=n.next;r.prev=n;n.next.prev=r;n.next=r}return r};p.removeNode=function(t){t.next.prev=t.prev;t.prev.next=t.next;if(t.prevZ)t.prevZ.nextZ=t.nextZ;if(t.nextZ)t.nextZ.prevZ=t.prevZ};p.signedArea=function(t,e,i,n){var r=0;for(var s=e,a=i-n;s<i;s+=n){r+=(t[a]-t[s])*(t[s+1]+t[a+1]);a=s}return r};return p}();var vt=function(){function t(t,e,i){this.i=null;this.x=null;this.y=null;this.prev=null;this.next=null;this.z=null;this.prevZ=null;this.nextZ=null;this.steiner=null;this.i=t;this.x=e;this.y=i;this.prev=null;this.next=null;this.z=null;this.prevZ=null;this.nextZ=null;this.steiner=false}v(t,"laya.webgl.shapes.EarcutNode");return t}();var gt=function(){function t(t,e,i,n,r,s,a){this.lineWidth=t;this.lineColor=e;this.lineAlpha=i;this.fillColor=n;this.fillAlpha=r;this.shape=a;this.fill=s}v(t,"laya.webgl.shapes.GeometryData");var e=t.prototype;e.clone=function(){return new t(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)};e.getIndexData=function(){return null};e.getVertexData=function(){return null};e.destroy=function(){this.shape=null};return t}();var mt=function(){function t(t){if(t instanceof Float32Array)this.points=t;else if(t instanceof Array){var e=t.length;this.points=new Float32Array(t)}}v(t,"laya.webgl.shapes.Vertex");var e=t.prototype;w.imps(e,{"laya.webgl.shapes.IShape":true});e.getData=function(t,e,i){};e.needUpdate=function(t){return false};e.rebuild=function(t){};e.setMatrix=function(t){};return t}();var yt=function(){function h(t){t===void 0&&(t=1e4);this._renderType=t}v(h,"laya.webgl.submit.Submit");var t=h.prototype;w.imps(t,{"laya.webgl.submit.ISubmit":true});t.releaseRender=function(){var t=h._cache;t[t._length++]=this;this.shaderValue.release();this._vb=null};t.getRenderType=function(){return this._renderType};t.renderSubmit=function(){if(this._numEle===0)return 1;var t=this.shaderValue.textureHost;if(t){var e=t.source;if(!t.bitmap||!e)return 1;this.shaderValue.texture=e}this._vb.bind_upload(this._ib);var i=Nt.mainContext;this.shaderValue.upload();if(tt.activeBlendFunction!==this._blendFn){i.enable(3042);this._blendFn(i);tt.activeBlendFunction=this._blendFn}F.drawCall++;F.trianglesFaces+=this._numEle/3;i.drawElements(4,this._numEle,5123,this._startIdx);return 1};h.__init__=function(){var t=h.RENDERBASE=new h(-1);t.shaderValue=new Ut(0,0);t.shaderValue.ALPHA=-1234};h.createSubmit=function(t,e,i,n,r){var s=h._cache._length?h._cache[--h._cache._length]:new h;if(i==null){i=s._selfVb||(s._selfVb=ve.create(-1));i.clear();n=0}s._ib=e;s._vb=i;s._startIdx=n*It.BYTES_PIDX;s._numEle=0;var a=t._nBlendType;s._blendFn=t._targets?tt.targetFns[a]:tt.fns[a];s.shaderValue=r;s.shaderValue.setValue(t._shader2D);var o=t._shader2D.filters;o&&s.shaderValue.setFilters(o);return s};h.createShape=function(t,e,i,n,r,s){var a=!h._cache._length?new h:h._cache[--h._cache._length];a._ib=e;a._vb=i;a._numEle=n;a._startIdx=r;a.shaderValue=s;a.shaderValue.setValue(t._shader2D);var o=t._nBlendType;a._blendFn=t._targets?tt.targetFns[o]:tt.fns[o];return a};h.TYPE_2D=1e4;h.TYPE_CANVAS=10003;h.TYPE_CMDSETRT=10004;h.TYPE_CUSTOM=10005;h.TYPE_BLURRT=10006;h.TYPE_CMDDESTORYPRERT=10007;h.TYPE_DISABLESTENCIL=10008;h.TYPE_OTHERIBVB=10009;h.TYPE_PRIMITIVE=10010;h.TYPE_RT=10011;h.TYPE_BLUR_RT=10012;h.TYPE_TARGET=10013;h.TYPE_CHANGE_VALUE=10014;h.TYPE_SHAPE=10015;h.TYPE_TEXTURE=10016;h.TYPE_FILLTEXTURE=10017;h.RENDERBASE=null;h._cache=(h._cache=[],h._cache._length=0,h._cache);return h}();var bt=function(){function n(){this.fun=null;this.args=null}v(n,"laya.webgl.submit.SubmitCMD");var t=n.prototype;w.imps(t,{"laya.webgl.submit.ISubmit":true});t.renderSubmit=function(){this.fun.apply(null,this.args);return 1};t.getRenderType=function(){return 0};t.releaseRender=function(){var t=n._cache;t[t._length++]=this};n.create=function(t,e){var i=n._cache._length?n._cache[--n._cache._length]:new n;i.fun=e;i.args=t;return i};n._cache=(n._cache=[],n._cache._length=0,n._cache);return n}();var xt=function(){function e(){this.variables={}}v(e,"laya.webgl.submit.SubmitCMDScope");var t=e.prototype;t.getValue=function(t){return this.variables[t]};t.addValue=function(t,e){return this.variables[t]=e};t.setValue=function(t,e){if(this.variables.hasOwnProperty(t)){return this.variables[t]=e}return null};t.clear=function(){for(var t in this.variables){delete this.variables[t]}};t.recycle=function(){this.clear();e.POOL.push(this)};e.create=function(){var t=e.POOL.pop();t||(t=new e);return t};e.POOL=[];return e}();var wt=function(){function c(){this.offset=0;this.startIndex=0;this._mat=A.create()}v(c,"laya.webgl.submit.SubmitOtherIBVB");var t=c.prototype;w.imps(t,{"laya.webgl.submit.ISubmit":true});t.releaseRender=function(){var t=c._cache;t[t._length++]=this};t.getRenderType=function(){return 10009};t.renderSubmit=function(){var t=this._shaderValue.textureHost;if(t){var e=t.source;if(!t.bitmap||!e)return 1;this._shaderValue.texture=e}this._vb.bind_upload(this._ib);var i=Dt.worldMatrix4;var n=A.TEMP;A.mulPre(this._mat,i[0],i[1],i[4],i[5],i[12],i[13],n);var r=Dt.worldMatrix4=c.tempMatrix4;r[0]=n.a;r[1]=n.b;r[4]=n.c;r[5]=n.d;r[12]=n.tx;r[13]=n.ty;this._shader._offset=this.offset;this._shaderValue.refresh();this._shader.upload(this._shaderValue);this._shader._offset=0;var s=Nt.mainContext;if(tt.activeBlendFunction!==this._blendFn){s.enable(3042);this._blendFn(s);tt.activeBlendFunction=this._blendFn}F.drawCall++;F.trianglesFaces+=this._numEle/3;s.drawElements(4,this._numEle,5123,this.startIndex);Dt.worldMatrix4=i;Zt.activeShader=null;return 1};c.create=function(t,e,i,n,r,s,a,o,h){h===void 0&&(h=0);var l=!c._cache._length?new c:c._cache[--c._cache._length];l._ib=i;l._vb=e;l._numEle=n;l._shader=r;l._shaderValue=s;var u=t._nBlendType;l._blendFn=t._targets?tt.targetFns[u]:tt.fns[u];switch(h){case 0:l.offset=0;l.startIndex=o/(It.BYTES_PE*e.vertexStride)*1.5;l.startIndex*=It.BYTES_PIDX;break;case 1:l.startIndex=a;l.offset=o;break}return l};c._cache=(c._cache=[],c._cache._length=0,c._cache);c.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return c}();var Tt=function(){function i(){this.submitIndex=0;this.submitLength=0;this.context=null;this.clipRect=new I;this.screenRect=new I}v(i,"laya.webgl.submit.SubmitScissor");var t=i.prototype;w.imps(t,{"laya.webgl.submit.ISubmit":true});t._scissor=function(t,e,i,n){var r=Dt.worldMatrix4;var s=r[0],a=r[5],o=r[12],h=r[13];t=t*s+o;e=e*a+h;i*=s;n*=a;if(i<1||n<1){return false}var l=t+i;var u=e+n;t<0&&(t=0,i=l-t);e<0&&(e=0,n=u-e);var c=Dt.worldClipRect;t=Math.max(t,c.x);e=Math.max(e,c.y);i=Math.min(l,c.right)-t;n=Math.min(u,c.bottom)-e;if(i<1||n<1){return false}var f=Dt.worldScissorTest;this.screenRect.copyFrom(c);c.x=t;c.y=e;c.width=i;c.height=n;Dt.worldScissorTest=true;e=Dt.height-e-n;Nt.mainContext.scissor(t,e,i,n);Nt.mainContext.enable(3089);this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength);if(f){e=Dt.height-this.screenRect.y-this.screenRect.height;Nt.mainContext.scissor(this.screenRect.x,e,this.screenRect.width,this.screenRect.height);Nt.mainContext.enable(3089)}else{Nt.mainContext.disable(3089);Dt.worldScissorTest=false}c.copyFrom(this.screenRect);return true};t._scissorWithTagart=function(t,e,i,n){if(i<1||n<1){return false}var r=t+i;var s=e+n;t<0&&(t=0,i=r-t);e<0&&(e=0,n=s-e);var a=Dt.worldClipRect;t=Math.max(t,a.x);e=Math.max(e,a.y);i=Math.min(r,a.right)-t;n=Math.min(s,a.bottom)-e;if(i<1||n<1){return false}var o=Dt.worldScissorTest;this.screenRect.copyFrom(a);Dt.worldScissorTest=true;a.x=t;a.y=e;a.width=i;a.height=n;e=Dt.height-e-n;Nt.mainContext.scissor(t,e,i,n);Nt.mainContext.enable(3089);this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength);if(o){e=Dt.height-this.screenRect.y-this.screenRect.height;Nt.mainContext.scissor(this.screenRect.x,e,this.screenRect.width,this.screenRect.height);Nt.mainContext.enable(3089)}else{Nt.mainContext.disable(3089);Dt.worldScissorTest=false}a.copyFrom(this.screenRect);return true};t.renderSubmit=function(){this.submitLength=Math.min(this.context._submits._length-1,this.submitLength);if(this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1)return this.submitLength+1;if(this.context._targets)this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height);else this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height);return this.submitLength+1};t.getRenderType=function(){return 0};t.releaseRender=function(){var t=i._cache;t[t._length++]=this;this.context=null};i.create=function(t){var e=i._cache._length?i._cache[--i._cache._length]:new i;e.context=t;return e};i._cache=(i._cache=[],i._cache._length=0,i._cache);return i}();var St=function(){function u(){this.step=0;this.blendMode=null;this.level=0}v(u,"laya.webgl.submit.SubmitStencil");var t=u.prototype;w.imps(t,{"laya.webgl.submit.ISubmit":true});t.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8();break}return 1};t.getRenderType=function(){return 0};t.releaseRender=function(){var t=u._cache;t[t._length++]=this};t.do1=function(){var t=Nt.mainContext;t.enable(2960);t.clear(1024);t.colorMask(false,false,false,false);t.stencilFunc(514,this.level,255);t.stencilOp(7680,7680,7682)};t.do2=function(){var t=Nt.mainContext;t.stencilFunc(514,this.level+1,255);t.colorMask(true,true,true,true);t.stencilOp(7680,7680,7680)};t.do3=function(){var t=Nt.mainContext;t.colorMask(true,true,true,true);t.stencilOp(7680,7680,7680);t.clear(1024);t.disable(2960)};t.do4=function(){var t=Nt.mainContext;if(this.level==0){t.enable(2960);t.clear(1024)}t.colorMask(false,false,false,false);t.stencilFunc(519,0,255);t.stencilOp(7680,7680,7682)};t.do5=function(){var t=Nt.mainContext;t.stencilFunc(514,this.level,255);t.colorMask(true,true,true,true);t.stencilOp(7680,7680,7680)};t.do6=function(){var t=Nt.mainContext;tt.targetFns[tt.TOINT[this.blendMode]](t)};t.do7=function(){var t=Nt.mainContext;t.colorMask(false,false,false,false);t.stencilOp(7680,7680,7683)};t.do8=function(){var t=Nt.mainContext;t.colorMask(true,true,true,true);t.stencilFunc(514,this.level,255);t.stencilOp(7680,7680,7680)};u.restore=function(t,e,i,n,r){var s;t._renderKey=0;if(u._mask>0){u._mask--}if(u._mask==0){s=laya.webgl.submit.SubmitStencil.create(3);t.addRenderObject(s);t._curSubmit=yt.RENDERBASE}else{s=laya.webgl.submit.SubmitStencil.create(7);t.addRenderObject(s);var a=t._vb;var o=a._byteLength>>2;if(Lt.fillRectImgVb(a,null,e.x,e.y,e.width,e.height,z.DEF_UV,i,n,r,0,0)){var h=t._shader2D;h.glTexture=null;var l=t._curSubmit=yt.createSubmit(t,t._ib,a,(a._byteLength-16*4)/32*3,Ut.create(2,0));l.shaderValue.ALPHA=1;t._submits[t._submits._length++]=l;t._curSubmit._numEle+=6;t._curSubmit=yt.RENDERBASE}else{alert("clipRect calc stencil rect error")}s=laya.webgl.submit.SubmitStencil.create(8);t.addRenderObject(s)}};u.restore2=function(t,e){var i;t._renderKey=0;if(u._mask>0){u._mask--}if(u._mask==0){i=laya.webgl.submit.SubmitStencil.create(3);t.addRenderObject(i);t._curSubmit=yt.RENDERBASE}else{i=laya.webgl.submit.SubmitStencil.create(7);t.addRenderObject(i);t._submits[t._submits._length++]=e;i=laya.webgl.submit.SubmitStencil.create(8);t.addRenderObject(i)}};u.create=function(t){var e=u._cache._length?u._cache[--u._cache._length]:new u;e.step=t;if(t==5)++u._mask;e.level=u._mask;return e};u._cache=(u._cache=[],u._cache._length=0,u._cache);u._mask=0;return u}();var Ct=function(){function o(){this._renderType=0;this._vb=null;this._ib=null;this._startIdx=0;this._numEle=0;this.shaderValue=null;this.blendType=0;this.proName=null;this.scope=null}v(o,"laya.webgl.submit.SubmitTarget");var t=o.prototype;w.imps(t,{"laya.webgl.submit.ISubmit":true});t.renderSubmit=function(){this._vb.bind_upload(this._ib);var t=this.scope.getValue(this.proName);if(t){this.shaderValue.texture=t.source;if(this.shaderValue["strength"]&&!this.shaderValue["blurInfo"]){this.shaderValue["blurInfo"]=[t.width,t.height]}this.shaderValue.upload();this.blend();F.drawCall++;F.trianglesFaces+=this._numEle/3;Nt.mainContext.drawElements(4,this._numEle,5123,this._startIdx)}return 1};t.blend=function(){if(tt.activeBlendFunction!==tt.fns[this.blendType]){var t=Nt.mainContext;t.enable(3042);tt.fns[this.blendType](t);tt.activeBlendFunction=tt.fns[this.blendType]}};t.getRenderType=function(){return 0};t.releaseRender=function(){var t=o._cache;t[t._length++]=this};o.create=function(t,e,i,n,r,s){var a=o._cache._length?o._cache[--o._cache._length]:new o;a._ib=e;a._vb=i;a.proName=s;a._startIdx=n*It.BYTES_PIDX;a._numEle=0;a.blendType=t._nBlendType;a.shaderValue=r;a.shaderValue.setValue(t._shader2D);return a};o._cache=(o._cache=[],o._cache._length=0,o._cache);return o}();var Et=function(){function t(){this._sourceStr=null}v(t,"laya.webgl.text.CharSegment");var e=t.prototype;w.imps(e,{"laya.webgl.text.ICharSegment":true});e.textToSpit=function(t){this._sourceStr=t};e.getChar=function(t){return this._sourceStr.charAt(t)};e.getCharCode=function(t){return this._sourceStr.charCodeAt(t)};e.length=function(){return this._sourceStr.length};return t}();var At=function(){var t;function P(){}v(P,"laya.webgl.text.DrawText");P.__init__=function(){P._charsTemp=new Array;P._drawValue=new t;P._charSeg=new Et};P.customCharSeg=function(t){P._charSeg=t};P.getChar=function(t,e,i){if(!t)return"";var n=oe.createOneChar(t,i);if(e!=-1)P._charsCache[e]=n;return n};P._drawSlow=function(t,e,i,n,r,s,a,o,h,l,u,c,f,_,d){var p=P._drawValue.value(s,o,h,l,f,_,d);var v=0,g=0;var m=P._charsTemp;var y=0,b,x,w=NaN;if(n){m.length=n.length;for(v=0,g=n.length;v<g;v++){x=n[v];w=x.charNum+p.txtID;m[v]=b=P._charsCache[w]||P.getChar(x.char,w,p);b.active()}}else{var T=i instanceof laya.utils.WordText?i.toString():i;if(W.CharacterCache){P._charSeg.textToSpit(T);var S=P._charSeg.length();m.length=S;for(v=0,g=S;v<g;v++){w=P._charSeg.getCharCode(v)+p.txtID;m[v]=b=P._charsCache[w]||P.getChar(P._charSeg.getChar(v),w,p);b.active();y+=b.cw}}else{m.length=0;b=P.getChar(T,-1,p);b.active();y+=b.cw;m[0]=b}}var C=0;if(a!==null&&a!=="left")C=-(a=="center"?y/2:y);var E,A=NaN,M,I,L=0;if(n){for(v=0,g=m.length;v<g;v++){b=m[v];if(!b.isSpace){x=n[v];A=b.borderSize;M=b.texture;e._drawText(M,u+C+x.x*f-A,c+x.y*_-A,M.width,M.height,r,0,0,0,0)}}}else{for(v=0,g=m.length;v<g;v++){b=m[v];if(!b.isSpace){A=b.borderSize;M=b.texture;e._drawText(M,u+C-A,c-A,M.width,M.height,r,0,0,0,0);t&&(I=t[L++],I||(I=t[L-1]=[]),I[0]=M,I[1]=C-A,I[2]=-A)}C+=b.cw}t&&(t.length=L)}};P._drawFast=function(t,e,i,n,r){var s,a;for(var o=0,h=t.length;o<h;o++){a=t[o];s=a[0];s.active();e._drawText(s,n+a[1],r+a[2],s.width,s.height,i,0,0,0,0)}};P.drawText=function(t,e,i,n,r,s,a,o,h,l,u,c){c===void 0&&(c=0);if(e&&e.length===0||i&&i.length===0)return;var f=n.a,_=n.d;(n.b!==0||n.c!==0)&&(f=_=1);var d=f!==1||_!==1;if(d&&w.stage.transform){var p=w.stage.transform;d=p.a===f&&p.d===_}else d=false;if(d){n=n.copyTo(Ft._tmpMatrix);var v=n.tx;var g=n.ty;n.scale(1/f,1/_);n._checkTransform();l*=f;u*=_;l+=v-n.tx;u+=g-n.ty}else f=_=1;if(i){P._drawSlow(null,t,e,i,n,r,s,a,o,h,l,u,f,_,c)}else{if(e.toUpperCase===null){var m=f+_*1e5;var y=e;if(!y.changed&&y.id===m){P._drawFast(y.save,t,n,l,u)}else{y.id=m;y.changed=false;P._drawSlow(y.save,t,e,i,n,r,s,a,o,h,l,u,f,_,c)}return}var b=e+r.toString()+a+o+h+f+_+s;var x=P._textsCache[b];if(W.CharacterCache){if(x){P._drawFast(x,t,n,l,u)}else{P._textsCache.__length||(P._textsCache.__length=0);if(P._textsCache.__length>T.WebGLTextCacheCount){P._textsCache={};P._textsCache.__length=0;P._curPoolIndex=0}P._textCachesPool[P._curPoolIndex]?(x=P._textsCache[b]=P._textCachesPool[P._curPoolIndex],x.length=0):P._textCachesPool[P._curPoolIndex]=x=P._textsCache[b]=[];P._textsCache.__length++;P._curPoolIndex++;P._drawSlow(x,t,e,i,n,r,s,a,o,h,l,u,f,_,c)}}else{P._drawSlow(x,t,e,i,n,r,s,a,o,h,l,u,f,_,c)}}};P._charsTemp=null;P._textCachesPool=[];P._curPoolIndex=0;P._charsCache={};P._textsCache={};P._drawValue=null;P.d=[];P._charSeg=null;P.__init$=function(){t=function(){function h(){}v(h,"");var t=h.prototype;t.value=function(t,e,i,n,r,s,a){this.font=t;this.fillColor=e;this.borderColor=i;this.lineWidth=n;this.scaleX=r;this.scaleY=s;this.underLine=a;var o=t.toString()+r+s+n+e+i+a;this.txtID=h._keymap[o];if(!this.txtID){this.txtID=++h._keymapCount*1e-7;h._keymap[o]=this.txtID}return this};h.clear=function(){h._keymap={};h._keymapCount=1};h._keymap={};h._keymapCount=1;return h}()};return P}();var Mt=function(){function r(t){this._index=0;this._size=14;this._italic=-2;r._cache2=r._cache2||[];this.setFont(t||"14px Arial")}v(r,"laya.webgl.text.FontInContext");var t=r.prototype;t.setFont=function(t){var e=r._cache2[t];if(!e){this._words=t.split(" ");for(var i=0,n=this._words.length;i<n;i++){if(this._words[i].indexOf("px")>0){this._index=i;break}}this._size=parseInt(this._words[this._index]);r._cache2[t]=[this._words,this._size]}else{this._words=e[0];this._size=e[1]}this._text=null;this._italic=-2};t.getItalic=function(){this._italic===-2&&(this._italic=this.hasType("italic"));return this._italic};t.hasType=function(t){for(var e=0,i=this._words.length;e<i;e++)if(this._words[e]===t)return e;return-1};t.removeType=function(t){for(var e=0,i=this._words.length;e<i;e++)if(this._words[e]===t){this._words.splice(e,1);if(this._index>e)this._index--;break}this._text=null;this._italic=-2};t.copyTo=function(t){t._text=this._text;t._size=this._size;t._index=this._index;t._words=this._words.slice();t._italic=-2;return t};t.toString=function(){return this._text?this._text:this._text=this._words.join(" ")};h(0,t,"size",function(){return this._size},function(t){this._size=t;this._words[this._index]=t+"px";this._text=null});r.create=function(t){var e=r._cache[t];if(e)return e;e=r._cache[t]=new r(t);return e};r.EMPTY=new r;r._cache={};r._cache2=null;return r}();var It=function(){function t(){}v(t,"laya.webgl.utils.CONST3D2D");t.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];t.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1];t.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0];t._TMPARRAY=[];t._OFFSETX=0;t._OFFSETY=0;a(t,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]);return t}();var Lt=function(){function d(){}v(d,"laya.webgl.utils.GlUtils");d.make2DProjection=function(t,e,i){return[2/t,0,0,0,0,-2/e,0,0,0,0,2/i,0,-1,1,0,1]};d.fillIBQuadrangle=function(t,e){if(e>65535/4){throw Error("IBQuadrangle count:"+e+" must<:"+Math.floor(65535/4));return false}e=Math.floor(e);t._resizeBuffer((e+1)*6*2,false);t.byteLength=t.bufferLength;var i=t.getUint16Array();var n=0;for(var r=0;r<e;r++){i[n++]=r*4;i[n++]=r*4+2;i[n++]=r*4+1;i[n++]=r*4;i[n++]=r*4+3;i[n++]=r*4+2}t.setNeedUpload();return true};d.expandIBQuadrangle=function(t,e){t.bufferLength>=e*6*2||d.fillIBQuadrangle(t,e)};d.mathCeilPowerOfTwo=function(t){t--;t|=t>>1;t|=t>>2;t|=t>>4;t|=t>>8;t|=t>>16;t++;return t};d.fillQuadrangleImgVb=function(t,e,i,n,r,s,a,o){var h=(t._byteLength>>2)+16;t.byteLength=h<<2;var l=t.getFloat32Array();h-=16;l[h+2]=r[0];l[h+3]=r[1];l[h+6]=r[2];l[h+7]=r[3];l[h+10]=r[4];l[h+11]=r[5];l[h+14]=r[6];l[h+15]=r[7];var u=s.a,c=s.b,f=s.c,_=s.d;if(u!==1||c!==0||f!==0||_!==1){s.bTransform=true;var d=s.tx+a,p=s.ty+o;l[h]=(n[0]+e)*u+(n[1]+i)*f+d;l[h+1]=(n[0]+e)*c+(n[1]+i)*_+p;l[h+4]=(n[2]+e)*u+(n[3]+i)*f+d;l[h+5]=(n[2]+e)*c+(n[3]+i)*_+p;l[h+8]=(n[4]+e)*u+(n[5]+i)*f+d;l[h+9]=(n[4]+e)*c+(n[5]+i)*_+p;l[h+12]=(n[6]+e)*u+(n[7]+i)*f+d;l[h+13]=(n[6]+e)*c+(n[7]+i)*_+p}else{s.bTransform=false;e+=s.tx+a;i+=s.ty+o;l[h]=e+n[0];l[h+1]=i+n[1];l[h+4]=e+n[2];l[h+5]=i+n[3];l[h+8]=e+n[4];l[h+9]=i+n[5];l[h+12]=e+n[6];l[h+13]=i+n[7]}t._upload=true;return true};d.fillTranglesVB=function(t,e,i,n,r,s,a){var o=(t._byteLength>>2)+n.length;t.byteLength=o<<2;var h=t.getFloat32Array();o-=n.length;var l=n.length;var u=r.a,c=r.b,f=r.c,_=r.d;for(var d=0;d<l;d+=4){h[o+d+2]=n[d+2];h[o+d+3]=n[d+3];if(u!==1||c!==0||f!==0||_!==1){r.bTransform=true;var p=r.tx+s,v=r.ty+a;h[o+d]=(n[d]+e)*u+(n[d+1]+i)*f+p;h[o+d+1]=(n[d]+e)*c+(n[d+1]+i)*_+v}else{r.bTransform=false;e+=r.tx+s;i+=r.ty+a;h[o+d]=e+n[d];h[o+d+1]=i+n[d+1]}}t._upload=true;return true};d.copyPreImgVb=function(t,e,i){var n=t._byteLength>>2;t.byteLength=n+16<<2;var r=t.getFloat32Array();for(var s=0,a=n-16;s<4;s++){r[n]=r[a]+e;++n;++a;r[n]=r[a]+i;++n;++a;r[n]=r[a];++n;++a;r[n]=r[a];++n;++a}t._upload=true};d.fillRectImgVb=function(t,e,i,n,r,s,a,o,h,l,u,c,f){f===void 0&&(f=false);var _=1;var d,p,v,g;var m,y,b,x;var w,T,S,C;var E,A,M,I;var L=o.a,P=o.b,k=o.c,D=o.d;var R=e&&e.width<99999999;if(L!==1||P!==0||k!==0||D!==1){o.bTransform=true;if(P===0&&k===0){_=23;w=r+i,T=s+n;S=o.tx+h,C=o.ty+l;d=L*i+S;v=L*w+S;p=D*n+C;g=D*T+C}}else{_=23;o.bTransform=false;d=i+o.tx+h;v=d+r;p=n+o.ty+l;g=p+s}if(R){m=e.x,y=e.y,b=e.width+m,x=e.height+y}if(_!==1){if(Math.min(d,v)>=b)return false;if(Math.min(p,g)>=x)return false;if(Math.max(v,d)<=m)return false;if(Math.max(g,p)<=y)return false}var N=t._byteLength>>2;t.byteLength=N+16<<2;var O=t.getFloat32Array();O[N+2]=a[0];O[N+3]=a[1];O[N+6]=a[2];O[N+7]=a[3];O[N+10]=a[4];O[N+11]=a[5];O[N+14]=a[6];O[N+15]=a[7];switch(_){case 1:S=o.tx+h,C=o.ty+l;w=r+i,T=s+n;var B=i,F=n;var U=L*B,G=k*F,V=D*F,W=P*B;var z=L*w,H=k*T,Y=D*T,j=P*w;if(f){E=U+G+S;M=Math.round(E)-E;A=V+W+C;I=Math.round(A)-A;O[N]=E+M;O[N+1]=A+I;O[N+4]=z+G+S+M;O[N+5]=V+j+C+I;O[N+8]=z+H+S+M;O[N+9]=Y+j+C+I;O[N+12]=U+H+S+M;O[N+13]=Y+W+C+I}else{O[N]=U+G+S;O[N+1]=V+W+C;O[N+4]=z+G+S;O[N+5]=V+j+C;O[N+8]=z+H+S;O[N+9]=Y+j+C;O[N+12]=U+H+S;O[N+13]=Y+W+C}break;case 23:if(f){E=d+u;M=Math.round(E)-E;A=p;I=Math.round(A)-A;O[N]=E+M;O[N+1]=A+I;O[N+4]=v+u+M;O[N+5]=p+I;O[N+8]=v+M;O[N+9]=g+I;O[N+12]=d+M;O[N+13]=g+I}else{O[N]=d+u;O[N+1]=p;O[N+4]=v+u;O[N+5]=p;O[N+8]=v;O[N+9]=g;O[N+12]=d;O[N+13]=g}break}t._upload=true;return true};d.fillLineVb=function(t,e,i,n,r,s,a,o){var h=a*.5;var l=d._fillLineArray;var u=-(n-s),c=i-r;var f=Math.sqrt(u*u+c*c);u/=f,c/=f,u*=h,c*=h;l[0]=i-u,l[1]=n-c,l[4]=i+u,l[5]=n+c,l[8]=r+u,l[9]=s+c,l[12]=r-u,l[13]=s-c;o&&o.transformPointArray(l,l);var _=(t._byteLength>>2)+16;t.byteLength=_<<2;t.insertData(l,_-16);return true};d._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];return d}();var Pt=function(){function h(){}v(h,"laya.webgl.utils.MatirxArray");h.ArrayMul=function(t,e,i){if(!t){h.copyArray(e,i);return}if(!e){h.copyArray(t,i);return}var n=NaN,r=NaN,s=NaN,a=NaN;for(var o=0;o<4;o++){n=t[o];r=t[o+4];s=t[o+8];a=t[o+12];i[o]=n*e[0]+r*e[1]+s*e[2]+a*e[3];i[o+4]=n*e[4]+r*e[5]+s*e[6]+a*e[7];i[o+8]=n*e[8]+r*e[9]+s*e[10]+a*e[11];i[o+12]=n*e[12]+r*e[13]+s*e[14]+a*e[15]}};h.copyArray=function(t,e){if(!t)return;if(!e)return;for(var i=0;i<t.length;i++){e[i]=t[i]}};return h}();var kt=function(){function e(t,e,i){this._stride=0;this.vertNum=0;this.indexNum=0;this._applied=false;this._vb=null;this._ib=null;this._vao=null;this._attribInfo=null;this._quadNum=0;this.canReuse=false;this._stride=t;this._vb=new ve(t,35048);if(e){this._vb._resizeBuffer(e,false)}else{}this._ib=new pe;if(i){this._ib._resizeBuffer(i,false)}}v(e,"laya.webgl.utils.Mesh2D");var t=e.prototype;t.cloneWithNewVB=function(){var t=new e(this._stride,0,0);t._ib=this._ib;t._quadNum=this._quadNum;t._attribInfo=this._attribInfo;return t};t.cloneWithNewVBIB=function(){var t=new e(this._stride,0,0);t._attribInfo=this._attribInfo;return t};t.getVBW=function(){this._vb.setNeedUpload();return this._vb};t.getVBR=function(){return this._vb};t.getIBR=function(){return this._ib};t.getIBW=function(){this._ib.setNeedUpload();return this._ib};t.createQuadIB=function(t){this._quadNum=t;this._ib._resizeBuffer(t*6*2,false);this._ib.byteLength=this._ib.bufferLength;var e=this._ib.getUint16Array();var i=0;var n=0;for(var r=0;r<t;r++){e[i++]=n;e[i++]=n+2;e[i++]=n+1;e[i++]=n;e[i++]=n+3;e[i++]=n+2;n+=4}this._ib.setNeedUpload()};t.setAttributes=function(t){this._attribInfo=t;if(this._attribInfo.length%3!=0){throw"Mesh2D setAttributes error!"}};t.getEleNum=function(){return this._ib.getBuffer().byteLength/2};t.releaseMesh=function(){};t.destroy=function(){};t.clearVB=function(){this._vb.clear()};e._gvaoid=0;return e}();var Dt=function(){function r(){}v(r,"laya.webgl.utils.RenderState2D");r.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};r.mat2MatArray=function(t,e){var i=t;var n=e;n[0]=i.a;n[1]=i.b;n[2]=r.EMPTYMAT4_ARRAY[2];n[3]=r.EMPTYMAT4_ARRAY[3];n[4]=i.c;n[5]=i.d;n[6]=r.EMPTYMAT4_ARRAY[6];n[7]=r.EMPTYMAT4_ARRAY[7];n[8]=r.EMPTYMAT4_ARRAY[8];n[9]=r.EMPTYMAT4_ARRAY[9];n[10]=r.EMPTYMAT4_ARRAY[10];n[11]=r.EMPTYMAT4_ARRAY[11];n[12]=i.tx;n[13]=i.ty;n[14]=r.EMPTYMAT4_ARRAY[14];n[15]=r.EMPTYMAT4_ARRAY[15];return e};r.restoreTempArray=function(){r.TEMPMAT4_ARRAY[0]=1;r.TEMPMAT4_ARRAY[1]=0;r.TEMPMAT4_ARRAY[4]=0;r.TEMPMAT4_ARRAY[5]=1;r.TEMPMAT4_ARRAY[12]=0;r.TEMPMAT4_ARRAY[13]=0};r.clear=function(){r.worldScissorTest=false;r.worldShaderDefines=null;r.worldFilters=null;r.worldAlpha=1;r.worldClipRect.x=r.worldClipRect.y=0;r.worldClipRect.width=r.width;r.worldClipRect.height=r.height;r.curRenderTarget=null};r._MAXSIZE=99999999;r.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];r.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];r.worldMatrix4=r.TEMPMAT4_ARRAY;r.worldAlpha=1;r.worldScissorTest=false;r.worldFilters=null;r.worldShaderDefines=null;r.curRenderTarget=null;r.width=0;r.height=0;a(r,["worldMatrix",function(){return this.worldMatrix=new A},"worldClipRect",function(){return this.worldClipRect=new I(0,0,99999999,99999999)}]);return r}();var Rt=function(){var m,i;function y(t,e,i,n,r){var s=this;function a(t){var e=[];var i=new m(e);s._compileToTree(i,t.split("\n"),0,e,r);return i}var o=_.now();this._VS=a(e);this._PS=a(i);this._nameMap=n;if(_.now()-o>2)console.log("ShaderCompile use time:"+(_.now()-o)+"  size:"+e.length+"/"+i.length)}v(y,"laya.webgl.utils.ShaderCompile");var t=y.prototype;t._compileToTree=function(t,e,i,n,r){var s,a;var o,h,l;var u=0,c,f;var _=0,d=0,p=0;for(_=i;_<e.length;_++){o=e[_];if(o.length<1)continue;u=o.indexOf("//");if(u===0)continue;if(u>=0)o=o.substr(0,u);s=f||new m(n);f=null;s.text=o;s.noCompile=true;if((u=o.indexOf("#"))>=0){h="#";for(p=u+1,d=o.length;p<d;p++){var v=o.charAt(p);if(v===" "||v==="\t"||v==="?")break;h+=v}s.name=h;switch(h){case"#ifdef":case"#ifndef":s.src=o;s.noCompile=o.match(/[!&|()=<>]/)!=null;if(!s.noCompile){c=o.replace(/^\s*/,"").split(/\s+/);s.setCondition(c[1],h==="#ifdef"?1:2);s.text="//"+s.text}else{console.log("function():Boolean{return "+o.substr(u+s.name.length)+"}")}s.setParent(t);t=s;if(r){c=o.substr(p).split(y._splitToWordExps3);for(p=0;p<c.length;p++){o=c[p];o.length&&(r[o]=true)}}continue;case"#if":s.src=o;s.noCompile=true;s.setParent(t);t=s;if(r){c=o.substr(p).split(y._splitToWordExps3);for(p=0;p<c.length;p++){o=c[p];o.length&&o!="defined"&&(r[o]=true)}}continue;case"#else":s.src=o;t=t.parent;a=t.childs[t.childs.length-1];s.noCompile=a.noCompile;if(!s.noCompile){s.condition=a.condition;s.conditionType=a.conditionType==1?2:1;s.text="//"+s.text+" "+a.text+" "+s.conditionType}s.setParent(t);t=s;continue;case"#endif":t=t.parent;a=t.childs[t.childs.length-1];s.noCompile=a.noCompile;if(!s.noCompile){s.text="//"+s.text}s.setParent(t);continue;case"#include":c=y.splitToWords(o,null);var g=y.includes[c[1]];if(!g){throw"ShaderCompile error no this include file:"+c[1];return}if((u=c[0].indexOf("?"))<0){s.setParent(t);o=g.getWith(c[2]=="with"?c[3]:null);this._compileToTree(s,o.split("\n"),0,n,r);s.text="";continue}s.setCondition(c[0].substr(u+1),1);s.text=g.getWith(c[2]=="with"?c[3]:null);break;case"#import":c=y.splitToWords(o,null);l=c[1];n.push({node:s,file:y.includes[l],ofs:s.text.length});continue}}else{a=t.childs[t.childs.length-1];if(a&&!a.name){n.length>0&&y.splitToWords(o,a);f=s;a.text+="\n"+o;continue}n.length>0&&y.splitToWords(o,s)}s.setParent(t)}};t.createShader=function(t,e,i){var n={};var r="";if(t){for(var s in t){r+="#define "+s+"\n";n[s]=true}}var a=this._VS.toscript(n,[]);var o=this._PS.toscript(n,[]);return(i||ue.create)(r+a.join("\n"),r+o.join("\n"),e,this._nameMap)};y._parseOne=function(t,e,i,n,r,s){var a={type:y.shaderParamsMap[i[n+1]],name:i[n+2],size:isNaN(parseInt(i[n+3]))?1:parseInt(i[n+3])};if(s){if(r=="attribute"){t.push(a)}else{e.push(a)}}if(i[n+3]==":"){a.type=i[n+4];n+=2}n+=2;return n};y.addInclude=function(t,e){if(!e||e.length===0)throw new Error("add shader include file err:"+t);if(y.includes[t])throw new Error("add shader include file err, has add:"+t);y.includes[t]=new i(e)};y.preGetParams=function(t,e){var i=[t,e];var n={};var r=[];var s=[];var a={};var o=[];n.attributes=r;n.uniforms=s;n.defines=a;var h=0,l=0,u;for(var c=0;c<2;c++){i[c]=i[c].replace(y._removeAnnotation,"");var f=i[c].match(y._reg);var _;for(h=0,l=f.length;h<l;h++){var d=f[h];if(d!="attribute"&&d!="uniform"){if(d=="#define"){d=f[++h];o[d]=1;continue}else if(d=="#ifdef"){_=f[++h];var p=a[_]=a[_]||[];for(h++;h<l;h++){d=f[h];if(d!="attribute"&&d!="uniform"){if(d=="#else"){for(h++;h<l;h++){d=f[h];if(d!="attribute"&&d!="uniform"){if(d=="#endif"){break}continue}h=y._parseOne(r,s,f,h,d,!o[_])}}continue}h=y._parseOne(r,s,f,h,d,o[_])}}continue}h=y._parseOne(r,s,f,h,d,true)}}return n};y.splitToWords=function(t,e){var i=[];var n;var r=-1;var s;for(var a=0,o=t.length;a<o;a++){n=t.charAt(a);if(" \t=+-*/&%!<>()'\",;".indexOf(n)>=0){if(r>=0&&a-r>1){s=t.substr(r,a-r);i.push(s)}if(n=='"'||n=="'"){var h=t.indexOf(n,a+1);if(h<0){throw"Sharder err:"+t}i.push(t.substr(a+1,h-a-1));a=h;r=-1;continue}if(n=="("&&e&&i.length>0){s=i[i.length-1]+";";if("vec4;main;".indexOf(s)<0)e.useFuns+=s}r=-1;continue}if(r<0)r=a}if(r<o&&o-r>1){s=t.substr(r,o-r);i.push(s)}return i};y.IFDEF_NO=0;y.IFDEF_YES=1;y.IFDEF_ELSE=2;y.IFDEF_PARENT=3;y._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g");y._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g");y._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g");y.includes={};a(y,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]);y.__init$=function(){m=function(){function i(t){this.childs=[];this.text="";this.parent=null;this.name=null;this.noCompile=false;this.includefiles=null;this.condition=null;this.conditionType=0;this.useFuns="";this.z=0;this.src=null;this.includefiles=t}v(i,"");var t=i.prototype;t.setParent=function(t){t.childs.push(this);this.z=t.z+1;this.parent=t};t.setCondition=function(t,e){if(t){this.conditionType=e;t=t.replace(/(\s*$)/g,"");this.condition=function(){return this[t]};this.condition.__condition=t}};t.toscript=function(t,e){return this._toscript(t,e,++i.__id)};t._toscript=function(n,r,s){if(this.childs.length<1&&!this.text)return r;var t=r.length;if(this.condition){var e=!!this.condition.call(n);this.conditionType===2&&(e=!e);if(!e)return r}this.text&&r.push(this.text);this.childs.length>0&&this.childs.forEach(function(t,e,i){t._toscript(n,r,s)});if(this.includefiles.length>0&&this.useFuns.length>0){var i;for(var a=0,o=this.includefiles.length;a<o;a++){if(this.includefiles[a].curUseID==s){continue}i=this.includefiles[a].file.getFunsScript(this.useFuns);if(i.length>0){this.includefiles[a].curUseID=s;r[0]=i+r[0]}}}return r};i.__id=1;return i}();i=function(){function t(t){this.script=null;this.codes={};this.funs={};this.curUseID=-1;this.funnames="";this.script=t;var e=0,i=0,n=0;while(true){e=t.indexOf("#begin",e);if(e<0)break;n=e+5;while(true){n=t.indexOf("#end",n);if(n<0)break;if(t.charAt(n+4)==="i")n+=5;else break}if(n<0){throw"add include err,no #end:"+t;return}i=t.indexOf("\n",e);var r=y.splitToWords(t.substr(e,i-e),null);if(r[1]=="code"){this.codes[r[2]]=t.substr(i+1,n-i-1)}else if(r[1]=="function"){i=t.indexOf("function",e);i+="function".length;this.funs[r[3]]=t.substr(i+1,n-i-1);this.funnames+=r[3]+";"}e=n+1}}v(t,"");var e=t.prototype;e.getWith=function(t){var e=t?this.codes[t]:this.script;if(!e){throw"get with error:"+t}return e};e.getFunsScript=function(t){var e="";for(var i in this.funs){if(t.indexOf(i+";")>=0){e+=this.funs[i]}}return e};return t}()};return y}();var Nt=function(){function a(){}v(a,"laya.webgl.WebGL");a._uint8ArraySlice=function(){var t=this;var e=t.length;var i=new Uint8Array(t.length);for(var n=0;n<e;n++)i[n]=t[n];return i};a._float32ArraySlice=function(){var t=this;var e=t.length;var i=new Float32Array(t.length);for(var n=0;n<e;n++)i[n]=t[n];return i};a._uint16ArraySlice=function(t){var e=arguments;var i=this;var n=0;var r;var s=0;if(e.length===0){n=i.length;r=new Uint16Array(n);for(s=0;s<n;s++)r[s]=i[s]}else if(e.length===2){var a=e[0];var o=e[1];if(o>a){n=o-a;r=new Uint16Array(n);for(s=a;s<o;s++)r[s-a]=i[s]}else{r=new Uint16Array(0)}}return r};a.expandContext=function(){var t=l.prototype;var e=CanvasRenderingContext2D.prototype;e.fillTrangles=t.fillTrangles;ce.__int__(null);e.setIBVB=function(t,e,i,n,r,s,a,o,h,l){h===void 0&&(h=0);l===void 0&&(l=0);if(i===null){this._ib=this._ib||pe.QuadrangleIB;i=this._ib;Lt.expandIBQuadrangle(i,n._byteLength/(4*16)+8)}this._setIBVB(t,e,i,n,r,s,a,o,h,l)};e.fillTrangles=function(t,e,i,n,r){this._curMat=this._curMat||A.create();this._vb=this._vb||ve.create();if(!this._ib){this._ib=pe.create();Lt.fillIBQuadrangle(this._ib,a/4)}var s=this._vb;var a=n.length>>4;Lt.fillTranglesVB(s,e,i,n,r||this._curMat,0,0);Lt.expandIBQuadrangle(this._ib,s._byteLength/(4*16)+8);var o=new Ut(1,0);o.textureHost=t;var h=new de("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; void main() {vec4 color= texture2D(texture, v_texcoord); color.a*=1.0; gl_FragColor= color;}");s._vertType=3;this._setIBVB(e,i,this._ib,s,a*6,r,h,o,0,0)}};a.enable=function(){_.__init__();if(L.isConchApp){if(!L.isConchWebGL){N.skinAniSprite=function(){var t=new ft;return t};a.expandContext();return false}}N.getWebGLContext=function t(e){var i;var n=["webgl","experimental-webgl","webkit-3d","moz-webgl"];for(var r=0;r<n.length;r++){try{i=e.getContext(n[r],{stencil:T.isStencil,alpha:T.isAlpha,antialias:T.isAntialias,premultipliedAlpha:T.premultipliedAlpha,preserveDrawingBuffer:T.preserveDrawingBuffer})}catch(t){}if(i)return i}return null};a.mainContext=N.getWebGLContext(L._mainCanvas);if(a.mainContext==null)return false;if(L.isWebGL)return true;b.create=function(t,e){return new ge(t,e)};x.create=function(t,e,i,n,r,s,a){return new le(t,e,i,n,r,s,a)};L.WebGL=a;L.isWebGL=true;At.__init__();N.createRenderSprite=function(t,e){return new Gt(t,e)};N.createWebGLContext2D=function(t){return new Ft(t)};N.changeWebGLSize=function(t,e){laya.webgl.WebGL.onStageResize(t,e)};N.createGraphics=function(){return new Bt};var t=N.createFilterAction;N.createFilterAction=t?t:function(t){return new Vt};N.clear=function(t){Dt.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var e=L.context.ctx;var i=e._submits._length==0||T.preserveDrawingBuffer?p.create(t)._color:B._wgColor;if(i)e.clearBG(i[0],i[1],i[2],i[3]);Dt.clear()};N.addToAtlas=function(t,e){e===void 0&&(e=false);var i=t.bitmap;if(!L.optimizeTextureMemory(t.url,t)){i.enableMerageInAtlas=false;return}if(w.__typeof(i,"laya.webgl.resource.IMergeAtlasBitmap")&&i.allowMerageInAtlas){i.on("recovered",t,t.addTextureToAtlas)}};N.isAtlas=function(t){return t instanceof laya.webgl.atlas.AtlasWebGLCanvas};Q._enable();N.beginFlush=function(){var t=Q.instance;var e=t.getAtlaserCount();for(var i=0;i<e;i++){var n=t.getAtlaserByIndex(i).texture;n._flashCacheImageNeedFlush&&N.flashFlushImage(n)}};N.drawToCanvas=function(t,e,i,n,r,s){if(i<=0||n<=0){console.log("[error] canvasWidth and canvasHeight should greater than zero")}i|=0;n|=0;r|=0;s|=0;var a=Qt.create(i,n,6408,5121,0,false);a.start();a.clear(0,0,0,0);L.context.clear();k.renders[e]._fun(t,L.context,r,Dt.height-n+s);L.context.flush();a.end();var o=a.getData(0,0,i,n);a.recycle();if(o.byteLength!=i*n*4){console.log("drawToCanvas error: w:"+i+",h:"+n+",datalen:"+o.byteLength);return}var h=new ae;h._canvas=_.createElement("canvas");h.size(i,n);var l=h._canvas.getContext("2d");_.canvas.size(i,n);var u=_.context;var c=u.createImageData(i,n);c.data.set(new Uint8ClampedArray(o.buffer));h._imgData=c;u.putImageData(c,0,0);l.save();l.translate(0,n);l.scale(1,-1);l.drawImage(_.canvas.source,0,0);l.restore();return h};N.createFilterAction=function(t){var e;switch(t){case 32:e=new Vt;break}return e};N.addTextureToAtlas=function(t){t._uvID++;Q._atlasRestore++;t.bitmap.enableMerageInAtlas&&Q.instance.addToAtlas(t)};N.getTexturePixels=function(t,e,i,n,r){L.context.ctx.clear();var s=new O;s.graphics.drawTexture(t,-e,-i);var a=Qt.create(n,r);a.start();a.clear(0,0,0,0);s.render(L.context,0,0);L.context.ctx.flush();a.end();var o=a.getData(0,0,n,r);var h=[];var l=0;for(var u=r-1;u>=0;u--){for(var c=0;c<n;c++){l=(u*n+c)*4;h.push(o[l]);h.push(o[l+1]);h.push(o[l+2]);h.push(o[l+3])}}return h};N.skinAniSprite=function(){var t=new ft;return t};m.create=function(t,e){var i=new ae;i._imgData=e;i.flipY=false;return i};S._filterStart=function(t,e,i,n,r){var s=t.getValue("bounds");var a=Qt.create(s.width,s.height);a.start();a.clear(0,0,0,0);t.addValue("src",a);t.addValue("ScissorTest",Dt.worldScissorTest);if(Dt.worldScissorTest){var o=new I;o.copyFrom(i.ctx._clipRect);t.addValue("clipRect",o);Dt.worldScissorTest=false;laya.webgl.WebGL.mainContext.disable(3089)}};S._filterEnd=function(t,e,i,n,r){var s=t.getValue("bounds");var a=t.getValue("src");a.end();var o=Qt.create(s.width,s.height);o.start();o.clear(0,0,0,0);t.addValue("out",o);e._set$P("_filterCache",o);e._set$P("_isHaveGlowFilter",t.getValue("_isHaveGlowFilter"))};S._EndTarget=function(t,e){var i=t.getValue("src");i.recycle();var n=t.getValue("out");n.end();var r=t.getValue("ScissorTest");if(r){Dt.worldScissorTest=true;laya.webgl.WebGL.mainContext.enable(3089);e.ctx.save();var s=t.getValue("clipRect");e.ctx.clipRect(s.x,s.y,s.width,s.height)}};S._useSrc=function(t){var e=t.getValue("out");e.end();e=t.getValue("src");e.start();e.clear(0,0,0,0)};S._endSrc=function(t){var e=t.getValue("src");e.end()};S._useOut=function(t){var e=t.getValue("src");e.end();e=t.getValue("out");e.start();e.clear(0,0,0,0)};S._endOut=function(t){var e=t.getValue("out");e.end()};S._recycleScope=function(t){t.recycle()};S._filter=function(t,e,i,n){var r=this._next;if(r){var s=t.filters,a=s.length;if(a==1&&s[0].type==32){e.ctx.save();e.ctx.setFilters([s[0]]);r._fun.call(r,t,e,i,n);e.ctx.restore();return}var o;var h;var l=xt.create();var u=M.TEMP;var c=e.ctx._getTransformMatrix();var f=A.create();c.copyTo(f);var _=0;var d=0;var p=false;var v=t._$P._filterCache?t._$P._filterCache:null;if(!v||t._repaint){p=t._isHaveGlowFilter();l.addValue("_isHaveGlowFilter",p);if(p){_=50;d=25}h=new I;h.copyFrom(t.getSelfBounds());h.x+=t.x;h.y+=t.y;h.x-=t.pivotX+4;h.y-=t.pivotY+4;var g=h.x;var m=h.y;h.width+=_+8;h.height+=_+8;u.x=h.x*f.a+h.y*f.c;u.y=h.y*f.d+h.x*f.b;h.x=u.x;h.y=u.y;u.x=h.width*f.a+h.height*f.c;u.y=h.height*f.d+h.width*f.b;h.width=u.x;h.height=u.y;if(h.width<=0||h.height<=0){return}v&&v.recycle();l.addValue("bounds",h);var y=bt.create([l,t,e,0,0],S._filterStart);e.addRenderObject(y);e.ctx._renderKey=0;e.ctx._shader2D.glTexture=null;var b=t.x-g+d;var x=t.y-m+d;r._fun.call(r,t,e,b,x);y=bt.create([l,t,e,0,0],S._filterEnd);e.addRenderObject(y);for(var w=0;w<a;w++){if(w!=0){y=bt.create([l],S._useSrc);e.addRenderObject(y);o=Ut.create(1,0);A.TEMP.identity();e.ctx.drawTarget(l,0,0,h.width,h.height,A.TEMP,"out",o,null,tt.TOINT.overlay);y=bt.create([l],S._useOut);e.addRenderObject(y)}var T=s[w];T.action.apply3d(l,t,e,0,0)}y=bt.create([l,e],S._EndTarget);e.addRenderObject(y)}else{p=t._$P._isHaveGlowFilter?t._$P._isHaveGlowFilter:false;if(p){_=50;d=25}h=t.getBounds();if(h.width<=0||h.height<=0){return}h.width+=_;h.height+=_;u.x=h.x*f.a+h.y*f.c;u.y=h.y*f.d+h.x*f.b;h.x=u.x;h.y=u.y;u.x=h.width*f.a+h.height*f.c;u.y=h.height*f.d+h.width*f.b;h.width=u.x;h.height=u.y;l.addValue("out",v)}i=i-d-t.x;n=n-d-t.y;u.setTo(i,n);f.transformPoint(u);i=u.x+h.x;n=u.y+h.y;o=Ut.create(1,0);A.TEMP.identity();e.ctx.drawTarget(l,i,n,h.width,h.height,A.TEMP,"out",o,null,tt.TOINT.overlay);y=bt.create([l],S._recycleScope);e.addRenderObject(y);f.destroy()}};Float32Array.prototype.slice||(Float32Array.prototype.slice=a._float32ArraySlice);Uint16Array.prototype.slice||(Uint16Array.prototype.slice=a._uint16ArraySlice);Uint8Array.prototype.slice||(Uint8Array.prototype.slice=a._uint8ArraySlice);return true};a.onStageResize=function(t,e){if(a.mainContext==null)return;a.mainContext.viewport(0,0,t,e);Dt.width=t;Dt.height=e};a.onInvalidGLRes=function(){Q.instance.freeAll();R.releaseContentManagers(true);a.doNodeRepaint(w.stage);a.mainContext.viewport(0,0,Dt.width,Dt.height);w.stage.event("devicelost")};a.doNodeRepaint=function(t){t.numChildren==0&&t.repaint();for(var e=0;e<t.numChildren;e++)a.doNodeRepaint(t.getChildAt(e))};a.init=function(t,e,i){a.mainCanvas=t;m._createContext=function(t){return new Ft(t)};ae._createContext=function(t){return new Ft(t)};var n=laya.webgl.WebGL.mainContext;if(n.getShaderPrecisionFormat!=null){var r=n.getShaderPrecisionFormat(35633,36338);var s=n.getShaderPrecisionFormat(35632,36338);a.shaderHighPrecision=r.precision&&s.precision?true:false}else{a.shaderHighPrecision=false}a.compressAstc=n.getExtension("WEBGL_compressed_texture_astc");a.compressAtc=n.getExtension("WEBGL_compressed_texture_atc");a.compressEtc=n.getExtension("WEBGL_compressed_texture_etc");a.compressEtc1=n.getExtension("WEBGL_compressed_texture_etc1");a.compressPvrtc=n.getExtension("WEBGL_compressed_texture_pvrtc");a.compressS3tc=n.getExtension("WEBGL_compressed_texture_s3tc");a.compressS3tc_srgb=n.getExtension("WEBGL_compressed_texture_s3tc_srgb");n.deleteTexture1=n.deleteTexture;n.deleteTexture=function(t){if(t==Ot.curBindTexValue){Ot.curBindTexValue=null}n.deleteTexture1(t)};a.onStageResize(e,i);if(a.mainContext==null)throw new Error("webGL getContext err!");V.__init__();Q.__init__();zt.__init__();yt.__init__();Ft.__init__();Ut.__init__();ut.__init__();ce.__int__(n);tt._init_(n);if(L.isConchApp){conch.setOnInvalidGLRes(a.onInvalidGLRes)}};a.compressAstc=null;a.compressAtc=null;a.compressEtc=null;a.compressEtc1=null;a.compressPvrtc=null;a.compressS3tc=null;a.compressS3tc_srgb=null;a.mainCanvas=null;a.mainContext=null;a.antialias=true;a.shaderHighPrecision=false;a._bg_null=[0,0,0,0];return a}();var Ot=function(){function n(){}v(n,"laya.webgl.WebGLContext");n.UseProgram=function(t){if(n._useProgram===t)return false;Nt.mainContext.useProgram(t);n._useProgram=t;return true};n.setDepthTest=function(t,e){e!==n._depthTest&&(n._depthTest=e,e?t.enable(2929):t.disable(2929))};n.setDepthMask=function(t,e){e!==n._depthMask&&(n._depthMask=e,t.depthMask(e))};n.setDepthFunc=function(t,e){e!==n._depthFunc&&(n._depthFunc=e,t.depthFunc(e))};n.setBlend=function(t,e){e!==n._blend&&(n._blend=e,e?t.enable(3042):t.disable(3042))};n.setBlendFunc=function(t,e,i){(e!==n._sFactor||i!==n._dFactor)&&(n._sFactor=e,n._dFactor=i,t.blendFunc(e,i))};n.setCullFace=function(t,e){e!==n._cullFace&&(n._cullFace=e,e?t.enable(2884):t.disable(2884))};n.setFrontFace=function(t,e){e!==n._frontFace&&(n._frontFace=e,t.frontFace(e))};n.bindTexture=function(t,e,i){t.bindTexture(e,i);n.curBindTexTarget=e;n.curBindTexValue=i};n.DEPTH_BUFFER_BIT=256;n.STENCIL_BUFFER_BIT=1024;n.COLOR_BUFFER_BIT=16384;n.POINTS=0;n.LINES=1;n.LINE_LOOP=2;n.LINE_STRIP=3;n.TRIANGLES=4;n.TRIANGLE_STRIP=5;n.TRIANGLE_FAN=6;n.ZERO=0;n.ONE=1;n.SRC_COLOR=768;n.ONE_MINUS_SRC_COLOR=769;n.SRC_ALPHA=770;n.ONE_MINUS_SRC_ALPHA=771;n.DST_ALPHA=772;n.ONE_MINUS_DST_ALPHA=773;n.DST_COLOR=774;n.ONE_MINUS_DST_COLOR=775;n.SRC_ALPHA_SATURATE=776;n.FUNC_ADD=32774;n.BLEND_EQUATION=32777;n.BLEND_EQUATION_RGB=32777;n.BLEND_EQUATION_ALPHA=34877;n.FUNC_SUBTRACT=32778;n.FUNC_REVERSE_SUBTRACT=32779;n.BLEND_DST_RGB=32968;n.BLEND_SRC_RGB=32969;n.BLEND_DST_ALPHA=32970;n.BLEND_SRC_ALPHA=32971;n.CONSTANT_COLOR=32769;n.ONE_MINUS_CONSTANT_COLOR=32770;n.CONSTANT_ALPHA=32771;n.ONE_MINUS_CONSTANT_ALPHA=32772;n.BLEND_COLOR=32773;n.ARRAY_BUFFER=34962;n.ELEMENT_ARRAY_BUFFER=34963;n.ARRAY_BUFFER_BINDING=34964;n.ELEMENT_ARRAY_BUFFER_BINDING=34965;n.STREAM_DRAW=35040;n.STATIC_DRAW=35044;n.DYNAMIC_DRAW=35048;n.BUFFER_SIZE=34660;n.BUFFER_USAGE=34661;n.CURRENT_VERTEX_ATTRIB=34342;n.FRONT=1028;n.BACK=1029;n.CULL_FACE=2884;n.FRONT_AND_BACK=1032;n.BLEND=3042;n.DITHER=3024;n.STENCIL_TEST=2960;n.DEPTH_TEST=2929;n.SCISSOR_TEST=3089;n.POLYGON_OFFSET_FILL=32823;n.SAMPLE_ALPHA_TO_COVERAGE=32926;n.SAMPLE_COVERAGE=32928;n.NO_ERROR=0;n.INVALID_ENUM=1280;n.INVALID_VALUE=1281;n.INVALID_OPERATION=1282;n.OUT_OF_MEMORY=1285;n.CW=2304;n.CCW=2305;n.LINE_WIDTH=2849;n.ALIASED_POINT_SIZE_RANGE=33901;n.ALIASED_LINE_WIDTH_RANGE=33902;n.CULL_FACE_MODE=2885;n.FRONT_FACE=2886;n.DEPTH_RANGE=2928;n.DEPTH_WRITEMASK=2930;n.DEPTH_CLEAR_VALUE=2931;n.DEPTH_FUNC=2932;n.STENCIL_CLEAR_VALUE=2961;n.STENCIL_FUNC=2962;n.STENCIL_FAIL=2964;n.STENCIL_PASS_DEPTH_FAIL=2965;n.STENCIL_PASS_DEPTH_PASS=2966;n.STENCIL_REF=2967;n.STENCIL_VALUE_MASK=2963;n.STENCIL_WRITEMASK=2968;n.STENCIL_BACK_FUNC=34816;n.STENCIL_BACK_FAIL=34817;n.STENCIL_BACK_PASS_DEPTH_FAIL=34818;n.STENCIL_BACK_PASS_DEPTH_PASS=34819;n.STENCIL_BACK_REF=36003;n.STENCIL_BACK_VALUE_MASK=36004;n.STENCIL_BACK_WRITEMASK=36005;n.VIEWPORT=2978;n.SCISSOR_BOX=3088;n.COLOR_CLEAR_VALUE=3106;n.COLOR_WRITEMASK=3107;n.UNPACK_ALIGNMENT=3317;n.PACK_ALIGNMENT=3333;n.MAX_TEXTURE_SIZE=3379;n.MAX_VIEWPORT_DIMS=3386;n.SUBPIXEL_BITS=3408;n.RED_BITS=3410;n.GREEN_BITS=3411;n.BLUE_BITS=3412;n.ALPHA_BITS=3413;n.DEPTH_BITS=3414;n.STENCIL_BITS=3415;n.POLYGON_OFFSET_UNITS=10752;n.POLYGON_OFFSET_FACTOR=32824;n.TEXTURE_BINDING_2D=32873;n.SAMPLE_BUFFERS=32936;n.SAMPLES=32937;n.SAMPLE_COVERAGE_VALUE=32938;n.SAMPLE_COVERAGE_INVERT=32939;n.NUM_COMPRESSED_TEXTURE_FORMATS=34466;n.COMPRESSED_TEXTURE_FORMATS=34467;n.DONT_CARE=4352;n.FASTEST=4353;n.NICEST=4354;n.GENERATE_MIPMAP_HINT=33170;n.BYTE=5120;n.UNSIGNED_BYTE=5121;n.SHORT=5122;n.UNSIGNED_SHORT=5123;n.INT=5124;n.UNSIGNED_INT=5125;n.FLOAT=5126;n.DEPTH_COMPONENT=6402;n.ALPHA=6406;n.RGB=6407;n.RGBA=6408;n.LUMINANCE=6409;n.LUMINANCE_ALPHA=6410;n.UNSIGNED_SHORT_4_4_4_4=32819;n.UNSIGNED_SHORT_5_5_5_1=32820;n.UNSIGNED_SHORT_5_6_5=33635;n.FRAGMENT_SHADER=35632;n.VERTEX_SHADER=35633;n.MAX_VERTEX_ATTRIBS=34921;n.MAX_VERTEX_UNIFORM_VECTORS=36347;n.MAX_VARYING_VECTORS=36348;n.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661;n.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660;n.MAX_TEXTURE_IMAGE_UNITS=34930;n.MAX_FRAGMENT_UNIFORM_VECTORS=36349;n.SHADER_TYPE=35663;n.DELETE_STATUS=35712;n.LINK_STATUS=35714;n.VALIDATE_STATUS=35715;n.ATTACHED_SHADERS=35717;n.ACTIVE_UNIFORMS=35718;n.ACTIVE_ATTRIBUTES=35721;n.SHADING_LANGUAGE_VERSION=35724;n.CURRENT_PROGRAM=35725;n.NEVER=512;n.LESS=513;n.EQUAL=514;n.LEQUAL=515;n.GREATER=516;n.NOTEQUAL=517;n.GEQUAL=518;n.ALWAYS=519;n.KEEP=7680;n.REPLACE=7681;n.INCR=7682;n.DECR=7683;n.INVERT=5386;n.INCR_WRAP=34055;n.DECR_WRAP=34056;n.VENDOR=7936;n.RENDERER=7937;n.VERSION=7938;n.NEAREST=9728;n.LINEAR=9729;n.NEAREST_MIPMAP_NEAREST=9984;n.LINEAR_MIPMAP_NEAREST=9985;n.NEAREST_MIPMAP_LINEAR=9986;n.LINEAR_MIPMAP_LINEAR=9987;n.TEXTURE_MAG_FILTER=10240;n.TEXTURE_MIN_FILTER=10241;n.TEXTURE_WRAP_S=10242;n.TEXTURE_WRAP_T=10243;n.TEXTURE_2D=3553;n.TEXTURE=5890;n.TEXTURE_CUBE_MAP=34067;n.TEXTURE_BINDING_CUBE_MAP=34068;n.TEXTURE_CUBE_MAP_POSITIVE_X=34069;n.TEXTURE_CUBE_MAP_NEGATIVE_X=34070;n.TEXTURE_CUBE_MAP_POSITIVE_Y=34071;n.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072;n.TEXTURE_CUBE_MAP_POSITIVE_Z=34073;n.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074;n.MAX_CUBE_MAP_TEXTURE_SIZE=34076;n.TEXTURE0=33984;n.TEXTURE1=33985;n.TEXTURE2=33986;n.TEXTURE3=33987;n.TEXTURE4=33988;n.TEXTURE5=33989;n.TEXTURE6=33990;n.TEXTURE7=33991;n.TEXTURE8=33992;n.TEXTURE9=33993;n.TEXTURE10=33994;n.TEXTURE11=33995;n.TEXTURE12=33996;n.TEXTURE13=33997;n.TEXTURE14=33998;n.TEXTURE15=33999;n.TEXTURE16=34e3;n.TEXTURE17=34001;n.TEXTURE18=34002;n.TEXTURE19=34003;n.TEXTURE20=34004;n.TEXTURE21=34005;n.TEXTURE22=34006;n.TEXTURE23=34007;n.TEXTURE24=34008;n.TEXTURE25=34009;n.TEXTURE26=34010;n.TEXTURE27=34011;n.TEXTURE28=34012;n.TEXTURE29=34013;n.TEXTURE30=34014;n.TEXTURE31=34015;n.ACTIVE_TEXTURE=34016;n.REPEAT=10497;n.CLAMP_TO_EDGE=33071;n.MIRRORED_REPEAT=33648;n.FLOAT_VEC2=35664;n.FLOAT_VEC3=35665;n.FLOAT_VEC4=35666;n.INT_VEC2=35667;n.INT_VEC3=35668;n.INT_VEC4=35669;n.BOOL=35670;n.BOOL_VEC2=35671;n.BOOL_VEC3=35672;n.BOOL_VEC4=35673;n.FLOAT_MAT2=35674;n.FLOAT_MAT3=35675;n.FLOAT_MAT4=35676;n.SAMPLER_2D=35678;n.SAMPLER_CUBE=35680;n.VERTEX_ATTRIB_ARRAY_ENABLED=34338;n.VERTEX_ATTRIB_ARRAY_SIZE=34339;n.VERTEX_ATTRIB_ARRAY_STRIDE=34340;n.VERTEX_ATTRIB_ARRAY_TYPE=34341;n.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922;n.VERTEX_ATTRIB_ARRAY_POINTER=34373;n.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975;n.COMPILE_STATUS=35713;n.LOW_FLOAT=36336;n.MEDIUM_FLOAT=36337;n.HIGH_FLOAT=36338;n.LOW_INT=36339;n.MEDIUM_INT=36340;n.HIGH_INT=36341;n.FRAMEBUFFER=36160;n.RENDERBUFFER=36161;n.RGBA4=32854;n.RGB5_A1=32855;n.RGB565=36194;n.DEPTH_COMPONENT16=33189;n.STENCIL_INDEX=6401;n.STENCIL_INDEX8=36168;n.DEPTH_STENCIL=34041;n.RENDERBUFFER_WIDTH=36162;n.RENDERBUFFER_HEIGHT=36163;n.RENDERBUFFER_INTERNAL_FORMAT=36164;n.RENDERBUFFER_RED_SIZE=36176;n.RENDERBUFFER_GREEN_SIZE=36177;n.RENDERBUFFER_BLUE_SIZE=36178;n.RENDERBUFFER_ALPHA_SIZE=36179;n.RENDERBUFFER_DEPTH_SIZE=36180;n.RENDERBUFFER_STENCIL_SIZE=36181;n.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048;n.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049;n.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050;n.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051;n.COLOR_ATTACHMENT0=36064;n.DEPTH_ATTACHMENT=36096;n.STENCIL_ATTACHMENT=36128;n.DEPTH_STENCIL_ATTACHMENT=33306;n.NONE=0;n.FRAMEBUFFER_COMPLETE=36053;n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054;n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055;n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057;n.FRAMEBUFFER_UNSUPPORTED=36061;n.FRAMEBUFFER_BINDING=36006;n.RENDERBUFFER_BINDING=36007;n.MAX_RENDERBUFFER_SIZE=34024;n.INVALID_FRAMEBUFFER_OPERATION=1286;n.UNPACK_FLIP_Y_WEBGL=37440;n.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441;n.CONTEXT_LOST_WEBGL=37442;n.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443;n.BROWSER_DEFAULT_WEBGL=37444;n._useProgram=null;n._depthTest=true;n._depthMask=true;n._blend=false;n._cullFace=false;n.curBindTexTarget=null;n.curBindTexValue=null;a(n,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]);return n}();var Bt=function(t){function e(){e.__super.call(this)}v(e,"laya.webgl.display.GraphicsGL",t);var i=e.prototype;i.setShader=function(t){this._saveToCmd(L.context._setShader,[t])};i.setIBVB=function(t,e,i,n,r,s){this._saveToCmd(L.context._setIBVB,[t,e,i,n,r,s])};i.drawParticle=function(t,e,i){var n=N.createParticleTemplate2D(i);n.x=t;n.y=e;this._saveToCmd(L.context._drawParticle,[n])};return e}(g);var Ft=function(t){var i;function Y(t){this._x=0;this._y=0;this._id=++Y._COUNT;this._path=null;this._drawCount=1;this._maxNumEle=0;this._clear=false;this._isMain=false;this._atlasResourceChange=0;this._submits=null;this._curSubmit=null;this._ib=null;this._vb=null;this._nBlendType=0;this._saveMark=null;this._shader2D=null;this.meshlist=[];this.mId=-1;this.mHaveKey=false;this.mHaveLineKey=false;this.mX=0;this.mY=0;Y.__super.call(this);this._width=99999999;this._height=99999999;this._clipRect=Y.MAXCLIPRECT;this.mOutPoint;this._canvas=t;Y._contextcount++;if(L.isFlash){this._ib=pe.create(35044);Lt.fillIBQuadrangle(this._ib,16)}else this._ib=pe.QuadrangleIB;this.clear()}v(Y,"laya.webgl.canvas.WebGLContext2D",t);var e=Y.prototype;e.setIsMainContext=function(){this._isMain=true};e.clearBG=function(t,e,i,n){var r=Nt.mainContext;r.clearColor(t,e,i,n);r.clear(16384)};e._getSubmits=function(){return this._submits};e._releaseMem=function(){if(!this._submits)return;this._curMat.destroy();this._curMat=null;this._shader2D.destroy();this._shader2D=null;for(var t=0,e=this._submits._length;t<e;t++)this._submits[t].releaseRender();this._submits.length=0;this._submits._length=0;this._submits=null;this._curSubmit=null;this._path&&this._path.recover();this._path=null;this._other&&(this._other.font=null);this._save=null;if(this._vb){this._vb.releaseResource();this._vb.destroy();this._vb.destory();this._vb=null}};e.destroy=function(){--Y._contextcount;this.sprite=null;this._releaseMem();this._targets&&this._targets.destroy();this._targets=null;this._canvas=null;this._ib&&this._ib!=pe.QuadrangleIB&&this._ib.releaseResource()};e.clear=function(){if(!this._submits){this._other=i.DEFAULT;this._curMat=A.create();this._vb=ve.create(-1);this._submits=[];this._save=[at.Create(this)];this._save.length=10;this._shader2D=new ut;this._triangleMesh=qt.getAMesh()}this._vb.clear();this._targets&&(this._targets.repaint=true);this._other=i.DEFAULT;this._clear=true;this._repaint=false;this._drawCount=1;this._renderKey=0;this._other.lineWidth=this._shader2D.ALPHA=1;this._nBlendType=0;this._clipRect=Y.MAXCLIPRECT;this._curSubmit=yt.RENDERBASE;this._shader2D.glTexture=null;this._shader2D.fillStyle=this._shader2D.strokeStyle=et.DEFAULT;for(var t=0,e=this._submits._length;t<e;t++)this._submits[t].releaseRender();this._submits._length=0;this._curMat.identity();this._other.clear();this._saveMark=this._save[0];this._save._length=1};e.size=function(t,e){if(this._width!=t||this._height!=e){if(t==0||e==0){if(this._vb._byteLength!=0){this._width=t;this._height=e;this._vb.clear();this._vb.upload()}for(var i=0,n=this._submits._length;i<n;i++)this._submits[i].releaseRender();this._submits.length=0;this._submits._length=0;this._curSubmit=null;this._path&&this._path.recover();this._path=null;this.sprite=null;this._targets&&this._targets.destroy();this._targets=null}else{this._width=t;this._height=e;this._targets&&this._targets.size(t,e);this._canvas.memorySize-=this._canvas.memorySize}}if(t===0&&e===0)this._releaseMem()};e._getTransformMatrix=function(){return this._curMat};e.translate=function(t,e){if(t!==0||e!==0){ht.save(this);if(this._curMat.bTransform){ot.save(this);this._curMat.transformPointN(M.TEMP.setTo(t,e));t=M.TEMP.x;e=M.TEMP.y}this._x+=t;this._y+=e}};e.save=function(){this._save[this._save._length++]=at.Create(this)};e.restore=function(){var t=this._save._length;if(t<1)return;for(var e=t-1;e>=0;e--){var i=this._save[e];i.restore(this);if(i.isSaveMark()){this._save._length=e;return}}};e._fillText=function(t,e,i,n,r,s,a,o,h,l){l===void 0&&(l=0);var u=this._shader2D;var c=this._curSubmit.shaderValue;var f=r?Mt.create(r):this._other.font;if(Q.enabled){if(u.ALPHA!==c.ALPHA)u.glTexture=null;At.drawText(this,t,e,this._curMat,f,h||this._other.textAlign,s,a,o,i,n,l)}else{var _=this._shader2D.defines.getValue();var d=s?p.create(s)._color:u.colorAdd;if(u.ALPHA!==c.ALPHA||d!==u.colorAdd||c.colorAdd!==u.colorAdd){u.glTexture=null;u.colorAdd=d}At.drawText(this,t,e,this._curMat,f,h||this._other.textAlign,s,a,o,i,n,l)}};e.fillWords=function(t,e,i,n,r,s){this._fillText(null,t,e,i,n,r,null,-1,null,s)};e.fillBorderWords=function(t,e,i,n,r,s,a){this._fillBorderText(null,t,e,i,n,r,s,a,null)};e.fillText=function(t,e,i,n,r,s){this._fillText(t,null,e,i,n,r,null,-1,s)};e.strokeText=function(t,e,i,n,r,s,a){this._fillText(t,null,e,i,n,null,r,s||1,a)};e.fillBorderText=function(t,e,i,n,r,s,a,o){this._fillBorderText(t,null,e,i,n,r,s,a,o)};e._fillBorderText=function(t,e,i,n,r,s,a,o,h){if(!Q.enabled){this._fillText(t,e,i,n,r,null,a,o||1,h);this._fillText(t,e,i,n,r,s,null,-1,h);return}var l=this._shader2D;var u=this._curSubmit.shaderValue;if(l.ALPHA!==u.ALPHA)l.glTexture=null;var c=r?(Y._fontTemp.setFont(r),Y._fontTemp):this._other.font;At.drawText(this,t,e,this._curMat,c,h||this._other.textAlign,s,a,o||1,i,n,0)};e.fillRect=function(t,e,i,n,r){var s=this._vb;if(Lt.fillRectImgVb(s,this._clipRect,t,e,i,n,z.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var a=this._shader2D.fillStyle;r&&(this._shader2D.fillStyle=et.create(r));var o=this._shader2D;var h=this._curSubmit.shaderValue;if(o.fillStyle!==h.fillStyle||o.ALPHA!==h.ALPHA){o.glTexture=null;var l=this._curSubmit=yt.createSubmit(this,this._ib,s,(s._byteLength-16*4)/32*3,Ut.create(2,0));l.shaderValue.color=o.fillStyle._color._color;l.shaderValue.ALPHA=o.ALPHA;this._submits[this._submits._length++]=l}this._curSubmit._numEle+=6;this._shader2D.fillStyle=a}};e.fillTexture=function(t,e,i,n,r,s,a,o){if(!(t.loaded&&t.bitmap&&t.source)){if(this.sprite){w.timer.callLater(this,this._repaintSprite)}return}var h=this._vb;var l=t.bitmap.width,u=t.bitmap.height,c=t.uv;var f=a.x%t.width,_=a.y%t.height;if(l!=o.w||u!=o.h){if(!o.w&&!o.h){o.oy=o.ox=0;switch(s){case"repeat":o.width=n;o.height=r;break;case"repeat-x":o.width=n;if(_<0){if(t.height+_>r){o.height=r}else{o.height=t.height+_}}else{o.oy=_;if(t.height+_>r){o.height=r-_}else{o.height=t.height}}break;case"repeat-y":if(f<0){if(t.width+f>n){o.width=n}else{o.width=t.width+f}}else{o.ox=f;if(t.width+f>n){o.width=n-f}else{o.width=t.width}}o.height=r;break;case"no-repeat":if(f<0){if(t.width+f>n){o.width=n}else{o.width=t.width+f}}else{o.ox=f;if(t.width+f>n){o.width=n-f}else{o.width=t.width}}if(_<0){if(t.height+_>r){o.height=r}else{o.height=t.height+_}}else{o.oy=_;if(t.height+_>r){o.height=r-_}else{o.height=t.height}}break;default:o.width=n;o.height=r;break}}o.w=l;o.h=u;o.uv=[0,0,o.width/l,0,o.width/l,o.height/u,0,o.height/u]}e+=o.ox;i+=o.oy;f-=o.ox;_-=o.oy;if(Lt.fillRectImgVb(h,this._clipRect,e,i,o.width,o.height,o.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var d=Kt.create(this,this._ib,h,(h._byteLength-16*4)/32*3,Ut.create(256,0));this._submits[this._submits._length++]=d;var p=d.shaderValue;p.textureHost=t;var v=c[0]*l;var g=c[1]*u;var m=(c[2]-c[0])*l;var y=(c[5]-c[3])*u;var b=-f/l;var x=-_/u;p.u_TexRange[0]=v/l;p.u_TexRange[1]=m/l;p.u_TexRange[2]=g/u;p.u_TexRange[3]=y/u;p.u_offset[0]=b;p.u_offset[1]=x;if(Q.enabled&&!this._isMain)d.addTexture(t,(h._byteLength>>2)-16);this._curSubmit=d;d._renderType=10017;d._numEle+=6}};e.setShader=function(t){nt.save(this,1048576,this._shader2D,true);this._shader2D.shader=t};e.setFilters=function(t){nt.save(this,2097152,this._shader2D,true);this._shader2D.filters=t;this._curSubmit=yt.RENDERBASE;this._renderKey=0;this._drawCount++};e.drawTexture=function(t,e,i,n,r,s,a){this._drawTextureM(t,e,i,n,r,s,a,null,1)};e.addTextureVb=function(t,e,i){var n=this._curSubmit._vb||this._vb;var r=n._byteLength>>2;n.byteLength=r+16<<2;var s=n.getFloat32Array();for(var a=0,o=0;a<16;a+=4){s[r++]=t[a]+e;s[r++]=t[a+1]+i;s[r++]=t[a+2];s[r++]=t[a+3]}this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle);n._upload=true};e.willDrawTexture=function(t,e){if(!(t.loaded&&t.bitmap&&t.source)){if(this.sprite){w.timer.callLater(this,this._repaintSprite)}return 0}var i=t.bitmap;var n=i.id+this._shader2D.ALPHA*e+10016;if(n==this._renderKey)return n;var r=this._shader2D;var s=r.ALPHA;var a=this._curSubmit.shaderValue;r.ALPHA*=e;this._renderKey=n;this._drawCount++;r.glTexture=i;var o=this._vb;var h=null;var l=o._byteLength/32*3;h=Kt.create(this,this._ib,o,l,Ut.create(1,0));this._submits[this._submits._length++]=h;h.shaderValue.textureHost=t;h._renderType=10016;h._preIsSameTextureShader=this._curSubmit._renderType===10016&&r.ALPHA===a.ALPHA;this._curSubmit=h;r.ALPHA=s;return n};e.drawTextures=function(t,e,i,n){if(!(t.loaded&&t.bitmap&&t.source)){this.sprite&&w.timer.callLater(this,this._repaintSprite);return}var r=this._clipRect;this._clipRect=Y.MAXCLIPRECT;if(!this._drawTextureM(t,e[0],e[1],t.width,t.height,i,n,null,1)){alert("drawTextures err");return}this._clipRect=r;F.drawCall++;if(e.length<4)return;var s=this._curSubmit._vb||this._vb;var a=this._curMat.a,o=this._curMat.d;for(var h=2,l=e.length;h<l;h+=2){Lt.copyPreImgVb(s,(e[h]-e[h-2])*a,(e[h+1]-e[h-1])*o);this._curSubmit._numEle+=6}this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)};e._drawTextureM=function(t,e,i,n,r,s,a,o,h){if(!(t.loaded&&t.source)){if(this.sprite){w.timer.callLater(this,this._repaintSprite)}return false}var l=this._curSubmit._vb||this._vb;var u=t.bitmap;e+=s;i+=a;this._drawCount++;var c=u.id+this._shader2D.ALPHA*h+10016;if(c!=this._renderKey){this._renderKey=c;var f=this._curSubmit.shaderValue;var _=this._shader2D;var d=_.ALPHA;_.ALPHA*=h;_.glTexture=u;var p=this._vb;var v=null;var g=p._byteLength/32*3;v=Kt.create(this,this._ib,p,g,Ut.create(1,0));this._submits[this._submits._length++]=v;v.shaderValue.textureHost=t;v._renderType=10016;v._preIsSameTextureShader=this._curSubmit._renderType===10016&&_.ALPHA===f.ALPHA;this._curSubmit=v;l=this._curSubmit._vb||this._vb;_.ALPHA=d}if(Lt.fillRectImgVb(l,this._clipRect,e,i,n||t.width,r||t.height,t.uv,o||this._curMat,this._x,this._y,0,0)){if(Q.enabled&&!this._isMain)this._curSubmit.addTexture(t,(l._byteLength>>2)-16);this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle);return true}return false};e._repaintSprite=function(){if(this.sprite)this.sprite.repaint()};e._drawText=function(t,e,i,n,r,s,a,o,h,l){var u=t.bitmap;this._drawCount++;var c=u.id+this._shader2D.ALPHA+10016;if(c!=this._renderKey){this._renderKey=c;var f=this._curSubmit.shaderValue;var _=this._shader2D;_.glTexture=u;var d=this._vb;var p=null;var v=NaN;var g=d._byteLength/32*3;if(Q.enabled){p=Kt.create(this,this._ib,d,g,Ut.create(1,0))}else{p=Kt.create(this,this._ib,d,g,_e.create())}p._preIsSameTextureShader=this._curSubmit._renderType===10016&&_.ALPHA===f.ALPHA;this._submits[this._submits._length++]=p;p.shaderValue.textureHost=t;p._renderType=10016;this._curSubmit=p}t.active();var m=this._curSubmit._vb||this._vb;if(Lt.fillRectImgVb(m,this._clipRect,e+a,i+o,n||t.width,r||t.height,t.uv,s||this._curMat,this._x,this._y,h,l,true)){if(Q.enabled&&!this._isMain){this._curSubmit.addTexture(t,(m._byteLength>>2)-16)}this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}};e.drawTextureWithTransform=function(t,e,i,n,r,s,a,o,h){if(!s){this._drawTextureM(t,e,i,n,r,a,o,null,h);return}var l=this._curMat;var u=this._x;var c=this._y;(a!==0||o!==0)&&(this._x=a*l.a+o*l.c,this._y=o*l.d+a*l.b);if(s&&l.bTransform){A.mul(s,l,Y._tmpMatrix);s=Y._tmpMatrix;s._checkTransform()}else{this._x+=l.tx;this._y+=l.ty}this._drawTextureM(t,e,i,n,r,0,0,s,h);this._x=u;this._y=c};e.fillQuadrangle=function(t,e,i,n,r){var s=this._curSubmit;var a=this._vb;var o=this._shader2D;var h=s.shaderValue;this._renderKey=0;if(t.bitmap){var l=t.bitmap;if(o.glTexture!=l||o.ALPHA!==h.ALPHA){o.glTexture=l;s=this._curSubmit=yt.createSubmit(this,this._ib,a,a._byteLength/32*3,Ut.create(1,0));s.shaderValue.glTexture=l;this._submits[this._submits._length++]=s}Lt.fillQuadrangleImgVb(a,e,i,n,t.uv,r||this._curMat,this._x,this._y)}else{if(!s.shaderValue.fillStyle||!s.shaderValue.fillStyle.equal(t)||o.ALPHA!==h.ALPHA){o.glTexture=null;s=this._curSubmit=yt.createSubmit(this,this._ib,a,a._byteLength/32*3,Ut.create(2,0));s.shaderValue.defines.add(2);s.shaderValue.fillStyle=et.create(t);this._submits[this._submits._length++]=s}Lt.fillQuadrangleImgVb(a,e,i,n,z.DEF_UV,r||this._curMat,this._x,this._y)}s._numEle+=6};e.drawTexture2=function(t,e,i,n,r,s,a,o){if(s==0)return;var h=this._curMat;this._x=t*h.a+e*h.c;this._y=e*h.d+t*h.b;if(r){if(h.bTransform||r.bTransform){A.mul(r,h,Y._tmpMatrix);r=Y._tmpMatrix}else{this._x+=r.tx+h.tx;this._y+=r.ty+h.ty;r=A.EMPTY}}if(s===1&&!a)this._drawTextureM(o[0],o[1]-i,o[2]-n,o[3],o[4],0,0,r,1);else{var l=this._shader2D.ALPHA;var u=this._nBlendType;this._shader2D.ALPHA=s;a&&(this._nBlendType=tt.TOINT(a));this._drawTextureM(o[0],o[1]-i,o[2]-n,o[3],o[4],0,0,r,1);this._shader2D.ALPHA=l;this._nBlendType=u}this._x=this._y=0};e.drawCanvas=function(t,e,i,n,r){var s=t.context;this._renderKey=0;if(s._targets){this._submits[this._submits._length++]=$t.create(s,0,null);this._curSubmit=yt.RENDERBASE;s._targets.drawTo(this,e,i,n,r)}else{var a=this._submits[this._submits._length++]=$t.create(s,this._shader2D.ALPHA,this._shader2D.filters);var o=n/t.width;var h=r/t.height;var l=a._matrix;this._curMat.copyTo(l);o!=1&&h!=1&&l.scale(o,h);var u=l.tx,c=l.ty;l.tx=l.ty=0;l.transformPoint(M.TEMP.setTo(e,i));l.translate(M.TEMP.x+u,M.TEMP.y+c);this._curSubmit=yt.RENDERBASE}if(T.showCanvasMark){this.save();this.lineWidth=4;this.strokeStyle=s._targets?"yellow":"green";this.strokeRect(e-1,i-1,n+2,r+2,1);this.strokeRect(e,i,n,r,1);this.restore()}};e.drawTarget=function(t,e,i,n,r,s,a,o,h,l){l===void 0&&(l=-1);var u=this._vb;if(Lt.fillRectImgVb(u,this._clipRect,e,i,n,r,h||z.DEF_UV,s||this._curMat,this._x,this._y,0,0)){this._renderKey=0;var c=this._shader2D;c.glTexture=null;var f=this._curSubmit.shaderValue;var _=this._curSubmit=Ct.create(this,this._ib,u,(u._byteLength-16*4)/32*3,o,a);if(l==-1){_.blendType=this._nBlendType}else{_.blendType=l}_.scope=t;this._submits[this._submits._length++]=_;this._curSubmit._numEle+=6}};e.mixRGBandAlpha=function(t){return this._mixRGBandAlpha(t,this._shader2D.ALPHA)};e._mixRGBandAlpha=function(t,e){var i=(t&4278190080)>>>24;if(i!=0){i*=e}else{i=e*255}return t&16777215|i<<24};e.drawTriangles=function(t,e,i,n,r,s,a,o,h,l){if(!(t.loaded&&t.source)){if(this.sprite){w.timer.callLater(this,this._repaintSprite)}return false}this._drawCount++;var u=t.bitmap;var c=this._mixRGBandAlpha(4294967295,o);var f=n.length/2;var _=s.length;this._renderKey=-1;var d=this._curSubmit=Kt.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,Ut.create(1,0));d.shaderValue.textureHost=t;d._renderType=10016;this._submits[this._submits._length++]=d;if(a){Y._tmpMatrix.a=a.a;Y._tmpMatrix.b=a.b;Y._tmpMatrix.c=a.c;Y._tmpMatrix.d=a.d;Y._tmpMatrix.tx=a.tx+e;Y._tmpMatrix.ty=a.ty+i;A.mul(Y._tmpMatrix,this._curMat,Y._tmpMatrix)}else{Y._tmpMatrix.a=this._curMat.a;Y._tmpMatrix.b=this._curMat.b;Y._tmpMatrix.c=this._curMat.c;Y._tmpMatrix.d=this._curMat.d;Y._tmpMatrix.tx=this._curMat.tx+e;Y._tmpMatrix.ty=this._curMat.ty+i}this._triangleMesh.addData(n,r,s,Y._tmpMatrix,c,this);this._curSubmit._numEle+=_;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle);return true};e.transform=function(t,e,i,n,r,s){ot.save(this);A.mul(A.TEMP.setTo(t,e,i,n,r,s),this._curMat,this._curMat);this._curMat._checkTransform()};e.setTransformByMatrix=function(t){t.copyTo(this._curMat)};e.transformByMatrix=function(t){ot.save(this);A.mul(t,this._curMat,this._curMat);this._curMat._checkTransform()};e.rotate=function(t){ot.save(this);this._curMat.rotateEx(t)};e.scale=function(t,e){ot.save(this);this._curMat.scaleEx(t,e)};e.clipRect=function(t,e,i,n){if(this._curMat.b!=0||this._curMat.c!=0){this._renderKey=0;var r=St.create(4);this.addRenderObject(r);var s=this._vb;var a=s._byteLength>>2;if(Lt.fillRectImgVb(s,null,t,e,i,n,z.DEF_UV,this._curMat,this._x,this._y,0,0)){var o=this._shader2D;o.glTexture=null;var h=this._curSubmit=yt.createSubmit(this,this._ib,s,(s._byteLength-16*4)/32*3,Ut.create(2,0));h.shaderValue.ALPHA=1;this._submits[this._submits._length++]=h;this._curSubmit._numEle+=6}else{alert("clipRect calc stencil rect error")}var l=St.create(5);this.addRenderObject(l);var u=s.getFloat32Array();var c=Math.min(Math.min(Math.min(u[a+0],u[a+4]),u[a+8]),u[a+12]);var f=Math.max(Math.max(Math.max(u[a+0],u[a+4]),u[a+8]),u[a+12]);var _=Math.min(Math.min(Math.min(u[a+1],u[a+5]),u[a+9]),u[a+13]);var d=Math.max(Math.max(Math.max(u[a+1],u[a+5]),u[a+9]),u[a+13]);st.save(this,l,t,e,i,n,c,_,f-c,d-_);this._curSubmit=yt.RENDERBASE}else{i*=this._curMat.a;n*=this._curMat.d;var p=M.TEMP;this._curMat.transformPoint(p.setTo(t,e));if(i<0){p.x=p.x+i;i=-i}if(n<0){p.y=p.y+n;n=-n}this._renderKey=0;var v=this._curSubmit=Tt.create(this);this._submits[this._submits._length++]=v;v.submitIndex=this._submits._length;v.submitLength=9999999;rt.save(this,v);var g=this._clipRect;var m=g.x,y=g.y;var b=p.x+i,x=p.y+n;m<p.x&&(g.x=p.x);y<p.y&&(g.y=p.y);g.width=Math.min(b,m+g.width)-g.x;g.height=Math.min(x,y+g.height)-g.y;this._shader2D.glTexture=null;v.clipRect.copyFrom(g);this._curSubmit=yt.RENDERBASE}};e.setIBVB=function(t,e,i,n,r,s,a,o,h,l,u){h===void 0&&(h=0);l===void 0&&(l=0);u===void 0&&(u=0);if(i===null){if(!L.isFlash){i=this._ib}else{var c=n;c._selfIB||(c._selfIB=pe.create(35044));c._selfIB.clear();i=c._selfIB}Lt.expandIBQuadrangle(i,n._byteLength/(4*n.vertexStride*4))}if(!o||!a)throw Error("setIBVB must input:shader shaderValues");var f=wt.create(this,n,i,r,a,o,h,l,u);s||(s=A.EMPTY);s.translate(t,e);A.mul(s,this._curMat,f._mat);s.translate(-t,-e);this._submits[this._submits._length++]=f;this._curSubmit=yt.RENDERBASE;this._renderKey=0};e.addRenderObject=function(t){this._submits[this._submits._length++]=t};e.fillTrangles=function(t,e,i,n,r){var s=this._curSubmit;var a=this._vb;var o=this._shader2D;var h=s.shaderValue;var l=n.length>>4;var u=t.bitmap;this._renderKey=0;if(o.glTexture!=u||o.ALPHA!==h.ALPHA){s=this._curSubmit=yt.createSubmit(this,this._ib,a,a._byteLength/32*3,Ut.create(1,0));s.shaderValue.textureHost=t;this._submits[this._submits._length++]=s}Lt.fillTranglesVB(a,e,i,n,r||this._curMat,this._x,this._y);s._numEle+=l*6};e.submitElement=function(t,e){var i=this._submits;e<0&&(e=i._length);while(t<e){t+=i[t].renderSubmit()}};e.finish=function(){Nt.mainContext.finish()};e.flush=function(){var t=Math.max(this._vb._byteLength/(4*16),this._maxNumEle/6)+8;if(t>this._ib.bufferLength/(6*2)){Lt.expandIBQuadrangle(this._ib,t)}if(!this._isMain&&Q.enabled&&Q._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=Q._atlasRestore;var e=this._submits;for(var i=0,n=e._length;i<n;i++){var r=e[i];if(r.getRenderType()===10016)r.checkTexture()}}this.submitElement(0,this._submits._length);this._path&&this._path.reset();_t.instance&&_t.getInstance().reset();var s=0;for(i=0,s=this.meshlist.length;i<s;i++){var a=this.meshlist[i];a.canReuse?a.releaseMesh():a.destroy()}this.meshlist.length=0;this._curSubmit=yt.RENDERBASE;this._renderKey=0;this._triangleMesh=qt.getAMesh();this.meshlist.push(this._triangleMesh);return this._submits._length};e.setPathId=function(t){this.mId=t;if(this.mId!=-1){this.mHaveKey=false;var e=X.getInstance();if(e.shapeDic[this.mId]){this.mHaveKey=true}this.mHaveLineKey=false;if(e.shapeLineDic[this.mId]){this.mHaveLineKey=true}}};e.movePath=function(t,e){var i=t,n=e;t=this._curMat.a*i+this._curMat.c*n+this._curMat.tx;e=this._curMat.b*i+this._curMat.d*n+this._curMat.ty;this.mX+=t;this.mY+=e};e.beginPath=function(){var t=this._getPath();t.tempArray.length=0;t.closePath=false;this.mX=0;this.mY=0};e.closePath=function(){this._path.closePath=true};e.fill=function(t){t===void 0&&(t=false);var e=this._getPath();this.drawPoly(0,0,e.tempArray,this.fillStyle._color.numColor,0,0,t)};e.stroke=function(){var t=this._getPath();if(this.lineWidth>0){if(this.mId==-1){t.drawLine(0,0,t.tempArray,this.lineWidth,this.strokeStyle._color.numColor)}else{if(this.mHaveLineKey){var e=X.getInstance().shapeLineDic[this.mId];e.rebuild(t.tempArray);t.setGeomtry(e)}else{X.getInstance().addLine(this.mId,t.drawLine(0,0,t.tempArray,this.lineWidth,this.strokeStyle._color.numColor))}}t.update();var i=[this.mX,this.mY];var n=yt.createShape(this,t.ib,t.vb,t.count,t.offset,Ut.create(4,0));n.shaderValue.ALPHA=this._shader2D.ALPHA;n.shaderValue.u_pos=i;n.shaderValue.u_mmat2=Dt.TEMPMAT4_ARRAY;this._submits[this._submits._length++]=n;this._renderKey=-1}};e.line=function(t,e,i,n,r,s){var a=this._curSubmit;var o=this._vb;if(Lt.fillLineVb(o,this._clipRect,t,e,i,n,r,s)){this._renderKey=0;var h=this._shader2D;var l=a.shaderValue;if(h.strokeStyle!==l.strokeStyle||h.ALPHA!==l.ALPHA){h.glTexture=null;a=this._curSubmit=yt.createSubmit(this,this._ib,o,(o._byteLength-16*4)/32*3,Ut.create(2,0));a.shaderValue.strokeStyle=h.strokeStyle;a.shaderValue.mainID=2;a.shaderValue.ALPHA=h.ALPHA;this._submits[this._submits._length++]=a}a._numEle+=6}};e.moveTo=function(t,e,i){i===void 0&&(i=true);var n=this._getPath();if(i){var r=t,s=e;t=this._curMat.a*r+this._curMat.c*s;e=this._curMat.b*r+this._curMat.d*s}n.addPoint(t,e)};e.lineTo=function(t,e,i){i===void 0&&(i=true);var n=this._getPath();if(i){var r=t,s=e;t=this._curMat.a*r+this._curMat.c*s;e=this._curMat.b*r+this._curMat.d*s}n.addPoint(t,e)};e.drawCurves=function(t,e,i){this.setPathId(-1);this.beginPath();this.strokeStyle=i[3];this.lineWidth=i[4];var n=i[2];t+=i[0],e+=i[1];this.movePath(t,e);this.moveTo(n[0],n[1]);var r=2,s=n.length;while(r<s){this.quadraticCurveTo(n[r++],n[r++],n[r++],n[r++])}this.stroke()};e.arcTo=function(t,e,i,n,r){if(this.mId!=-1){if(this.mHaveKey){return}}var s=0;var a=0,o=0;var h=this._getPath();this._curMat.copyTo(Y._tmpMatrix);Y._tmpMatrix.tx=Y._tmpMatrix.ty=0;Y._tempPoint.setTo(h.getEndPointX(),h.getEndPointY());Y._tmpMatrix.invertTransformPoint(Y._tempPoint);var l=Y._tempPoint.x-t;var u=Y._tempPoint.y-e;var c=Math.sqrt(l*l+u*u);if(c<=1e-6){return}var f=l/c;var _=u/c;var d=i-t;var p=n-e;var v=d*d+p*p;var g=Math.sqrt(v);if(g<=1e-6){return}var m=d/g;var y=p/g;var b=f+m;var x=_+y;var w=Math.sqrt(b*b+x*x);if(w<=1e-6){return}var T=b/w;var S=x/w;var C=Math.acos(T*f+S*_);var E=Math.PI/2-C;c=r/Math.tan(E);var A=c*f+t;var M=c*_+e;var I=Math.sqrt(c*c+r*r);var L=t+T*I;var P=e+S*I;var k=c*m+t;var D=c*y+e;var R=f*y-_*m;var N=0;var O=0;var B=0;if(R>=0){N=E*2;var F=N/Y.SEGNUM;O=Math.sin(F);B=Math.cos(F)}else{N=-E*2;F=N/Y.SEGNUM;O=Math.sin(F);B=Math.cos(F)}a=this._curMat.a*A+this._curMat.c*M;o=this._curMat.b*A+this._curMat.d*M;if(a!=this._path.getEndPointX()||o!=this._path.getEndPointY()){h.addPoint(a,o)}var U=A-L;var G=M-P;var V=0;var W=0;for(s=0;s<Y.SEGNUM;s++){var z=U*B+G*O;var H=-U*O+G*B;a=z+L;o=H+P;t=this._curMat.a*a+this._curMat.c*o;e=this._curMat.b*a+this._curMat.d*o;a=t;o=e;if(a!=this._path.getEndPointX()||o!=this._path.getEndPointY()){h.addPoint(a,o)}U=z;G=H}};e.arc=function(t,e,i,n,r,s,a){s===void 0&&(s=false);a===void 0&&(a=true);if(this.mId!=-1){var o=X.getInstance().shapeDic[this.mId];if(o){if(this.mHaveKey&&!o.needUpdate(this._curMat))return}t=0;e=0}var h=0,l=0,u=0,c=0;var f=0,_=0,d=0,p=0,v=0,g=0;var m=0,y=0,b=0,x=0;var w=0,T=0,S=0;l=r-n;if(!s){if(Math.abs(l)>=Math.PI*2){l=Math.PI*2}else{while(l<0){l+=Math.PI*2}}}else{if(Math.abs(l)>=Math.PI*2){l=-Math.PI*2}else{while(l>0){l-=Math.PI*2}}}if(i<101){T=Math.max(10,l*i/5)}else if(i<201){T=Math.max(10,l*i/20)}else{T=Math.max(10,l*i/40)}u=l/T/2;c=Math.abs(4/3*(1-Math.cos(u))/Math.sin(u));if(s)c=-c;S=0;var C=this._getPath();var E=NaN,A=NaN;for(w=0;w<=T;w++){h=n+l*(w/T);f=Math.cos(h);_=Math.sin(h);d=t+f*i;p=e+_*i;if(a){E=d,A=p;d=this._curMat.a*E+this._curMat.c*A;p=this._curMat.b*E+this._curMat.d*A}if(d!=this._path.getEndPointX()||p!=this._path.getEndPointY()){C.addPoint(d,p)}}f=Math.cos(r);_=Math.sin(r);d=t+f*i;p=e+_*i;if(a){E=d,A=p;d=this._curMat.a*E+this._curMat.c*A;p=this._curMat.b*E+this._curMat.d*A}if(d!=this._path.getEndPointX()||p!=this._path.getEndPointY()){C.addPoint(d,p)}};e.quadraticCurveTo=function(t,e,i,n){var r=f.I;var s=[];var a=i,o=n;i=this._curMat.a*a+this._curMat.c*o;n=this._curMat.b*a+this._curMat.d*o;a=t,o=e;t=this._curMat.a*a+this._curMat.c*o;e=this._curMat.b*a+this._curMat.d*o;var h=r.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),t,e,i,n],30,2);for(var l=0,u=h.length/2;l<u;l++){this.lineTo(h[l*2],h[l*2+1],false)}this.lineTo(i,n,false)};e.rect=function(t,e,i,n){this._other=this._other.make();this._other.path||(this._other.path=new it);this._other.path.rect(t,e,i,n)};e.strokeRect=function(t,e,i,n,r){var s=r*.5;this.line(t-s,e,t+i+s,e,r,this._curMat);this.line(t+i,e,t+i,e+n,r,this._curMat);this.line(t,e,t,e+n,r,this._curMat);this.line(t-s,e+n,t+i+s,e+n,r,this._curMat)};e.clip=function(){};e.drawPoly=function(t,e,i,n,r,s,a){a===void 0&&(a=false);this._renderKey=0;this._shader2D.glTexture=null;var o=this._getPath();if(this.mId==-1){o.polygon(t,e,i,n,r?r:1,s)}else{if(this.mHaveKey){var h=X.getInstance().shapeDic[this.mId];h.setMatrix(this._curMat);h.rebuild(o.tempArray);o.setGeomtry(h)}else{var l=o.polygon(t,e,i,n,r?r:1,s);X.getInstance().addShape(this.mId,l);l.setMatrix(this._curMat)}}o.update();var u=[this.mX,this.mY];var c;c=yt.createShape(this,o.ib,o.vb,o.count,o.offset,Ut.create(4,0));c.shaderValue.ALPHA=this._shader2D.ALPHA;c.shaderValue.u_pos=u;c.shaderValue.u_mmat2=Dt.EMPTYMAT4_ARRAY;this._submits[this._submits._length++]=c;if(r>0){if(this.mHaveLineKey){var f=X.getInstance().shapeLineDic[this.mId];f.rebuild(o.tempArray);o.setGeomtry(f)}else{X.getInstance().addShape(this.mId,o.drawLine(t,e,i,r,s))}o.update();c=yt.createShape(this,o.ib,o.vb,o.count,o.offset,Ut.create(4,0));c.shaderValue.ALPHA=this._shader2D.ALPHA;c.shaderValue.u_mmat2=Dt.EMPTYMAT4_ARRAY;this._submits[this._submits._length++]=c}};e.drawParticle=function(t,e,i){i.x=t;i.y=e;this._submits[this._submits._length++]=i};e._getPath=function(){return this._path||(this._path=new it)};h(0,e,"globalCompositeOperation",function(){return tt.NAMES[this._nBlendType]},function(t){var e=tt.TOINT[t];e==null||this._nBlendType===e||(nt.save(this,65536,this,true),this._curSubmit=yt.RENDERBASE,this._renderKey=0,this._nBlendType=e)});h(0,e,"strokeStyle",function(){return this._shader2D.strokeStyle},function(t){this._shader2D.strokeStyle.equal(t)||(nt.save(this,512,this._shader2D,false),this._shader2D.strokeStyle=et.create(t))});h(0,e,"globalAlpha",function(){return this._shader2D.ALPHA},function(t){t=Math.floor(t*1e3)/1e3;if(t!=this._shader2D.ALPHA){nt.save(this,1,this._shader2D,true);this._shader2D.ALPHA=t}});h(0,e,"asBitmap",null,function(t){if(t){this._targets||(this._targets=new lt);this._targets.repaint=true;if(!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite);this._targets.size(this._width,this._height)}else this._targets=null});h(0,e,"fillStyle",function(){return this._shader2D.fillStyle},function(t){this._shader2D.fillStyle.equal(t)||(nt.save(this,2,this._shader2D,false),this._shader2D.fillStyle=et.create(t))});h(0,e,"textAlign",function(){return this._other.textAlign},function(t){this._other.textAlign===t||(this._other=this._other.make(),nt.save(this,32768,this._other,false),this._other.textAlign=t)});h(0,e,"lineWidth",function(){return this._other.lineWidth},function(t){this._other.lineWidth===t||(this._other=this._other.make(),nt.save(this,256,this._other,false),this._other.lineWidth=t)});h(0,e,"textBaseline",function(){return this._other.textBaseline},function(t){this._other.textBaseline===t||(this._other=this._other.make(),nt.save(this,16384,this._other,false),this._other.textBaseline=t)});h(0,e,"font",null,function(t){if(t==this._other.font.toString())return;this._other=this._other.make();nt.save(this,8,this._other,false);this._other.font===Mt.EMPTY?this._other.font=new Mt(t):this._other.font.setFont(t)});Y.__init__=function(){i.DEFAULT=new i};Y._tempPoint=new M;Y._SUBMITVBSIZE=32e3;Y._MAXSIZE=99999999;Y._RECTVBSIZE=16;Y.MAXCLIPRECT=new I(0,0,99999999,99999999);Y._COUNT=0;Y._tmpMatrix=new A;Y.SEGNUM=32;Y._contextcount=0;a(Y,["_fontTemp",function(){return this._fontTemp=new Mt},"_drawStyleTemp",function(){return this._drawStyleTemp=new et(null)}]);Y.__init$=function(){i=function(){function t(){this.lineWidth=1;this.path=null;this.textAlign=null;this.textBaseline=null;this.font=Mt.EMPTY}v(t,"");var e=t.prototype;e.clear=function(){this.lineWidth=1;this.path&&this.path.clear();this.textAlign=this.textBaseline=null;this.font=Mt.EMPTY};e.make=function(){return this===t.DEFAULT?new t:this};t.DEFAULT=null;return t}()};return Y}(l);var Ut=function(t){function n(t,e){this.size=[0,0];this.alpha=1;this.ALPHA=1;this.subID=0;this._cacheID=0;n.__super.call(this);this.defines=new zt;this.position=n._POSITION;this.mainID=t;this.subID=e;this.textureHost=null;this.texture=null;this.fillStyle=null;this.color=null;this.strokeStyle=null;this.colorAdd=null;this.glTexture=null;this.u_mmat2=null;this._cacheID=t|e;this._inClassCache=n._cache[this._cacheID];if(t>0&&!this._inClassCache){this._inClassCache=n._cache[this._cacheID]=[];this._inClassCache._length=0}this.clear()}v(n,"laya.webgl.shader.d2.value.Value2D",t);var e=n.prototype;e.setValue=function(t){};e.refresh=function(){var t=this.size;t[0]=Dt.width;t[1]=Dt.height;this.alpha=this.ALPHA*Dt.worldAlpha;this.mmat=Dt.worldMatrix4;return this};e._ShaderWithCompile=function(){return ue.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,de.create)};e._withWorldShaderDefines=function(){var t=Dt.worldShaderDefines;var e=ue.sharders[this.mainID|this.defines._value|t.getValue()];if(!e){var i={};var n;var r;n=this.defines.toNameDic();for(r in n)i[r]="";n=t.toNameDic();for(r in n)i[r]="";e=ue.withCompile2D(0,this.mainID,i,this.mainID|this.defines._value|t.getValue(),de.create)}var s=Dt.worldFilters;if(!s)return e;var a=s.length,o;for(var h=0;h<a;h++){(o=s[h])&&o.action.setValue(this)}return e};e.upload=function(){var t=Dt;this.alpha=this.ALPHA*t.worldAlpha;if(Dt.worldMatrix4!==Dt.TEMPMAT4_ARRAY)this.defines.add(128);Nt.shaderHighPrecision&&this.defines.add(1024);var e=t.worldShaderDefines?this._withWorldShaderDefines():ue.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();var i;this.size[0]=t.width,this.size[1]=t.height;this.mmat=t.worldMatrix4;if(Zt.activeShader!==e){if(e._shaderValueWidth!==t.width||e._shaderValueHeight!==t.height){e._shaderValueWidth=t.width;e._shaderValueHeight=t.height}else{i=e._params2dQuick2||e._make2dQuick2()}e.upload(this,i)}else{if(e._shaderValueWidth!==t.width||e._shaderValueHeight!==t.height){e._shaderValueWidth=t.width;e._shaderValueHeight=t.height}else{i=e._params2dQuick1||e._make2dQuick1()}e.upload(this,i)}};e.setFilters=function(t){this.filters=t;if(!t)return;var e=t.length,i;for(var n=0;n<e;n++){i=t[n];if(i){this.defines.add(i.type);if(i.action&&i.action.setValue&&typeof i.action.setValue==="function"){i.action.setValue(this)}}}};e.clear=function(){this.defines.setValue(this.subID)};e.release=function(){this._inClassCache[this._inClassCache._length++]=this;this.fillStyle=null;this.strokeStyle=null;this.clear()};n._initone=function(t,e){n._typeClass[t]=e;n._cache[t]=[];n._cache[t]._length=0};n.__init__=function(){n._POSITION=[2,5126,false,4*It.BYTES_PE,0];n._TEXCOORD=[2,5126,false,4*It.BYTES_PE,2*It.BYTES_PE];n._initone(2,ee);n._initone(4,re);n._initone(256,ie);n._initone(512,te);n._initone(1,ne);n._initone(1|64,_e);n._initone(1|8,ne)};n.create=function(t,e){var i=n._cache[t|e];if(i._length)return i[--i._length];else return new n._typeClass[t|e](e)};n._POSITION=null;n._TEXCOORD=null;n._cache=[];n._typeClass=[];n.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return n}(q);var Gt=function(t){function g(t,e){g.__super.call(this,t,e)}v(g,"laya.webgl.utils.RenderSprite3D",t);var e=g.prototype;e.onCreate=function(t){switch(t){case 8:this._fun=this._blend;return;case 4:this._fun=this._transform;return}};e._mask=function(t,e,i,n){var r=this._next;var s=t.mask;var a;var o;if(s){e.ctx.save();var h=e.ctx.globalCompositeOperation;var l=new I;l.copyFrom(s.getBounds());l.width=Math.round(l.width);l.height=Math.round(l.height);l.x=Math.round(l.x);l.y=Math.round(l.y);if(l.width>0&&l.height>0){var u=t._style._tf;var c=xt.create();c.addValue("bounds",l);a=bt.create([c,e],laya.webgl.utils.RenderSprite3D.tmpTarget);e.addRenderObject(a);s.render(e,-l.x,-l.y);a=bt.create([c],laya.webgl.utils.RenderSprite3D.endTmpTarget);e.addRenderObject(a);e.ctx.save();e.clipRect(i-u.translateX+l.x,n-u.translateY+l.y,l.width,l.height);r._fun.call(r,t,e,i,n);e.ctx.restore();o=St.create(6);h=e.ctx.globalCompositeOperation;o.blendMode="mask";e.addRenderObject(o);A.TEMP.identity();var f=Ut.create(1,0);var _=z.INV_UV;var d=l.width;var p=l.height;var v=32;if(l.width<v||l.height<v){_=g.tempUV;_[0]=0;_[1]=0;_[2]=l.width>=32?1:l.width/v;_[3]=0;_[4]=l.width>=32?1:l.width/v;_[5]=l.height>=32?1:l.height/v;_[6]=0;_[7]=l.height>=32?1:l.height/v;l.width=l.width>=32?l.width:v;l.height=l.height>=32?l.height:v;_[1]*=-1;_[3]*=-1;_[5]*=-1;_[7]*=-1;_[1]+=1;_[3]+=1;_[5]+=1;_[7]+=1}e.ctx.drawTarget(c,i+l.x-u.translateX,n+l.y-u.translateY,d,p,A.TEMP,"tmpTarget",f,_,6);a=bt.create([c],laya.webgl.utils.RenderSprite3D.recycleTarget);e.addRenderObject(a);o=St.create(6);o.blendMode=h;e.addRenderObject(o)}e.ctx.restore()}else{r._fun.call(r,t,e,i,n)}};e._blend=function(t,e,i,n){var r=t._style;var s=this._next;if(r.blendMode){e.ctx.save();e.ctx.globalCompositeOperation=r.blendMode;s._fun.call(s,t,e,i,n);e.ctx.restore()}else{s._fun.call(s,t,e,i,n)}};e._transform=function(t,e,i,n){var r=t.transform,s=this._next;if(r&&s!=k.NORENDER){var a=e.ctx;var o=t._style;r.tx=i;r.ty=n;var h=a._getTransformMatrix();var l=h.clone();A.mul(r,h,h);h._checkTransform();r.tx=r.ty=0;s._fun.call(s,t,e,0,0);l.copyTo(h);l.destroy()}else{s._fun.call(s,t,e,i,n)}};g.tmpTarget=function(t,e){var i=t.getValue("bounds");var n=Qt.create(i.width,i.height);n.start();n.clear(0,0,0,0);t.addValue("tmpTarget",n)};g.endTmpTarget=function(t){var e=t.getValue("tmpTarget");e.end()};g.recycleTarget=function(t){var e=t.getValue("tmpTarget");e.recycle();t.recycle()};a(g,["tempUV",function(){return this.tempUV=new Array(8)}]);return g}(k);var Vt=function(t){function e(){this.data=null;e.__super.call(this)}v(e,"laya.filters.webgl.ColorFilterActionGL",t);var i=e.prototype;w.imps(i,{"laya.filters.IFilterActionGL":true});i.setValue=function(t){t.colorMat=this.data._mat;t.colorAlpha=this.data._alpha};i.apply3d=function(t,e,i,n,r){var s=t.getValue("bounds");var a=Ut.create(1,0);a.setFilters([this.data]);var o=A.TEMP;o.identity();i.ctx.drawTarget(t,0,0,s.width,s.height,o,"src",a)};return e}(K);var Wt=function(t){function s(t,e,i,n,r){this._atlasCanvas=null;this._inAtlasTextureKey=null;this._inAtlasTextureBitmapValue=null;this._inAtlasTextureOriUVValue=null;this._InAtlasWebGLImagesKey=null;this._InAtlasWebGLImagesOffsetValue=null;s.__super.call(this,t,e,r);this._inAtlasTextureKey=[];this._inAtlasTextureBitmapValue=[];this._inAtlasTextureOriUVValue=[];this._InAtlasWebGLImagesKey={};this._InAtlasWebGLImagesOffsetValue=[];this._atlasCanvas=new se;this._atlasCanvas._atlaser=this;this._atlasCanvas.width=i;this._atlasCanvas.height=n;this._atlasCanvas.activeResource();this._atlasCanvas.lock=true}v(s,"laya.webgl.atlas.Atlaser",t);var e=s.prototype;e.computeUVinAtlasTexture=function(t,e,i,n){var r=t;var s=Q.atlasTextureWidth;var a=Q.atlasTextureHeight;var o=i/s,h=n/a,l=(i+t.bitmap.width)/s,u=(n+t.bitmap.height)/a;var c=t.bitmap.width/s,f=t.bitmap.height/a;t.uv=[o+e[0]*c,h+e[1]*f,l-(1-e[2])*c,h+e[3]*f,l-(1-e[4])*c,u-(1-e[5])*f,o+e[6]*c,u-(1-e[7])*f]};e.findBitmapIsExist=function(t){if(t instanceof laya.webgl.resource.WebGLImage){var e=t;var i=e.url;var n=this._InAtlasWebGLImagesKey[i?i:e.id];if(n){return n.offsetInfoID}}return-1};e.addToAtlasTexture=function(t,e,i){if(t instanceof laya.webgl.resource.WebGLImage){var n=t;var r=n.url;this._InAtlasWebGLImagesKey[r?r:n.id]={bitmap:t,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length};this._InAtlasWebGLImagesOffsetValue.push([e,i])}this._atlasCanvas.texSubImage2D(e,i,t.atlasImgData||t.atlasSource);t.clearAtlasSource()};e.addToAtlas=function(t,e,i){t._atlasID=this._inAtlasTextureKey.length;var n=t.uv.slice();var r=t.bitmap;this._inAtlasTextureKey.push(t);this._inAtlasTextureOriUVValue.push(n);this._inAtlasTextureBitmapValue.push(r);this.computeUVinAtlasTexture(t,n,e,i);t.bitmap=this._atlasCanvas};e.clear=function(){for(var t=0,e=this._inAtlasTextureKey.length;t<e;t++){this._inAtlasTextureKey[t].bitmap=this._inAtlasTextureBitmapValue[t];this._inAtlasTextureKey[t].uv=this._inAtlasTextureOriUVValue[t];this._inAtlasTextureKey[t]._atlasID=-1;this._inAtlasTextureKey[t].bitmap.lock=false;this._inAtlasTextureKey[t].bitmap.releaseResource()}this._inAtlasTextureKey.length=0;this._inAtlasTextureBitmapValue.length=0;this._inAtlasTextureOriUVValue.length=0;this._InAtlasWebGLImagesKey=null;this._InAtlasWebGLImagesOffsetValue.length=0};e.dispose=function(){this.clear();this._atlasCanvas.destroy()};h(0,e,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue});h(0,e,"texture",function(){return this._atlasCanvas});h(0,e,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey});return s}(Z);var zt=function(t){function i(){i.__super.call(this,i.__name2int,i.__int2name,i.__int2nameMap)}v(i,"laya.webgl.shader.d2.ShaderDefines2D",t);i.__init__=function(){i.reg("TEXTURE2D",1);i.reg("COLOR2D",2);i.reg("PRIMITIVE",4);i.reg("GLOW_FILTER",8);i.reg("BLUR_FILTER",16);i.reg("COLOR_FILTER",32);i.reg("COLOR_ADD",64);i.reg("WORLDMAT",128);i.reg("FILLTEXTURE",256);i.reg("FSHIGHPRECISION",1024)};i.reg=function(t,e){ct._reg(t,e,i.__name2int,i.__int2name)};i.toText=function(t,e,i){return ct._toText(t,e,i)};i.toInt=function(t){return ct._toInt(t,i.__name2int)};i.TEXTURE2D=1;i.COLOR2D=2;i.PRIMITIVE=4;i.FILTERGLOW=8;i.FILTERBLUR=16;i.FILTERCOLOR=32;i.COLORADD=64;i.WORLDMAT=128;i.FILLTEXTURE=256;i.SKINMESH=512;i.SHADERDEFINE_FSHIGHPRECISION=1024;i.__name2int={};i.__int2name=[];i.__int2nameMap=[];return i}(ct);var Ht=function(t){function o(t,e,i,n,r,s,a){o.__super.call(this,t,e,i,n,40,r,s,a)}v(o,"laya.webgl.shapes.Ellipse",t);return o}(dt);var Yt=function(t){function s(t,e,i,n,r){this._points=[];this.rebuild(i);s.__super.call(this,t,e,0,0,0,r,n,r,0)}v(s,"laya.webgl.shapes.Line",t);var e=s.prototype;e.rebuild=function(t){var e=t.length;var i=this._points.length;if(e!=i){this.mUint16Array=new Uint16Array((e/2-1)*6);this.mFloat32Array=new Float32Array(e*5)}this._points.length=0;var n=NaN;var r=NaN;var s=-1;var a=-1;var o=t.length/2;for(var h=0;h<o;h++){n=t[h*2];r=t[h*2+1];if(Math.abs(s-n)>.01||Math.abs(a-r)>.01){this._points.push(n,r)}s=n;a=r}};e.getData=function(t,e,i){var n=[];var r=[];this.borderWidth>0&&this.createLine2(this._points,n,this.borderWidth,i,r,this._points.length/2);this.mUint16Array.set(n,0);this.mFloat32Array.set(r,0);t.append(this.mUint16Array);e.append(this.mFloat32Array)};return s}(dt);var jt=function(t){function c(t,e,i,n,r){this._points=[];var s=NaN;var a=NaN;var o=-1;var h=-1;var l=i.length/2-1;for(var u=0;u<l;u++){s=i[u*2];a=i[u*2+1];if(Math.abs(o-s)>.01||Math.abs(h-a)>.01){this._points.push(s,a)}o=s;h=a}s=i[l*2];a=i[l*2+1];o=this._points[0];h=this._points[1];if(Math.abs(o-s)>.01||Math.abs(h-a)>.01){this._points.push(s,a)}c.__super.call(this,t,e,0,0,this._points.length/2,0,n,r)}v(c,"laya.webgl.shapes.LoopLine",t);var e=c.prototype;e.getData=function(t,e,i){if(this.borderWidth>0){var n=this.color;var r=(n>>16&255)/255,s=(n>>8&255)/255,a=(n&255)/255;var o=[];var h=-1,l=-1;var u=0,c=0;var f=[];var _=Math.floor(this._points.length/2);for(var d=0;d<_;d++){u=this._points[d*2];c=this._points[d*2+1];o.push(this.x+u,this.y+c,r,s,a)}this.createLoopLine(o,f,this.borderWidth,i+o.length/5);t.append(new Uint16Array(f));e.append(new Float32Array(o))}};e.createLoopLine=function(t,e,i,n,r,s){var a=t.length/5;var o=t.concat();var h=r?r:t;var l=this.borderColor;var u=(l>>16&255)/255,c=(l>>8&255)/255,f=(l&255)/255;var _=[o[0],o[1]];var d=[o[o.length-5],o[o.length-4]];var p=d[0]+(_[0]-d[0])*.5;var v=d[1]+(_[1]-d[1])*.5;o.unshift(p,v,0,0,0);o.push(p,v,0,0,0);var g=o.length/5;var m=n,y=i/2;var b,x,w,T,S,C,E,A;var M,I,L,P,k,D;var R,N,O,B,F,U;var G,V,W;w=o[0];T=o[1];S=o[5];C=o[6];M=-(T-C);I=w-S;W=Math.sqrt(M*M+I*I);M=M/W*y;I=I/W*y;h.push(w-M,T-I,u,c,f,w+M,T+I,u,c,f);for(var z=1;z<g-1;z++){w=o[(z-1)*5];T=o[(z-1)*5+1];S=o[z*5];C=o[z*5+1];E=o[(z+1)*5];A=o[(z+1)*5+1];M=-(T-C);I=w-S;W=Math.sqrt(M*M+I*I);M=M/W*y;I=I/W*y;L=-(C-A);P=S-E;W=Math.sqrt(L*L+P*P);L=L/W*y;P=P/W*y;R=-I+T-(-I+C);N=-M+S-(-M+w);O=(-M+w)*(-I+C)-(-M+S)*(-I+T);B=-P+A-(-P+C);F=-L+S-(-L+E);U=(-L+E)*(-P+C)-(-L+S)*(-P+A);G=R*F-B*N;if(Math.abs(G)<.1){G+=10.1;h.push(S-M,C-I,u,c,f,S+M,C+I,u,c,f);continue}b=(N*U-F*O)/G;x=(B*O-R*U)/G;V=(b-S)*(b-S)+(x-C)+(x-C);h.push(b,x,u,c,f,S-(b-S),C-(x-C),u,c,f)}if(s){e=s}var H=this.edges+1;for(z=1;z<H;z++){e.push(m+(z-1)*2,m+(z-1)*2+1,m+z*2+1,m+z*2+1,m+z*2,m+(z-1)*2)}e.push(m+(z-1)*2,m+(z-1)*2+1,m+1,m+1,m,m+(z-1)*2);return h};return c}(dt);var Xt=function(t){function a(t,e,i,n,r,s){this._points=null;this._start=-1;this._repaint=false;this.earcutTriangles=null;this._mat=A.create();this._points=i.slice(0,i.length);a.__super.call(this,t,e,0,0,this._points.length/2,n,r,s)}v(a,"laya.webgl.shapes.Polygon",t);var e=a.prototype;e.rebuild=function(t){if(!this._repaint){this._points.length=0;this._points=this._points.concat(t)}};e.setMatrix=function(t){t.copyTo(this._mat)};e.needUpdate=function(t){this._repaint=this._mat.a==t.a&&this._mat.b==t.b&&this._mat.c==t.c&&this._mat.d==t.d&&this._mat.tx==t.tx&&this._mat.ty==t.ty;return!this._repaint};e.getData=function(t,e,i){var n,r=0;var s=this._points;var a=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=i){this._start=i;n=[];a=this.earcutTriangles.length;for(r=0;r<a;r++){n.push(this.earcutTriangles[r]+i)}this.mUint16Array=new Uint16Array(n)}}else{this._start=i;n=[];var o=[];var h=[];var l=this.color;var u=(l>>16&255)/255,c=(l>>8&255)/255,f=(l&255)/255;a=Math.floor(s.length/2);for(r=0;r<a;r++){o.push(this.x+s[r*2],this.y+s[r*2+1],u,c,f);h.push(this.x+s[r*2],this.y+s[r*2+1])}this.earcutTriangles=pt.earcut(h,null,2);a=this.earcutTriangles.length;for(r=0;r<a;r++){n.push(this.earcutTriangles[r]+i)}this.mUint16Array=new Uint16Array(n);this.mFloat32Array=new Float32Array(o)}t.append(this.mUint16Array);e.append(this.mFloat32Array)};return a}(dt);var $t=function(t){function s(){this._matrix=new A;this._matrix4=It.defaultMatrix4.concat();s.__super.call(this,1e4);this.shaderValue=new Ut(0,0)}v(s,"laya.webgl.submit.SubmitCanvas",t);var e=s.prototype;e.renderSubmit=function(){if(this._ctx_src._targets){this._ctx_src._targets.flush(this._ctx_src);return 1}var t=Dt.worldAlpha;var e=Dt.worldMatrix4;var i=Dt.worldMatrix;var n=Dt.worldFilters;var r=Dt.worldShaderDefines;var s=this.shaderValue;var a=this._matrix;var o=this._matrix4;var h=A.TEMP;A.mul(a,i,h);o[0]=h.a;o[1]=h.b;o[4]=h.c;o[5]=h.d;o[12]=h.tx;o[13]=h.ty;Dt.worldMatrix=h.clone();Dt.worldMatrix4=o;Dt.worldAlpha=Dt.worldAlpha*s.alpha;if(s.filters&&s.filters.length){Dt.worldFilters=s.filters;Dt.worldShaderDefines=s.defines}this._ctx_src.flush();Dt.worldAlpha=t;Dt.worldMatrix4=e;Dt.worldMatrix.destroy();Dt.worldMatrix=i;Dt.worldFilters=n;Dt.worldShaderDefines=r;return 1};e.releaseRender=function(){var t=s._cache;this._ctx_src=null;t[t._length++]=this};e.getRenderType=function(){return 10003};s.create=function(t,e,i){var n=!s._cache._length?new s:s._cache[--s._cache._length];n._ctx_src=t;var r=n.shaderValue;r.alpha=e;r.defines.setValue(0);i&&i.length&&r.setFilters(i);return n};s._cache=(s._cache=[],s._cache._length=0,s._cache);return s}(yt);var Kt=function(t){function l(t){this._preIsSameTextureShader=false;this._isSameTexture=true;this._texs=new Array;this._texsID=new Array;this._vbPos=new Array;t===void 0&&(t=1e4);l.__super.call(this,t)}v(l,"laya.webgl.submit.SubmitTexture",t);var e=l.prototype;e.releaseRender=function(){var t=l._cache;t[t._length++]=this;this.shaderValue.release();this._preIsSameTextureShader=false;this._vb=null;this._texs.length=0;this._vbPos.length=0;this._isSameTexture=true};e.addTexture=function(t,e){this._texsID[this._texs.length]=t._uvID;this._texs.push(t);this._vbPos.push(e)};e.checkTexture=function(){if(this._texs.length<1){this._isSameTexture=true;return}var t=this.shaderValue.textureHost;var e=t.bitmap;if(e===null)return;var i=this._vb.getFloat32Array();for(var n=0,r=this._texs.length;n<r;n++){var s=this._texs[n];s.active();var a=s.uv;if(this._texsID[n]!==s._uvID){this._texsID[n]=s._uvID;var o=this._vbPos[n];i[o+2]=a[0];i[o+3]=a[1];i[o+6]=a[2];i[o+7]=a[3];i[o+10]=a[4];i[o+11]=a[5];i[o+14]=a[6];i[o+15]=a[7];this._vb.setNeedUpload()}if(s.bitmap!==e){this._isSameTexture=false}}};e.renderSubmit=function(){if(this._numEle===0){l._shaderSet=false;return 1}var t=this.shaderValue.textureHost;if(t){var e=t.source;if(!t.bitmap||!e){l._shaderSet=false;return 1}this.shaderValue.texture=e}this._vb.bind_upload(this._ib);var i=Nt.mainContext;if(tt.activeBlendFunction!==this._blendFn){i.enable(3042);this._blendFn(i);tt.activeBlendFunction=this._blendFn}F.drawCall++;F.trianglesFaces+=this._numEle/3;if(this._preIsSameTextureShader&&Zt.activeShader&&l._shaderSet)Zt.activeShader.uploadTexture2D(this.shaderValue.texture);else this.shaderValue.upload();l._shaderSet=true;if(this._texs.length>1&&!this._isSameTexture){var n=t.bitmap;var r=0;var s=Zt.activeShader;for(var a=0,o=this._texs.length;a<o;a++){var h=this._texs[a];if(h.bitmap!==n||a+1===o){s.uploadTexture2D(h.source);i.drawElements(4,(a-r+1)*6,5123,this._startIdx+r*6*It.BYTES_PIDX);n=h.bitmap;r=a}}}else{i.drawElements(4,this._numEle,5123,this._startIdx)}return 1};l.create=function(t,e,i,n,r){var s=l._cache._length?l._cache[--l._cache._length]:new l;if(i==null){i=s._selfVb||(s._selfVb=ve.create(-1));i.clear();n=0}s._ib=e;s._vb=i;s._startIdx=n*It.BYTES_PIDX;s._numEle=0;var a=t._nBlendType;s._blendFn=t._targets?tt.targetFns[a]:tt.fns[a];s.shaderValue=r;s.shaderValue.setValue(t._shader2D);var o=t._shader2D.filters;o&&s.shaderValue.setFilters(o);return s};l._cache=(l._cache=[],l._cache._length=0,l._cache);l._shaderSet=true;return l}(yt);var qt=function(t){function y(){y.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0);this.canReuse=true;this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}v(y,"laya.webgl.utils.MeshTexture",t);var e=y.prototype;e.addData=function(t,e,i,n,r,s){var a=t.length/2;var o=this._vb.needSize(a*y.const_stride);var h=o>>2;var l=this._vb.getFloat32Array();var u=0;for(var c=0;c<a;c++){var f=t[u],_=t[u+1];var d=f*n.a+_*n.c+n.tx;var p=f*n.b+_*n.d+n.ty;l[h++]=d;l[h++]=p;l[h++]=e[u];l[h++]=e[u+1];u+=2}this._vb.setNeedUpload();var v=this.vertNum;if(v>0){var g=i.length;if(g>y.tmpIdx.length)y.tmpIdx=new Uint16Array(g);for(var m=0;m<g;m++){y.tmpIdx[m]=i[m]+v}this._ib.appendU16Array(y.tmpIdx,i.length)}else{this._ib.append(i)}this._ib.setNeedUpload();this.vertNum+=a;this.indexNum+=i.length};e.releaseMesh=function(){this._vb._byteLength=0;this._ib._byteLength=0;this.vertNum=0;this.indexNum=0;laya.webgl.utils.MeshTexture._POOL.push(this)};e.destroy=function(){this._ib.destroy();this._vb.destroy()};y.getAMesh=function(){if(laya.webgl.utils.MeshTexture._POOL.length){return laya.webgl.utils.MeshTexture._POOL.pop()}return new y};y.const_stride=16;y._POOL=[];a(y,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]);return y}(kt);var Zt=function(t){function e(){e.__super.call(this);this.lock=true}v(e,"laya.webgl.shader.BaseShader",t);e.activeShader=null;e.bindShader=null;return e}(D);var Qt=function(e){function u(t,e,i,n,r,s,a,o,h){this._type=0;this._svWidth=NaN;this._svHeight=NaN;this._preRenderTarget=null;this._alreadyResolved=false;this._looked=false;this._surfaceFormat=0;this._surfaceType=0;this._depthStencilFormat=0;this._mipMap=false;this._repeat=false;this._minFifter=0;this._magFifter=0;this._destroy=false;i===void 0&&(i=6408);n===void 0&&(n=5121);r===void 0&&(r=34041);s===void 0&&(s=false);a===void 0&&(a=false);o===void 0&&(o=-1);h===void 0&&(h=-1);this._type=1;this._w=t;this._h=e;this._surfaceFormat=i;this._surfaceType=n;this._depthStencilFormat=r;if(L.isConchWebGL&&this._depthStencilFormat===34041){this._depthStencilFormat=33189}this._mipMap=s;this._repeat=a;this._minFifter=o;this._magFifter=h;this._createWebGLRenderTarget();this.bitmap.lock=true;u.__super.call(this,this.bitmap,z.INV_UV)}v(u,"laya.webgl.resource.RenderTarget2D",e);var t=u.prototype;w.imps(t,{"laya.resource.IDispose":true});t.getType=function(){return this._type};t.getTexture=function(){return this};t.size=function(t,e){if(this._w==t&&this._h==e)return;this._w=t;this._h=e;this.release();if(this._w!=0&&this._h!=0)this._createWebGLRenderTarget()};t.release=function(){this.destroy()};t.recycle=function(){u.POOL.push(this)};t.start=function(){var t=Nt.mainContext;this._preRenderTarget=Dt.curRenderTarget;Dt.curRenderTarget=this;t.bindFramebuffer(36160,this.bitmap.frameBuffer);this._alreadyResolved=false;if(this._type==1){t.viewport(0,0,this._w,this._h);this._svWidth=Dt.width;this._svHeight=Dt.height;Dt.width=this._w;Dt.height=this._h;Zt.activeShader=null}return this};t.clear=function(t,e,i,n){t===void 0&&(t=0);e===void 0&&(e=0);i===void 0&&(i=0);n===void 0&&(n=1);var r=Nt.mainContext;r.clearColor(t,e,i,n);var s=16384;switch(this._depthStencilFormat){case 33189:s|=256;break;case 36168:s|=1024;break;case 34041:s|=256;s|=1024;break}r.clear(s)};t.end=function(){var t=Nt.mainContext;t.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null);this._alreadyResolved=true;Dt.curRenderTarget=this._preRenderTarget;if(this._type==1){t.viewport(0,0,this._svWidth,this._svHeight);Dt.width=this._svWidth;Dt.height=this._svHeight;Zt.activeShader=null}else t.viewport(0,0,w.stage.width,w.stage.height)};t.getData=function(t,e,i,n){var r=Nt.mainContext;r.bindFramebuffer(36160,this.bitmap.frameBuffer);var s=r.checkFramebufferStatus(36160)===36053;if(!s){r.bindFramebuffer(36160,null);return null}var a=new Uint8Array(this._w*this._h*4);r.readPixels(t,e,i,n,this._surfaceFormat,this._surfaceType,a);r.bindFramebuffer(36160,null);return a};t.destroy=function(t){t===void 0&&(t=false);if(!this._destroy){this._loaded=false;this.bitmap.offAll();this.bitmap.disposeResource();this.bitmap.dispose();this.offAll();this.bitmap=null;this._alreadyResolved=false;this._destroy=true;e.prototype.destroy.call(this)}};t.dispose=function(){};t._createWebGLRenderTarget=function(){this.bitmap=new he(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter);this.bitmap.activeResource();this._alreadyResolved=true;this._destroy=false;this._loaded=true;this.bitmap.on("recovered",this,function(t){this.event("recovered")})};h(0,t,"surfaceFormat",function(){return this._surfaceFormat});h(0,t,"magFifter",function(){return this._magFifter});h(0,t,"surfaceType",function(){return this._surfaceType});h(0,t,"mipMap",function(){return this._mipMap});h(0,t,"depthStencilFormat",function(){return this._depthStencilFormat});h(0,t,"minFifter",function(){return this._minFifter});h(0,t,"source",function(){if(this._alreadyResolved)return w.superGet(z,this,"source");return null});u.create=function(t,e,i,n,r,s,a,o,h){i===void 0&&(i=6408);n===void 0&&(n=5121);r===void 0&&(r=34041);s===void 0&&(s=false);a===void 0&&(a=false);o===void 0&&(o=-1);h===void 0&&(h=-1);var l=u.POOL.pop();l||(l=new u(t,e));if(!l.bitmap||l._w!=t||l._h!=e||l._surfaceFormat!=i||l._surfaceType!=n||l._depthStencilFormat!=r||l._mipMap!=s||l._repeat!=a||l._minFifter!=o||l._magFifter!=h){l._w=t;l._h=e;l._surfaceFormat=i;l._surfaceType=n;l._depthStencilFormat=r;if(L.isConchWebGL&&l._depthStencilFormat===34041){l._depthStencilFormat=33189}l._mipMap=s;l._repeat=a;l._minFifter=o;l._magFifter=h;l.release();l._createWebGLRenderTarget()}return l};u.TYPE2D=1;u.TYPE3D=2;u.POOL=[];return u}(z);var Jt=function(t){function e(){this._glBuffer=null;this._buffer=null;this._bufferType=0;this._bufferUsage=0;this._byteLength=0;e.__super.call(this);e._gl=Nt.mainContext}v(e,"laya.webgl.utils.Buffer",t);var i=e.prototype;i._bind=function(){this.activeResource();if(e._bindActive[this._bufferType]!==this._glBuffer){this._bufferType===34962&&(e._bindVertexBuffer=this._glBuffer);e._gl.bindBuffer(this._bufferType,e._bindActive[this._bufferType]=this._glBuffer);Zt.activeShader=null}};i.recreateResource=function(){this._glBuffer||(this._glBuffer=e._gl.createBuffer());this.completeCreate()};i.disposeResource=function(){if(this._glBuffer){Nt.mainContext.deleteBuffer(this._glBuffer);this._glBuffer=null}this.memorySize=0};h(0,i,"bufferUsage",function(){return this._bufferUsage});e._gl=null;e._bindActive={};e._bindVertexBuffer=null;e._enableAtributes=[];return e}(D);var te=function(t){function i(t){this.texcoord=null;this.offsetX=300;this.offsetY=0;i.__super.call(this,512,0);var e=8*It.BYTES_PE;this.position=[2,5126,false,e,0];this.texcoord=[2,5126,false,e,2*It.BYTES_PE];this.color=[4,5126,false,e,4*It.BYTES_PE]}v(i,"laya.webgl.shader.d2.skinAnishader.SkinSV",t);return i}(Ut);var ee=function(t){function e(t){e.__super.call(this,2,0);this.color=[]}v(e,"laya.webgl.shader.d2.value.Color2dSV",t);var i=e.prototype;i.setValue=function(t){t.fillStyle&&(this.color=t.fillStyle._color._color);t.strokeStyle&&(this.color=t.strokeStyle._color._color)};return e}(Ut);var ie=function(t){function e(t){this.u_colorMatrix=null;this.strength=0;this.colorMat=null;this.colorAlpha=null;this.u_TexRange=[0,1,0,1];this.u_offset=[0,0];this.texcoord=Ut._TEXCOORD;e.__super.call(this,256,0)}v(e,"laya.webgl.shader.d2.value.FillTextureSV",t);var i=e.prototype;i.setValue=function(t){this.ALPHA=t.ALPHA;t.filters&&this.setFilters(t.filters)};i.clear=function(){this.texture=null;this.shader=null;this.defines.setValue(0)};return e}(Ut);var ne=function(t){function e(t){this.u_colorMatrix=null;this.strength=0;this.blurInfo=null;this.colorMat=null;this.colorAlpha=null;this.texcoord=Ut._TEXCOORD;t===void 0&&(t=0);e.__super.call(this,1,t)}v(e,"laya.webgl.shader.d2.value.TextureSV",t);var i=e.prototype;i.setValue=function(t){this.ALPHA=t.ALPHA;t.filters&&this.setFilters(t.filters)};i.clear=function(){this.texture=null;this.shader=null;this.defines.setValue(0)};return e}(Ut);var re=function(t){function e(t){this.a_color=null;this.u_pos=[0,0];e.__super.call(this,4,0);this.position=[2,5126,false,5*It.BYTES_PE,0];this.a_color=[3,5126,false,5*It.BYTES_PE,2*It.BYTES_PE]}v(e,"laya.webgl.shader.d2.value.PrimitiveSV",t);return e}(Ut);var se=function(t){function e(){this._atlaser=null;this._flashCacheImage=null;this._flashCacheImageNeedFlush=false;e.__super.call(this)}v(e,"laya.webgl.atlas.AtlasWebGLCanvas",t);var i=e.prototype;i.recreateResource=function(){var t=Nt.mainContext;var e=this._source=t.createTexture();var i=Ot.curBindTexTarget;var n=Ot.curBindTexValue;Ot.bindTexture(t,3553,e);t.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null);t.texParameteri(3553,10241,9729);t.texParameteri(3553,10240,9729);t.texParameteri(3553,10242,33071);t.texParameteri(3553,10243,33071);i&&n&&Ot.bindTexture(t,i,n);this.memorySize=this._w*this._h*4;this.completeCreate()};i.disposeResource=function(){if(this._source){Nt.mainContext.deleteTexture(this._source);this._source=null;this.memorySize=0}};i.texSubImage2D=function(t,e,i){if(!L.isFlash){var n=Nt.mainContext;var r=Ot.curBindTexTarget;var s=Ot.curBindTexValue;Ot.bindTexture(n,3553,this._source);if(L.isConchWebGL){if(i!==ConchTextCanvas){t-1>=0&&n.texSubImage2DEx(true,3553,0,t-1,e,6408,5121,i);t+1<=this._w&&n.texSubImage2DEx(true,3553,0,t+1,e,6408,5121,i);e-1>=0&&n.texSubImage2DEx(true,3553,0,t,e-1,6408,5121,i);e+1<=this._h&&n.texSubImage2DEx(true,3553,0,t,e+1,6408,5121,i)}n.texSubImage2DEx(true,3553,0,t,e,6408,5121,i)}else{n.pixelStorei(37441,true);t-1>=0&&n.texSubImage2D(3553,0,t-1,e,6408,5121,i);t+1<=this._w&&n.texSubImage2D(3553,0,t+1,e,6408,5121,i);e-1>=0&&n.texSubImage2D(3553,0,t,e-1,6408,5121,i);e+1<=this._h&&n.texSubImage2D(3553,0,t,e+1,6408,5121,i);n.texSubImage2D(3553,0,t,e,6408,5121,i);n.pixelStorei(37441,false)}r&&s&&Ot.bindTexture(n,r,s)}else{if(!this._flashCacheImage){this._flashCacheImage=b.create("");this._flashCacheImage._image.createCanvas(this._w,this._h)}var a=i.bitmapdata;this._flashCacheImage._image.copyPixels(a,0,0,a.width,a.height,t,e);this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=true)}};i.texSubImage2DPixel=function(t,e,i,n,r){var s=Nt.mainContext;var a=Ot.curBindTexTarget;var o=Ot.curBindTexValue;Ot.bindTexture(s,3553,this._source);var h=new Uint8Array(r.data);if(L.isConchWebGL){s.texSubImage2DEx(true,3553,0,t,e,i,n,6408,5121,h)}else{s.pixelStorei(37441,true);s.texSubImage2D(3553,0,t,e,i,n,6408,5121,h);s.pixelStorei(37441,false)}a&&o&&Ot.bindTexture(s,a,o)};h(0,i,"width",t.prototype._$get_width,function(t){this._w=t});h(0,i,"height",t.prototype._$get_height,function(t){this._h=t});return e}(r);var ae=function(t){function r(){this.flipY=true;this.alwaysChange=false;r.__super.call(this)}v(r,"laya.webgl.resource.WebGLCanvas",t);var e=r.prototype;e.getCanvas=function(){return this._canvas};e.clear=function(){this._ctx&&this._ctx.clear()};e.destroy=function(){this._ctx&&this._ctx.destroy();this._ctx=null;laya.resource.Resource.prototype.destroy.call(this)};e._setContext=function(t){this._ctx=t};e.getContext=function(t,e){return this._ctx?this._ctx:this._ctx=r._createContext(this)};e.size=function(t,e){if(this._w!=t||this._h!=e){this._w=t;this._h=e;this._ctx&&this._ctx.size(t,e);this._canvas&&(this._canvas.height=e,this._canvas.width=t)}};e.activeResource=function(t){t===void 0&&(t=false);if(!this._source){this.recreateResource()}};e.recreateResource=function(){this.createWebGlTexture();this.completeCreate()};e.disposeResource=function(){if(this._source&&!this.iscpuSource){Nt.mainContext.deleteTexture(this._source);this._source=null;this.memorySize=0}};e.createWebGlTexture=function(){var t=Nt.mainContext;if(!this._canvas){}var e=this._source=t.createTexture();this.iscpuSource=false;var i=Ot.curBindTexTarget;var n=Ot.curBindTexValue;Ot.bindTexture(t,3553,e);t.pixelStorei(37440,this.flipY?1:0);if(L.isConchWebGL){t.texImage2DEx(r.premulAlpha,3553,0,6408,6408,5121,this._imgData)}else{r.premulAlpha&&t.pixelStorei(37441,true);t.texImage2D(3553,0,6408,6408,5121,this._imgData);r.premulAlpha&&t.pixelStorei(37441,false)}t.texParameteri(3553,10240,9729);t.texParameteri(3553,10241,9729);t.texParameteri(3553,10242,33071);t.texParameteri(3553,10243,33071);t.pixelStorei(37440,0);this.memorySize=this._w*this._h*4;i&&n&&Ot.bindTexture(t,i,n)};e.reloadCanvasData=function(){var t=Nt.mainContext;if(!this._source){throw"reloadCanvasData error, gl texture not created!"}var e=Ot.curBindTexTarget;var i=Ot.curBindTexValue;Ot.bindTexture(t,3553,this._source);if(L.isConchWebGL){t.texImage2DEx(r.premulAlpha,3553,0,6408,6408,5121,this._imgData)}else{r.premulAlpha&&t.pixelStorei(37441,true);t.texImage2D(3553,0,6408,6408,5121,this._imgData);r.premulAlpha&&t.pixelStorei(37441,false)}t.pixelStorei(37440,0);e&&i&&Ot.bindTexture(t,e,i)};e.texSubImage2D=function(t,e,i){var n=Nt.mainContext;var r=Ot.curBindTexTarget;var s=Ot.curBindTexValue;Ot.bindTexture(n,3553,this._source);if(L.isConchWebGL){n.texSubImage2DEx(true,3553,0,e,i,6408,5121,t._source)}else{n.pixelStorei(37441,true);n.texSubImage2D(3553,0,e,i,6408,5121,t._source);n.pixelStorei(37441,false)}r&&s&&Ot.bindTexture(n,r,s)};e.toBase64=function(t,e,i){var n=null;if(this._canvas){n=this._canvas.toDataURL(t,e)}i.call(this,n)};h(0,e,"context",function(){return this._ctx});h(0,e,"source",function(){if(this.alwaysChange)this.reloadCanvasData();return this._source});h(0,e,"asBitmap",null,function(t){this._ctx&&(this._ctx.asBitmap=t)});r._createContext=null;r.premulAlpha=false;return r}(r);var oe=function(t){function s(t,e){this.CborderSize=12;s.__super.call(this);this.char=t;this.isSpace=t===" ";this.xs=e.scaleX;this.ys=e.scaleY;this.font=e.font.toString();this.fontSize=e.font.size;this.fillColor=e.fillColor;this.borderColor=e.borderColor;this.lineWidth=e.lineWidth;this.underLine=e.underLine;var i=L.isConchApp;var n;if(i){n=ConchTextCanvas;n._source=ConchTextCanvas;n._source.canvas=ConchTextCanvas}else{n=_.canvas.source}this.canvas=n;this._enableMerageInAtlas=true;if(i){this._ctx=n}else{this._ctx=this.canvas.getContext("2d",undefined)}var r=j.measureText(this.char,this.font);this.cw=r.width*this.xs;this.ch=(r.height||this.fontSize)*this.ys;this.onresize(this.cw+this.CborderSize*2,this.ch+this.CborderSize*2);this.texture=new z(this)}v(s,"laya.webgl.resource.WebGLCharImage",t);var e=s.prototype;w.imps(e,{"laya.webgl.resource.IMergeAtlasBitmap":true});e.active=function(){this.texture.active()};e.recreateResource=function(){var t=L.isConchApp;this.onresize(this.cw+this.CborderSize*2,this.ch+this.CborderSize*2);this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w);if(t){var e=this.fontSize;if(this.xs!=1||this.ys!=1){e=parseInt(e*(this.xs>this.ys?this.xs:this.ys)+"")}var i="normal 100 "+this.font;i=i.replace(s._fontSizeReg,e);if(this.borderColor){i+=" 1 "+this.borderColor}this._ctx.font=i;this._ctx.textBaseline="top";this._ctx.fillStyle=this.fillColor;this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{this._ctx.save();this._ctx.lineJoin="round";this._ctx.clearRect(0,0,this.cw+this.CborderSize*2,this.ch+this.CborderSize*2);this._ctx.font=this.font;if(W.RightToLeft){this._ctx.textAlign="end"}this._ctx.textBaseline="top";this._ctx.translate(this.CborderSize,this.CborderSize);if(this.xs!=1||this.ys!=1){this._ctx.setTransform(this.xs,0,0,this.ys,0,0)}if(this.fillColor&&this.borderColor){this._ctx.strokeStyle=this.borderColor;this._ctx.lineWidth=this.lineWidth;this._ctx.strokeText(this.char,0,0,null,null,0,null);this._ctx.fillStyle=this.fillColor;this._ctx.fillText(this.char,0,0,null,null,null)}else{if(this.lineWidth===-1){this._ctx.fillStyle=this.fillColor?this.fillColor:"white";this._ctx.fillText(this.char,0,0,null,null,null)}else{this._ctx.strokeStyle=this.borderColor?this.borderColor:"white";this._ctx.lineWidth=this.lineWidth;this._ctx.strokeText(this.char,0,0,null,null,0,null)}}if(this.underLine){this._ctx.lineWidth=1;this._ctx.strokeStyle=this.fillColor;this._ctx.beginPath();this._ctx.moveTo(0,this.fontSize+1);var n=this._ctx.measureText(this.char).width+1;this._ctx.lineTo(n,this.fontSize+1);this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize;this.completeCreate()};e.onresize=function(t,e){this._w=t;this._h=e;this._allowMerageInAtlas=true};e.clearAtlasSource=function(){};h(0,e,"allowMerageInAtlas",function(){return this._allowMerageInAtlas});h(0,e,"atlasSource",function(){return this.canvas});h(0,e,"atlasImgData",function(){if(!s.canUseCanvas){if(this._ctx.getImageData)return this._ctx.getImageData(0,0,this._w,this._h)}return null});h(0,e,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(t){this._enableMerageInAtlas=t});s.createOneChar=function(t,e){var i=new s(t,e);return i};s.canUseCanvas=true;s._fontSizeReg=new RegExp("\\d+(?=px)","g");return s}(r);var he=function(t){function l(t,e,i,n,r,s,a,o,h){i===void 0&&(i=6408);n===void 0&&(n=5121);r===void 0&&(r=34041);s===void 0&&(s=false);a===void 0&&(a=false);o===void 0&&(o=-1);h===void 0&&(h=1);l.__super.call(this);this._w=t;this._h=e;this._surfaceFormat=i;this._surfaceType=n;this._depthStencilFormat=r;if(L.isConchWebGL&&this._depthStencilFormat===34041){this._depthStencilFormat=33189}this._mipMap=s;this._repeat=a;this._minFifter=o;this._magFifter=h}v(l,"laya.webgl.resource.WebGLRenderTarget",t);var e=l.prototype;e.recreateResource=function(){var t=Nt.mainContext;this._frameBuffer||(this._frameBuffer=t.createFramebuffer());this._source||(this._source=t.createTexture());var e=Ot.curBindTexTarget;var i=Ot.curBindTexValue;Ot.bindTexture(t,3553,this._source);t.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var n=this._minFifter;var r=this._magFifter;var s=this._repeat?10497:33071;var a=c.isPOT(this._w,this._h);if(a){if(this._mipMap)n!==-1||(n=9987);else n!==-1||(n=9729);r!==-1||(r=9729);t.texParameteri(3553,10241,n);t.texParameteri(3553,10240,r);t.texParameteri(3553,10242,s);t.texParameteri(3553,10243,s);this._mipMap&&t.generateMipmap(3553)}else{n!==-1||(n=9729);r!==-1||(r=9729);t.texParameteri(3553,10241,n);t.texParameteri(3553,10240,r);t.texParameteri(3553,10242,33071);t.texParameteri(3553,10243,33071)}t.bindFramebuffer(36160,this._frameBuffer);t.framebufferTexture2D(36160,36064,3553,this._source,0);if(this._depthStencilFormat){this._depthStencilBuffer||(this._depthStencilBuffer=t.createRenderbuffer());t.bindRenderbuffer(36161,this._depthStencilBuffer);t.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h);switch(this._depthStencilFormat){case 33189:t.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:t.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:t.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer);break}}t.bindFramebuffer(36160,null);e&&i&&Ot.bindTexture(t,e,i);t.bindRenderbuffer(36161,null);if(a&&this._mipMap)this.memorySize=this._w*this._h*4*(1+1/3);else this.memorySize=this._w*this._h*4;this.completeCreate()};e.disposeResource=function(){if(this._frameBuffer){Nt.mainContext.deleteTexture(this._source);Nt.mainContext.deleteFramebuffer(this._frameBuffer);Nt.mainContext.deleteRenderbuffer(this._depthStencilBuffer);this._source=null;this._frameBuffer=null;this._depthStencilBuffer=null;this.memorySize=0}};h(0,e,"depthStencilBuffer",function(){return this._depthStencilBuffer});h(0,e,"frameBuffer",function(){return this._frameBuffer});return l}(r);var le=function(t){function o(t,e,i,n,r,s,a){this.offsetX=0;this.offsetY=0;o.__super.call(this);this.repeat=true;this.mipmap=false;this.minFifter=-1;this.magFifter=-1;this.atlasImage=s;this.canvas=t;this._ctx=t.getContext("2d",undefined);this._w=n;this._h=r;this.offsetX=e;this.offsetY=i;this.src=a;this._enableMerageInAtlas=true;Q.enabled&&(this._w<Q.atlasLimitWidth&&this._h<Q.atlasLimitHeight)?this._allowMerageInAtlas=true:this._allowMerageInAtlas=false}v(o,"laya.webgl.resource.WebGLSubImage",t);var e=o.prototype;w.imps(e,{"laya.webgl.resource.IMergeAtlasBitmap":true});e.size=function(t,e){this._w=t;this._h=e;this._ctx&&this._ctx.size(t,e);this.canvas&&(this.canvas.height=e,this.canvas.width=t)};e.recreateResource=function(){this.size(this._w,this._h);this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h);!(this._allowMerageInAtlas&&this._enableMerageInAtlas)?this.createWebGlTexture():this.memorySize=0;this.completeCreate()};e.createWebGlTexture=function(){var t=Nt.mainContext;if(!this.canvas){throw"create GLTextur err:no data:"+this.canvas}var e=this._source=t.createTexture();var i=Ot.curBindTexTarget;var n=Ot.curBindTexValue;Ot.bindTexture(t,3553,e);if(L.isConchWebGL){t.texImage2DEx(true,3553,0,6408,6408,5121,this.canvas)}else{t.pixelStorei(37441,true);t.texImage2D(3553,0,6408,6408,5121,this.canvas);t.pixelStorei(37441,false)}var r=this.minFifter;var s=this.magFifter;var a=this.repeat?10497:33071;var o=c.isPOT(this.width,this.height);if(o){if(this.mipmap)r!==-1||(r=9987);else r!==-1||(r=9729);s!==-1||(s=9729);t.texParameteri(3553,10240,s);t.texParameteri(3553,10241,r);t.texParameteri(3553,10242,a);t.texParameteri(3553,10243,a);this.mipmap&&t.generateMipmap(3553)}else{r!==-1||(r=9729);s!==-1||(s=9729);t.texParameteri(3553,10241,r);t.texParameteri(3553,10240,s);t.texParameteri(3553,10242,33071);t.texParameteri(3553,10243,33071)}i&&n&&Ot.bindTexture(t,i,n);this.canvas=null;if(o&&this.mipmap)this.memorySize=this._w*this._h*4*(1+1/3);else this.memorySize=this._w*this._h*4};e.disposeResource=function(){if(!(Q.enabled&&this._allowMerageInAtlas)&&this._source){Nt.mainContext.deleteTexture(this._source);this._source=null;this.memorySize=0}};e.clearAtlasSource=function(){};h(0,e,"allowMerageInAtlas",function(){return this._allowMerageInAtlas});h(0,e,"atlasSource",function(){return this.canvas});h(0,e,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function(t){this._allowMerageInAtlas=t});return o}(r);var ue=function(t){function f(t,e,i,n){this._curActTexIndex=0;this.tag={};this._program=null;this._params=null;this._paramsMap={};this._offset=0;f.__super.call(this);if(!t||!e)throw"Shader Error";this._id=++f._count;this._vs=t;this._ps=e;this._nameMap=n?n:{};i!=null&&(f.sharders[i]=this)}v(f,"laya.webgl.shader.Shader",t);var e=f.prototype;e.recreateResource=function(){this._compile();this.completeCreate();this.memorySize=0};e.disposeResource=function(){Nt.mainContext.deleteShader(this._vshader);Nt.mainContext.deleteShader(this._pshader);Nt.mainContext.deleteProgram(this._program);this._vshader=this._pshader=this._program=null;this._params=null;this._paramsMap={};this.memorySize=0;this._curActTexIndex=0};e._compile=function(){if(!this._vs||!this._ps||this._params)return;this._reCompile=true;this._params=[];var t=[this._vs,this._ps];var e;var i=Nt.mainContext;this._program=i.createProgram();this._vshader=f._createShader(i,t[0],35633);this._pshader=f._createShader(i,t[1],35632);i.attachShader(this._program,this._vshader);i.attachShader(this._program,this._pshader);i.linkProgram(this._program);if(!L.isConchApp&&!i.getProgramParameter(this._program,35714)){throw i.getProgramInfoLog(this._program)}var n,r=0,s=0,a=0,o;var h=0;if(L.isConchApp){h=i.getProgramParameterEx(this._vs,this._ps,"",35721)}else{h=i.getProgramParameter(this._program,35721)}for(r=0;r<h;r++){var l=null;if(L.isConchApp){l=i.getActiveAttribEx(this._vs,this._ps,"",r)}else{l=i.getActiveAttrib(this._program,r)}o=i.getAttribLocation(this._program,l.name);n={vartype:"attribute",glfun:null,ivartype:0,attrib:l,location:o,name:l.name,type:l.type,isArray:false,isSame:false,preValue:null,indexOfParams:0};this._params.push(n)}var u=0;if(L.isConchApp){u=i.getProgramParameterEx(this._vs,this._ps,"",35718)}else{u=i.getProgramParameter(this._program,35718)}for(r=0;r<u;r++){var c=null;if(L.isConchApp){c=i.getActiveUniformEx(this._vs,this._ps,"",r)}else{c=i.getActiveUniform(this._program,r)}o=i.getUniformLocation(this._program,c.name);n={vartype:"uniform",glfun:null,ivartype:1,attrib:l,location:o,name:c.name,type:c.type,isArray:false,isSame:false,preValue:null,indexOfParams:0};if(n.name.indexOf("[0]")>0){n.name=n.name.substr(0,n.name.length-3);n.isArray=true;n.location=i.getUniformLocation(this._program,n.name)}this._params.push(n)}for(r=0,a=this._params.length;r<a;r++){n=this._params[r];n.indexOfParams=r;n.index=1;n.value=[n.location,null];n.codename=n.name;n.name=this._nameMap[n.codename]?this._nameMap[n.codename]:n.codename;this._paramsMap[n.name]=n;n._this=this;n.uploadedValue=[];if(n.vartype==="attribute"){n.fun=this._attribute;continue}switch(n.type){case 5124:n.fun=n.isArray?this._uniform1iv:this._uniform1i;break;case 5126:n.fun=n.isArray?this._uniform1fv:this._uniform1f;break;case 35664:n.fun=n.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:n.fun=n.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:n.fun=n.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:n.fun=this._uniform_sampler2D;break;case 35680:n.fun=this._uniform_samplerCube;break;case 35676:n.glfun=i.uniformMatrix4fv;n.fun=this._uniformMatrix4fv;break;case 35670:n.fun=this._uniform1i;break;case 35674:case 35675:throw new Error("compile shader err!");break;default:throw new Error("compile shader err!");break}}};e.getUniform=function(t){return this._paramsMap[t]};e._attribute=function(t,e){var i=Nt.mainContext;var n=Jt._enableAtributes;var r=t.location;n[r]||i.enableVertexAttribArray(r);i.vertexAttribPointer(r,e[0],e[1],e[2],e[3],e[4]+this._offset);n[r]=Jt._bindVertexBuffer;return 1};e._uniform1f=function(t,e){var i=t.uploadedValue;if(i[0]!==e){Nt.mainContext.uniform1f(t.location,i[0]=e);return 1}return 0};e._uniform1fv=function(t,e){if(e.length<4){var i=t.uploadedValue;if(i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]||i[3]!==e[3]){Nt.mainContext.uniform1fv(t.location,e);i[0]=e[0];i[1]=e[1];i[2]=e[2];i[3]=e[3];return 1}return 0}else{Nt.mainContext.uniform1fv(t.location,e);return 1}};e._uniform_vec2=function(t,e){var i=t.uploadedValue;if(i[0]!==e[0]||i[1]!==e[1]){Nt.mainContext.uniform2f(t.location,i[0]=e[0],i[1]=e[1]);return 1}return 0};e._uniform_vec2v=function(t,e){if(e.length<2){var i=t.uploadedValue;if(i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]||i[3]!==e[3]){Nt.mainContext.uniform2fv(t.location,e);i[0]=e[0];i[1]=e[1];i[2]=e[2];i[3]=e[3];return 1}return 0}else{Nt.mainContext.uniform2fv(t.location,e);return 1}};e._uniform_vec3=function(t,e){var i=t.uploadedValue;if(i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]){Nt.mainContext.uniform3f(t.location,i[0]=e[0],i[1]=e[1],i[2]=e[2]);return 1}return 0};e._uniform_vec3v=function(t,e){Nt.mainContext.uniform3fv(t.location,e);return 1};e._uniform_vec4=function(t,e){var i=t.uploadedValue;if(i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]||i[3]!==e[3]){Nt.mainContext.uniform4f(t.location,i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3]);return 1}return 0};e._uniform_vec4v=function(t,e){Nt.mainContext.uniform4fv(t.location,e);return 1};e._uniformMatrix2fv=function(t,e){Nt.mainContext.uniformMatrix2fv(t.location,false,e);return 1};e._uniformMatrix3fv=function(t,e){Nt.mainContext.uniformMatrix3fv(t.location,false,e);return 1};e._uniformMatrix4fv=function(t,e){Nt.mainContext.uniformMatrix4fv(t.location,false,e);return 1};e._uniform1i=function(t,e){var i=t.uploadedValue;if(i[0]!==e){Nt.mainContext.uniform1i(t.location,i[0]=e);return 1}return 0};e._uniform1iv=function(t,e){Nt.mainContext.uniform1iv(t.location,e);return 1};e._uniform_ivec2=function(t,e){var i=t.uploadedValue;if(i[0]!==e[0]||i[1]!==e[1]){Nt.mainContext.uniform2i(t.location,i[0]=e[0],i[1]=e[1]);return 1}return 0};e._uniform_ivec2v=function(t,e){Nt.mainContext.uniform2iv(t.location,e);return 1};e._uniform_vec3i=function(t,e){var i=t.uploadedValue;if(i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]){Nt.mainContext.uniform3i(t.location,i[0]=e[0],i[1]=e[1],i[2]=e[2]);return 1}return 0};e._uniform_vec3vi=function(t,e){Nt.mainContext.uniform3iv(t.location,e);return 1};e._uniform_vec4i=function(t,e){var i=t.uploadedValue;if(i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]||i[3]!==e[3]){Nt.mainContext.uniform4i(t.location,i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3]);return 1}return 0};e._uniform_vec4vi=function(t,e){Nt.mainContext.uniform4iv(t.location,e);return 1};e._uniform_sampler2D=function(t,e){var i=Nt.mainContext;var n=t.uploadedValue;if(n[0]==null){n[0]=this._curActTexIndex;i.uniform1i(t.location,this._curActTexIndex);i.activeTexture(f._TEXTURES[this._curActTexIndex]);Ot.bindTexture(i,3553,e);this._curActTexIndex++;return 1}else{i.activeTexture(f._TEXTURES[n[0]]);Ot.bindTexture(i,3553,e);return 0}};e._uniform_samplerCube=function(t,e){var i=Nt.mainContext;var n=t.uploadedValue;if(n[0]==null){n[0]=this._curActTexIndex;i.uniform1i(t.location,this._curActTexIndex);i.activeTexture(f._TEXTURES[this._curActTexIndex]);Ot.bindTexture(i,34067,e);this._curActTexIndex++;return 1}else{i.activeTexture(f._TEXTURES[n[0]]);Ot.bindTexture(i,34067,e);return 0}};e._noSetValue=function(t){console.log("no....:"+t.name)};e.uploadOne=function(t,e){this.activeResource();Ot.UseProgram(this._program);var i=this._paramsMap[t];i.fun.call(this,i,e)};e.uploadTexture2D=function(t){F.shaderCall++;var e=Nt.mainContext;e.activeTexture(33984);Ot.bindTexture(e,3553,t)};e.upload=function(t,e){Zt.activeShader=Zt.bindShader=this;this._lastUseFrameCount===F.loopCount||this.activeResource();Ot.UseProgram(this._program);if(this._reCompile){e=this._params;this._reCompile=false}else{e=e||this._params}var i=Nt.mainContext;var n,r,s=e.length,a=0;for(var o=0;o<s;o++){n=e[o];if((r=t[n.name])!==null)a+=n.fun.call(this,n,r)}F.shaderCall+=a};e.uploadArray=function(t,e,i){Zt.activeShader=this;Zt.bindShader=this;this.activeResource();Ot.UseProgram(this._program);var n=this._params,r;var s,a=0;for(var o=e-2;o>=0;o-=2){s=this._paramsMap[t[o]];if(!s)continue;r=t[o+1];if(r!=null){i&&i[s.name]&&i[s.name].bind();a+=s.fun.call(this,s,r)}}F.shaderCall+=a};e.getParams=function(){return this._params};f.getShader=function(t){return f.sharders[t]};f.create=function(t,e,i,n){return new f(t,e,i,n)};f.withCompile=function(t,e,i,n){if(i&&f.sharders[i])return f.sharders[i];var r=f._preCompileShader[2e-4*t];if(!r)throw new Error("withCompile shader err!"+t);return r.createShader(e,i,n)};f.withCompile2D=function(t,e,i,n,r){if(n&&f.sharders[n])return f.sharders[n];var s=f._preCompileShader[2e-4*t+e];if(!s)throw new Error("withCompile shader err!"+t+" "+e);return s.createShader(i,n,r)};f.addInclude=function(t,e){Rt.addInclude(t,e)};f.preCompile=function(t,e,i,n){var r=2e-4*t;f._preCompileShader[r]=new Rt(r,e,i,n)};f.preCompile2D=function(t,e,i,n,r){var s=2e-4*t+e;f._preCompileShader[s]=new Rt(s,i,n,r)};f._createShader=function(t,e,i){var n=t.createShader(i);t.shaderSource(n,e);t.compileShader(n);return n};f._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992];f._count=0;f._preCompileShader={};f.SHADERNAME2ID=2e-4;f.sharders=(f.sharders=[],f.sharders.length=32,f.sharders);a(f,["nameKey",function(){return this.nameKey=new U}]);return f}(Zt);var ce=function(t){function e(){this._maxsize=0;this._upload=true;this._uploadSize=0;e.__super.call(this);this.lock=true}v(e,"laya.webgl.utils.Buffer2D",t);var i=e.prototype;i.needSize=function(t){var e=this._byteLength;if(t){var i=this._byteLength+t;i<=this._buffer.byteLength||this._resizeBuffer(i<<1,true);this._byteLength=i}return e};i._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength);if(F.loopCount%30==0){if(this._buffer.byteLength>this._maxsize+64){this.memorySize=this._buffer.byteLength;this._buffer=this._buffer.slice(0,this._maxsize+64);this._checkArrayUse()}this._maxsize=this._byteLength}if(this._uploadSize<this._buffer.byteLength){this._uploadSize=this._buffer.byteLength;Jt._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage);this.memorySize=this._uploadSize}Jt._gl.bufferSubData(this._bufferType,0,this._buffer)};i._bufferSubData=function(t,e,i){t===void 0&&(t=0);e===void 0&&(e=0);i===void 0&&(i=0);this._maxsize=Math.max(this._maxsize,this._byteLength);if(F.loopCount%30==0){if(this._buffer.byteLength>this._maxsize+64){this.memorySize=this._buffer.byteLength;this._buffer=this._buffer.slice(0,this._maxsize+64);this._checkArrayUse()}this._maxsize=this._byteLength}if(this._uploadSize<this._buffer.byteLength){this._uploadSize=this._buffer.byteLength;Jt._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage);this.memorySize=this._uploadSize}if(e||i){var n=this._buffer.slice(e,i);Jt._gl.bufferSubData(this._bufferType,t,n)}else{Jt._gl.bufferSubData(this._bufferType,t,this._buffer)}};i._checkArrayUse=function(){};i._bind_upload=function(){if(!this._upload)return false;this._upload=false;this._bind();this._bufferData();return true};i._bind_subUpload=function(t,e,i){t===void 0&&(t=0);e===void 0&&(e=0);i===void 0&&(i=0);if(!this._upload)return false;this._upload=false;this._bind();this._bufferSubData(t,e,i);return true};i._resizeBuffer=function(t,e){if(t<this._buffer.byteLength)return this;this.memorySize=t;if(e&&this._buffer&&this._buffer.byteLength>0){var i=new ArrayBuffer(t);var n=new Uint8Array(i);n.set(new Uint8Array(this._buffer),0);this._buffer=i}else this._buffer=new ArrayBuffer(t);this._checkArrayUse();this._upload=true;return this};i.append=function(t){this._upload=true;var e=0,i;e=t.byteLength;if(t instanceof Uint8Array){this._resizeBuffer(this._byteLength+e,true);i=new Uint8Array(this._buffer,this._byteLength)}else if(t instanceof Uint16Array){this._resizeBuffer(this._byteLength+e,true);i=new Uint16Array(this._buffer,this._byteLength)}else if(t instanceof Float32Array){this._resizeBuffer(this._byteLength+e,true);i=new Float32Array(this._buffer,this._byteLength)}i.set(t,0);this._byteLength+=e;this._checkArrayUse()};i.appendU16Array=function(t,e){this._resizeBuffer(this._byteLength+e*2,true);var i=new Uint16Array(this._buffer,this._byteLength,e);for(var n=0;n<e;n++){i[n]=t[n]}this._byteLength+=e*2;this._checkArrayUse()};i.appendEx=function(t,e){this._upload=true;var i=0,n;i=t.byteLength;this._resizeBuffer(this._byteLength+i,true);n=new e(this._buffer,this._byteLength);n.set(t,0);this._byteLength+=i;this._checkArrayUse()};i.appendEx2=function(t,e,i,n){n===void 0&&(n=1);this._upload=true;var r=0,s;r=i*n;this._resizeBuffer(this._byteLength+r,true);s=new e(this._buffer,this._byteLength);var a=0;for(a=0;a<i;a++){s[a]=t[a]}this._byteLength+=r;this._checkArrayUse()};i.getBuffer=function(){return this._buffer};i.setNeedUpload=function(){this._upload=true};i.getNeedUpload=function(){return this._upload};i.upload=function(){var t=this._bind_upload();Jt._gl.bindBuffer(this._bufferType,null);Jt._bindActive[this._bufferType]=null;Zt.activeShader=null;return t};i.subUpload=function(t,e,i){t===void 0&&(t=0);e===void 0&&(e=0);i===void 0&&(i=0);var n=this._bind_subUpload();Jt._gl.bindBuffer(this._bufferType,null);Jt._bindActive[this._bufferType]=null;Zt.activeShader=null;return n};i.disposeResource=function(){t.prototype.disposeResource.call(this);this._upload=true;this._uploadSize=0};i.clear=function(){this._byteLength=0;this._upload=true};h(0,i,"bufferLength",function(){return this._buffer.byteLength});h(0,i,"byteLength",null,function(t){if(this._byteLength===t)return;t<=this._buffer.byteLength||this._resizeBuffer(t*2+256,true);this._byteLength=t});e.__int__=function(t){pe.QuadrangleIB=pe.create(35044);Lt.fillIBQuadrangle(pe.QuadrangleIB,16)};e.FLOAT32=4;e.SHORT=2;return e}(Jt);var fe=function(e){function i(t){this.u_blurX=false;this.u_color=null;this.u_offset=null;this.u_strength=NaN;this.u_texW=0;this.u_texH=0;i.__super.call(this,8|1)}v(i,"laya.webgl.shader.d2.value.GlowSV",e);var t=i.prototype;t.setValue=function(t){e.prototype.setValue.call(this,t)};t.clear=function(){e.prototype.clear.call(this)};return i}(ne);var _e=function(t){function e(t){e.__super.call(this,64);this.defines.add(64)}v(e,"laya.webgl.shader.d2.value.TextSV",t);var i=e.prototype;i.release=function(){e.pool[e._length++]=this;this.clear()};i.clear=function(){t.prototype.clear.call(this)};e.create=function(){if(e._length)return e.pool[--e._length];else return new e(null)};e.pool=[];e._length=0;return e}(ne);var de=function(t){function r(t,e,i,n){this._params2dQuick1=null;this._params2dQuick2=null;this._shaderValueWidth=NaN;this._shaderValueHeight=NaN;r.__super.call(this,t,e,i,n)}v(r,"laya.webgl.shader.d2.Shader2X",t);var e=r.prototype;e.upload2dQuick1=function(t){this.upload(t,this._params2dQuick1||this._make2dQuick1())};e._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource();this._params2dQuick1=[];var t=this._params,e;for(var i=0,n=t.length;i<n;i++){e=t[i];if(!L.isFlash&&(e.name==="size"||e.name==="position"||e.name==="texcoord"))continue;this._params2dQuick1.push(e)}}return this._params2dQuick1};e.disposeResource=function(){t.prototype.disposeResource.call(this);this._params2dQuick1=null;this._params2dQuick2=null};e.upload2dQuick2=function(t){this.upload(t,this._params2dQuick2||this._make2dQuick2())};e._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource();this._params2dQuick2=[];var t=this._params,e;for(var i=0,n=t.length;i<n;i++){e=t[i];if(!L.isFlash&&e.name==="size")continue;this._params2dQuick2.push(e)}}return this._params2dQuick2};r.create=function(t,e,i,n){return new r(t,e,i,n)};return r}(ue);var pe=function(t){function e(t){this._uint8Array=null;this._uint16Array=null;t===void 0&&(t=35044);e.__super.call(this);this._bufferUsage=t;this._bufferType=34963;L.isFlash||(this._buffer=new ArrayBuffer(8))}v(e,"laya.webgl.utils.IndexBuffer2D",t);var i=e.prototype;i._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer));this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))};i.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))};i.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))};i.destory=function(){this._uint16Array=null;this._uint8Array=null;this._buffer=null};e.QuadrangleIB=null;e.create=function(t){t===void 0&&(t=35044);return new e(t)};return e}(ce);var ve=function(i){function n(t,e){this._floatArray32=null;this._vertexStride=0;n.__super.call(this);this._vertexStride=t;this._bufferUsage=e;this._bufferType=34962;L.isFlash||(this._buffer=new ArrayBuffer(8));this.getFloat32Array()}v(n,"laya.webgl.utils.VertexBuffer2D",i);var t=n.prototype;t.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))};t.bind=function(t){t&&t._bind();this._bind()};t.insertData=function(t,e){var i=this.getFloat32Array();i.set(t,e);this._upload=true};t.bind_upload=function(t){t._bind_upload()||t._bind();this._bind_upload()||this._bind()};t._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))};t.disposeResource=function(){i.prototype.disposeResource.call(this);return;var t=Jt._enableAtributes;if(!L.isConchWebGL){for(var e=0;e<10;e++){Nt.mainContext.disableVertexAttribArray(e);t[e]=null}}};t.destory=function(){this._byteLength=0;this._upload=true;this._buffer=null;this._floatArray32=null};h(0,t,"vertexStride",function(){return this._vertexStride});n.create=function(t,e){e===void 0&&(e=35048);return new n(t,e)};return n}(ce);var ge=function(t){function u(t,e,i,n){this._format=0;this._mipmap=false;this._allowMerageInAtlas=false;this._enableMerageInAtlas=false;this.repeat=false;this._image=null;this.minFifter=0;this.magFifter=0;i===void 0&&(i=6408);n===void 0&&(n=true);u.__super.call(this,t,e);this._format=i;this._mipmap=n;this.repeat=false;this.minFifter=-1;this.magFifter=-1;if(typeof t=="string"){this._url=t;this._src=t;this._image=new _.window.Image;if(e){e.onload&&(this.onload=e.onload);e.onerror&&(this.onerror=e.onerror);e.onCreate&&e.onCreate(this)}this._image.crossOrigin=t&&t.indexOf("data:")==0?null:"";t&&(this._image.src=t)}else if(t instanceof ArrayBuffer){this._src=e;this._url=this._src;var r=new d(t);var s=r.readUTFBytes(4);var a=r.readUTFBytes(2);var o=r.getInt16();r.endian="bigEndian";this._w=r.getInt16();this._h=r.getInt16();var h=r.getInt16();var l=r.getInt16();this._image=new Uint8Array(t,r.pos);this._format=Nt.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL;Q.enabled&&(this._w<Q.atlasLimitWidth&&this._h<Q.atlasLimitHeight)?this._allowMerageInAtlas=true:this._allowMerageInAtlas=false}else{this._src=e;this._url=this._src;this._image=t["source"]||t;this.onresize()}this._$5__enableMerageInAtlas=true}v(u,"laya.webgl.resource.WebGLImage",t);var e=u.prototype;w.imps(e,{"laya.webgl.resource.IMergeAtlasBitmap":true});e._init_=function(t,e){};e._createWebGlTexture=function(){if(!this._image){throw"create GLTextur err:no data:"+this._image}var t=Nt.mainContext;var e=this._source=t.createTexture();var i=Ot.curBindTexTarget;var n=Ot.curBindTexValue;Ot.bindTexture(t,3553,e);if(L.isConchWebGL){switch(this._format){case 6408:t.texImage2DEx(true,3553,0,this._format,6408,5121,this._image);break;case Nt.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:t.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break}}else{t.pixelStorei(37441,true);switch(this._format){case 6408:t.texImage2D(3553,0,this._format,6408,5121,this._image);break;case Nt.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:t.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break}t.pixelStorei(37441,false)}var r=this.minFifter;var s=this.magFifter;var a=this.repeat?10497:33071;var o=c.isPOT(this._w,this._h);if(o){if(this.mipmap)r!==-1||(r=9987);else r!==-1||(r=9729);s!==-1||(s=9729);t.texParameteri(3553,10241,r);t.texParameteri(3553,10240,s);t.texParameteri(3553,10242,a);t.texParameteri(3553,10243,a);this.mipmap&&t.generateMipmap(3553)}else{r!==-1||(r=9729);s!==-1||(s=9729);t.texParameteri(3553,10241,r);t.texParameteri(3553,10240,s);t.texParameteri(3553,10242,33071);t.texParameteri(3553,10243,33071)}i&&n&&Ot.bindTexture(t,i,n);this._image.onload=null;this._image=null;if(o&&this.mipmap)this.memorySize=this._w*this._h*4*(1+1/3);else this.memorySize=this._w*this._h*4;this._recreateLock=false};e.recreateResource=function(){var t=this;if(this._src==null||this._src==="")return;this._needReleaseAgain=false;if(!this._image){this._recreateLock=true;var e=this;this._image=new _.window.Image;this._image.crossOrigin=this._src.indexOf("data:")==0?null:"";this._image.onload=function(){if(e._needReleaseAgain){e._needReleaseAgain=false;e._image.onload=null;e._image=null;return}!(e._allowMerageInAtlas&&e._enableMerageInAtlas)?e._createWebGlTexture():(t.memorySize=0,t._recreateLock=false);e.completeCreate()};this._image.src=this._src}else{if(this._recreateLock){return}!(this._allowMerageInAtlas&&this._$5__enableMerageInAtlas)?this._createWebGlTexture():(this.memorySize=0,this._recreateLock=false);this.completeCreate()}};e.disposeResource=function(){if(this._recreateLock){this._needReleaseAgain=true}if(this._source){Nt.mainContext.deleteTexture(this._source);this._source=null;this._image=null;this.memorySize=0}};e.onresize=function(){this._w=this._image.width;this._h=this._image.height;Q.enabled&&(this._w<Q.atlasLimitWidth&&this._h<Q.atlasLimitHeight)?this._allowMerageInAtlas=true:this._allowMerageInAtlas=false};e.clearAtlasSource=function(){this._image=null};h(0,e,"format",function(){return this._format});h(0,e,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function(t){this._$5__enableMerageInAtlas=t});h(0,e,"mipmap",function(){return this._mipmap});h(0,e,"allowMerageInAtlas",function(){return this._allowMerageInAtlas});h(0,e,"atlasSource",function(){return this._image});h(0,e,"onload",null,function(t){var e=this;this._onload=t;this._image&&(this._image.onload=this._onload!=null?function(){e.onresize();e._onload()}:null)});h(0,e,"onerror",null,function(t){var e=this;this._onerror=t;this._image&&(this._image.onerror=this._onerror!=null?function(){e._onerror()}:null)});return u}(b);w.__init([At,Z,Ft,Rt])})(window,document,Laya);if(typeof define==="function"&&define.amd){define("laya.core",["require","exports"],function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:true});for(var i in Laya){var n=Laya[i];n&&n.__isclass&&(e[i]=n)}})}(function(t,e,rt){var i=rt.un,n=rt.uns,r=rt.static,a=rt.class,o=rt.getset,g=rt.__newvec;var h=laya.maths.Bezier,c=laya.utils.Browser,Rt=laya.utils.Byte,s=laya.events.Event;var l=laya.events.EventDispatcher,u=laya.display.Graphics,f=laya.resource.HTMLCanvas;var v=laya.utils.Handler,_=laya.net.Loader,d=laya.maths.MathUtil,Nt=laya.maths.Matrix;var p=laya.display.Node,m=laya.maths.Point,y=laya.maths.Rectangle,x=laya.renders.Render;var b=laya.renders.RenderContext,w=laya.resource.Resource,T=laya.utils.RunDriver;var st=laya.display.Sprite,S=laya.utils.Stat,Ot=laya.resource.Texture,C=laya.net.URL,E=laya.utils.Utils;var L=function(){function t(){this.nodes=null;this.name=null;this.playTime=NaN;this.bone3DMap=null;this.totalKeyframeDatasLength=0}a(t,"laya.ani.AnimationContent");return t}();var P=function(){function t(){this.name=null;this.parentIndex=0;this.parent=null;this.keyframeWidth=0;this.lerpType=0;this.interpolationMethod=null;this.childs=null;this.keyFrame=null;this.playTime=NaN;this.extenData=null;this.dataOffset=0}a(t,"laya.ani.AnimationNodeContent");return t}();var A=function(){function t(){}a(t,"laya.ani.AnimationParser01");t.parse=function(t,e){var i=e.__getBuffer();var n=0,r=0,s=0,a=0,o=0,h=0,l=0;var u=e.readUTFString();t._aniClassName=u;var c=e.readUTFString().split("\n");var f=e.getUint8();var _=e.getUint32();var d=e.getUint32();var p;if(_>0)p=i.slice(_,d);var v=new Rt(p);if(d>0)t._publicExtData=i.slice(d,i.byteLength);t._useParent=!!e.getUint8();t._anis.length=f;for(n=0;n<f;n++){var g=t._anis[n]=new L;{}g.nodes=new Array;var m=g.name=c[e.getUint16()];t._aniMap[m]=n;g.bone3DMap={};g.playTime=e.getFloat32();var y=g.nodes.length=e.getUint8();g.totalKeyframeDatasLength=0;for(r=0;r<y;r++){var b=g.nodes[r]=new P;{}b.childs=[];var x=e.getInt16();if(x>=0){b.name=c[x];g.bone3DMap[b.name]=r}b.keyFrame=new Array;b.parentIndex=e.getInt16();b.parentIndex==-1?b.parent=null:b.parent=g.nodes[b.parentIndex];b.lerpType=e.getUint8();var w=e.getUint32();v.pos=w;var T=b.keyframeWidth=v.getUint16();g.totalKeyframeDatasLength+=T;if(b.lerpType===0||b.lerpType===1){b.interpolationMethod=[];b.interpolationMethod.length=T;for(s=0;s<T;s++)b.interpolationMethod[s]=H.interpolation[v.getUint8()]}if(b.parent!=null)b.parent.childs.push(b);var S=e.getUint16();if(S>0){b.extenData=i.slice(e.pos,e.pos+S);e.pos+=S}var C=e.getUint16();b.keyFrame.length=C;var E=0;var A;for(s=0,a=C;s<a;s++){A=b.keyFrame[s]=new U;{}A.duration=e.getFloat32();A.startTime=E;if(b.lerpType===2){A.interpolationData=[];var M=e.getUint8();var I=0;I=e.getFloat32();switch(I){case 254:A.interpolationData.length=T;for(l=0;l<T;l++)A.interpolationData[l]=0;break;case 255:A.interpolationData.length=T;for(l=0;l<T;l++)A.interpolationData[l]=5;break;default:A.interpolationData.push(I);for(h=1;h<M;h++){A.interpolationData.push(e.getFloat32())}}}A.data=new Float32Array(T);for(o=0;o<T;o++){A.data[o]=e.getFloat32();if(A.data[o]>-1e-8&&A.data[o]<1e-8)A.data[o]=0}E+=A.duration}A.startTime=g.playTime;b.playTime=g.playTime;t._calculateKeyFrame(b,C,T)}}};return t}();var M=function(){function w(){}a(w,"laya.ani.AnimationParser02");w.READ_DATA=function(){w._DATA.offset=w._reader.getUint32();w._DATA.size=w._reader.getUint32()};w.READ_BLOCK=function(){var t=w._BLOCK.count=w._reader.getUint16();var e=w._BLOCK.blockStarts=[];var i=w._BLOCK.blockLengths=[];for(var n=0;n<t;n++){e.push(w._reader.getUint32());i.push(w._reader.getUint32())}};w.READ_STRINGS=function(){var t=w._reader.getUint32();var e=w._reader.getUint16();var i=w._reader.pos;w._reader.pos=t+w._DATA.offset;for(var n=0;n<e;n++)w._strings[n]=w._reader.readUTFString();w._reader.pos=i};w.parse=function(t,e){w._templet=t;w._reader=e;var i=e.__getBuffer();w.READ_DATA();w.READ_BLOCK();w.READ_STRINGS();for(var n=0,r=w._BLOCK.count;n<r;n++){var s=e.getUint16();var a=w._strings[s];var o=w["READ_"+a];if(o==null)throw new Error("model file err,no this function:"+s+" "+a);else o.call()}};w.READ_ANIMATIONS=function(){var t=w._reader;var e=t.__getBuffer();var i=0,n=0,r=0,s=0,a=0;var o=t.getUint16();var h=[];h.length=o;for(i=0;i<o;i++)h[i]=H.interpolation[t.getByte()];var l=t.getUint8();w._templet._anis.length=l;for(i=0;i<l;i++){var u=w._templet._anis[i]={};u.nodes=new Array;var c=u.name=w._strings[t.getUint16()];w._templet._aniMap[c]=i;u.bone3DMap={};u.playTime=t.getFloat32();var f=u.nodes.length=t.getInt16();u.totalKeyframeDatasLength=0;for(n=0;n<f;n++){var _=u.nodes[n]={};_.keyframeWidth=o;_.childs=[];var d=t.getUint16();if(d>=0){_.name=w._strings[d];u.bone3DMap[_.name]=n}_.keyFrame=new Array;_.parentIndex=t.getInt16();_.parentIndex==-1?_.parent=null:_.parent=u.nodes[_.parentIndex];u.totalKeyframeDatasLength+=o;_.interpolationMethod=h;if(_.parent!=null)_.parent.childs.push(_);var p=t.getUint16();_.keyFrame.length=p;var v=null,g=null;for(r=0,s=p;r<s;r++){v=_.keyFrame[r]={};v.startTime=t.getFloat32();g&&(g.duration=v.startTime-g.startTime);var m=w._DATA.offset;var y=t.getUint32();var b=o*4;var x=e.slice(m+y,m+y+b);v.data=new Float32Array(x);g=v}v.duration=0;_.playTime=u.playTime;w._templet._calculateKeyFrame(_,p,o)}}};w._templet=null;w._reader=null;w._strings=[];r(w,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]);return w}();var I=function(){function t(){}a(t,"laya.ani.AnimationState");t.stopped=0;t.paused=1;t.playing=2;return t}();var Bt=function(){function s(){this.name=null;this.root=null;this.parentBone=null;this.length=10;this.transform=null;this.inheritScale=true;this.inheritRotation=true;this.rotation=NaN;this.resultRotation=NaN;this.d=-1;this._tempMatrix=null;this._sprite=null;this.resultTransform=new qt;this.resultMatrix=new Nt;this._children=[]}a(s,"laya.ani.bone.Bone");var t=s.prototype;t.setTempMatrix=function(t){this._tempMatrix=t;var e=0,i=0;var n;for(e=0,i=this._children.length;e<i;e++){n=this._children[e];n.setTempMatrix(this._tempMatrix)}};t.update=function(t){this.rotation=this.transform.skX;var e;if(t){e=this.resultTransform.getMatrix();Nt.mul(e,t,this.resultMatrix);this.resultRotation=this.rotation}else{this.resultRotation=this.rotation+this.parentBone.resultRotation;if(this.parentBone){if(this.inheritRotation&&this.inheritScale){e=this.resultTransform.getMatrix();Nt.mul(e,this.parentBone.resultMatrix,this.resultMatrix)}else{var i=0;var n=this.parentBone;var r=NaN;var s=NaN;var a=NaN;var o=this.parentBone.resultMatrix;e=this.resultTransform.getMatrix();var h=o.a*e.tx+o.c*e.ty+o.tx;var l=o.b*e.tx+o.d*e.ty+o.ty;var u=new Nt;if(this.inheritRotation){r=Math.atan2(n.resultMatrix.b,n.resultMatrix.a);s=Math.cos(r),a=Math.sin(r);u.setTo(s,a,-a,s,0,0);Nt.mul(this._tempMatrix,u,Nt.TEMP);Nt.TEMP.copyTo(u);e=this.resultTransform.getMatrix();Nt.mul(e,u,this.resultMatrix);if(this.resultTransform.scX*this.resultTransform.scY<0){this.resultMatrix.rotate(Math.PI*.5)}this.resultMatrix.tx=h;this.resultMatrix.ty=l}else if(this.inheritScale){e=this.resultTransform.getMatrix();Nt.TEMP.identity();Nt.TEMP.d=this.d;Nt.mul(e,Nt.TEMP,this.resultMatrix);this.resultMatrix.tx=h;this.resultMatrix.ty=l}else{e=this.resultTransform.getMatrix();Nt.TEMP.identity();Nt.TEMP.d=this.d;Nt.mul(e,Nt.TEMP,this.resultMatrix);this.resultMatrix.tx=h;this.resultMatrix.ty=l}}}else{e=this.resultTransform.getMatrix();e.copyTo(this.resultMatrix)}}var c=0,f=0;var _;for(c=0,f=this._children.length;c<f;c++){_=this._children[c];_.update()}};t.updateChild=function(){var t=0,e=0;var i;for(t=0,e=this._children.length;t<e;t++){i=this._children[t];i.update()}};t.setRotation=function(t){if(this._sprite){this._sprite.rotation=t*180/Math.PI}};t.updateDraw=function(t,e){if(!s.ShowBones||s.ShowBones[this.name]){if(this._sprite){this._sprite.x=t+this.resultMatrix.tx;this._sprite.y=e+this.resultMatrix.ty}else{this._sprite=new st;this._sprite.graphics.drawCircle(0,0,5,"#ff0000");this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00");this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center");rt.stage.addChild(this._sprite);this._sprite.x=t+this.resultMatrix.tx;this._sprite.y=e+this.resultMatrix.ty}}var i=0,n=0;var r;for(i=0,n=this._children.length;i<n;i++){r=this._children[i];r.updateDraw(t,e)}};t.addChild=function(t){this._children.push(t);t.parentBone=this};t.findBone=function(t){if(this.name==t){return this}else{var e=0,i=0;var n;var r;for(e=0,i=this._children.length;e<i;e++){n=this._children[e];r=n.findBone(t);if(r){return r}}}return null};t.localToWorld=function(t){var e=t[0];var i=t[1];t[0]=e*this.resultMatrix.a+i*this.resultMatrix.c+this.resultMatrix.tx;t[1]=e*this.resultMatrix.b+i*this.resultMatrix.d+this.resultMatrix.ty};s.ShowBones={};return s}();var Ft=function(){function b(){this.name=null;this.parent=null;this.attachmentName=null;this.srcDisplayIndex=-1;this.type="src";this.templet=null;this.currSlotData=null;this.currTexture=null;this.currDisplayData=null;this.displayIndex=-1;this.originalIndex=-1;this._diyTexture=null;this._parentMatrix=null;this._resultMatrix=null;this._replaceDic={};this._curDiyUV=null;this._curDiyVS=null;this._skinSprite=null;this.deformData=null;this._mVerticleArr=null}a(b,"laya.ani.bone.BoneSlot");var t=b.prototype;t.showSlotData=function(t,e){e===void 0&&(e=true);this.currSlotData=t;if(e)this.displayIndex=this.srcDisplayIndex;this.currDisplayData=null;this.currTexture=null};t.showDisplayByName=function(t){if(this.currSlotData){this.showDisplayByIndex(this.currSlotData.getDisplayByName(t))}};t.replaceDisplayByName=function(t,e){if(!this.currSlotData)return;var i=0;i=this.currSlotData.getDisplayByName(t);var n=0;n=this.currSlotData.getDisplayByName(e);this.replaceDisplayByIndex(i,n)};t.replaceDisplayByIndex=function(t,e){if(!this.currSlotData)return;this._replaceDic[t]=e;if(this.originalIndex==t){this.showDisplayByIndex(t)}};t.showDisplayByIndex=function(t){this.originalIndex=t;if(this._replaceDic[t]!=null)t=this._replaceDic[t];if(this.currSlotData&&t>-1&&t<this.currSlotData.displayArr.length){this.displayIndex=t;this.currDisplayData=this.currSlotData.displayArr[t];if(this.currDisplayData){var e=this.currDisplayData.name;this.currTexture=this.templet.getTexture(e);if(this.currTexture&&this.currDisplayData.type==0&&this.currDisplayData.uvs&&(!x.isConchApp||x.isConchApp&&st.RUNTIMEVERION>"0.9.15")){this.currTexture=this.currDisplayData.createTexture(this.currTexture)}}}else{this.displayIndex=-1;this.currDisplayData=null;this.currTexture=null}};t.replaceSkin=function(t){this._diyTexture=t;if(this._curDiyUV)this._curDiyUV.length=0;if(this.currDisplayData&&this._diyTexture==this.currDisplayData.texture){this._diyTexture=null}};t.setParentMatrix=function(t){this._parentMatrix=t};t.draw=function(t,e,i,n){i===void 0&&(i=false);n===void 0&&(n=1);if(this._diyTexture==null&&this.currTexture==null||this.currDisplayData==null){if(!(this.currDisplayData&&this.currDisplayData.type==3)){return}}var r=this.currTexture;if(this._diyTexture)r=this._diyTexture;var s;switch(this.currDisplayData.type){case 0:if(t){var a=this.getDisplayMatrix();if(this._parentMatrix){var o=false;if(a){Nt.mul(a,this._parentMatrix,Nt.TEMP);var h;if(i){if(this._resultMatrix==null)this._resultMatrix=new Nt;h=this._resultMatrix}else{h=new Nt}if(!x.isWebGL&&this.currDisplayData.uvs||x.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var l=b._tempMatrix;l.identity();if(this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]){l.d=-1}if(this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]){o=true;l.rotate(-Math.PI/2)}Nt.mul(l,Nt.TEMP,h)}else{Nt.TEMP.copyTo(h)}if(o){t.drawTexture(r,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,h)}else{t.drawTexture(r,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,h)}}}}break;case 1:if(i){if(this._skinSprite==null){this._skinSprite=b.createSkinMesh()}s=this._skinSprite}else{s=b.createSkinMesh()}if(s==null){return};var u;var c=1;var f=1;var _=1;var d=1;if(this.currDisplayData.bones==null){var p=this.currDisplayData.weights;if(this.deformData){p=this.deformData}var v;if(this._diyTexture){if(!this._curDiyUV){this._curDiyUV=[]}if(this._curDiyUV.length==0){this._curDiyUV=F.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV);this._curDiyUV=F.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)}v=this._curDiyUV}else{v=this.currDisplayData.uvs}this._mVerticleArr=p;var g=this.currDisplayData.triangles.length/3;u=this.currDisplayData.triangles;s.init2(r,null,u,this._mVerticleArr,v);var m=this.getDisplayMatrix();if(this._parentMatrix){if(m){Nt.mul(m,this._parentMatrix,Nt.TEMP);var y;if(i){if(this._resultMatrix==null)this._resultMatrix=new Nt;y=this._resultMatrix}else{y=new Nt}Nt.TEMP.copyTo(y);s.transform=y}}}else{this.skinMesh(e,s,n)}t.drawSkin(s);break;case 2:if(i){if(this._skinSprite==null){this._skinSprite=b.createSkinMesh()}s=this._skinSprite}else{s=b.createSkinMesh()}if(s==null){return}this.skinMesh(e,s,n);t.drawSkin(s);break;case 3:break}};t.skinMesh=function(t,e,i){var n=this.currTexture;var r=this.currDisplayData.bones;var s;if(this._diyTexture){n=this._diyTexture;if(!this._curDiyUV){this._curDiyUV=[]}if(this._curDiyUV.length==0){this._curDiyUV=F.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV);this._curDiyUV=F.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)}s=this._curDiyUV}else{s=this.currDisplayData.uvs}var a=this.currDisplayData.weights;var o=this.currDisplayData.triangles;var h;var l=0;var u=0;var c=0;var f;var _=NaN;var d=NaN;var p=0;var v=0;var g=[];var m=0,y=0,b=0;var x=1;var w=1;var T=1;var S=i;if(this.deformData&&this.deformData.length>0){var C=0;for(m=0,b=r.length;m<b;){c=r[m++]+m;l=0,u=0;for(;m<c;m++){f=t[r[m]];_=a[p]+this.deformData[C++];d=a[p+1]+this.deformData[C++];v=a[p+2];l+=(_*f.a+d*f.c+f.tx)*v;u+=(_*f.b+d*f.d+f.ty)*v;p+=3}g.push(l,u)}}else{for(m=0,b=r.length;m<b;){c=r[m++]+m;l=0,u=0;for(;m<c;m++){f=t[r[m]];_=a[p];d=a[p+1];v=a[p+2];l+=(_*f.a+d*f.c+f.tx)*v;u+=(_*f.b+d*f.d+f.ty)*v;p+=3}g.push(l,u)}}this._mVerticleArr=g;h=o;e.init2(n,null,h,this._mVerticleArr,s)};t.drawBonePoint=function(t){if(t&&this._parentMatrix){t.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")}};t.getDisplayMatrix=function(){if(this.currDisplayData){return this.currDisplayData.transform.getMatrix()}return null};t.getMatrix=function(){return this._resultMatrix};t.copy=function(){var t=new b;t.type="copy";t.name=this.name;t.attachmentName=this.attachmentName;t.srcDisplayIndex=this.srcDisplayIndex;t.parent=this.parent;t.displayIndex=this.displayIndex;t.templet=this.templet;t.currSlotData=this.currSlotData;t.currTexture=this.currTexture;t.currDisplayData=this.currDisplayData;return t};b.createSkinMesh=function(){if(x.isWebGL||x.isConchApp){return T.skinAniSprite()}else{if(!x.isWebGL){if(X.useSimpleMeshInCanvas){return new j}else{return new z}}}return null};r(b,["_tempMatrix",function(){return this._tempMatrix=new Nt}]);return b}();var k=function(){function t(){this.mesh=null;this.transform=null;this.context=null;this.mode=0}a(t,"laya.ani.bone.canvasmesh.CanvasMeshRender");var e=t.prototype;e.renderToContext=function(t){this.context=t.ctx||t;if(this.mesh){if(this.mode==0){this._renderWithIndexes(this.mesh)}else{this._renderNoIndexes(this.mesh)}}};e._renderNoIndexes=function(t){var e=0,i=t.vertices.length/2;var n=0;for(e=0;e<i-2;e++){n=e*2;this._renderDrawTriangle(t,n,n+2,n+4)}};e._renderWithIndexes=function(t){var e=t.indexes;var i=0,n=e.length;for(i=0;i<n;i+=3){var r=e[i]*2;var s=e[i+1]*2;var a=e[i+2]*2;this._renderDrawTriangle(t,r,s,a)}};e._renderDrawTriangle=function(t,e,i,n){var r=this.context;var s=t.uvs;var a=t.vertices;var o=t.texture;var h=o.bitmap;var l=h.source;var u=o.width;var c=o.height;var f=h.width;var _=h.height;var d=NaN;var p=NaN;var v=NaN;var g=NaN;var m=NaN;var y=NaN;if(t.useUvTransform){var b=t.uvTransform;d=(s[e]*b.a+s[e+1]*b.c+b.tx)*f;p=(s[i]*b.a+s[i+1]*b.c+b.tx)*f;v=(s[n]*b.a+s[n+1]*b.c+b.tx)*f;g=(s[e]*b.b+s[e+1]*b.d+b.ty)*_;m=(s[i]*b.b+s[i+1]*b.d+b.ty)*_;y=(s[n]*b.b+s[n+1]*b.d+b.ty)*_}else{d=s[e]*f;p=s[i]*f;v=s[n]*f;g=s[e+1]*_;m=s[i+1]*_;y=s[n+1]*_}var x=a[e];var w=a[i];var T=a[n];var S=a[e+1];var C=a[i+1];var E=a[n+1];if(t.canvasPadding>0){var A=t.canvasPadding;var M=t.canvasPadding;var I=(x+w+T)/3;var L=(S+C+E)/3;var P=x-I;var k=S-L;var D=Math.sqrt(P*P+k*k);x=I+P/D*(D+A);S=L+k/D*(D+M);P=w-I;k=C-L;D=Math.sqrt(P*P+k*k);w=I+P/D*(D+A);C=L+k/D*(D+M);P=T-I;k=E-L;D=Math.sqrt(P*P+k*k);T=I+P/D*(D+A);E=L+k/D*(D+M)}r.save();if(this.transform){var R=this.transform;r.transform(R.a,R.b,R.c,R.d,R.tx,R.ty)}r.beginPath();r.moveTo(x,S);r.lineTo(w,C);r.lineTo(T,E);r.closePath();r.clip();var N=d*m+g*v+p*y-m*v-g*p-d*y;var O=1/N;var B=x*m+g*T+w*y-m*T-g*w-x*y;var F=d*w+x*v+p*T-w*v-x*p-d*T;var U=d*m*T+g*w*v+x*p*y-x*m*v-g*p*T-d*w*y;var G=S*m+g*E+C*y-m*E-g*C-S*y;var V=d*C+S*v+p*E-C*v-S*p-d*E;var W=d*m*E+g*C*v+S*p*y-S*m*v-g*p*E-d*C*y;r.transform(B*O,G*O,F*O,V*O,U*O,W*O);r.drawImage(l,o.uv[0]*f,o.uv[1]*_,u,c,o.uv[0]*f,o.uv[1]*_,u,c);r.restore()};return t}();var D=function(){function t(){this.texture=null;this.uvs=[0,0,1,0,1,1,0,1];this.vertices=[0,0,100,0,100,100,0,100];this.indexes=[0,1,3,3,1,2];this.uvTransform=null;this.useUvTransform=false;this.canvasPadding=1}a(t,"laya.ani.bone.canvasmesh.MeshData");var e=t.prototype;e.getBounds=function(){return y._getWrapRec(this.vertices)};return t}();var Ut=function(){function t(){this.skinName=null;this.deformSlotDataList=[]}a(t,"laya.ani.bone.DeformAniData");return t}();var Gt=function(){function t(){this.deformSlotDisplayList=[]}a(t,"laya.ani.bone.DeformSlotData");return t}();var Vt=function(){function t(){this.boneSlot=null;this.slotIndex=-1;this.attachment=null;this.deformData=null;this.frameIndex=0;this.timeList=[];this.vectices=[];this.tweenKeyList=[]}a(t,"laya.ani.bone.DeformSlotDisplayData");var e=t.prototype;e.binarySearch1=function(t,e){var i=0;var n=t.length-2;if(n==0)return 1;var r=n>>>1;while(true){if(t[Math.floor(r+1)]<=e)i=r+1;else n=r;if(i==n)return i+1;r=i+n>>>1}return 0};e.apply=function(t,e,i){i===void 0&&(i=1);t+=.05;if(this.timeList.length<=0){return}var n=0;var r=0;var s=this.timeList[0];if(t<s){return}var a=this.vectices[0].length;var o=[];var h=this.binarySearch1(this.timeList,t);this.frameIndex=h;if(t>=this.timeList[this.timeList.length-1]){var l=this.vectices[this.vectices.length-1];if(i<1){for(n=0;n<a;n++){o[n]+=(l[n]-o[n])*i}}else{for(n=0;n<a;n++){o[n]=l[n]}}this.deformData=o;return}var u=this.tweenKeyList[this.frameIndex];var c=this.vectices[this.frameIndex-1];var f=this.vectices[this.frameIndex];var _=this.timeList[this.frameIndex-1];var d=this.timeList[this.frameIndex];if(this.tweenKeyList[h-1]){i=(t-_)/(d-_)}else{i=0}var p=NaN;for(n=0;n<a;n++){p=c[n];o[n]=p+(f[n]-p)*i}this.deformData=o};return t}();var Wt=function(){function t(){this.time=NaN;this.drawOrder=[]}a(t,"laya.ani.bone.DrawOrderData");return t}();var zt=function(){function t(){this.name=null;this.intValue=0;this.floatValue=NaN;this.stringValue=null;this.time=NaN}a(t,"laya.ani.bone.EventData");return t}();var R=function(){function nt(t,e){this._targetBone=null;this._bones=null;this._data=null;this.name=null;this.mix=NaN;this.bendDirection=NaN;this.isSpine=true;this._sp=null;this.isDebug=false;this._data=t;this._targetBone=e[t.targetBoneIndex];this.isSpine=t.isSpine;if(this._bones==null)this._bones=[];this._bones.length=0;for(var i=0,n=t.boneIndexs.length;i<n;i++){this._bones.push(e[t.boneIndexs[i]])}this.name=t.name;this.mix=t.mix;this.bendDirection=t.bendDirection}a(nt,"laya.ani.bone.IkConstraint");var t=nt.prototype;t.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:if(this.isSpine){this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}else{this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}break}};t._applyIk1=function(t,e,i,n){var r=t.parentBone;var s=1/(r.resultMatrix.a*r.resultMatrix.d-r.resultMatrix.b*r.resultMatrix.c);var a=e-r.resultMatrix.tx;var o=i-r.resultMatrix.ty;var h=(a*r.resultMatrix.d-o*r.resultMatrix.c)*s-t.transform.x;var l=(o*r.resultMatrix.a-a*r.resultMatrix.b)*s-t.transform.y;var u=Math.atan2(l,h)*nt.radDeg-0-t.transform.skX;if(t.transform.scX<0)u+=180;if(u>180)u-=360;else if(u<-180)u+=360;t.transform.skX=t.transform.skY=t.transform.skX+u*n;t.update()};t.updatePos=function(t,e){if(this._sp){this._sp.pos(t,e)}};t._applyIk2=function(t,e,i,n,r,s){if(s==0){return}var a=t.resultTransform.x,o=t.resultTransform.y;var h=t.transform.scX,l=t.transform.scY;var u=e.transform.scX;var c=0,f=0,_=0;if(h<0){h=-h;c=180;_=-1}else{c=0;_=1}if(l<0){l=-l;_=-_}if(u<0){u=-u;f=180}else{f=0}var d=e.resultTransform.x,p=NaN,v=NaN,g=NaN;var m=t.resultMatrix.a,y=t.resultMatrix.c;var b=t.resultMatrix.b,x=t.resultMatrix.d;var w=Math.abs(h-l)<=1e-4;if(!w){p=0;v=m*d+t.resultMatrix.tx;g=b*d+t.resultMatrix.ty}else{p=e.resultTransform.y;v=m*d+y*p+t.resultMatrix.tx;g=b*d+x*p+t.resultMatrix.ty}if(this.isDebug){if(!this._sp){this._sp=new st;rt.stage.addChild(this._sp)}this._sp.graphics.clear();this._sp.graphics.drawCircle(i,n,15,"#ffff00");this._sp.graphics.drawCircle(v,g,15,"#ff00ff")}t.setRotation(Math.atan2(g-t.resultMatrix.ty,v-t.resultMatrix.tx));var T=t.parentBone;m=T.resultMatrix.a;y=T.resultMatrix.c;b=T.resultMatrix.b;x=T.resultMatrix.d;var S=1/(m*x-y*b);var C=i-T.resultMatrix.tx,E=n-T.resultMatrix.ty;var A=(C*x-E*y)*S-a;var M=(E*m-C*b)*S-o;C=v-T.resultMatrix.tx;E=g-T.resultMatrix.ty;var I=(C*x-E*y)*S-a;var L=(E*m-C*b)*S-o;var P=Math.sqrt(I*I+L*L);var k=e.length*u;var D=NaN,R=NaN;if(w){k*=h;var N=(A*A+M*M-P*P-k*k)/(2*P*k);if(N<-1)N=-1;else if(N>1)N=1;R=Math.acos(N)*r;m=P+k*N;y=k*Math.sin(R);D=Math.atan2(M*m-A*y,A*m+M*y)}else{m=h*k;y=l*k;var O=m*m,B=y*y,F=A*A+M*M,U=Math.atan2(M,A);b=B*P*P+O*F-O*B;var G=-2*B*P,V=B-O;x=G*G-4*V*b;if(x>0){var W=Math.sqrt(x);if(G<0)W=-W;W=-(G+W)/2;var z=W/V,H=b/W;var Y=Math.abs(z)<Math.abs(H)?z:H;if(Y*Y<=F){E=Math.sqrt(F-Y*Y)*r;D=U-Math.atan2(E,Y);R=Math.atan2(E/l,(Y-P)/h)}}var j=0,X=Number.MAX_VALUE,$=0,K=0;var q=0,Z=0,Q=0,J=0;C=P+m;x=C*C;if(x>Z){q=0;Z=x;Q=C}C=P-m;x=C*C;if(x<X){j=Math.PI;X=x;$=C}var tt=Math.acos(-m*P/(O-B));C=m*Math.cos(tt)+P;E=y*Math.sin(tt);x=C*C+E*E;if(x<X){j=tt;X=x;$=C;K=E}if(x>Z){q=tt;Z=x;Q=C;J=E}if(F<=(X+Z)/2){D=U-Math.atan2(K*r,$);R=j*r}else{D=U-Math.atan2(J*r,Q);R=q*r}}var et=Math.atan2(p,d)*_;var it=t.resultTransform.skX;D=(D-et)*nt.radDeg+c-it;if(D>180)D-=360;else if(D<-180)D+=360;t.resultTransform.x=a;t.resultTransform.y=o;t.resultTransform.skX=t.resultTransform.skY=it+D*s;it=e.resultTransform.skX;it=it%360;R=((R+et)*nt.radDeg-0)*_+f-it;if(R>180)R-=360;else if(R<-180)R+=360;e.resultTransform.x=d;e.resultTransform.y=p;e.resultTransform.skX=e.resultTransform.skY=e.resultTransform.skY+R*s;t.update()};t._applyIk3=function(t,e,i,n,r,s){if(s==0){return}var a=NaN,o=NaN;var h=e.resultMatrix.a*e.length;var l=e.resultMatrix.b*e.length;var u=h*h+l*l;var c=Math.sqrt(u);var f=t.resultMatrix.tx;var _=t.resultMatrix.ty;var d=e.resultMatrix.tx;var p=e.resultMatrix.ty;var v=d-f;var g=p-_;var m=v*v+g*g;var y=Math.sqrt(m);v=i-t.resultMatrix.tx;g=n-t.resultMatrix.ty;var b=v*v+g*g;var x=Math.sqrt(b);var w=0;if(c+y<=x||x+c<=y||x+y<=c){var T=NaN;if(c+y<=x){T=1}else{T=-1}d=f+T*(i-f)*y/x;p=_+T*(n-_)*y/x}else{var S=(m-u+b)/(2*b);var C=Math.sqrt(m-S*S*b)/x;var E=f+v*S;var A=_+g*S;var M=-g*C;var I=v*C;if(r>0){d=E-M;p=A-I}else{d=E+M;p=A+I}}a=d;o=p;if(this.isDebug){if(!this._sp){this._sp=new st;rt.stage.addChild(this._sp)}this._sp.graphics.clear();this._sp.graphics.drawCircle(f,_,15,"#ff00ff");this._sp.graphics.drawCircle(i,n,15,"#ffff00");this._sp.graphics.drawCircle(a,o,15,"#ff00ff")}var L=NaN;L=Math.atan2(o-t.resultMatrix.ty,a-t.resultMatrix.tx);t.setRotation(L);var P;P=nt._tempMatrix;P.identity();P.rotate(L);P.scale(t.resultMatrix.getScaleX(),t.resultMatrix.getScaleY());P.translate(t.resultMatrix.tx,t.resultMatrix.ty);P.copyTo(t.resultMatrix);t.updateChild();var k=NaN;k=Math.atan2(n-o,i-a);e.setRotation(k);var D;D=nt._tempMatrix;D.identity();D.rotate(k);D.scale(e.resultMatrix.getScaleX(),e.resultMatrix.getScaleY());D.translate(a,o);P.copyTo(e.resultMatrix);e.updateChild()};r(nt,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new Nt}]);return nt}();var Ht=function(){function t(){this.name=null;this.targetBoneName=null;this.bendDirection=1;this.mix=1;this.isSpine=true;this.targetBoneIndex=-1;this.boneNames=[];this.boneIndexs=[]}a(t,"laya.ani.bone.IkConstraintData");return t}();var N=function(){function d(){}a(d,"laya.ani.bone.MeshTools");d.findEdge=function(t,e,i){e===void 0&&(e=0);i===void 0&&(i=true);var n=0,r=0;var s=0;r=t.length;s=-1;for(n=0;n<r;n+=2){if(s<0||i==t[s+e]<t[n+e]){s=n}}return s};d.findBestTriangle=function(t){var e=0;e=d.findEdge(t,1,true);var i=0;i=d.findEdge(t,1,false);var n=0;n=d.findEdge(t,0,true);var r=0;r=d.findEdge(t,0,false);var s;s=d._bestTriangle;s.length=0;s.push(n,r);if(s.indexOf(e)<0)s.push(e);if(s.indexOf(i)<0)s.push(i);return s};d.solveMesh=function(t,e){e=e||[];e.length=0;var i;i=t.uvs;var n;n=t.vertices;var r;var s;s=d.findBestTriangle(i);var a=0;var o=0;var h=0;a=s[0];o=s[1];h=s[2];d._absArr.length=0;var l;if(d.isNormalUV(t.texture.uv)){d.adptTexture(t)}r=d.solvePoints(t.texture.uv,i[a],i[a+1],i[o]-i[a],i[o+1]-i[a+1],i[h]-i[a],i[h+1]-i[a+1],d._absArr);l=d.transPoints(r,n[a],n[a+1],n[o]-n[a],n[o+1]-n[a+1],n[h]-n[a],n[h+1]-n[a+1],e);return l};d.findWrapRect=function(t){var e=0;e=d.findEdge(t,1,true);var i=0;i=d.findEdge(t,1,false);var n=0;n=d.findEdge(t,0,true);var r=0;r=d.findEdge(t,0,false);var s=NaN;s=t[n];var a=NaN;a=t[r];var o=NaN;o=t[e+1];var h=NaN;h=t[i+1];var l;return[a,h,s-a,o-h]};d.adptTexture=function(t){var e;e=d.findWrapRect(t.uvs);var i;var n;i=t.texture;var r=i.width;var s=i.height;n=Ot.create(i,e[0]*r,e[1]*s,e[2]*r,e[3]*s);t.texture=n};d.isNormalUV=function(t){return t[0]==0&&t[1]==0&&t[4]==1&&t[5]==1};d.solvePoints=function(t,e,i,n,r,s,a,o){o=o||[];var h=0,l=0;l=t.length;var u;for(h=0;h<l;h+=2){u=d.solve2(t[h],t[h+1],e,i,n,r,s,a);o.push(u[0],u[1])}return o};d.transPoints=function(t,e,i,n,r,s,a,o){o=o||[];var h=0,l=0;l=t.length;var u;for(h=0;h<l;h+=2){u=d.transPoint(t[h],t[h+1],e,i,n,r,s,a,o)}return o};d.transPoint=function(t,e,i,n,r,s,a,o,h){h=h||[];var l=NaN;var u=NaN;l=i+r*t+a*e;u=n+s*t+o*e;h.push(l,u);return h};d.solve2=function(t,e,i,n,r,s,a,o,h,l){h===void 0&&(h=false);l=l||[];var u=NaN,c=NaN;if(r==0){return d.solve2(t,e,i,n,a,o,r,s,true,l)}var f=NaN;var _=NaN;f=t-i;_=e-n;c=(_-f*s/r)/(o-a*s/r);u=(f-c*a)/r;if(h){l.push(c,u)}else{l.push(u,c)}return l};d.solve=function(t,e,i,n){return d.solve2(t.x,t.y,e.x,e.y,i.x,i.y,n.x,n.y)};d._bestTriangle=[];d._absArr=[];return d}();var O=function(){function ot(t,e){this.target=null;this.data=null;this.bones=null;this.position=NaN;this.spacing=NaN;this.rotateMix=NaN;this.translateMix=NaN;this._debugKey=false;this._spaces=null;this._segments=[];this._curves=[];this.data=t;this.position=t.position;this.spacing=t.spacing;this.rotateMix=t.rotateMix;this.translateMix=t.translateMix;this.bones=[];var i=this.data.bones;for(var n=0,r=i.length;n<r;n++){this.bones.push(e[i[n]])}}a(ot,"laya.ani.bone.PathConstraint");var t=ot.prototype;t.apply=function(t,e){if(!this.target)return;var i=this.translateMix;var n=this.translateMix;var r=i>0;var s=n>0;var a=this.data.spacingMode;var o=a=="length";var h=this.data.rotateMode;var l=h=="tangent";var u=h=="chainScale";var c=[];var f=this.bones.length;var _=l?f:f+1;var d=[];this._spaces=d;d[0]=this.position;var p=this.spacing;if(u||o){for(var v=0,g=_-1;v<g;){var m=this.bones[v];var y=m.length;var b=y*m.resultMatrix.a;var x=y*m.resultMatrix.b;y=Math.sqrt(b*b+x*x);if(u)c[v]=y;d[++v]=o?Math.max(0,y+p):p}}else{for(v=1;v<_;v++){d[v]=p}}var w=this.computeWorldPositions(this.target,t,e,_,l,this.data.positionMode=="percent",a=="percent");if(this._debugKey){for(v=0;v<w.length;v++){e.drawCircle(w[v++],w[v++],5,"#00ff00")}var T=[];for(v=0;v<w.length;v++){T.push(w[v++],w[v++])}e.drawLines(0,0,T,"#ff0000")}var S=NaN;var C=NaN;var E=w[0];var A=w[1];var M=this.data.offsetRotation;var I=h=="chain"&&M==0;var L=NaN;for(v=0,L=3;v<f;v++,L+=3){m=this.bones[v];m.resultMatrix.tx+=(E-m.resultMatrix.tx)*i;m.resultMatrix.ty+=(A-m.resultMatrix.ty)*i;b=w[L];x=w[L+1];var P=b-E,k=x-A;if(u){y=c[v];if(y!=0){var D=(Math.sqrt(P*P+k*k)/y-1)*n+1;m.resultMatrix.a*=D;m.resultMatrix.c*=D}}E=b;A=x;if(s){var R=m.resultMatrix.a;var N=m.resultMatrix.c;var O=m.resultMatrix.b;var B=m.resultMatrix.d;var F=NaN;var U=NaN;var G=NaN;if(l){F=w[L-1]}else if(d[v+1]==0){F=w[L+2]}else{F=Math.atan2(k,P)}F-=Math.atan2(O,R)-M/180*Math.PI;if(I){U=Math.cos(F);G=Math.sin(F);y=m.length;E+=(y*(U*R-G*O)-P)*n;A+=(y*(G*R+U*O)-k)*n}if(F>Math.PI){F-=Math.PI*2}else if(F<-Math.PI){F+=Math.PI*2}F*=n;U=Math.cos(F);G=Math.sin(F);m.resultMatrix.a=U*R-G*O;m.resultMatrix.c=U*N-G*B;m.resultMatrix.b=G*R+U*O;m.resultMatrix.d=G*N+U*B}}};t.computeWorldVertices2=function(t,e,i,n,r,s){var a=t.currDisplayData.bones;var o=t.currDisplayData.weights;var h=t.currDisplayData.triangles;var l;var u=0;var c=0;var f=0;var _=0;var d=0;var p=0;var v=0;var g=0;var m=0;var y=0;var b;var x=0;if(a==null){if(!h)h=o;if(t.deformData)h=t.deformData;var w;w=t.parent;if(e){x=e.length;for(u=0;u<x;u++){if(e[u].name==w){b=e[u];break}}}var T;if(b){T=b.resultMatrix}if(!T)T=ot._tempMt;var S=T.tx;var C=T.ty;var E=T.a,A=T.b,M=T.c,I=T.d;if(b)I*=b.d;for(c=i,d=s;d<n;c+=2,d+=2){m=h[c],y=h[c+1];r[d]=m*E+y*A+S;r[d+1]=-(m*M+y*I+C)}return}for(u=0;u<i;u+=2){_=a[c];c+=_+1;f+=_}var L=e;for(d=s,p=f*3;d<n;d+=2){v=0,g=0;_=a[c++];_+=c;for(;c<_;c++,p+=3){l=L[a[c]].resultMatrix;m=o[p];y=o[p+1];var P=o[p+2];v+=(m*l.a+y*l.c+l.tx)*P;g+=(m*l.b+y*l.d+l.ty)*P}r[d]=v;r[d+1]=g}};t.computeWorldPositions=function(t,e,i,n,r,s,a){var o=t.currDisplayData.bones;var h=t.currDisplayData.weights;var l=t.currDisplayData.triangles;var u=0;var c=0;var f=0;var _;var d=NaN;var p=NaN;var v=0;var g=0;var m=[];var y=0,b=0,x=0;var w=t.currDisplayData.verLen;var T=t;var S=this.position;var C=this._spaces;var E=[];var A=[];var M=false;var I=w/6;var L=-1;var P=NaN;var k=0,D=0;var R=NaN;var N=NaN;var O=NaN;var B=NaN;if(!true){var F=t.currDisplayData.lengths;I-=M?1:2;P=F[I];if(s)S*=P;if(a){for(y=0;y<n;y++)C[y]*=P}E.length=8;for(y=0,k=0,D=0;y<n;y++,k+=3){N=C[y];S+=N;R=S;if(M){R%=P;if(R<0)R+=P;D=0}else if(R<0){if(L!=ot.BEFORE){L=ot.BEFORE;this.computeWorldVertices2(T,e,2,4,E,0)}this.addBeforePosition(R,E,0,A,k);continue}else if(R>P){if(L!=ot.AFTER){L=ot.AFTER;this.computeWorldVertices2(T,e,w-6,4,E,0)}this.addAfterPosition(R-P,E,0,A,k);continue}for(;;D++){B=F[D];if(R>B)continue;if(D==0)R/=B;else{O=F[D-1];R=(R-O)/(B-O)}break}if(D!=L){L=D;if(M&&D==I){this.computeWorldVertices2(T,e,w-4,4,E,0);this.computeWorldVertices2(T,e,0,4,E,4)}else this.computeWorldVertices2(T,e,D*6+2,8,E,0)}this.addCurvePosition(R,E[0],E[1],E[2],E[3],E[4],E[5],E[6],E[7],A,k,r||y>0&&N==0)}return A}if(M){w+=2;E[w-2]=E[0];E[w-1]=E[1]}else{I--;w-=4;this.computeWorldVertices2(t,e,2,w,m,0);if(this._debugKey){for(y=0;y<m.length;){i.drawCircle(m[y++],m[y++],10,"#ff0000")}}E=m}this._curves.length=I;var U=this._curves;P=0;var G=E[0],V=E[1],W=0,z=0,H=0,Y=0,j=0,X=0;var $=NaN,K=NaN,q=NaN,Z=NaN,Q=NaN,J=NaN,tt=NaN,et=NaN;var it=0;for(y=0,it=2;y<I;y++,it+=6){W=E[it];z=E[it+1];H=E[it+2];Y=E[it+3];j=E[it+4];X=E[it+5];$=(G-W*2+H)*.1875;K=(V-z*2+Y)*.1875;q=((W-H)*3-G+j)*.09375;Z=((z-Y)*3-V+X)*.09375;Q=$*2+q;J=K*2+Z;tt=(W-G)*.75+$+q*.16666667;et=(z-V)*.75+K+Z*.16666667;P+=Math.sqrt(tt*tt+et*et);tt+=Q;et+=J;Q+=q;J+=Z;P+=Math.sqrt(tt*tt+et*et);tt+=Q;et+=J;P+=Math.sqrt(tt*tt+et*et);tt+=Q+q;et+=J+Z;P+=Math.sqrt(tt*tt+et*et);U[y]=P;G=j;V=X}if(s)S*=P;if(a){for(y=0;y<n;y++)C[y]*=P}var nt=this._segments;var rt=0;var st=0;for(y=0,k=0,D=0,st=0;y<n;y++,k+=3){N=C[y];S+=N;R=S;if(M){R%=P;if(R<0)R+=P;D=0}else if(R<0){this.addBeforePosition(R,E,0,A,k);continue}else if(R>P){this.addAfterPosition(R-P,E,w-4,A,k);continue}for(;;D++){B=U[D];if(R>B)continue;if(D==0)R/=B;else{O=U[D-1];R=(R-O)/(B-O)}break}if(D!=L){L=D;var at=D*6;G=E[at];V=E[at+1];W=E[at+2];z=E[at+3];H=E[at+4];Y=E[at+5];j=E[at+6];X=E[at+7];$=(G-W*2+H)*.03;K=(V-z*2+Y)*.03;q=((W-H)*3-G+j)*.006;Z=((z-Y)*3-V+X)*.006;Q=$*2+q;J=K*2+Z;tt=(W-G)*.3+$+q*.16666667;et=(z-V)*.3+K+Z*.16666667;rt=Math.sqrt(tt*tt+et*et);nt[0]=rt;for(at=1;at<8;at++){tt+=Q;et+=J;Q+=q;J+=Z;rt+=Math.sqrt(tt*tt+et*et);nt[at]=rt}tt+=Q;et+=J;rt+=Math.sqrt(tt*tt+et*et);nt[8]=rt;tt+=Q+q;et+=J+Z;rt+=Math.sqrt(tt*tt+et*et);nt[9]=rt;st=0}R*=rt;for(;;st++){B=nt[st];if(R>B)continue;if(st==0)R/=B;else{O=nt[st-1];R=st+(R-O)/(B-O)}break}this.addCurvePosition(R*.1,G,V,W,z,H,Y,j,X,A,k,r||y>0&&N==0)}return A};t.addBeforePosition=function(t,e,i,n,r){var s=e[i],a=e[i+1],o=e[i+2]-s,h=e[i+3]-a,l=Math.atan2(h,o);n[r]=s+t*Math.cos(l);n[r+1]=a+t*Math.sin(l);n[r+2]=l};t.addAfterPosition=function(t,e,i,n,r){var s=e[i+2],a=e[i+3],o=s-e[i],h=a-e[i+1],l=Math.atan2(h,o);n[r]=s+t*Math.cos(l);n[r+1]=a+t*Math.sin(l);n[r+2]=l};t.addCurvePosition=function(t,e,i,n,r,s,a,o,h,l,u,c){if(t==0)t=1e-4;var f=t*t,_=f*t,d=1-t,p=d*d,v=p*d;var g=d*t,m=g*3,y=d*m,b=m*t;var x=e*v+n*y+s*b+o*_,w=i*v+r*y+a*b+h*_;l[u]=x;l[u+1]=w;if(c){l[u+2]=Math.atan2(w-(i*p+r*g*2+a*f),x-(e*p+n*g*2+s*f))}else{l[u+2]=0}};ot.NONE=-1;ot.BEFORE=-2;ot.AFTER=-3;r(ot,["_tempMt",function(){return this._tempMt=new Nt}]);return ot}();var Yt=function(){function t(){this.name=null;this.target=null;this.positionMode=null;this.spacingMode=null;this.rotateMode=null;this.offsetRotation=NaN;this.position=NaN;this.spacing=NaN;this.rotateMix=NaN;this.translateMix=NaN;this.bones=[]}a(t,"laya.ani.bone.PathConstraintData");return t}();var jt=function(){function t(){this.name=null;this.slotArr=[]}a(t,"laya.ani.bone.SkinData");return t}();var Xt=function(){function t(){this.name=null;this.attachmentName=null;this.type=0;this.transform=null;this.width=NaN;this.height=NaN;this.texture=null;this.bones=null;this.uvs=null;this.weights=null;this.triangles=null;this.vertices=null;this.lengths=null;this.verLen=0}a(t,"laya.ani.bone.SkinSlotDisplayData");var e=t.prototype;e.createTexture=function(t){if(this.texture)return this.texture;this.texture=new Ot(t.bitmap,this.uvs);if(this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]){this.texture.width=t.height;this.texture.height=t.width;this.texture.offsetX=-t.offsetX;this.texture.offsetY=-t.offsetY;this.texture.sourceWidth=t.sourceHeight;this.texture.sourceHeight=t.sourceWidth}else{this.texture.width=t.width;this.texture.height=t.height;this.texture.offsetX=-t.offsetX;this.texture.offsetY=-t.offsetY;this.texture.sourceWidth=t.sourceWidth;this.texture.sourceHeight=t.sourceHeight}if(!x.isWebGL){if(this.uvs[1]>this.uvs[5]){this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY}}return this.texture};e.destory=function(){if(this.texture)this.texture.destroy()};return t}();var $t=function(){function t(){this.name=null;this.displayArr=[]}a(t,"laya.ani.bone.SlotData");var e=t.prototype;e.getDisplayByName=function(t){var e;for(var i=0,n=this.displayArr.length;i<n;i++){e=this.displayArr[i];if(e.attachmentName==t){return i}}return-1};return t}();var B=function(){function t(t,e){this._data=null;this._bones=null;this.target=null;this.rotateMix=NaN;this.translateMix=NaN;this.scaleMix=NaN;this.shearMix=NaN;this._temp=g(2,0);this._data=t;if(this._bones==null){this._bones=[]}this.target=e[t.targetIndex];var i=0,n=0;for(i=0,n=t.boneIndexs.length;i<n;i++){this._bones.push(e[t.boneIndexs[i]])}this.rotateMix=t.rotateMix;this.translateMix=t.translateMix;this.scaleMix=t.scaleMix;this.shearMix=t.shearMix}a(t,"laya.ani.bone.TfConstraint");var e=t.prototype;e.apply=function(){var t;var e=this.target.resultMatrix.a,i=this.target.resultMatrix.b,n=this.target.resultMatrix.c,r=this.target.resultMatrix.d;for(var s=0,a=this._bones.length;s<a;s++){t=this._bones[s];if(this.rotateMix>0){var o=t.resultMatrix.a,h=t.resultMatrix.b,l=t.resultMatrix.c,u=t.resultMatrix.d;var c=Math.atan2(n,e)-Math.atan2(l,o)+this._data.offsetRotation*Math.PI/180;if(c>Math.PI)c-=Math.PI*2;else if(c<-Math.PI)c+=Math.PI*2;c*=this.rotateMix;var f=Math.cos(c),_=Math.sin(c);t.resultMatrix.a=f*o-_*l;t.resultMatrix.b=f*h-_*u;t.resultMatrix.c=_*o+f*l;t.resultMatrix.d=_*h+f*u}if(this.translateMix){this._temp[0]=this._data.offsetX;this._temp[1]=this._data.offsetY;this.target.localToWorld(this._temp);t.resultMatrix.tx+=(this._temp[0]-t.resultMatrix.tx)*this.translateMix;t.resultMatrix.ty+=(this._temp[1]-t.resultMatrix.ty)*this.translateMix;t.updateChild()}if(this.scaleMix>0){var d=Math.sqrt(t.resultMatrix.a*t.resultMatrix.a+t.resultMatrix.c*t.resultMatrix.c);var p=Math.sqrt(e*e+n*n);var v=d>1e-5?(d+(p-d+this._data.offsetScaleX)*this.scaleMix)/d:0;t.resultMatrix.a*=v;t.resultMatrix.c*=v;d=Math.sqrt(t.resultMatrix.b*t.resultMatrix.b+t.resultMatrix.d*t.resultMatrix.d);p=Math.sqrt(i*i+r*r);v=d>1e-5?(d+(p-d+this._data.offsetScaleY)*this.scaleMix)/d:0;t.resultMatrix.b*=v;t.resultMatrix.d*=v}if(this.shearMix>0){h=t.resultMatrix.b,u=t.resultMatrix.d;var g=Math.atan2(u,h);c=Math.atan2(r,i)-Math.atan2(n,e)-(g-Math.atan2(t.resultMatrix.c,t.resultMatrix.a));if(c>Math.PI)c-=Math.PI*2;else if(c<-Math.PI)c+=Math.PI*2;c=g+(c+this._data.offsetShearY*Math.PI/180)*this.shearMix;v=Math.sqrt(h*h+u*u);t.resultMatrix.b=Math.cos(c)*v;t.resultMatrix.d=Math.sin(c)*v}}};return t}();var Kt=function(){function t(){this.name=null;this.targetIndex=0;this.rotateMix=NaN;this.translateMix=NaN;this.scaleMix=NaN;this.shearMix=NaN;this.offsetRotation=NaN;this.offsetX=NaN;this.offsetY=NaN;this.offsetScaleX=NaN;this.offsetScaleY=NaN;this.offsetShearY=NaN;this.boneIndexs=[]}a(t,"laya.ani.bone.TfConstraintData");return t}();var qt=function(){function t(){this.skX=0;this.skY=0;this.scX=1;this.scY=1;this.x=0;this.y=0;this.skewX=0;this.skewY=0;this.mMatrix=null}a(t,"laya.ani.bone.Transform");var e=t.prototype;e.initData=function(t){if(t.x!=undefined){this.x=t.x}if(t.y!=undefined){this.y=t.y}if(t.skX!=undefined){this.skX=t.skX}if(t.skY!=undefined){this.skY=t.skY}if(t.scX!=undefined){this.scX=t.scX}if(t.scY!=undefined){this.scY=t.scY}};e.getMatrix=function(){var t;if(this.mMatrix){t=this.mMatrix}else{t=this.mMatrix=new Nt}t.identity();t.scale(this.scX,this.scY);if(this.skewX||this.skewY){this.skew(t,this.skewX*Math.PI/180,this.skewY*Math.PI/180)}t.rotate(this.skX*Math.PI/180);t.translate(this.x,this.y);return t};e.skew=function(t,e,i){var n=Math.sin(i);var r=Math.cos(i);var s=Math.sin(e);var a=Math.cos(e);t.setTo(t.a*a-t.b*n,t.a*s+t.b*r,t.c*a-t.d*n,t.c*s+t.d*r,t.tx*a-t.ty*n,t.tx*s+t.ty*r);return t};return t}();var F=function(){function t(){}a(t,"laya.ani.bone.UVTools");t.getRelativeUV=function(t,e,i){var n=t[0];var r=t[2]-t[0];var s=t[1];var a=t[5]-t[1];if(!i)i=[];i.length=e.length;var o=0,h=0;h=i.length;var l=1/r;var u=1/a;for(o=0;o<h;o+=2){i[o]=(e[o]-n)*l;i[o+1]=(e[o+1]-s)*u}return i};t.getAbsoluteUV=function(t,e,i){if(t[0]==0&&t[1]==0&&t[4]==1&&t[5]==1){if(i){E.copyArray(i,e);return i}else{return e}}var n=t[0];var r=t[2]-t[0];var s=t[1];var a=t[5]-t[1];if(!i)i=[];i.length=e.length;var o=0,h=0;h=i.length;for(o=0;o<h;o+=2){i[o]=e[o]*r+n;i[o+1]=e[o+1]*a+s}return i};return t}();var U=function(){function t(){this.startTime=NaN;this.duration=NaN;this.interpolationData=null;this.data=null;this.nextData=null}a(t,"laya.ani.KeyFramesContent");return t}();var G=function(){function u(){}a(u,"laya.ani.math.BezierLerp");u.getBezierRate=function(t,e,i,n,r){var s=u._getBezierParamKey(e,i,n,r);var a=s*100+t;if(u._bezierResultCache[a])return u._bezierResultCache[a];var o=u._getBezierPoints(e,i,n,r,s);var h=0,l=0;l=o.length;for(h=0;h<l;h+=2){if(t<=o[h]){u._bezierResultCache[a]=o[h+1];return o[h+1]}}u._bezierResultCache[a]=1;return 1};u._getBezierParamKey=function(t,e,i,n){return(((t*100+e)*100+i)*100+n)*100};u._getBezierPoints=function(t,e,i,n,r){if(u._bezierPointsCache[r])return u._bezierPointsCache[r];var s;s=[0,0,t,e,i,n,1,1];var a;a=new h;var o;o=a.getBezierPoints(s,100,3);u._bezierPointsCache[r]=o;return o};u._bezierResultCache={};u._bezierPointsCache={};return u}();var V=function(t){function e(){this._destroyed=false;this._templet=null;this._currentTime=NaN;this._currentFrameTime=NaN;this._playStart=NaN;this._playEnd=NaN;this._playDuration=NaN;this._overallDuration=NaN;this._stopWhenCircleFinish=false;this._elapsedPlaybackTime=NaN;this._startUpdateLoopCount=NaN;this._currentAnimationClipIndex=0;this._currentKeyframeIndex=0;this._paused=false;this._cacheFrameRate=0;this._cacheFrameRateInterval=NaN;this._cachePlayRate=NaN;this._fullFrames=null;this.isCache=true;this.playbackRate=1;this.returnToZeroStopped=false;e.__super.call(this);this._destroyed=false;this._currentAnimationClipIndex=-1;this._currentKeyframeIndex=-1;this._currentTime=0;this._overallDuration=Number.MAX_VALUE;this._stopWhenCircleFinish=false;this._elapsedPlaybackTime=0;this._startUpdateLoopCount=-1;this._cachePlayRate=1;this.cacheFrameRate=60;this.returnToZeroStopped=false}a(e,"laya.ani.AnimationPlayer",t);var i=e.prototype;rt.imps(i,{"laya.resource.IDestroy":true});i._onTempletLoadedComputeFullKeyframeIndices=function(t,e,i){if(this._templet===i&&this._cachePlayRate===t&&this._cacheFrameRate===e)this._computeFullKeyframeIndices()};i._computeFullKeyframeIndices=function(){var t=this._fullFrames=[];var e=this._templet;var i=this._cacheFrameRateInterval*this._cachePlayRate;for(var n=0,r=e.getAnimationCount();n<r;n++){var s=[];for(var a=0,o=e.getAnimation(n).nodes.length;a<o;a++){var h=e.getAnimation(n).nodes[a];var l=Math.floor(h.playTime/i+.01);var u=new Uint16Array(l+1);var c=-1;for(var f=0,_=h.keyFrame.length;f<_;f++){var d=h.keyFrame[f];var p=d.startTime;var v=p+d.duration+i;do{var g=Math.floor(p/i+.5);for(var m=c+1;m<g;m++)u[m]=f;c=g;u[g]=f;p+=i}while(p<=v)}s.push(u)}t.push(s)}};i._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()};i._calculatePlayDuration=function(){if(this.state!==0){var t=this._templet.getAniDuration(this._currentAnimationClipIndex);this._playEnd===0&&(this._playEnd=t);if(this._playEnd>t)this._playEnd=t;this._playDuration=this._playEnd-this._playStart}};i._setPlayParams=function(t,e){this._currentTime=t;this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/e+.01),0);this._currentFrameTime=this._currentKeyframeIndex*e};i._setPlayParamsWhenStop=function(t,e){this._currentTime=t;this._currentKeyframeIndex=Math.max(Math.floor(t/e+.01),0);this._currentFrameTime=this._currentKeyframeIndex*e;this._currentAnimationClipIndex=-1};i._update=function(t){if(this._currentAnimationClipIndex===-1||this._paused||!this._templet||!this._templet.loaded)return;var e=this._cacheFrameRateInterval*this._cachePlayRate;var i=0;this._startUpdateLoopCount!==S.loopCount&&(i=t*this.playbackRate,this._elapsedPlaybackTime+=i);var n=this.playDuration;if(this._overallDuration!==0&&this._elapsedPlaybackTime>=this._overallDuration||this._overallDuration===0&&this._elapsedPlaybackTime>=n){this._setPlayParamsWhenStop(n,e);this.event("stopped");return}i+=this._currentTime;if(n>0){if(i>=n){do{i-=n;if(this._stopWhenCircleFinish){this._setPlayParamsWhenStop(n,e);this._stopWhenCircleFinish=false;this.event("stopped");return}if(i<n){this._setPlayParams(i,e);this.event("complete")}}while(i>=n)}else{this._setPlayParams(i,e)}}else{if(this._stopWhenCircleFinish){this._setPlayParamsWhenStop(n,e);this._stopWhenCircleFinish=false;this.event("stopped");return}this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0;this.event("complete")}};i._destroy=function(){this.offAll();this._templet=null;this._fullFrames=null;this._destroyed=true};i.play=function(t,e,i,n,r){t===void 0&&(t=0);e===void 0&&(e=1);i===void 0&&(i=2147483647);n===void 0&&(n=0);r===void 0&&(r=0);if(!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(i<0||n<0||r<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(r!==0&&n>r)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0;this._currentFrameTime=0;this._elapsedPlaybackTime=0;this.playbackRate=e;this._overallDuration=i;this._playStart=n;this._playEnd=r;this._paused=false;this._currentAnimationClipIndex=t;this._currentKeyframeIndex=0;this._startUpdateLoopCount=S.loopCount;this.event("played");if(this._templet.loaded)this._calculatePlayDuration();else this._templet.once("loaded",this,this._onAnimationTempletLoaded);this._update(0)};i.playByFrame=function(t,e,i,n,r,s){t===void 0&&(t=0);e===void 0&&(e=1);i===void 0&&(i=2147483647);n===void 0&&(n=0);r===void 0&&(r=0);s===void 0&&(s=30);var a=1e3/s;this.play(t,e,i,n*a,r*a)};i.stop=function(t){t===void 0&&(t=true);if(t){this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0;this._currentAnimationClipIndex=-1;this.event("stopped")}else{this._stopWhenCircleFinish=true}};o(0,i,"playEnd",function(){return this._playEnd});o(0,i,"templet",function(){return this._templet},function(t){if(!this.state===0)this.stop(true);if(this._templet!==t){this._templet=t;if(t.loaded)this._computeFullKeyframeIndices();else t.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate])}});o(0,i,"playStart",function(){return this._playStart});o(0,i,"playDuration",function(){return this._playDuration});o(0,i,"state",function(){if(this._currentAnimationClipIndex===-1)return 0;if(this._paused)return 1;return 2});o(0,i,"currentKeyframeIndex",function(){return this._currentKeyframeIndex});o(0,i,"overallDuration",function(){return this._overallDuration});o(0,i,"currentFrameTime",function(){return this._currentFrameTime});o(0,i,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex});o(0,i,"currentPlayTime",function(){return this._currentTime+this._playStart});o(0,i,"cachePlayRate",function(){return this._cachePlayRate},function(t){if(this._cachePlayRate!==t){this._cachePlayRate=t;if(this._templet)if(this._templet.loaded)this._computeFullKeyframeIndices();else this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[t,this._cacheFrameRate])}});o(0,i,"cacheFrameRate",function(){return this._cacheFrameRate},function(t){if(this._cacheFrameRate!==t){this._cacheFrameRate=t;this._cacheFrameRateInterval=1e3/this._cacheFrameRate;if(this._templet)if(this._templet.loaded)this._computeFullKeyframeIndices();else this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,t])}});o(0,i,"currentTime",null,function(t){if(this._currentAnimationClipIndex===-1||!this._templet||!this._templet.loaded)return;if(t<this._playStart||t>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=S.loopCount;var e=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=t;this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/e),0);this._currentFrameTime=this._currentKeyframeIndex*e});o(0,i,"paused",function(){return this._paused},function(t){this._paused=t;t&&this.event("paused")});o(0,i,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval});o(0,i,"destroyed",function(){return this._destroyed});return e}(l);var W=function(t){function e(){e.__super.call(this);if(x.isConchNode){this["drawSkin"]=function(t){t.transform||(t.transform=Nt.EMPTY);this._addCmd([t]);this.setSkinMesh&&this.setSkinMesh(t._ps,t.mVBData,t.mEleNum,0,t.mTexture,t.transform)}}}a(e,"laya.ani.GraphicsAni",t);var i=e.prototype;i.drawSkin=function(t){var e=[t];this._saveToCmd(x._context._drawSkin,e)};e.create=function(){var t=e._caches.pop();return t||new e};e.recycle=function(t){t.clear();e._caches.push(t)};e._caches=[];return e}(u);var z=function(t){function n(){n.__super.call(this);this.mesh=new D}a(n,"laya.ani.bone.canvasmesh.SkinMeshCanvas",t);var e=n.prototype;e.init2=function(t,e,i,n,r){if(this.transform){this.transform=null}var s;if(i){s=i}else{s=[];s.push(0,1,3,3,1,2)}this.mesh.texture=t;this.mesh.indexes=s;this.mesh.vertices=n;this.mesh.uvs=r};e.render=function(t,e,i){if(!this.mesh.texture)return;if(!this.transform){this.transform=n._tempMatrix;this.transform.identity();this.transform.translate(e,i);this.renderToContext(t);this.transform.translate(-e,-i);this.transform=null}else{this.transform.translate(e,i);this.renderToContext(t);this.transform.translate(-e,-i)}};r(n,["_tempMatrix",function(){return this._tempMatrix=new Nt}]);return n}(k);var H=function(t){function y(){this._aniMap={};this.unfixedLastAniIndex=-1;y.__super.call(this);this._anis=new Array}a(y,"laya.ani.AnimationTemplet",t);var e=y.prototype;e.parse=function(t){var e=new Rt(t);this._aniVersion=e.readUTFString();A.parse(this,e)};e._calculateKeyFrame=function(t,e,i){var n=t.keyFrame;n[e]=n[0];for(var r=0;r<e;r++){var s=n[r];s.nextData=s.duration===0?s.data:n[r+1].data}n.length--};e.onAsynLoaded=function(t,e,i){var n=new Rt(e);this._aniVersion=n.readUTFString();switch(this._aniVersion){case"LAYAANIMATION:02":M.parse(this,n);break;default:A.parse(this,n)}this._endLoaded()};e.disposeResource=function(){this._aniVersion=null;this._anis=null;this._aniMap=null;this._publicExtData=null;this.unfixedCurrentFrameIndexes=null;this.unfixedCurrentTimes=null;this.unfixedKeyframes=null;this._aniClassName=null;this._animationDatasCache=null};e.getAnimationCount=function(){return this._anis.length};e.getAnimation=function(t){return this._anis[t]};e.getAniDuration=function(t){return this._anis[t].playTime};e.getNodes=function(t){return this._anis[t].nodes};e.getNodeIndexWithName=function(t,e){return this._anis[t].bone3DMap[e]};e.getNodeCount=function(t){return this._anis[t].nodes.length};e.getTotalkeyframesLength=function(t){return this._anis[t].totalKeyframeDatasLength};e.getPublicExtData=function(){return this._publicExtData};e.getAnimationDataWithCache=function(t,e,i,n){var r=e[i];if(!r){return null}else{var s=r[t];if(!s)return null;else{return s[n]}}};e.setAnimationDataWithCache=function(t,e,i,n,r){var s=e[i]||(e[i]={});var a=s[t]||(s[t]=[]);a[n]=r};e.getOriginalData=function(t,e,i,n,r){var s=this._anis[t];var a=s.nodes;var o=0;for(var h=0,l=a.length,u=0;h<l;h++){var c=a[h];var f;f=c.keyFrame[i[h][n]];c.dataOffset=u;var _=r-f.startTime;var d=c.lerpType;if(d){switch(d){case 0:case 1:for(o=0;o<c.keyframeWidth;)o+=c.interpolationMethod[o](c,o,e,u+o,f.data,_,null,f.duration,f.nextData);break;case 2:;var p=f.interpolationData;var v=p.length;var g=0;for(o=0;o<v;){var m=p[o];switch(m){case 6:o+=y.interpolation[m](c,g,e,u+g,f.data,_,null,f.duration,f.nextData,p,o+1);break;case 7:o+=y.interpolation[m](c,g,e,u+g,f.data,_,null,f.duration,f.nextData,p,o+1);break;default:o+=y.interpolation[m](c,g,e,u+g,f.data,_,null,f.duration,f.nextData)}g++}break}}else{for(o=0;o<c.keyframeWidth;)o+=c.interpolationMethod[o](c,o,e,u+o,f.data,_,null,f.duration,f.nextData)}u+=c.keyframeWidth}};e.getNodesCurrentFrameIndex=function(t,e){var i=this._anis[t];var n=i.nodes;if(t!==this.unfixedLastAniIndex){this.unfixedCurrentFrameIndexes=new Uint32Array(n.length);this.unfixedCurrentTimes=new Float32Array(n.length);this.unfixedLastAniIndex=t}for(var r=0,s=n.length,a=0;r<s;r++){var o=n[r];if(e<this.unfixedCurrentTimes[r])this.unfixedCurrentFrameIndexes[r]=0;this.unfixedCurrentTimes[r]=e;while(this.unfixedCurrentFrameIndexes[r]<o.keyFrame.length){if(o.keyFrame[this.unfixedCurrentFrameIndexes[r]].startTime>this.unfixedCurrentTimes[r])break;this.unfixedCurrentFrameIndexes[r]++}this.unfixedCurrentFrameIndexes[r]--}return this.unfixedCurrentFrameIndexes};e.getOriginalDataUnfixedRate=function(t,e,i){var n=this._anis[t];var r=n.nodes;if(t!==this.unfixedLastAniIndex){this.unfixedCurrentFrameIndexes=new Uint32Array(r.length);this.unfixedCurrentTimes=new Float32Array(r.length);this.unfixedKeyframes=g(r.length);this.unfixedLastAniIndex=t}var s=0;for(var a=0,o=r.length,h=0;a<o;a++){var l=r[a];if(i<this.unfixedCurrentTimes[a])this.unfixedCurrentFrameIndexes[a]=0;this.unfixedCurrentTimes[a]=i;while(this.unfixedCurrentFrameIndexes[a]<l.keyFrame.length){if(l.keyFrame[this.unfixedCurrentFrameIndexes[a]].startTime>this.unfixedCurrentTimes[a])break;this.unfixedKeyframes[a]=l.keyFrame[this.unfixedCurrentFrameIndexes[a]];this.unfixedCurrentFrameIndexes[a]++}var u=this.unfixedKeyframes[a];l.dataOffset=h;var c=i-u.startTime;var f=l.lerpType;if(f){switch(l.lerpType){case 0:case 1:for(s=0;s<l.keyframeWidth;)s+=l.interpolationMethod[s](l,s,e,h+s,u.data,c,null,u.duration,u.nextData);break;case 2:;var _=u.interpolationData;var d=_.length;var p=0;for(s=0;s<d;){var v=_[s];switch(v){case 6:s+=y.interpolation[v](l,p,e,h+p,u.data,c,null,u.duration,u.nextData,_,s+1);break;case 7:s+=y.interpolation[v](l,p,e,h+p,u.data,c,null,u.duration,u.nextData,_,s+1);break;default:s+=y.interpolation[v](l,p,e,h+p,u.data,c,null,u.duration,u.nextData)}p++}break}}else{for(s=0;s<l.keyframeWidth;)s+=l.interpolationMethod[s](l,s,e,h+s,u.data,c,null,u.duration,u.nextData)}h+=l.keyframeWidth}};y._LinearInterpolation_0=function(t,e,i,n,r,s,a,o,h,l){var u=o===0?0:s/o;i[n]=(1-u)*r[e]+u*h[e];return 1};y._QuaternionInterpolation_1=function(t,e,i,n,r,s,a,o,h,l){var u=o===0?0:s/o;d.slerpQuaternionArray(r,e,h,e,u,i,n);return 4};y._AngleInterpolation_2=function(t,e,i,n,r,s,a,o,h,l){return 0};y._RadiansInterpolation_3=function(t,e,i,n,r,s,a,o,h,l){return 0};y._Matrix4x4Interpolation_4=function(t,e,i,n,r,s,a,o,h,l){for(var u=0;u<16;u++,e++)i[n+u]=r[e]+s*a[e];return 16};y._NoInterpolation_5=function(t,e,i,n,r,s,a,o,h,l){i[n]=r[e];return 1};y._BezierInterpolation_6=function(t,e,i,n,r,s,a,o,h,l,u){u===void 0&&(u=0);i[n]=r[e]+(h[e]-r[e])*G.getBezierRate(s/o,l[u],l[u+1],l[u+2],l[u+3]);return 5};y._BezierInterpolation_7=function(t,e,i,n,r,s,a,o,h,l,u){u===void 0&&(u=0);i[n]=l[u+4]+l[u+5]*G.getBezierRate((s*.001+l[u+6])/l[u+7],l[u],l[u+1],l[u+2],l[u+3]);return 9};y.load=function(t){return rt.loader.create(t,null,null,y)};y.interpolation=[y._LinearInterpolation_0,y._QuaternionInterpolation_1,y._AngleInterpolation_2,y._RadiansInterpolation_3,y._Matrix4x4Interpolation_4,y._NoInterpolation_5,y._BezierInterpolation_6,y._BezierInterpolation_7];return y}(w);var Y=function(t){function n(){this.isCached=false;this.canvas=null;this.tex=null;this.rec=null;n.__super.call(this)}a(n,"laya.ani.bone.canvasmesh.CacheAbleSkinMesh",t);var e=n.prototype;e.getCanvasPic=function(){var t=new f("2D");var e=t.getContext("2d");this.rec=this.mesh.getBounds();debugger;t.size(this.rec.width,this.rec.height);var i;i=this.transform;this.transform=n.tempMt;this.transform.identity();this.transform.translate(-this.rec.x,-this.rec.y);this.renderToContext(e);this.transform.translate(+this.rec.x,+this.rec.y);this.transform=i;return new Ot(t)};e.render=function(t,e,i){if(!this.mesh.texture)return;if(!this.isCached){this.isCached=true;this.tex=this.getCanvasPic()}if(!this.transform){this.transform=z._tempMatrix;this.transform.identity();this.transform.translate(e,i);this._renderTextureToContext(t);this.transform.translate(-e,-i);this.transform=null}else{this.transform.translate(e,i);this._renderTextureToContext(t);this.transform.translate(-e,-i)}};e._renderTextureToContext=function(t){this.context=t.ctx||t;t.save();var e;e=this.tex;if(this.transform){var i=this.transform;t.transform(i.a,i.b,i.c,i.d,i.tx,i.ty)}this.rec=this.mesh.getBounds();t.translate(this.rec.x,this.rec.y);t.drawTexture(e,0,0,e.width,e.height,0,0);t.restore()};r(n,["tempMt",function(){return this.tempMt=new Nt}]);return n}(z);var j=function(s){function t(){this.cacheOK=false;this.cacheCmdOK=false;this.transformCmds=[];this.drawCmds=[];t.__super.call(this);this.tempMesh=new D}a(t,"laya.ani.bone.canvasmesh.SimpleSkinMeshCanvas",s);var e=t.prototype;e.init2=function(t,e,i,n,r){s.prototype.init2.call(this,t,e,i,n,r);this.cacheOK=false;this.cacheCmdOK=false;this.transformCmds.length=6;this.drawCmds.length=9};e.renderToContext=function(t){this.context=t.ctx||t;if(this.mesh){if(this.mesh.uvs.length<=8){if(this.mode==0){this._renderWithIndexes(this.mesh)}else{this._renderNoIndexes(this.mesh)}return}if(!this.cacheOK){this.tempMesh.texture=this.mesh.texture;this.tempMesh.uvs=this.mesh.texture.uv;this.tempMesh.vertices=N.solveMesh(this.mesh,this.tempMesh.vertices);this.cacheOK=true}if(this.mode==0){this._renderWithIndexes(this.tempMesh)}else{this._renderNoIndexes(this.tempMesh)}}};e._renderWithIndexes=function(t){if(this.cacheCmdOK){this.renderByCache(t);return}var e=t.indexes;var i=0,n=e.length;if(n>1)n=1;for(i=0;i<n;i+=3){var r=e[i]*2;var s=e[i+1]*2;var a=e[i+2]*2;this._renderDrawTriangle(t,r,s,a)}this.cacheCmdOK=true};e._renderDrawTriangle=function(t,e,i,n){var r=this.context;var s=t.uvs;var a=t.vertices;var o=t.texture;var h=o.bitmap;var l=h.source;var u=o.width;var c=o.height;var f=h.width;var _=h.height;var d=NaN;var p=NaN;var v=NaN;var g=NaN;var m=NaN;var y=NaN;if(t.useUvTransform){var b=t.uvTransform;d=(s[e]*b.a+s[e+1]*b.c+b.tx)*f;p=(s[i]*b.a+s[i+1]*b.c+b.tx)*f;v=(s[n]*b.a+s[n+1]*b.c+b.tx)*f;g=(s[e]*b.b+s[e+1]*b.d+b.ty)*_;m=(s[i]*b.b+s[i+1]*b.d+b.ty)*_;y=(s[n]*b.b+s[n+1]*b.d+b.ty)*_}else{d=s[e]*f;p=s[i]*f;v=s[n]*f;g=s[e+1]*_;m=s[i+1]*_;y=s[n+1]*_}var x=a[e];var w=a[i];var T=a[n];var S=a[e+1];var C=a[i+1];var E=a[n+1];var A=d*m+g*v+p*y-m*v-g*p-d*y;var M=1/A;var I=x*m+g*T+w*y-m*T-g*w-x*y;var L=d*w+x*v+p*T-w*v-x*p-d*T;var P=d*m*T+g*w*v+x*p*y-x*m*v-g*p*T-d*w*y;var k=S*m+g*E+C*y-m*E-g*C-S*y;var D=d*C+S*v+p*E-C*v-S*p-d*E;var R=d*m*E+g*C*v+S*p*y-S*m*v-g*p*E-d*C*y;this.transformCmds[0]=I*M;this.transformCmds[1]=k*M;this.transformCmds[2]=L*M;this.transformCmds[3]=D*M;this.transformCmds[4]=P*M;this.transformCmds[5]=R*M;this.drawCmds[0]=l;this.drawCmds[1]=o.uv[0]*f;this.drawCmds[2]=o.uv[1]*_;this.drawCmds[3]=u;this.drawCmds[4]=c;this.drawCmds[5]=o.uv[0]*f;this.drawCmds[6]=o.uv[1]*_;this.drawCmds[7]=u;this.drawCmds[8]=c;r.save();if(this.transform){var N=this.transform;r.transform(N.a,N.b,N.c,N.d,N.tx,N.ty)}r.transform.apply(r,this.transformCmds);r.drawImage.apply(r,this.drawCmds);r.restore()};e.renderByCache=function(t){var e=this.context;e.save();if(this.transform){var i=this.transform;e.transform(i.a,i.b,i.c,i.d,i.tx,i.ty)}e.transform.apply(e,this.transformCmds);e.drawImage.apply(e,this.drawCmds);e.restore()};return t}(z);var X=function(e){function i(t,e){this._templet=null;this._player=null;this._curOriginalData=null;this._boneMatrixArray=[];this._lastTime=0;this._currAniName=null;this._currAniIndex=-1;this._pause=true;this._aniClipIndex=-1;this._clipIndex=-1;this._skinIndex=0;this._skinName="default";this._aniMode=0;this._graphicsCache=null;this._boneSlotDic=null;this._bindBoneBoneSlotDic=null;this._boneSlotArray=null;this._index=-1;this._total=-1;this._indexControl=false;this._aniPath=null;this._texturePath=null;this._complete=null;this._loadAniMode=0;this._yReverseMatrix=null;this._ikArr=null;this._tfArr=null;this._pathDic=null;this._rootBone=null;this._boneList=null;this._aniSectionDic=null;this._eventIndex=0;this._drawOrderIndex=0;this._drawOrder=null;this._lastAniClipIndex=-1;this._lastUpdateAniClipIndex=-1;i.__super.call(this);e===void 0&&(e=0);if(t)this.init(t,e)}a(i,"laya.ani.bone.Skeleton",e);var t=i.prototype;t.init=function(t,e){e===void 0&&(e=0);var i=0,n=0;if(e==1){this._graphicsCache=[];for(i=0,n=t.getAnimationCount();i<n;i++){this._graphicsCache.push([])}}this._yReverseMatrix=t.yReverseMatrix;this._aniMode=e;this._templet=t;this._player=new V;this._player.cacheFrameRate=t.rate;this._player.templet=t;this._player.play();this._parseSrcBoneMatrix();this._boneList=t.mBoneArr;this._rootBone=t.mRootBone;this._aniSectionDic=t.aniSectionDic;if(t.ikArr.length>0){this._ikArr=[];for(i=0,n=t.ikArr.length;i<n;i++){this._ikArr.push(new R(t.ikArr[i],this._boneList))}}if(t.pathArr.length>0){var r;var s;if(this._pathDic==null)this._pathDic={};var a;for(i=0,n=t.pathArr.length;i<n;i++){r=t.pathArr[i];s=new O(r,this._boneList);a=this._boneSlotDic[r.name];if(a){s=new O(r,this._boneList);s.target=a}this._pathDic[r.name]=s}}if(t.tfArr.length>0){this._tfArr=[];for(i=0,n=t.tfArr.length;i<n;i++){this._tfArr.push(new B(t.tfArr[i],this._boneList))}}if(t.skinDataArray.length>0){var o=this._templet.skinDataArray[this._skinIndex];this._skinName=o.name}this._player.on("played",this,this._onPlay);this._player.on("stopped",this,this._onStop);this._player.on("paused",this,this._onPause)};t.load=function(t,e,i){i===void 0&&(i=0);this._aniPath=t;this._complete=e;this._loadAniMode=i;rt.loader.load([{url:t,type:"arraybuffer"}],v.create(this,this._onLoaded))};t._onLoaded=function(){var t=_.getRes(this._aniPath);if(t==null)return;if(K.TEMPLET_DICTIONARY==null){K.TEMPLET_DICTIONARY={}}var e;e=K.TEMPLET_DICTIONARY[this._aniPath];if(e){if(e.isParseFail){this._parseFail()}else{if(e.isParserComplete){this._parseComplete()}else{e.on("complete",this,this._parseComplete);e.on("error",this,this._parseFail)}}}else{e=new K;e._setUrl(this._aniPath);K.TEMPLET_DICTIONARY[this._aniPath]=e;e.on("complete",this,this._parseComplete);e.on("error",this,this._parseFail);e.isParserComplete=false;e.parseData(null,t)}};t._parseComplete=function(){var t=K.TEMPLET_DICTIONARY[this._aniPath];if(t){this.init(t,this._loadAniMode);this.play(0,true)}this._complete&&this._complete.runWith(this)};t._parseFail=function(){console.log("[Error]:"+this._aniPath+"解析失败")};t._onPlay=function(){this.event("played")};t._onStop=function(){var t;var e=this._templet.eventAniArr;var i=e[this._aniClipIndex];if(i&&this._eventIndex<i.length){for(;this._eventIndex<i.length;this._eventIndex++){t=i[this._eventIndex];if(t.time>=this._player.playStart&&t.time<=this._player.playEnd){this.event("label",t)}}}this._drawOrder=null;this.event("stopped")};t._onPause=function(){this.event("paused")};t._parseSrcBoneMatrix=function(){var t=0,e=0;e=this._templet.srcBoneMatrixArr.length;for(t=0;t<e;t++){this._boneMatrixArray.push(new Nt)}if(this._aniMode==0){this._boneSlotDic=this._templet.boneSlotDic;this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic;this._boneSlotArray=this._templet.boneSlotArray}else{if(this._boneSlotDic==null)this._boneSlotDic={};if(this._bindBoneBoneSlotDic==null)this._bindBoneBoneSlotDic={};if(this._boneSlotArray==null)this._boneSlotArray=[];var i=this._templet.boneSlotArray;var n;var r;for(t=0,e=i.length;t<e;t++){n=i[t];r=this._bindBoneBoneSlotDic[n.parent];if(r==null){this._bindBoneBoneSlotDic[n.parent]=r=[]}this._boneSlotDic[n.name]=n=n.copy();r.push(n);this._boneSlotArray.push(n)}}};t._emitMissedEvents=function(t,e,i){i===void 0&&(i=0);var n=this._templet.eventAniArr;var r=n[this._player.currentAnimationClipIndex];if(r){var s=0,a=0;var o;a=r.length;for(s=i;s<a;s++){o=r[s];if(o.time>=this._player.playStart&&o.time<=this._player.playEnd){this.event("label",o)}}}};t._update=function(t){t===void 0&&(t=true);if(this._pause)return;if(t&&this._indexControl){return}var e=this.timer.currTimer;var i=this._player.currentKeyframeIndex;var n=e-this._lastTime;if(t){this._player._update(n)}else{i=-1}this._lastTime=e;if(!this._player)return;this._index=this._clipIndex=this._player.currentKeyframeIndex;if(this._index<0)return;if(n>0&&this._clipIndex==i&&this._lastUpdateAniClipIndex==this._aniClipIndex){return}this._lastUpdateAniClipIndex=this._aniClipIndex;if(i>this._clipIndex&&this._eventIndex!=0){this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex);this._eventIndex=0}var r;var s=this._templet.eventAniArr;var a=s[this._aniClipIndex];if(a&&this._eventIndex<a.length){r=a[this._eventIndex];if(r.time>=this._player.playStart&&r.time<=this._player.playEnd){if(this._player.currentPlayTime>=r.time){this.event("label",r);this._eventIndex++}}else{this._eventIndex++}}var o;if(this._aniMode==0){o=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex);if(o){if(this.graphics!=o){this.graphics=o}return}else{var h=0,l=0;l=this._clipIndex;while(!this._templet.getGrahicsDataWithCache(this._aniClipIndex,l-1)&&l>0){l--}if(l<this._clipIndex){for(h=l;h<this._clipIndex;h++){this._createGraphics(h)}}}}else if(this._aniMode==1){o=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex);if(o){if(this.graphics!=o){this.graphics=o}return}else{l=this._clipIndex;while(!this._getGrahicsDataWithCache(this._aniClipIndex,l-1)&&l>0){l--}if(l<this._clipIndex){for(h=l;h<this._clipIndex;h++){this._createGraphics(h)}}}}this._createGraphics()};t._createGraphics=function(t){t===void 0&&(t=-1);if(t==-1)t=this._clipIndex;var e=t*this._player.cacheFrameRateInterval;var i;var n=this._templet.drawOrderAniArr;var r=n[this._aniClipIndex];if(r&&r.length>0){this._drawOrderIndex=0;i=r[this._drawOrderIndex];while(e>=i.time){this._drawOrder=i.drawOrder;this._drawOrderIndex++;if(this._drawOrderIndex>=r.length){break}i=r[this._drawOrderIndex]}}var s;if(this._aniMode==0||this._aniMode==1){this.graphics=W.create()}else{if(this.graphics instanceof laya.ani.GraphicsAni){this.graphics.clear()}else{this.graphics=W.create()}}s=this.graphics;var a=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],t,e);var o=this._aniSectionDic[this._aniClipIndex];var h;var l=0;var u=0,c=0,f=0,_=0;var d;var p;var v;var g;var m=this._templet.srcBoneMatrixArr.length;for(u=0,_=o[0];u<m;u++){g=this._boneList[u];v=this._templet.srcBoneMatrixArr[u];g.resultTransform.scX=v.scX*this._curOriginalData[l++];g.resultTransform.skX=v.skX+this._curOriginalData[l++];g.resultTransform.skY=v.skY+this._curOriginalData[l++];g.resultTransform.scY=v.scY*this._curOriginalData[l++];g.resultTransform.x=v.x+this._curOriginalData[l++];g.resultTransform.y=v.y+this._curOriginalData[l++];if(this._templet.tMatrixDataLen===8){g.resultTransform.skewX=v.skewX+this._curOriginalData[l++];g.resultTransform.skewY=v.skewY+this._curOriginalData[l++]}}var y={};var b={};var x;for(_+=o[1];u<_;u++){x=a[u];y[x.name]=this._curOriginalData[l++];b[x.name]=this._curOriginalData[l++];this._curOriginalData[l++];this._curOriginalData[l++];this._curOriginalData[l++];this._curOriginalData[l++]}var w={};var T={};for(_+=o[2];u<_;u++){x=a[u];w[x.name]=this._curOriginalData[l++];T[x.name]=this._curOriginalData[l++];this._curOriginalData[l++];this._curOriginalData[l++];this._curOriginalData[l++];this._curOriginalData[l++]}if(this._pathDic){var S;for(_+=o[3];u<_;u++){x=a[u];S=this._pathDic[x.name];if(S){var C=new Rt(x.extenData);switch(C.getByte()){case 1:S.position=this._curOriginalData[l++];break;case 2:S.spacing=this._curOriginalData[l++];break;case 3:S.rotateMix=this._curOriginalData[l++];S.translateMix=this._curOriginalData[l++];break}}}}if(this._yReverseMatrix){this._rootBone.update(this._yReverseMatrix)}else{this._rootBone.update(Nt.TEMP.identity())}if(this._ikArr){var E;for(u=0,_=this._ikArr.length;u<_;u++){E=this._ikArr[u];if(w.hasOwnProperty(E.name)){E.bendDirection=w[E.name]}if(T.hasOwnProperty(E.name)){E.mix=T[E.name]}E.apply()}}if(this._pathDic){for(var A in this._pathDic){S=this._pathDic[A];S.apply(this._boneList,s)}}if(this._tfArr){var M;for(u=0,f=this._tfArr.length;u<f;u++){M=this._tfArr[u];M.apply()}}for(u=0,f=this._boneList.length;u<f;u++){g=this._boneList[u];p=this._bindBoneBoneSlotDic[g.name];g.resultMatrix.copyTo(this._boneMatrixArray[u]);if(p){for(c=0,_=p.length;c<_;c++){d=p[c];if(d){d.setParentMatrix(g.resultMatrix)}}}}var I={};var L=this._templet.deformAniArr;var P;var k;var D;if(L&&L.length>0){if(this._lastAniClipIndex!=this._aniClipIndex){this._lastAniClipIndex=this._aniClipIndex;for(u=0,_=this._boneSlotArray.length;u<_;u++){d=this._boneSlotArray[u];d.deformData=null}}var R=L[this._aniClipIndex];P=R["default"];this._setDeform(P,I,this._boneSlotArray,e);var N;for(N in R){if(N!="default"&&N!=this._skinName){P=R[N];this._setDeform(P,I,this._boneSlotArray,e)}}P=R[this._skinName];this._setDeform(P,I,this._boneSlotArray,e)}var O;var B;var F;if(this._drawOrder){for(u=0,_=this._drawOrder.length;u<_;u++){d=this._boneSlotArray[this._drawOrder[u]];O=y[d.name];B=b[d.name];if(!isNaN(B)){s.save();s.alpha(B)}if(!isNaN(O)&&O!=-2){if(this._templet.attachmentNames){d.showDisplayByName(this._templet.attachmentNames[O])}else{d.showDisplayByIndex(O)}}if(I[this._drawOrder[u]]){F=I[this._drawOrder[u]];if(d.currDisplayData&&F[d.currDisplayData.attachmentName]){d.deformData=F[d.currDisplayData.attachmentName]}else{d.deformData=null}}else{d.deformData=null}if(!isNaN(B)){d.draw(s,this._boneMatrixArray,this._aniMode==2,B)}else{d.draw(s,this._boneMatrixArray,this._aniMode==2)}if(!isNaN(B)){s.restore()}}}else{for(u=0,_=this._boneSlotArray.length;u<_;u++){d=this._boneSlotArray[u];O=y[d.name];B=b[d.name];if(!isNaN(B)){s.save();s.alpha(B)}if(!isNaN(O)&&O!=-2){if(this._templet.attachmentNames){d.showDisplayByName(this._templet.attachmentNames[O])}else{d.showDisplayByIndex(O)}}if(I[u]){F=I[u];if(d.currDisplayData&&F[d.currDisplayData.attachmentName]){d.deformData=F[d.currDisplayData.attachmentName]}else{d.deformData=null}}else{d.deformData=null}if(!isNaN(B)){d.draw(s,this._boneMatrixArray,this._aniMode==2,B)}else{d.draw(s,this._boneMatrixArray,this._aniMode==2)}if(!isNaN(B)){s.restore()}}}if(this._aniMode==0){this._templet.setGrahicsDataWithCache(this._aniClipIndex,t,s)}else if(this._aniMode==1){this._setGrahicsDataWithCache(this._aniClipIndex,t,s)}};t._setDeform=function(t,e,i,n){if(!t)return;var r;var s;var a;var o=0,h=0,l=0;if(t){for(o=0,h=t.deformSlotDataList.length;o<h;o++){r=t.deformSlotDataList[o];for(l=0;l<r.deformSlotDisplayList.length;l++){s=r.deformSlotDisplayList[l];a=i[s.slotIndex];s.apply(n,a);if(!e[s.slotIndex]){e[s.slotIndex]={}}e[s.slotIndex][s.attachment]=s.deformData}}}};t.getAnimNum=function(){return this._templet.getAnimationCount()};t.getAniNameByIndex=function(t){return this._templet.getAniNameByIndex(t)};t.getSlotByName=function(t){return this._boneSlotDic[t]};t.showSkinByName=function(t,e){e===void 0&&(e=true);this.showSkinByIndex(this._templet.getSkinIndexByName(t),e)};t.showSkinByIndex=function(t,e){e===void 0&&(e=true);for(var i=0;i<this._boneSlotArray.length;i++){this._boneSlotArray[i].showSlotData(null,e)}if(this._templet.showSkinByIndex(this._boneSlotDic,t,e)){var n=this._templet.skinDataArray[t];this._skinIndex=t;this._skinName=n.name}this._clearCache()};t.showSlotSkinByIndex=function(t,e){if(this._aniMode==0)return;var i=this.getSlotByName(t);if(i){i.showDisplayByIndex(e)}this._clearCache()};t.showSlotSkinByName=function(t,e){if(this._aniMode==0)return;var i=this.getSlotByName(t);if(i){i.showDisplayByName(e)}this._clearCache()};t.replaceSlotSkinName=function(t,e,i){if(this._aniMode==0)return;var n=this.getSlotByName(t);if(n){n.replaceDisplayByName(e,i)}this._clearCache()};t.replaceSlotSkinByIndex=function(t,e,i){if(this._aniMode==0)return;var n=this.getSlotByName(t);if(n){n.replaceDisplayByIndex(e,i)}this._clearCache()};t.setSlotSkin=function(t,e){if(this._aniMode==0)return;var i=this.getSlotByName(t);if(i){i.replaceSkin(e)}this._clearCache()};t._clearCache=function(){if(this._aniMode==1){for(var t=0,e=this._graphicsCache.length;t<e;t++){for(var i=0,n=this._graphicsCache[t].length;i<n;i++){var r=this._graphicsCache[t][i];if(r!=this.graphics){W.recycle(r)}}this._graphicsCache[t].length=0}}};t.play=function(t,e,i,n,r,s){i===void 0&&(i=true);n===void 0&&(n=0);r===void 0&&(r=0);s===void 0&&(s=true);this._indexControl=false;var a=-1;var o=NaN;if(e){o=2147483647}else{o=0}if(typeof t=="string"){for(var h=0,l=this._templet.getAnimationCount();h<l;h++){var u=this._templet.getAnimation(h);if(u&&t==u.name){a=h;break}}}else{a=t}if(a>-1&&a<this.getAnimNum()){this._aniClipIndex=a;if(i||this._pause||this._currAniIndex!=a){this._currAniIndex=a;this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(a));this._drawOrder=null;this._eventIndex=0;this._player.play(a,this._player.playbackRate,o,n,r);if(s)this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex);if(this._pause){this._pause=false;this._lastTime=c.now();this.timer.frameLoop(1,this,this._update,null,true)}this._update()}}};t.stop=function(){if(!this._pause){this._pause=true;if(this._player){this._player.stop(true)}this.timer.clear(this,this._update)}};t.playbackRate=function(t){if(this._player){this._player.playbackRate=t}};t.paused=function(){if(!this._pause){this._pause=true;if(this._player){this._player.paused=true}this.timer.clear(this,this._update)}};t.resume=function(){this._indexControl=false;if(this._pause){this._pause=false;if(this._player){this._player.paused=false}this._lastTime=c.now();this.timer.frameLoop(1,this,this._update,null,true)}};t._getGrahicsDataWithCache=function(t,e){return this._graphicsCache[t][e]};t._setGrahicsDataWithCache=function(t,e,i){this._graphicsCache[t][e]=i};t.destroy=function(t){t===void 0&&(t=true);e.prototype.destroy.call(this,t);this._templet=null;if(this._player)this._player.offAll();this._player=null;this._curOriginalData=null;this._boneMatrixArray.length=0;this._lastTime=0;this.timer.clear(this,this._update)};o(0,t,"url",function(){return this._aniPath},function(t){this.load(t)});o(0,t,"index",function(){return this._index},function(t){if(this.player){this._index=t;this._player.currentTime=this._index*1e3/this._player.cacheFrameRate;this._indexControl=true;this._update(false)}});o(0,t,"total",function(){if(this._templet&&this._player){this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate)}else{this._total=-1}return this._total});o(0,t,"templet",function(){return this._templet});o(0,t,"player",function(){return this._player});i.useSimpleMeshInCanvas=false;return i}(st);var $=function(e){function g(t){this._start=0;this._Pos=0;this._data=null;this._curIndex=0;this._preIndex=0;this._playIndex=0;this._playing=false;this._ended=true;this._count=0;this._ids=null;this._loadedImage={};this._idOfSprite=null;this._parentMovieClip=null;this._movieClipList=null;this._labels=null;this.basePath=null;this._atlasPath=null;this._url=null;this._isRoot=false;this._completeHandler=null;this._endFrame=-1;this.interval=30;this.loop=false;g.__super.call(this);this._ids={};this._idOfSprite=[];this._reset();this._playing=false;this._parentMovieClip=t;if(!t){this._movieClipList=[this];this._isRoot=true;this._setUpNoticeType(1)}else{this._isRoot=false;this._movieClipList=t._movieClipList;this._movieClipList.push(this)}}a(g,"laya.ani.swf.MovieClip",e);var t=g.prototype;t.destroy=function(t){t===void 0&&(t=true);this._clear();e.prototype.destroy.call(this,t)};t._setDisplay=function(t){e.prototype._setDisplay.call(this,t);if(this._isRoot){this._$3__onDisplay(t)}};t._$3__onDisplay=function(t){if(t)this.timer.loop(this.interval,this,this.updates,null,true);else this.timer.clear(this,this.updates)};t.updates=function(){if(this._parentMovieClip)return;var t=0,e=0;e=this._movieClipList.length;for(t=0;t<e;t++){this._movieClipList[t]&&this._movieClipList[t]._update()}};t.addLabel=function(t,e){if(!this._labels)this._labels={};this._labels[e]=t};t.removeLabel=function(t){if(!t)this._labels=null;else if(!this._labels){for(var e in this._labels){if(this._labels[e]===t){delete this._labels[e];break}}}};t._update=function(){if(!this._data)return;if(!this._playing)return;this._playIndex++;if(this._playIndex>=this._count){if(!this.loop){this._playIndex--;this.stop();return}this._playIndex=0}this._parse(this._playIndex);if(this._labels&&this._labels[this._playIndex])this.event("label",this._labels[this._playIndex]);if(this._endFrame!=-1&&this._endFrame==this._playIndex){this._endFrame=-1;if(this._completeHandler!=null){var t=this._completeHandler;this._completeHandler=null;t.run()}this.stop()}};t.stop=function(){this._playing=false};t.gotoAndStop=function(t){this.index=t;this.stop()};t._clear=function(){this.stop();this._idOfSprite.length=0;if(!this._parentMovieClip){this.timer.clear(this,this.updates);var t=0,e=0;e=this._movieClipList.length;for(t=0;t<e;t++){if(this._movieClipList[t]!=this)this._movieClipList[t]._clear()}this._movieClipList.length=0}if(this._atlasPath){_.clearRes(this._atlasPath)}var i;for(i in this._loadedImage){if(this._loadedImage[i]){_.clearRes(i);this._loadedImage[i]=false}}this.removeChildren();this.graphics=null;this._parentMovieClip=null};t.play=function(t,e){t===void 0&&(t=0);e===void 0&&(e=true);this.loop=e;this._playing=true;if(this._data)this._displayFrame(t)};t._displayFrame=function(t){t===void 0&&(t=-1);if(t!=-1){if(this._curIndex>t)this._reset();this._parse(t)}};t._reset=function(t){t===void 0&&(t=true);if(t&&this._curIndex!=1)this.removeChildren();this._preIndex=this._curIndex=-1;this._Pos=this._start};t._parse=function(t){var e=this;var i,n,r=0,s=0,a=0,o=0,h=false;var l=this._idOfSprite,u=this._data,c;if(this._ended)this._reset();u.pos=this._Pos;this._ended=false;this._playIndex=t;if(this._curIndex>t&&t<this._preIndex){this._reset(true);u.pos=this._Pos}while(this._curIndex<=t&&!this._ended){s=u.getUint16();switch(s){case 12:r=u.getUint16();a=this._ids[u.getUint16()];this._Pos=u.pos;u.pos=a;if((o=u.getUint8())==0){var f=u.getUint16();n=l[r];if(!n){n=l[r]=new st;var _=new st;_.loadImage(this.basePath+f+".png");this._loadedImage[this.basePath+f+".png"]=true;n.addChild(_);_.size(u.getFloat32(),u.getFloat32());var d=u._getMatrix();_.transform=d}n.alpha=1}else if(o==1){i=l[r];if(!i){l[r]=i=new g(this);i.interval=this.interval;i._ids=this._ids;i.basePath=this.basePath;i._setData(u,a);i._initState();i.play(0)}i.alpha=1}u.pos=this._Pos;break;case 3:;var p=l[u.getUint16()];if(p){this.addChild(p);p.zOrder=u.getUint16();h=true}break;case 4:p=l[u.getUint16()];p&&p.removeSelf();break;case 5:l[u.getUint16()][g._ValueList[u.getUint16()]]=u.getFloat32();break;case 6:l[u.getUint16()].visible=u.getUint8()>0;break;case 7:n=l[u.getUint16()];var v=n.transform||Nt.create();v.setTo(u.getFloat32(),u.getFloat32(),u.getFloat32(),u.getFloat32(),u.getFloat32(),u.getFloat32());n.transform=v;break;case 8:l[u.getUint16()].setPos(u.getFloat32(),u.getFloat32());break;case 9:l[u.getUint16()].setSize(u.getFloat32(),u.getFloat32());break;case 10:l[u.getUint16()].alpha=u.getFloat32();break;case 11:l[u.getUint16()].setScale(u.getFloat32(),u.getFloat32());break;case 98:c=u.getString();this.event(c);if(c=="stop")this.stop();break;case 99:this._curIndex=u.getUint16();h&&this.updateZOrder();break;case 100:this._count=this._curIndex+1;this._ended=true;if(this._playing){this.event("enterframe");this.event("end");this.event("complete")}this._reset(false);break}}if(this._playing&&!this._ended)this.event("enterframe");this._Pos=u.pos};t._setData=function(t,e){this._data=t;this._start=e+3};t.load=function(t,e,i){e===void 0&&(e=false);this._url=t;if(e)this._atlasPath=i?i:t.split(".swf")[0]+".json";this.stop();this._clear();this._movieClipList=[this];var n;n=[{url:t,type:"arraybuffer"}];if(this._atlasPath){n.push({url:this._atlasPath,type:"atlas"})}rt.loader.load(n,v.create(this,this._onLoaded))};t._onLoaded=function(){var t;t=_.getRes(this._url);if(!t){this.event("error","file not find");return}if(this._atlasPath&&!_.getAtlas(this._atlasPath)){this.event("error","Atlas not find");return}this.basePath=this._atlasPath?_.getAtlas(this._atlasPath).dir:this._url.split(".swf")[0]+"/image/";this._initData(t)};t._initState=function(){this._reset();this._ended=false;var t=this._playing;this._playing=false;this._curIndex=0;while(!this._ended)this._parse(++this._curIndex);this._playing=t};t._initData=function(t){this._data=new Rt(t);var e=0,i=this._data.getUint16();for(e=0;e<i;e++)this._ids[this._data.getInt16()]=this._data.getInt32();this.interval=1e3/this._data.getUint16();this._setData(this._data,this._ids[32767]);this._initState();this.play(0);this.event("loaded");if(!this._parentMovieClip)this.timer.loop(this.interval,this,this.updates,null,true)};t.playTo=function(t,e,i){this._completeHandler=i;this._endFrame=e;this.play(t,false)};o(0,t,"index",function(){return this._playIndex},function(t){this._playIndex=t;if(this._data)this._displayFrame(this._playIndex);if(this._labels&&this._labels[t])this.event("label",this._labels[t])});o(0,t,"count",function(){return this._count});o(0,t,"playing",function(){return this._playing});o(0,t,"url",null,function(t){this.load(t)});g._ValueList=["x","y","width","height","scaleX","scaleY","rotation","alpha"];return g}(st);var K=function(e){function s(){this._mainTexture=null;this._textureJson=null;this._graphicsCache=[];this.srcBoneMatrixArr=[];this.ikArr=[];this.tfArr=[];this.pathArr=[];this.boneSlotDic={};this.bindBoneBoneSlotDic={};this.boneSlotArray=[];this.skinDataArray=[];this.skinDic={};this.subTextureDic={};this.isParseFail=false;this.yReverseMatrix=null;this.drawOrderAniArr=[];this.eventAniArr=[];this.attachmentNames=null;this.deformAniArr=[];this._isDestroyed=false;this._rate=30;this.isParserComplete=false;this.aniSectionDic={};this._skBufferUrl=null;this._textureDic={};this._loadList=null;this._path=null;this.tMatrixDataLen=0;this.mRootBone=null;s.__super.call(this);this.skinSlotDisplayDataArr=[];this.mBoneArr=[]}a(s,"laya.ani.bone.Templet",e);var t=s.prototype;t.loadAni=function(t){this._skBufferUrl=t;rt.loader.load(t,v.create(this,this.onComplete),null,"arraybuffer")};t.onComplete=function(t){if(this._isDestroyed){this.destroy();return}var e=_.getRes(this._skBufferUrl);if(!e){this.event("error","load failed:"+this._skBufferUrl);return}this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/";this.parseData(null,e)};t.parseData=function(t,e,i){i===void 0&&(i=30);if(!this._path&&this.url)this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/";this._mainTexture=t;if(this._mainTexture){if(x.isWebGL&&t.bitmap){t.bitmap.enableMerageInAtlas=false}}this._rate=i;this.parse(e)};t.buildArmature=function(t){t===void 0&&(t=0);return new X(this,t)};t.parse=function(t){e.prototype.parse.call(this,t);this._endLoaded();if(this._aniVersion!=s.LAYA_ANIMATION_VISION){console.log("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+s.LAYA_ANIMATION_VISION);this._loaded=false}if(this.loaded){if(this._mainTexture){this._parsePublicExtData()}else{this._parseTexturePath()}}else{this.event("error",this);this.isParseFail=true}};t._parseTexturePath=function(){if(this._isDestroyed){this.destroy();return}var t=0;this._loadList=[];var e=new Rt(this.getPublicExtData());var i=0,n=0,r=0,s=0;var a=0,o=0,h=0,l=0;var u=0;var c=e.getInt32();var f=e.readUTFString();var _=f.split("\n");var d;var p;for(t=0;t<c;t++){p=this._path+_[t*2];f=_[t*2+1];i=e.getFloat32();n=e.getFloat32();r=e.getFloat32();s=e.getFloat32();u=e.getFloat32();a=isNaN(u)?0:u;u=e.getFloat32();o=isNaN(u)?0:u;u=e.getFloat32();h=isNaN(u)?r:u;u=e.getFloat32();l=isNaN(u)?s:u;if(this._loadList.indexOf(p)==-1){this._loadList.push(p)}}rt.loader.load(this._loadList,v.create(this,this._textureComplete))};t._textureComplete=function(){var t;var e;for(var i=0,n=this._loadList.length;i<n;i++){e=this._loadList[i];t=this._textureDic[e]=_.getRes(e);if(x.isWebGL&&t&&t.bitmap){t.bitmap.enableMerageInAtlas=false}}this._parsePublicExtData()};t._parsePublicExtData=function(){var t=0,e=0,i=0,n=0,r=0;for(t=0,r=this.getAnimationCount();t<r;t++){this._graphicsCache.push([])}var s=false;s=this._aniClassName!="Dragon";var a=new Rt(this.getPublicExtData());var o=0,h=0,l=0,u=0;var c=0,f=0,_=0,d=0;var p=0;var v=a.getInt32();var g=a.readUTFString();var m=g.split("\n");var y;var b;for(t=0;t<v;t++){y=this._mainTexture;b=this._path+m[t*2];g=m[t*2+1];if(this._mainTexture==null){y=this._textureDic[b]}if(!y){this.event("error",this);this.isParseFail=true;return}o=a.getFloat32();h=a.getFloat32();l=a.getFloat32();u=a.getFloat32();p=a.getFloat32();c=isNaN(p)?0:p;p=a.getFloat32();f=isNaN(p)?0:p;p=a.getFloat32();_=isNaN(p)?l:p;p=a.getFloat32();d=isNaN(p)?u:p;this.subTextureDic[g]=Ot.create(y,o,h,l,u,-c,-f,_,d)}this._mainTexture=y;var x=a.getUint16();var w;for(t=0;t<x;t++){w=[];w.push(a.getUint16());w.push(a.getUint16());w.push(a.getUint16());w.push(a.getUint16());this.aniSectionDic[t]=w}var T;var S;var C;var E;var A=a.getInt16();var M={};var I;for(t=0;t<A;t++){T=new Bt;if(t==0){I=T}else{T.root=I}T.d=s?-1:1;C=a.readUTFString();E=a.readUTFString();T.length=a.getFloat32();if(a.getByte()==1){T.inheritRotation=false}if(a.getByte()==1){T.inheritScale=false}T.name=C;if(E){S=M[E];if(S){S.addChild(T)}else{this.mRootBone=T}}M[C]=T;this.mBoneArr.push(T)}this.tMatrixDataLen=a.getUint16();var L=a.getUint16();var P=0;var k=Math.floor(L/this.tMatrixDataLen);var D;var R=this.srcBoneMatrixArr;for(t=0;t<k;t++){D=new qt;D.scX=a.getFloat32();D.skX=a.getFloat32();D.skY=a.getFloat32();D.scY=a.getFloat32();D.x=a.getFloat32();D.y=a.getFloat32();if(this.tMatrixDataLen===8){D.skewX=a.getFloat32();D.skewY=a.getFloat32()}R.push(D);T=this.mBoneArr[t];T.transform=D}var N;var O=a.getUint16();var B=0;for(t=0;t<O;t++){N=new Ht;B=a.getUint16();for(e=0;e<B;e++){N.boneNames.push(a.readUTFString());N.boneIndexs.push(a.getInt16())}N.name=a.readUTFString();N.targetBoneName=a.readUTFString();N.targetBoneIndex=a.getInt16();N.bendDirection=a.getFloat32();N.mix=a.getFloat32();N.isSpine=s;this.ikArr.push(N)}var F;var U=a.getUint16();var G=0;for(t=0;t<U;t++){F=new Kt;G=a.getUint16();for(e=0;e<G;e++){F.boneIndexs.push(a.getInt16())}F.name=a.getUTFString();F.targetIndex=a.getInt16();F.rotateMix=a.getFloat32();F.translateMix=a.getFloat32();F.scaleMix=a.getFloat32();F.shearMix=a.getFloat32();F.offsetRotation=a.getFloat32();F.offsetX=a.getFloat32();F.offsetY=a.getFloat32();F.offsetScaleX=a.getFloat32();F.offsetScaleY=a.getFloat32();F.offsetShearY=a.getFloat32();this.tfArr.push(F)}var V;var W=a.getUint16();var z=0;for(t=0;t<W;t++){V=new Yt;V.name=a.readUTFString();z=a.getUint16();for(e=0;e<z;e++){V.bones.push(a.getInt16())}V.target=a.readUTFString();V.positionMode=a.readUTFString();V.spacingMode=a.readUTFString();V.rotateMode=a.readUTFString();V.offsetRotation=a.getFloat32();V.position=a.getFloat32();V.spacing=a.getFloat32();V.rotateMix=a.getFloat32();V.translateMix=a.getFloat32();this.pathArr.push(V)}var H=0;var Y=0;var j=0;var X;var $=0;var K=NaN;var q=0;var Z;var Q;var J;var tt;var et=a.getInt16();for(t=0;t<et;t++){var it=a.getUint8();var nt={};this.deformAniArr.push(nt);for(var rt=0;rt<it;rt++){Z=new Ut;Z.skinName=a.getUTFString();nt[Z.skinName]=Z;H=a.getInt16();for(e=0;e<H;e++){Q=new Gt;Z.deformSlotDataList.push(Q);Y=a.getInt16();for(i=0;i<Y;i++){J=new Vt;Q.deformSlotDisplayList.push(J);J.slotIndex=j=a.getInt16();J.attachment=X=a.getUTFString();$=a.getInt16();for(n=0;n<$;n++){if(a.getByte()==1){J.tweenKeyList.push(true)}else{J.tweenKeyList.push(false)}K=a.getFloat32();J.timeList.push(K);tt=[];J.vectices.push(tt);q=a.getInt16();for(r=0;r<q;r++){tt.push(a.getFloat32())}}}}}}var st;var at=a.getInt16();var ot=0;var ht;var lt=0;for(t=0;t<at;t++){ot=a.getInt16();st=[];for(e=0;e<ot;e++){ht=new Wt;ht.time=a.getFloat32();lt=a.getInt16();for(i=0;i<lt;i++){ht.drawOrder.push(a.getInt16())}st.push(ht)}this.drawOrderAniArr.push(st)}var ut;var ct=a.getInt16();var ft=0;var _t;for(t=0;t<ct;t++){ft=a.getInt16();ut=[];for(e=0;e<ft;e++){_t=new zt;_t.name=a.getUTFString();_t.intValue=a.getInt32();_t.floatValue=a.getFloat32();_t.stringValue=a.getUTFString();_t.time=a.getFloat32();ut.push(_t)}this.eventAniArr.push(ut)}var dt=a.getInt16();if(dt>0){this.attachmentNames=[];for(t=0;t<dt;t++){this.attachmentNames.push(a.getUTFString())}}var pt=a.getInt16();var vt;var gt;for(t=0;t<pt;t++){vt=new Ft;vt.name=a.readUTFString();vt.parent=a.readUTFString();vt.attachmentName=a.readUTFString();vt.srcDisplayIndex=vt.displayIndex=a.getInt16();vt.templet=this;this.boneSlotDic[vt.name]=vt;gt=this.bindBoneBoneSlotDic[vt.parent];if(gt==null){this.bindBoneBoneSlotDic[vt.parent]=gt=[]}gt.push(vt);this.boneSlotArray.push(vt)}var mt=a.readUTFString();var yt=mt.split("\n");var bt=0;var xt=a.getUint8();var wt,Tt,St;var Ct=0,Et=0;var At=0,Mt=0,It=0,Lt=0,Pt=0;for(t=0;t<xt;t++){wt=new jt;wt.name=yt[bt++];Ct=a.getUint8();for(e=0;e<Ct;e++){Tt=new $t;Tt.name=yt[bt++];vt=this.boneSlotDic[Tt.name];Et=a.getUint8();for(i=0;i<Et;i++){St=new Xt;this.skinSlotDisplayDataArr.push(St);St.name=yt[bt++];St.attachmentName=yt[bt++];St.transform=new qt;St.transform.scX=a.getFloat32();St.transform.skX=a.getFloat32();St.transform.skY=a.getFloat32();St.transform.scY=a.getFloat32();St.transform.x=a.getFloat32();St.transform.y=a.getFloat32();Tt.displayArr.push(St);St.width=a.getFloat32();St.height=a.getFloat32();St.type=a.getUint8();St.verLen=a.getUint16();A=a.getUint16();if(A>0){St.bones=[];for(n=0;n<A;n++){var kt=a.getUint16();St.bones.push(kt)}}At=a.getUint16();if(At>0){St.uvs=[];for(n=0;n<At;n++){St.uvs.push(a.getFloat32())}}Mt=a.getUint16();if(Mt>0){St.weights=[];for(n=0;n<Mt;n++){St.weights.push(a.getFloat32())}}It=a.getUint16();if(It>0){St.triangles=[];for(n=0;n<It;n++){St.triangles.push(a.getUint16())}}Lt=a.getUint16();if(Lt>0){St.vertices=[];for(n=0;n<Lt;n++){St.vertices.push(a.getFloat32())}}Pt=a.getUint16();if(Pt>0){St.lengths=[];for(n=0;n<Pt;n++){St.lengths.push(a.getFloat32())}}}wt.slotArr.push(Tt)}this.skinDic[wt.name]=wt;this.skinDataArray.push(wt)}var Dt=a.getUint8();if(Dt==1){this.yReverseMatrix=new Nt(1,0,0,-1,0,0);if(I){I.setTempMatrix(this.yReverseMatrix)}}else{if(I){I.setTempMatrix(new Nt)}}this.showSkinByIndex(this.boneSlotDic,0);this.isParserComplete=true;this.event("complete",this)};t.getTexture=function(t){var e=this.subTextureDic[t];if(!e){e=this.subTextureDic[t.substr(0,t.length-1)]}if(e==null){return this._mainTexture}return e};t.showSkinByIndex=function(t,e,i){i===void 0&&(i=true);if(e<0&&e>=this.skinDataArray.length)return false;var n=0,r=0;var s;var a;var o=this.skinDataArray[e];if(o){for(n=0,r=o.slotArr.length;n<r;n++){a=o.slotArr[n];if(a){s=t[a.name];if(s){s.showSlotData(a,i);if(i&&s.attachmentName!="undefined"&&s.attachmentName!="null"){s.showDisplayByName(s.attachmentName)}else{s.showDisplayByIndex(s.displayIndex)}}}}return true}return false};t.getSkinIndexByName=function(t){var e;for(var i=0,n=this.skinDataArray.length;i<n;i++){e=this.skinDataArray[i];if(e.name==t){return i}}return-1};t.getGrahicsDataWithCache=function(t,e){if(this._graphicsCache[t]&&this._graphicsCache[t][e]){return this._graphicsCache[t][e]}return null};t.setGrahicsDataWithCache=function(t,e,i){this._graphicsCache[t][e]=i};t.destroy=function(){this._isDestroyed=true;var t;for(var e in this.subTextureDic){t=this.subTextureDic[e];if(t)t.destroy()}var e;for(e in this._textureDic){t=this._textureDic[e];if(t)t.destroy()}var i;for(var n=0,r=this.skinSlotDisplayDataArr.length;n<r;n++){i=this.skinSlotDisplayDataArr[n];i.destory()}this.skinSlotDisplayDataArr.length=0;if(this.url){delete s.TEMPLET_DICTIONARY[this.url]}laya.resource.Resource.prototype.destroy.call(this)};t.getAniNameByIndex=function(t){var e=this.getAnimation(t);if(e)return e.name;return null};o(0,t,"rate",function(){return this._rate},function(t){this._rate=t});s.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0";s.TEMPLET_DICTIONARY=null;return s}(H)})(window,document,Laya);if(typeof define==="function"&&define.amd){define("laya.core",["require","exports"],function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:true});for(var i in Laya){var n=Laya[i];n&&n.__isclass&&(e[i]=n)}})}(function(t,e,n){var i=n.un,r=n.uns,s=n.static,a=n.class,o=n.getset,h=n.__newvec;var l=laya.utils.Browser,u=laya.utils.Color,c=laya.filters.ColorFilterAction;var f=laya.filters.webgl.ColorFilterActionGL,_=laya.filters.Filter,d=laya.filters.webgl.FilterActionGL;var p=laya.maths.Matrix,v=laya.maths.Rectangle,g=laya.renders.Render,m=laya.renders.RenderContext;var y=laya.webgl.resource.RenderTarget2D,b=laya.utils.RunDriver,x=laya.webgl.shader.d2.ShaderDefines2D;var w=laya.display.Sprite,T=laya.resource.Texture,S=laya.webgl.shader.d2.value.Value2D;var C=function(){function t(){this.data=null}a(t,"laya.filters.FilterAction");var e=t.prototype;n.imps(e,{"laya.filters.IFilterAction":true});e.apply=function(t){return null};return t}();var E=function(){function t(){}a(t,"laya.filters.WebGLFilter");t.enable=function(){if(t.isInit)return;t.isInit=true;if(!g.isWebGL)return;b.createFilterAction=function(t){var e;switch(t){case 32:e=new f;break;case 16:e=new I;break;case 8:e=new L;break}return e}};t.isInit=false;t.__init$=function(){I;f;L;g;b;{b.createFilterAction=function(t){var e;switch(t){case 16:e=new C;break;case 8:e=new C;break;case 32:e=new c;break}return e}}};return t}();var A=function(t){function e(t){this.strength=NaN;this.strength_sig2_2sig2_gauss1=[];e.__super.call(this);t===void 0&&(t=4);if(g.isWebGL)E.enable();this.strength=t;this._action=b.createFilterAction(16);this._action.data=this}a(e,"laya.filters.BlurFilter",t);var i=e.prototype;i.callNative=function(t){t.conchModel&&t.conchModel.blurFilter&&t.conchModel.blurFilter(this.strength)};o(0,i,"action",function(){return this._action});o(0,i,"type",function(){return 16});return e}(_);var M=function(t){function r(t,e,i,n){this._color=null;r.__super.call(this);this._elements=new Float32Array(9);e===void 0&&(e=4);i===void 0&&(i=6);n===void 0&&(n=6);if(g.isWebGL){E.enable()}this._color=new u(t);this.blur=Math.min(e,20);this.offX=i;this.offY=n;this._action=b.createFilterAction(8);this._action.data=this}a(r,"laya.filters.GlowFilter",t);var e=r.prototype;e.getColor=function(){return this._color._color};e.callNative=function(t){t.conchModel&&t.conchModel.glowFilter&&t.conchModel.glowFilter(this._color.strColor,this._elements[4],this._elements[5],this._elements[6])};o(0,e,"type",function(){return 8});o(0,e,"action",function(){return this._action});o(0,e,"offY",function(){return this._elements[6]},function(t){this._elements[6]=t});o(0,e,"offX",function(){return this._elements[5]},function(t){this._elements[5]=t});o(0,e,"blur",function(){return this._elements[4]},function(t){this._elements[4]=t});return r}(_);var I=function(t){function e(){this.data=null;e.__super.call(this)}a(e,"laya.filters.webgl.BlurFilterActionGL",t);var i=e.prototype;i.setValueMix=function(t){t.defines.add(this.data.type);var e=t};i.apply3d=function(t,e,i,n,r){var s=t.getValue("bounds");var a=S.create(1,0);a.setFilters([this.data]);var o=p.EMPTY;o.identity();i.ctx.drawTarget(t,0,0,s.width,s.height,p.EMPTY,"src",a);a.setFilters(null)};i.setValue=function(t){t.strength=this.data.strength;var e=this.data.strength/3;var i=e*e;this.data.strength_sig2_2sig2_gauss1[0]=this.data.strength;this.data.strength_sig2_2sig2_gauss1[1]=i;this.data.strength_sig2_2sig2_gauss1[2]=2*i;this.data.strength_sig2_2sig2_gauss1[3]=1/(2*Math.PI*i);t.strength_sig2_2sig2_gauss1=this.data.strength_sig2_2sig2_gauss1};o(0,i,"typeMix",function(){return 16});return e}(d);var L=function(t){function e(){this.data=null;this._initKey=false;this._textureWidth=0;this._textureHeight=0;e.__super.call(this)}a(e,"laya.filters.webgl.GlowFilterActionGL",t);var i=e.prototype;n.imps(i,{"laya.filters.IFilterActionGL":true});i.setValueMix=function(t){};i.apply3d=function(t,e,i,n,r){var s=t.getValue("bounds");t.addValue("color",this.data.getColor());var a=s.width,o=s.height;this._textureWidth=a;this._textureHeight=o;var h;var l=p.TEMP;l.identity();h=S.create(1,0);h.setFilters([this.data]);i.ctx.drawTarget(t,0,0,this._textureWidth,this._textureHeight,l,"src",h,null);h=S.create(1,0);i.ctx.drawTarget(t,0,0,this._textureWidth,this._textureHeight,l,"src",h);return null};i.setSpriteWH=function(t){this._textureWidth=t.width;this._textureHeight=t.height};i.setValue=function(t){t.u_offsetX=this.data.offX;t.u_offsetY=-this.data.offY;t.u_strength=1;t.u_blurX=this.data.blur;t.u_blurY=this.data.blur;t.u_textW=this._textureWidth;t.u_textH=this._textureHeight;t.u_color=this.data.getColor()};o(0,i,"typeMix",function(){return 8});e.tmpTarget=function(t,e,i,n,r){var s=t.getValue("bounds");var a=t.getValue("out");a.end();var o=y.create(s.width,s.height);o.start();var h=t.getValue("color");if(h){o.clear(h[0],h[1],h[2],0)}t.addValue("tmpTarget",o)};e.startOut=function(t,e,i,n,r){var s=t.getValue("tmpTarget");s.end();var a=t.getValue("out");a.start();var o=t.getValue("color");if(o){a.clear(o[0],o[1],o[2],0)}};e.recycleTarget=function(t,e,i,n,r){var s=t.getValue("src");var a=t.getValue("tmpTarget");a.recycle()};return e}(d);n.__init([E])})(window,document,Laya);if(typeof define==="function"&&define.amd){define("laya.core",["require","exports"],function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:true});for(var i in Laya){var n=Laya[i];n&&n.__isclass&&(e[i]=n)}})}(function(t,e,n){var i=n.un,r=n.uns,s=n.static,a=n.class,o=n.getset,h=n.__newvec;var l=laya.utils.Browser,u=laya.display.css.CSSStyle,d=laya.utils.ClassUtils;var c=laya.events.Event,f=laya.utils.HTMLChar,_=laya.net.Loader,p=laya.display.Node,v=laya.maths.Rectangle;var g=laya.renders.Render,m=laya.renders.RenderContext,y=laya.renders.RenderSprite;var b=laya.display.Sprite,x=laya.utils.Stat,F=laya.display.Text,w=laya.resource.Texture;var T=laya.net.URL,S=laya.utils.Utils;var C=function(){function _(){}a(_,"laya.html.utils.HTMLParse");_.parse=function(t,e,i){e=e.replace(/<br>/g,"<br/>");e="<root>"+e+"</root>";e=e.replace(_.spacePattern,_.char255);var n=S.parseXMLFromString(e);_._parseXML(t,n.childNodes[0].childNodes,i)};_._parseXML=function(t,e,i,n){var r=0,s=0;if(e.join||e.item){for(r=0,s=e.length;r<s;++r){_._parseXML(t,e[r],i,n)}}else{var a;var o;if(e.nodeType==3){var h;if(t instanceof laya.html.dom.HTMLDivElement){if(e.nodeName==null){e.nodeName="#text"}o=e.nodeName.toLowerCase();h=e.textContent.replace(/^\s+|\s+$/g,"");if(h.length>0){a=d.getInstance(o);if(a){t.addChild(a);a.innerTEXT=h.replace(_.char255AndOneSpacePattern," ")}}}else{h=e.textContent.replace(/^\s+|\s+$/g,"");if(h.length>0){t.innerTEXT=h.replace(_.char255AndOneSpacePattern," ")}}return}else{o=e.nodeName.toLowerCase();if(o=="#comment")return;a=d.getInstance(o);if(a){a=t.addChild(a);a.URI=i;a.href=n;var l=e.attributes;if(l&&l.length>0){for(r=0,s=l.length;r<s;++r){var u=l[r];var c=u.nodeName;var f=u.value;a._setAttributes(c,f)}}_._parseXML(a,e.childNodes,i,a.href)}else{_._parseXML(t,e.childNodes,i,n)}}}};_.char255=String.fromCharCode(255);_.spacePattern=/&nbsp;|&#160;/g;_.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g");return _}();var E=function(){function B(){}a(B,"laya.html.utils.Layout");B.later=function(t){if(B._will==null){B._will=[];n.stage.frameLoop(1,null,function(){if(B._will.length<1)return;for(var t=0;t<B._will.length;t++){laya.html.utils.Layout.layout(B._will[t])}B._will.length=0})}B._will.push(t)};B.layout=function(t){if(!t||!t._style)return null;if((t._style._type&512)===0)return null;t.getStyle()._type&=~512;var e=B._multiLineLayout(t);if(g.isConchApp&&t["layaoutCallNative"]){t.layaoutCallNative()}return e};B._multiLineLayout=function(t){if(F.RightToLeft)return B._multiLineLayout2(t);var e=new Array;t._addChildsToLayout(e);var i=0,n=e.length,r=0;var s=t._getCSSStyle();var a=s.letterSpacing;var o=s.leading;var h=s.lineHeight;var l=s._widthAuto()||!s.wordWrap;var u=l?999999:t.width;var c=t.height;var f=0;var _=s.italic?s.fontSize/3:0;var d=s._getAlign();var p=s._getValign();var v=p!==0||d!==0||h!=0;var g;var m=0;var y=0;var b=0;var x=0;var w=0;var T=new Array;var S;var C;var E=T[0]=new U;var A=false,M=false;var I;var L;E.h=0;if(s.italic)u-=s.fontSize/3;var P=0;var k=true;function D(){E.y=y;y+=E.h+o;if(E.h==0)y+=h;E.mWidth=P;P=0;E=new U;T.push(E);E.h=0;m=0;k=true;A=false}for(i=0;i<n;i++){g=e[i];if(g==null){if(!k){m+=B.DIV_ELEMENT_PADDING}E.wordStartIndex=E.elements.length;continue}k=false;if(g instanceof laya.html.dom.HTMLBrElement){D();E.y=y;continue}else if(g._isChar()){I=g;if(!I.isWord){if(T.length>0&&m+b>u&&E.wordStartIndex>0){var R=0;R=E.elements.length-E.wordStartIndex+1;E.elements.length=E.wordStartIndex;i-=R;D();continue}A=false;P+=I.width}else{A=M||I.char==="\n";E.wordStartIndex=E.elements.length}b=I.width+a;x=I.height;M=false;A=A||m+b>u;A&&D();E.minTextHeight=Math.min(E.minTextHeight,g.height)}else{S=g._getCSSStyle();L=g;C=S.padding;S._getCssFloat()===0||(v=true);A=M||S.lineElement;b=L.width*L._style._tf.scaleX+C[1]+C[3]+a;x=L.height*L._style._tf.scaleY+C[0]+C[2];M=S.lineElement;A=A||m+b>u&&S.wordWrap;A&&D()}E.elements.push(g);E.h=Math.max(E.h,x);g.x=m;g.y=y;m+=b;E.w=m-a;E.y=y;f=Math.max(m+_,f)}y=E.y+E.h;if(v){var N=0;var O=u;if(l&&t.width>0){O=t.width}for(i=0,n=T.length;i<n;i++){T[i].updatePos(0,O,i,N,d,p,h);N+=Math.max(h,T[i].h+o)}y=N}l&&(t.width=f);y>t.height&&(t.height=y);return[f,y]};B._multiLineLayout2=function(t){var e=new Array;t._addChildsToLayout(e);var i=0,n=e.length,r=0;var s=t._getCSSStyle();var a=s.letterSpacing;var o=s.leading;var h=s.lineHeight;var l=s._widthAuto()||!s.wordWrap;var u=l?999999:t.width;var c=t.height;var f=0;var _=s.italic?s.fontSize/3:0;var d=2-s._getAlign();var p=s._getValign();var v=p!==0||d!==0||h!=0;var g;var m=0;var y=0;var b=0;var x=0;var w=0;var T=new Array;var S;var C;var E=T[0]=new U;var A=false,M=false;var I;var L;E.h=0;if(s.italic)u-=s.fontSize/3;var P=0;var k=true;function D(){E.y=y;y+=E.h+o;if(E.h==0)y+=h;E.mWidth=P;P=0;E=new U;T.push(E);E.h=0;m=0;k=true;A=false}for(i=0;i<n;i++){g=e[i];if(g==null){if(!k){m+=B.DIV_ELEMENT_PADDING}E.wordStartIndex=E.elements.length;continue}k=false;if(g instanceof laya.html.dom.HTMLBrElement){D();E.y=y;continue}else if(g._isChar()){I=g;if(!I.isWord){if(T.length>0&&m+b>u&&E.wordStartIndex>0){var R=0;R=E.elements.length-E.wordStartIndex+1;E.elements.length=E.wordStartIndex;i-=R;D();continue}A=false;P+=I.width}else{A=M||I.char==="\n";E.wordStartIndex=E.elements.length}b=I.width+a;x=I.height;M=false;A=A||m+b>u;A&&D();E.minTextHeight=Math.min(E.minTextHeight,g.height)}else{S=g._getCSSStyle();L=g;C=S.padding;S._getCssFloat()===0||(v=true);A=M||S.lineElement;b=L.width*L._style._tf.scaleX+C[1]+C[3]+a;x=L.height*L._style._tf.scaleY+C[0]+C[2];M=S.lineElement;A=A||m+b>u&&S.wordWrap;A&&D()}E.elements.push(g);E.h=Math.max(E.h,x);g.x=m;g.y=y;m+=b;E.w=m-a;E.y=y;f=Math.max(m+_,f)}y=E.y+E.h;if(v){var N=0;var O=u;for(i=0,n=T.length;i<n;i++){T[i].updatePos(0,O,i,N,d,p,h);N+=Math.max(h,T[i].h+o)}y=N}l&&(t.width=f);y>t.height&&(t.height=y);for(i=0,n=T.length;i<n;i++){T[i].revertOrder(u)}return[f,y]};B._will=null;B.DIV_ELEMENT_PADDING=0;return B}();var U=function(){function t(){this.x=0;this.y=0;this.w=0;this.h=0;this.wordStartIndex=0;this.minTextHeight=99999;this.mWidth=0;this.elements=new Array}a(t,"laya.html.utils.LayoutLine");var e=t.prototype;e.updatePos=function(t,e,i,n,r,s,a){var o=0;var h;if(this.elements.length>0){h=this.elements[this.elements.length-1];o=h.x+h.width-this.elements[0].x}var l=0,u=NaN;r===1&&(l=(e-o)/2);r===2&&(l=e-o);a===0||s!=0||(s=1);for(var c=0,f=this.elements.length;c<f;c++){h=this.elements[c];var _=h._getCSSStyle();l!==0&&(h.x+=l);switch(_._getValign()){case 0:h.y=n;break;case 1:;var d=0;if(this.minTextHeight!=99999){d=this.minTextHeight};var p=(d+a)/2;p=Math.max(p,this.h);if(h instanceof laya.html.dom.HTMLImageElement){u=n+p-h.height}else{u=n+p-h.height}h.y=u;break;case 2:h.y=n+(a-h.height);break}}};e.revertOrder=function(t){var e;if(this.elements.length>0){var i=0,n=0;n=this.elements.length;for(i=0;i<n;i++){e=this.elements[i];e.x=t-e.x-e.width}}};return t}();var A=function(i){function e(){this.URI=null;this._href=null;e.__super.call(this);this._text=e._EMPTYTEXT;this.setStyle(new u(this));this._getCSSStyle().valign="middle";this.mouseEnabled=true}a(e,"laya.html.dom.HTMLElement",i);var t=e.prototype;t.layaoutCallNative=function(){var t=0;if(this._childs&&(t=this._childs.length)>0){for(var e=0;e<t;e++){this._childs[e].layaoutCallNative&&this._childs[e].layaoutCallNative()}}var i=this._getWords();i?laya.html.dom.HTMLElement.fillWords(this,i,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()};t.appendChild=function(t){return this.addChild(t)};t._getWords2=function(){var t=this._text.text;if(!t||t.length===0)return null;var e=0,i=0;var n;var r;if(!this._text.drawWords){n=t.split(" ");i=n.length-1;r=[];for(e=0;e<i;e++){r.push(n[e]," ")}if(i>=0)r.push(n[i]);this._text.drawWords=r}else{r=this._text.drawWords}var s=this._text.words;if(s&&s.length===r.length)return s;s===null&&(this._text.words=s=[]);s.length=r.length;var a;var o=this.style;var h=o.font;for(e=0,i=r.length;e<i;e++){a=S.measureText(r[e],h);var l=s[e]=new f(r[e],a.width,a.height||o.fontSize,o);if(l.char.length>1){l.charNum=l.char}if(this.href){var u=new b;this.addChild(u);l.setSprite(u)}}return s};t._getWords=function(){if(!F.CharacterCache)return this._getWords2();var t=this._text.text;if(!t||t.length===0)return null;var e=this._text.words;if(e&&e.length===t.length)return e;e===null&&(this._text.words=e=[]);e.length=t.length;var i;var n=this.style;var r=n.font;var s=0;for(var a=0,o=t.length;a<o;a++){i=S.measureText(t.charAt(a),r);var h=e[a]=new f(t.charAt(a),i.width,i.height||n.fontSize,n);if(this.href){var l=new b;this.addChild(l);h.setSprite(l)}}return e};t.showLinkSprite=function(){var t=this._text.words;if(t){var e=[];var i;var n;for(var r=0;r<t.length;r++){n=t[r];i=new b;i.graphics.drawRect(0,0,n.width,n.height,"#ff0000");i.width=n.width;i.height=n.height;this.addChild(i);e.push(i)}}};t._layoutLater=function(){var t=this.style;if(t._type&512)return;if(t.widthed(this)&&(this._childs.length>0||this._getWords()!=null)&&t.block){E.later(this);t._type|=512}else{this.parent&&this.parent._layoutLater()}};t._setAttributes=function(t,e){switch(t){case"style":this.style.cssText(e);return;case"class":this.className=e;return}i.prototype._setAttributes.call(this,t,e)};t.updateHref=function(){if(this._href!=null){var t=this._getWords();if(t){var e;var i;for(var n=0;n<t.length;n++){e=t[n];i=e.getSprite();if(i){i.size(e.width,e.height);i.on("click",this,this.onLinkHandler)}}}}};t.onLinkHandler=function(t){switch(t.type){case"click":;var e=this;while(e){e.event("link",[this.href]);e=e.parent}break}};t.formatURL=function(t){if(!this.URI)return t;return T.formatURL(t,this.URI?this.URI.path:null)};o(0,t,"href",function(){return this._href},function(t){this._href=t;if(t!=null){this._getCSSStyle().underLine=1;this.updateHref()}});o(0,t,"color",null,function(t){this.style.color=t});o(0,t,"onClick",null,function(t){var e;n._runScript("fn=function(event){"+t+";}");this.on("click",this,e)});o(0,t,"id",null,function(t){L.document.setElementById(t,this)});o(0,t,"innerTEXT",function(){return this._text.text},function(t){this.text=t});o(0,t,"style",function(){return this._style});o(0,t,"text",function(){return this._text.text},function(t){if(this._text==e._EMPTYTEXT){this._text={text:t,words:null}}else{this._text.text=t;this._text.words&&(this._text.words.length=0)}g.isConchApp&&this.layaoutCallNative();this._renderType|=2048;this.repaint();this.updateHref()});o(0,t,"parent",i.prototype._$get_parent,function(t){if(t instanceof laya.html.dom.HTMLElement){var e=t;this.URI||(this.URI=e.URI);this.style.inherit(e.style)}n.superSet(b,this,"parent",t)});o(0,t,"className",null,function(t){this.style.attrs(L.document.styleSheets["."+t])});e.fillWords=function(t,e,i,n,r,s,a){t.graphics.clear();for(var o=0,h=e.length;o<h;o++){var l=e[o];t.graphics.fillText(l.char,l.x+i,l.y+n,r,s,"left",a)}};e._EMPTYTEXT={text:null,words:null};return e}(b);var M=function(t){function e(){e.__super.call(this);this.style.lineElement=true;this.style.block=true}a(e,"laya.html.dom.HTMLBrElement",t);return e}(A);var I=function(t){function e(){this.contextHeight=NaN;this.contextWidth=NaN;e.__super.call(this);this.style.block=true;this.style.lineElement=true;this.style.width=200;this.style.height=200;D}a(e,"laya.html.dom.HTMLDivElement",t);var i=e.prototype;i.appendHTML=function(t){C.parse(this,t,this.URI);this.layout()};i._addChildsToLayout=function(e){var t=this._getWords();if(t==null&&this._childs.length==0)return false;t&&t.forEach(function(t){e.push(t)});var i=true;for(var n=0,r=this._childs.length;n<r;n++){var s=this._childs[n];if(i){i=false}else{e.push(null)}s._addToLayout(e)}return true};i._addToLayout=function(t){this.layout()};i.layout=function(){if(!this.style)return;this.style._type|=512;var t=E.layout(this);if(t){if(!this._$P.mHtmlBounds)this._set$P("mHtmlBounds",new v);var e=this._$P.mHtmlBounds;e.x=e.y=0;e.width=this.contextWidth=t[0];e.height=this.contextHeight=t[1];this.setBounds(e)}};o(0,i,"height",function(){if(this._height)return this._height;return this.contextHeight},t.prototype._$set_height);o(0,i,"innerHTML",null,function(t){this.destroyChildren();this.appendHTML(t)});o(0,i,"width",function(){if(this._width)return this._width;return this.contextWidth},function(t){var e=false;if(t===0){e=t!=this._width}else{e=t!=this.width}n.superSet(A,this,"width",t);if(e)this.layout()});return e}(A);var L=function(t){function e(){this.all=new Array;this.styleSheets=u.styleSheets;e.__super.call(this)}a(e,"laya.html.dom.HTMLDocument",t);var i=e.prototype;i.getElementById=function(t){return this.all[t]};i.setElementById=function(t,e){this.all[t]=e};s(e,["document",function(){return this.document=new e}]);return e}(A);var P=function(t){function e(){this._tex=null;this._url=null;this._renderArgs=[];e.__super.call(this);this.style.block=true}a(e,"laya.html.dom.HTMLImageElement",t);var i=e.prototype;i._addToLayout=function(t){!this._style.absolute&&t.push(this)};i.render=function(t,e,i){if(!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1)return;x.spriteCount++;this._renderArgs[0]=this._tex;this._renderArgs[1]=this.x;this._renderArgs[2]=this.y;this._renderArgs[3]=this.width||this._tex.width;this._renderArgs[4]=this.height||this._tex.height;t.ctx.drawTexture2(e,i,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs)};i.layaoutCallNative=function(){var t=0;if(this._childs&&(t=this._childs.length)>0){for(var e=0;e<t;e++){this._childs[e].layaoutCallNative&&this._childs[e].layaoutCallNative()}}};o(0,i,"src",null,function(t){var n=this;t=this.formatURL(t);if(this._url==t)return;this._url=t;var e=this._tex=_.getRes(t);if(!e){this._tex=e=new w;e.load(t);_.cacheRes(t,e)}function i(){if(!n._style)return;var t=n._style;var e=t.widthed(n)?-1:n._tex.width;var i=t.heighted(n)?-1:n._tex.height;if(!t.widthed(n)&&n._width!=n._tex.width){n.width=n._tex.width;n.parent&&n.parent._layoutLater()}if(!t.heighted(n)&&n._height!=n._tex.height){n.height=n._tex.height;n.parent&&n.parent._layoutLater()}if(g.isConchApp){n._renderArgs[0]=n._tex;n._renderArgs[1]=n.x;n._renderArgs[2]=n.y;n._renderArgs[3]=n.width||n._tex.width;n._renderArgs[4]=n.height||n._tex.height;n.graphics.drawTexture(n._tex,0,0,n._renderArgs[3],n._renderArgs[4])}n.repaint();n.parentRepaint()}e.loaded?i():e.on("loaded",null,i)});return e}(A);var k=function(t){function e(){this.type=null;e.__super.call(this);this.visible=false}a(e,"laya.html.dom.HTMLLinkElement",t);var i=e.prototype;i._onload=function(t){switch(this.type){case"text/css":u.parseCSS(t,this.URI);break}};o(0,i,"href",t.prototype._$get_href,function(t){var e=this;t=this.formatURL(t);this.URI=new T(t);var i=new _;i.once("complete",null,function(t){e._onload(t)});i.load(t,"text")});e._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g");return e}(A);var D=function(t){function e(){e.__super.call(this);this.visible=false}a(e,"laya.html.dom.HTMLStyleElement",t);var i=e.prototype;o(0,i,"text",t.prototype._$get_text,function(t){u.parseCSS(t,null)});return e}(A);var R=function(t){function e(){e.__super.call(this);this._getCSSStyle().valign="middle"}a(e,"laya.html.dom.HTMLIframeElement",t);var i=e.prototype;o(0,i,"href",t.prototype._$get_href,function(i){var n=this;i=this.formatURL(i);var t=new _;t.once("complete",null,function(t){var e=n.URI;n.URI=new T(i);n.innerHTML=t;!e||(n.URI=e)});t.load(i,"text")});return e}(I)})(window,document,Laya);if(typeof define==="function"&&define.amd){define("laya.core",["require","exports"],function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:true});for(var i in Laya){var n=Laya[i];n&&n.__isclass&&(e[i]=n)}})}(function(t,e,p){var i=p.un,n=p.uns,s=p.static,a=p.class,r=p.getset,o=p.__newvec;var h=laya.display.Animation,l=laya.utils.Browser,v=laya.utils.ClassUtils,u=laya.filters.ColorFilter;var c=laya.utils.Ease,f=laya.events.Event,_=laya.events.EventDispatcher,d=laya.display.css.Font;var g=laya.display.FrameAnimation,m=laya.display.Graphics,y=laya.utils.Handler;var b=laya.display.Input,x=laya.net.Loader,w=laya.display.Node,T=laya.maths.Point,S=laya.maths.Rectangle;var C=laya.renders.Render,E=laya.display.Sprite,A=laya.display.Text,M=laya.resource.Texture;var I=laya.utils.Tween,L=laya.utils.Utils,P=laya.utils.WeakObject;p.interface("laya.ui.IItem");p.interface("laya.ui.ISelect");p.interface("laya.ui.IRender");p.interface("laya.ui.IComponent");p.interface("laya.ui.IBox","IComponent");var k=function(){function t(){this.enable=false;this.top=NaN;this.bottom=NaN;this.left=NaN;this.right=NaN;this.centerX=NaN;this.centerY=NaN;this.anchorX=NaN;this.anchorY=NaN}a(t,"laya.ui.LayoutStyle");s(t,["EMPTY",function(){return this.EMPTY=new t}]);return t}();var D=function(){function t(){}a(t,"laya.ui.Styles");t.labelColor="#000000";t.buttonStateNum=3;t.scrollBarMinNum=15;t.scrollBarDelayTime=500;s(t,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]);return t}();var R=function(){function r(){}a(r,"laya.ui.UIUtils");r.fillArray=function(t,e,i){var n=t.concat();if(e){var r=e.split(",");for(var s=0,a=Math.min(n.length,r.length);s<a;s++){var o=r[s];n[s]=o=="true"?true:o=="false"?false:o;if(i!=null)n[s]=i(o)}}return n};r.toColor=function(t){return L.toHexColor(t)};r.gray=function(t,e){e===void 0&&(e=true);if(e){r.addFilter(t,r.grayFilter)}else{r.clearFilter(t,u)}};r.addFilter=function(t,e){var i=t.filters||[];i.push(e);t.filters=i};r.clearFilter=function(t,e){var i=t.filters;if(i!=null&&i.length>0){for(var n=i.length-1;n>-1;n--){var r=i[n];if(p.__typeof(r,e))i.splice(n,1)}t.filters=i}};r._getReplaceStr=function(t){return r.escapeSequence[t]};r.adptString=function(t){return t.replace(/\\(\w)/g,r._getReplaceStr)};r.getBindFun=function(t){var e=r._funMap.get(t);if(e==null){var i='"'+t+'"';i=i.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"');var n="(function(data){if(data==null)return;with(data){try{\nreturn "+i+"\n}catch(e){}}})";e=p._runScript(n);r._funMap.set(t,e)}return e};s(r,["grayFilter",function(){return this.grayFilter=new u([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new P}]);return r}();var N=function(){function t(){}a(t,"UIConfig");t.touchScrollEnable=true;t.mouseWheelEnable=true;t.showButtons=true;t.popupBgColor="#000000";t.popupBgAlpha=.5;t.closeDialogOnSide=true;return t}();var O=function(e){function d(){this.autoCacheCmd=true;this._width=0;this._height=0;this._source=null;this._sizeGrid=null;this._isChanged=false;this._offset=null;d.__super.call(this)}a(d,"laya.ui.AutoBitmap",e);var t=d.prototype;t.destroy=function(){e.prototype.destroy.call(this);this._source=null;this._sizeGrid=null;this._offset=null};t._setChanged=function(){if(!this._isChanged){this._isChanged=true;p.timer.callLater(this,this.changeSource)}};t.changeSource=function(){this._isChanged=false;var t=this._source;if(!t||!t.bitmap)return;var e=this.width;var i=this.height;var n=this._sizeGrid;var r=t.sourceWidth;var s=t.sourceHeight;if(!n||r===e&&s===i){this.clear();this.drawTexture(t,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,e,i)}else{t.$_GID||(t.$_GID=L.getGID());var a=t.$_GID+"."+e+"."+i+"."+n.join(".");if(L.isOKCmdList(P.I.get(a))){this.cmds=P.I.get(a);return}this.clear();var o=n[0];var h=n[1];var l=n[2];var u=n[3];var c=n[4];var f=false;if(e==r){u=h=0}if(i==s){o=l=0}if(u+h>e){var _=e;f=true;e=u+h;this.save();this.clipRect(0,0,_,i)}u&&o&&this.drawTexture(d.getTexture(t,0,0,u,o),0,0,u,o);h&&o&&this.drawTexture(d.getTexture(t,r-h,0,h,o),e-h,0,h,o);u&&l&&this.drawTexture(d.getTexture(t,0,s-l,u,l),0,i-l,u,l);h&&l&&this.drawTexture(d.getTexture(t,r-h,s-l,h,l),e-h,i-l,h,l);o&&this.drawBitmap(c,d.getTexture(t,u,0,r-u-h,o),u,0,e-u-h,o);l&&this.drawBitmap(c,d.getTexture(t,u,s-l,r-u-h,l),u,i-l,e-u-h,l);u&&this.drawBitmap(c,d.getTexture(t,0,o,u,s-o-l),0,o,u,i-o-l);h&&this.drawBitmap(c,d.getTexture(t,r-h,o,h,s-o-l),e-h,o,h,i-o-l);this.drawBitmap(c,d.getTexture(t,u,o,r-u-h,s-o-l),u,o,e-u-h,i-o-l);if(f)this.restore();if(this.autoCacheCmd&&!C.isConchApp)P.I.set(a,this.cmds)}this._repaint()};t.drawBitmap=function(t,e,i,n,r,s){r===void 0&&(r=0);s===void 0&&(s=0);if(r<.1||s<.1)return;if(t&&(e.width!=r||e.height!=s))this.fillTexture(e,i,n,r,s);else this.drawTexture(e,i,n,r,s)};t.clear=function(t){t===void 0&&(t=true);e.prototype.clear.call(this,false)};r(0,t,"sizeGrid",function(){return this._sizeGrid},function(t){this._sizeGrid=t;this._setChanged()});r(0,t,"width",function(){if(this._width)return this._width;if(this._source)return this._source.sourceWidth;return 0},function(t){if(this._width!=t){this._width=t;this._setChanged()}});r(0,t,"height",function(){if(this._height)return this._height;if(this._source)return this._source.sourceHeight;return 0},function(t){if(this._height!=t){this._height=t;this._setChanged()}});r(0,t,"source",function(){return this._source},function(t){if(t){this._source=t;this._setChanged()}else{this._source=null;this.clear()}});d.getTexture=function(t,e,i,n,r){if(n<=0)n=1;if(r<=0)r=1;t.$_GID||(t.$_GID=L.getGID());var s=t.$_GID+"."+e+"."+i+"."+n+"."+r;var a=P.I.get(s);if(!a||!a.source){a=M.createFromTexture(t,e,i,n,r);P.I.set(s,a)}return a};return d}(m);var B=function(t){function e(){e.__super.call(this)}a(e,"laya.ui.UIEvent",t);e.SHOW_TIP="showtip";e.HIDE_TIP="hidetip";return e}(f);var F=function(e){function t(){this._comXml=null;this._dataSource=null;this._toolTip=null;this._tag=null;this._disabled=false;this._gray=false;this.layoutEnabled=true;t.__super.call(this);this._layout=k.EMPTY;this.preinitialize();this.createChildren();this.initialize()}a(t,"laya.ui.Component",e);var i=t.prototype;p.imps(i,{"laya.ui.IComponent":true});i.destroy=function(t){t===void 0&&(t=true);e.prototype.destroy.call(this,t);this._dataSource=this._layout=null;this._tag=null;this._toolTip=null};i.preinitialize=function(){};i.createChildren=function(){};i.initialize=function(){};i.callLater=function(t,e){p.timer.callLater(this,t,e)};i.runCallLater=function(t){p.timer.runCallLater(this,t)};i.commitMeasure=function(){};i.changeSize=function(){this.event("resize");if(this._layout.enable){this.resetLayoutX();this.resetLayoutY()}};i.getLayout=function(){this._layout===k.EMPTY&&(this._layout=new k);return this._layout};i._setLayoutEnabled=function(t){if(this._layout&&this._layout.enable!=t){this._layout.enable=t;this.on("added",this,this.onAdded);this.on("removed",this,this.onRemoved);if(this.parent){this.onAdded()}}};i.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)};i.onAdded=function(){this.parent.on("resize",this,this.onCompResize);this.resetLayoutX();this.resetLayoutY()};i.onCompResize=function(){if(this._layout&&this._layout.enable){this.resetLayoutX();this.resetLayoutY()}};i.resetLayoutX=function(){var t=this._layout;if(!isNaN(t.anchorX))this.pivotX=t.anchorX*this.width;if(!this.layoutEnabled)return;var e=this.parent;if(e){if(!isNaN(t.centerX)){this.x=Math.round((e.width-this.displayWidth)*.5+t.centerX+this.pivotX*this.scaleX)}else if(!isNaN(t.left)){this.x=Math.round(t.left+this.pivotX*this.scaleX);if(!isNaN(t.right)){this.width=(e._width-t.left-t.right)/(this.scaleX||.01)}}else if(!isNaN(t.right)){this.x=Math.round(e.width-this.displayWidth-t.right+this.pivotX*this.scaleX)}}};i.resetLayoutY=function(){var t=this._layout;if(!isNaN(t.anchorY))this.pivotY=t.anchorY*this.height;if(!this.layoutEnabled)return;var e=this.parent;if(e){if(!isNaN(t.centerY)){this.y=Math.round((e.height-this.displayHeight)*.5+t.centerY+this.pivotY*this.scaleY)}else if(!isNaN(t.top)){this.y=Math.round(t.top+this.pivotY*this.scaleY);if(!isNaN(t.bottom)){this.height=(e._height-t.top-t.bottom)/(this.scaleY||.01)}}else if(!isNaN(t.bottom)){this.y=Math.round(e.height-this.displayHeight-t.bottom+this.pivotY*this.scaleY)}}};i.onMouseOver=function(t){p.stage.event("showtip",this._toolTip)};i.onMouseOut=function(t){p.stage.event("hidetip",this._toolTip)};i._childChanged=function(t){this.callLater(this.changeSize);e.prototype._childChanged.call(this,t)};r(0,i,"displayWidth",function(){return this.width*this.scaleX});r(0,i,"width",function(){if(this._width)return this._width;return this.measureWidth},function(t){if(this._width!=t){this._width=t;this.conchModel&&this.conchModel.size(this._width,this._height);this.callLater(this.changeSize);if(this._layout.enable&&(!isNaN(this._layout.centerX)||!isNaN(this._layout.right)||!isNaN(this._layout.anchorX)))this.resetLayoutX()}});r(0,i,"measureWidth",function(){var t=0;this.commitMeasure();for(var e=this.numChildren-1;e>-1;e--){var i=this.getChildAt(e);if(i.visible){t=Math.max(i.x+i.width*i.scaleX,t)}}return t});r(0,i,"displayHeight",function(){return this.height*this.scaleY});r(0,i,"height",function(){if(this._height)return this._height;return this.measureHeight},function(t){if(this._height!=t){this._height=t;this.conchModel&&this.conchModel.size(this._width,this._height);this.callLater(this.changeSize);if(this._layout.enable&&(!isNaN(this._layout.centerY)||!isNaN(this._layout.bottom)||!isNaN(this._layout.anchorY)))this.resetLayoutY()}});r(0,i,"dataSource",function(){return this._dataSource},function(t){this._dataSource=t;for(var e in this._dataSource){if(this.hasOwnProperty(e)&&!(typeof this[e]=="function")){this[e]=this._dataSource[e]}}});r(0,i,"scaleY",e.prototype._$get_scaleY,function(t){if(p.superGet(E,this,"scaleY")!=t){p.superSet(E,this,"scaleY",t);this.callLater(this.changeSize);this._layout.enable&&this.resetLayoutY()}});r(0,i,"measureHeight",function(){var t=0;this.commitMeasure();for(var e=this.numChildren-1;e>-1;e--){var i=this.getChildAt(e);if(i.visible){t=Math.max(i.y+i.height*i.scaleY,t)}}return t});r(0,i,"scaleX",e.prototype._$get_scaleX,function(t){if(p.superGet(E,this,"scaleX")!=t){p.superSet(E,this,"scaleX",t);this.callLater(this.changeSize);this._layout.enable&&this.resetLayoutX()}});r(0,i,"top",function(){return this._layout.top},function(t){if(t!=this._layout.top){this.getLayout().top=t;this._setLayoutEnabled(true)}this.resetLayoutY()});r(0,i,"bottom",function(){return this._layout.bottom},function(t){if(t!=this._layout.bottom){this.getLayout().bottom=t;this._setLayoutEnabled(true)}this.resetLayoutY()});r(0,i,"left",function(){return this._layout.left},function(t){if(t!=this._layout.left){this.getLayout().left=t;this._setLayoutEnabled(true)}this.resetLayoutX()});r(0,i,"right",function(){return this._layout.right},function(t){if(t!=this._layout.right){this.getLayout().right=t;this._setLayoutEnabled(true)}this.resetLayoutX()});r(0,i,"centerX",function(){return this._layout.centerX},function(t){if(t!=this._layout.centerX){this.getLayout().centerX=t;this._setLayoutEnabled(true)}this.resetLayoutX()});r(0,i,"centerY",function(){return this._layout.centerY},function(t){if(t!=this._layout.centerY){this.getLayout().centerY=t;this._setLayoutEnabled(true)}this.resetLayoutY()});r(0,i,"anchorX",function(){return this._layout.anchorX},function(t){if(t!=this._layout.anchorX){this.getLayout().anchorX=t;this._setLayoutEnabled(true)}this.resetLayoutX()});r(0,i,"anchorY",function(){return this._layout.anchorY},function(t){if(t!=this._layout.anchorY){this.getLayout().anchorY=t;this._setLayoutEnabled(true)}this.resetLayoutY()});r(0,i,"tag",function(){return this._tag},function(t){this._tag=t});r(0,i,"toolTip",function(){return this._toolTip},function(t){if(this._toolTip!=t){this._toolTip=t;if(t!=null){this.on("mouseover",this,this.onMouseOver);this.on("mouseout",this,this.onMouseOut)}else{this.off("mouseover",this,this.onMouseOver);this.off("mouseout",this,this.onMouseOut)}}});r(0,i,"comXml",function(){return this._comXml},function(t){this._comXml=t});r(0,i,"gray",function(){return this._gray},function(t){if(t!==this._gray){this._gray=t;R.gray(this,t)}});r(0,i,"disabled",function(){return this._disabled},function(t){if(t!==this._disabled){this.gray=this._disabled=t;this.mouseEnabled=!t}});return t}(E);var U=function(t){function e(){this.lockLayer=null;this.popupEffect=function(t){t.scale(1,1);I.from(t,{x:p.stage.width/2,y:p.stage.height/2,scaleX:0,scaleY:0},300,c.backOut,y.create(this,this.doOpen,[t]))};this.closeEffect=function(t,e){I.to(t,{x:p.stage.width/2,y:p.stage.height/2,scaleX:0,scaleY:0},300,c.strongOut,y.create(this,this.doClose,[t,e]))};e.__super.call(this);this.maskLayer=new E;this.popupEffectHandler=new y(this,this.popupEffect);this.closeEffectHandler=new y(this,this.closeEffect);this.mouseEnabled=this.maskLayer.mouseEnabled=true;this.zOrder=1e3;p.stage.addChild(this);p.stage.on("resize",this,this._onResize);if(N.closeDialogOnSide)this.maskLayer.on("click",this,this._closeOnSide);this._onResize(null)}a(e,"laya.ui.DialogManager",t);var i=e.prototype;i._closeOnSide=function(){var t=this.getChildAt(this.numChildren-1);if(t instanceof laya.ui.Dialog)t.close("side")};i.setLockView=function(t){if(!this.lockLayer){this.lockLayer=new V;this.lockLayer.mouseEnabled=true;this.lockLayer.size(p.stage.width,p.stage.height)}this.lockLayer.removeChildren();if(t){t.centerX=t.centerY=0;this.lockLayer.addChild(t)}};i._onResize=function(t){var e=this.maskLayer.width=p.stage.width;var i=this.maskLayer.height=p.stage.height;if(this.lockLayer)this.lockLayer.size(e,i);this.maskLayer.graphics.clear();this.maskLayer.graphics.drawRect(0,0,e,i,N.popupBgColor);this.maskLayer.alpha=N.popupBgAlpha;for(var n=this.numChildren-1;n>-1;n--){var r=this.getChildAt(n);if(r.popupCenter)this._centerDialog(r)}};i._centerDialog=function(t){t.x=Math.round((p.stage.width-t.width>>1)+t.pivotX);t.y=Math.round((p.stage.height-t.height>>1)+t.pivotY)};i.open=function(t,e,i){e===void 0&&(e=false);i===void 0&&(i=false);if(e)this._closeAll();if(t.popupCenter)this._centerDialog(t);this.addChild(t);if(t.isModal||this._$P["hasZorder"])this.timer.callLater(this,this._checkMask);if(i&&t.popupEffect!=null)t.popupEffect.runWith(t);else this.doOpen(t);this.event("open")};i.doOpen=function(t){t.onOpened()};i.lock=function(t){if(this.lockLayer){if(t)this.addChild(this.lockLayer);else this.lockLayer.removeSelf()}};i.close=function(t,e,i){i===void 0&&(i=false);if(i&&t.closeEffect!=null)t.closeEffect.runWith([t,e]);else this.doClose(t,e);this.event("close")};i.doClose=function(t,e){t.removeSelf();t.isModal&&this._checkMask();t.closeHandler&&t.closeHandler.runWith(e);t.onClosed(e)};i.closeAll=function(){this._closeAll();this.event("close")};i._closeAll=function(){for(var t=this.numChildren-1;t>-1;t--){var e=this.getChildAt(t);if(e&&e.close!=null){this.doClose(e)}}};i.getDialogsByGroup=function(t){var e=[];for(var i=this.numChildren-1;i>-1;i--){var n=this.getChildAt(i);if(n&&n.group===t){e.push(n)}}return e};i.closeByGroup=function(t){var e=[];for(var i=this.numChildren-1;i>-1;i--){var n=this.getChildAt(i);if(n&&n.group===t){n.close();e.push(n)}}return e};i._checkMask=function(){this.maskLayer.removeSelf();for(var t=this.numChildren-1;t>-1;t--){var e=this.getChildAt(t);if(e&&e.isModal){this.addChildAt(this.maskLayer,t);return}}};return e}(E);var G=function(e){function i(t){this._bitmap=null;this._skin=null;this._group=null;i.__super.call(this);this.skin=t}a(i,"laya.ui.Image",e);var t=i.prototype;t.destroy=function(t){t===void 0&&(t=true);e.prototype.destroy.call(this,true);this._bitmap&&this._bitmap.destroy();this._bitmap=null};t.dispose=function(){this.destroy(true);p.loader.clearRes(this._skin)};t.createChildren=function(){this.graphics=this._bitmap=new O;this._bitmap.autoCacheCmd=false};t.setSource=function(t,e){if(t===this._skin&&e){this.source=e;this.onCompResize()}};r(0,t,"source",function(){return this._bitmap.source},function(t){if(!this._bitmap)return;this._bitmap.source=t;this.event("loaded");this.repaint()});r(0,t,"dataSource",e.prototype._$get_dataSource,function(t){this._dataSource=t;if(typeof t=="string")this.skin=t;else p.superSet(F,this,"dataSource",t)});r(0,t,"measureHeight",function(){return this._bitmap.height});r(0,t,"skin",function(){return this._skin},function(t){if(this._skin!=t){this._skin=t;if(t){var e=x.getRes(t);if(e){this.source=e;this.onCompResize()}else p.loader.load(this._skin,y.create(this,this.setSource,[this._skin]),null,"image",1,true,this._group)}else{this.source=null}}});r(0,t,"group",function(){return this._group},function(t){if(t&&this._skin)x.setGroup(this._skin,t);this._group=t});r(0,t,"sizeGrid",function(){if(this._bitmap.sizeGrid)return this._bitmap.sizeGrid.join(",");return null},function(t){this._bitmap.sizeGrid=R.fillArray(D.defaultSizeGrid,t,Number)});r(0,t,"measureWidth",function(){return this._bitmap.width});r(0,t,"width",e.prototype._$get_width,function(t){p.superSet(F,this,"width",t);this._bitmap.width=t==0?1e-7:t});r(0,t,"height",e.prototype._$get_height,function(t){p.superSet(F,this,"height",t);this._bitmap.height=t==0?1e-7:t});return i}(F);var V=function(t){function e(){e.__super.call(this)}a(e,"laya.ui.Box",t);var i=e.prototype;p.imps(i,{"laya.ui.IBox":true});r(0,i,"dataSource",t.prototype._$get_dataSource,function(t){this._dataSource=t;for(var e in t){var i=this.getChildByName(e);if(i)i.dataSource=t[e];else if(this.hasOwnProperty(e)&&!(typeof this[e]=="function"))this[e]=t[e]}});return e}(F);var W=function(e){function i(t,e){this.toggle=false;this._bitmap=null;this._text=null;this._strokeColors=null;this._state=0;this._selected=false;this._skin=null;this._autoSize=true;this._sources=null;this._clickHandler=null;this._stateChanged=false;i.__super.call(this);this._labelColors=D.buttonLabelColors;this._stateNum=D.buttonStateNum;e===void 0&&(e="");this.skin=t;this.label=e}a(i,"laya.ui.Button",e);var t=i.prototype;p.imps(t,{"laya.ui.ISelect":true});t.destroy=function(t){t===void 0&&(t=true);e.prototype.destroy.call(this,t);this._bitmap&&this._bitmap.destroy();this._text&&this._text.destroy(t);this._bitmap=null;this._text=null;this._clickHandler=null;this._labelColors=this._sources=this._strokeColors=null};t.createChildren=function(){this.graphics=this._bitmap=new O};t.createText=function(){if(!this._text){this._text=new A;this._text.overflow=A.HIDDEN;this._text.align="center";this._text.valign="middle";this._text.width=this._width;this._text.height=this._height}};t.initialize=function(){if(this._mouseEnableState!==1){this.mouseEnabled=true;this._setBit(2,true)}this._createListener("mouseover",this,this.onMouse,null,false,false);this._createListener("mouseout",this,this.onMouse,null,false,false);this._createListener("mousedown",this,this.onMouse,null,false,false);this._createListener("mouseup",this,this.onMouse,null,false,false);this._createListener("click",this,this.onMouse,null,false,false)};t.onMouse=function(t){if(this.toggle===false&&this._selected)return;if(t.type==="click"){this.toggle&&(this.selected=!this._selected);this._clickHandler&&this._clickHandler.run();return}!this._selected&&(this.state=i.stateMap[t.type])};t.changeClips=function(){var t=x.getRes(this._skin);if(!t){console.log("lose skin",this._skin);return}var e=t.sourceWidth;var i=t.sourceHeight/this._stateNum;t.$_GID||(t.$_GID=L.getGID());var n=t.$_GID+"-"+this._stateNum;var r=P.I.get(n);if(!L.isOkTextureList(r)){r=null}if(r)this._sources=r;else{this._sources=[];if(this._stateNum===1){this._sources.push(t)}else{for(var s=0;s<this._stateNum;s++){this._sources.push(M.createFromTexture(t,0,i*s,e,i))}}P.I.set(n,this._sources)}if(this._autoSize){this._bitmap.width=this._width||e;this._bitmap.height=this._height||i;if(this._text){this._text.width=this._bitmap.width;this._text.height=this._bitmap.height}}else{this._text&&(this._text.x=e)}};t.changeState=function(){this._stateChanged=false;this.runCallLater(this.changeClips);var t=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[t]);if(this.label){this._text.color=this._labelColors[t];if(this._strokeColors)this._text.strokeColor=this._strokeColors[t]}};t._setStateChanged=function(){if(!this._stateChanged){this._stateChanged=true;this.callLater(this.changeState)}};r(0,t,"labelStrokeColor",function(){this.createText();return this._text.strokeColor},function(t){this.createText();this._text.strokeColor=t});r(0,t,"measureHeight",function(){this.runCallLater(this.changeClips);return this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height});r(0,t,"skin",function(){return this._skin},function(t){if(this._skin!=t){this._skin=t;this.callLater(this.changeClips);this._setStateChanged()}});r(0,t,"state",function(){return this._state},function(t){if(this._state!=t){this._state=t;this._setStateChanged()}});r(0,t,"text",function(){this.createText();return this._text});r(0,t,"stateNum",function(){return this._stateNum},function(t){if(typeof t=="string"){t=parseInt(t)}if(this._stateNum!=t){this._stateNum=t<1?1:t>3?3:t;this.callLater(this.changeClips)}});r(0,t,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(t){this._strokeColors=R.fillArray(D.buttonLabelColors,t,String);this._setStateChanged()});r(0,t,"labelColors",function(){return this._labelColors.join(",")},function(t){this._labelColors=R.fillArray(D.buttonLabelColors,t,String);this._setStateChanged()});r(0,t,"measureWidth",function(){this.runCallLater(this.changeClips);if(this._autoSize)return this._bitmap.width;this.runCallLater(this.changeState);return this._bitmap.width+(this._text?this._text.width:0)});r(0,t,"label",function(){return this._text?this._text.text:null},function(t){if(!this._text&&!t)return;this.createText();if(this._text.text!=t){t&&!this._text.parent&&this.addChild(this._text);this._text.text=(t+"").replace(/\\n/g,"\n");this._setStateChanged()}});r(0,t,"selected",function(){return this._selected},function(t){if(this._selected!=t){this._selected=t;this.state=this._selected?2:0;this.event("change")}});r(0,t,"labelPadding",function(){this.createText();return this._text.padding.join(",")},function(t){this.createText();this._text.padding=R.fillArray(D.labelPadding,t,Number)});r(0,t,"labelSize",function(){this.createText();return this._text.fontSize},function(t){this.createText();this._text.fontSize=t});r(0,t,"labelStroke",function(){this.createText();return this._text.stroke},function(t){this.createText();this._text.stroke=t});r(0,t,"labelBold",function(){this.createText();return this._text.bold},function(t){this.createText();this._text.bold=t});r(0,t,"labelFont",function(){this.createText();return this._text.font},function(t){this.createText();this._text.font=t});r(0,t,"labelAlign",function(){this.createText();return this._text.align},function(t){this.createText();this._text.align=t});r(0,t,"clickHandler",function(){return this._clickHandler},function(t){this._clickHandler=t});r(0,t,"sizeGrid",function(){if(this._bitmap.sizeGrid)return this._bitmap.sizeGrid.join(",");return null},function(t){this._bitmap.sizeGrid=R.fillArray(D.defaultSizeGrid,t,Number)});r(0,t,"width",e.prototype._$get_width,function(t){p.superSet(F,this,"width",t);if(this._autoSize){this._bitmap.width=t;this._text&&(this._text.width=t)}});r(0,t,"height",e.prototype._$get_height,function(t){p.superSet(F,this,"height",t);if(this._autoSize){this._bitmap.height=t;this._text&&(this._text.height=t)}});r(0,t,"dataSource",e.prototype._$get_dataSource,function(t){this._dataSource=t;if(typeof t=="number"||typeof t=="string")this.label=t+"";else p.superSet(F,this,"dataSource",t)});r(0,t,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(t){if(t)this._bitmap._offset=R.fillArray([1,1],t,Number);else this._bitmap._offset=[]});s(i,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]);return i}(F);var z=function(e){function n(t,e,i){this._sources=null;this._bitmap=null;this._skin=null;this._clipX=1;this._clipY=1;this._clipWidth=0;this._clipHeight=0;this._autoPlay=false;this._interval=50;this._complete=null;this._isPlaying=false;this._index=0;this._clipChanged=false;this._group=null;this._toIndex=-1;n.__super.call(this);e===void 0&&(e=1);i===void 0&&(i=1);this._clipX=e;this._clipY=i;this.skin=t}a(n,"laya.ui.Clip",e);var t=n.prototype;t.destroy=function(t){t===void 0&&(t=true);e.prototype.destroy.call(this,true);this._bitmap&&this._bitmap.destroy();this._bitmap=null;this._sources=null};t.dispose=function(){this.destroy(true);p.loader.clearRes(this._skin)};t.createChildren=function(){this.graphics=this._bitmap=new O};t._onDisplay=function(t){if(this._isPlaying){if(this._displayedInStage)this.play();else this.stop()}else if(this._autoPlay){this.play()}};t.changeClip=function(){this._clipChanged=false;if(!this._skin)return;var t=x.getRes(this._skin);if(t){this.loadComplete(this._skin,t)}else{p.loader.load(this._skin,y.create(this,this.loadComplete,[this._skin]))}};t.loadComplete=function(t,e){if(t===this._skin&&e){var i=this._clipWidth||Math.ceil(e.sourceWidth/this._clipX);var n=this._clipHeight||Math.ceil(e.sourceHeight/this._clipY);var r=this._skin+i+n;var s=P.I.get(r);if(!L.isOkTextureList(s)){s=null}if(s)this._sources=s;else{this._sources=[];for(var a=0;a<this._clipY;a++){for(var o=0;o<this._clipX;o++){this._sources.push(M.createFromTexture(e,i*o,n*a,i,n))}}P.I.set(r,this._sources)}this.index=this._index;this.event("loaded");this.onCompResize()}};t.play=function(t,e){t===void 0&&(t=0);e===void 0&&(e=-1);this._isPlaying=true;this.index=t;this._toIndex=e;this._index++;p.timer.loop(this.interval,this,this._loop);this.on("display",this,this._onDisplay);this.on("undisplay",this,this._onDisplay)};t._loop=function(){if(this._style.visible&&this._sources){this._index++;if(this._toIndex>-1&&this._index>=this._toIndex)this.stop();else if(this._index>=this._sources.length)this._index=0;this.index=this._index}};t.stop=function(){this._isPlaying=false;p.timer.clear(this,this._loop);this.event("complete")};t._setClipChanged=function(){if(!this._clipChanged){this._clipChanged=true;this.callLater(this.changeClip)}};r(0,t,"interval",function(){return this._interval},function(t){if(this._interval!=t){this._interval=t;if(this._isPlaying)this.play()}});r(0,t,"skin",function(){return this._skin},function(t){if(this._skin!=t){this._skin=t;if(t){this._setClipChanged()}else{this._bitmap.source=null}}});r(0,t,"sources",function(){return this._sources},function(t){this._sources=t;this.index=this._index;this.event("loaded")});r(0,t,"clipX",function(){return this._clipX},function(t){this._clipX=t||1;this._setClipChanged()});r(0,t,"clipY",function(){return this._clipY},function(t){this._clipY=t||1;this._setClipChanged()});r(0,t,"total",function(){this.runCallLater(this.changeClip);return this._sources?this._sources.length:0});r(0,t,"clipWidth",function(){return this._clipWidth},function(t){this._clipWidth=t;this._setClipChanged()});r(0,t,"sizeGrid",function(){if(this._bitmap.sizeGrid)return this._bitmap.sizeGrid.join(",");return null},function(t){this._bitmap.sizeGrid=R.fillArray(D.defaultSizeGrid,t,Number)});r(0,t,"group",function(){return this._group},function(t){if(t&&this._skin)x.setGroup(this._skin,t);this._group=t});r(0,t,"clipHeight",function(){return this._clipHeight},function(t){this._clipHeight=t;this._setClipChanged()});r(0,t,"width",e.prototype._$get_width,function(t){p.superSet(F,this,"width",t);this._bitmap.width=t});r(0,t,"height",e.prototype._$get_height,function(t){p.superSet(F,this,"height",t);this._bitmap.height=t});r(0,t,"measureWidth",function(){this.runCallLater(this.changeClip);return this._bitmap.width});r(0,t,"measureHeight",function(){this.runCallLater(this.changeClip);return this._bitmap.height});r(0,t,"index",function(){return this._index},function(t){this._index=t;this._bitmap&&this._sources&&(this._bitmap.source=this._sources[t]);this.event("change")});r(0,t,"autoPlay",function(){return this._autoPlay},function(t){if(this._autoPlay!=t){this._autoPlay=t;t?this.play():this.stop()}});r(0,t,"isPlaying",function(){return this._isPlaying},function(t){this._isPlaying=t});r(0,t,"dataSource",e.prototype._$get_dataSource,function(t){this._dataSource=t;if(typeof t=="number"&&Math.floor(t)==t||typeof t=="string")this.index=parseInt(t);else p.superSet(F,this,"dataSource",t)});r(0,t,"bitmap",function(){return this._bitmap});return n}(F);var H=function(e){function t(){this.changeHandler=null;this._gridSize=11;this._bgColor="#ffffff";this._borderColor="#000000";this._inputColor="#000000";this._inputBgColor="#efefef";this._colorPanel=null;this._colorTiles=null;this._colorBlock=null;this._colorInput=null;this._colorButton=null;this._colors=[];this._selectedColor="#000000";this._panelChanged=false;t.__super.call(this)}a(t,"laya.ui.ColorPicker",e);var i=t.prototype;i.destroy=function(t){t===void 0&&(t=true);e.prototype.destroy.call(this,t);this._colorPanel&&this._colorPanel.destroy(t);this._colorButton&&this._colorButton.destroy(t);this._colorPanel=null;this._colorTiles=null;this._colorBlock=null;this._colorInput=null;this._colorButton=null;this._colors=null;this.changeHandler=null};i.createChildren=function(){this.addChild(this._colorButton=new W);this._colorPanel=new V;this._colorPanel.size(230,166);this._colorPanel.addChild(this._colorTiles=new E);this._colorPanel.addChild(this._colorBlock=new E);this._colorPanel.addChild(this._colorInput=new b)};i.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick);this._colorBlock.pos(5,5);this._colorInput.pos(60,5);this._colorInput.size(60,20);this._colorInput.on("change",this,this.onColorInputChange);this._colorInput.on("keydown",this,this.onColorFieldKeyDown);this._colorTiles.pos(5,30);this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove);this._colorTiles.on("click",this,this.onColorTilesClick);this._colorTiles.size(20*this._gridSize,12*this._gridSize);this._colorPanel.on("mousedown",this,this.onPanelMouseDown);this.bgColor=this._bgColor};i.onPanelMouseDown=function(t){t.stopPropagation()};i.changePanel=function(){this._panelChanged=false;var t=this._colorPanel.graphics;t.clear();t.drawRect(0,0,230,166,this._bgColor,this._borderColor);this.drawBlock(this._selectedColor);this._colorInput.borderColor=this._borderColor;this._colorInput.bgColor=this._inputBgColor;this._colorInput.color=this._inputColor;t=this._colorTiles.graphics;t.clear();var e=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935];for(var i=0;i<12;i++){for(var n=0;n<20;n++){var r=0;if(n===0)r=e[i];else if(n===1)r=0;else r=(((i*3+n/6)%3<<0)+(i/6<<0)*3)*51<<16|n%6*51<<8|(i<<0)%6*51;var s=R.toColor(r);this._colors.push(s);var a=n*this._gridSize;var o=i*this._gridSize;t.drawRect(a,o,this._gridSize,this._gridSize,s,"#000000")}}};i.onColorButtonClick=function(t){if(this._colorPanel.parent)this.close();else this.open()};i.open=function(){var t=this.localToGlobal(new T);var e=t.x+this._colorPanel.width<=p.stage.width?t.x:p.stage.width-this._colorPanel.width;var i=t.y+this._colorButton.height;i=i+this._colorPanel.height<=p.stage.height?i:t.y-this._colorPanel.height;this._colorPanel.pos(e,i);this._colorPanel.zOrder=1001;p._currentStage.addChild(this._colorPanel);p.stage.on("mousedown",this,this.removeColorBox)};i.close=function(){p.stage.off("mousedown",this,this.removeColorBox);this._colorPanel.removeSelf()};i.removeColorBox=function(t){this.close()};i.onColorFieldKeyDown=function(t){if(t.keyCode==13){if(this._colorInput.text)this.selectedColor=this._colorInput.text;else this.selectedColor=null;this.close();t.stopPropagation()}};i.onColorInputChange=function(t){if(this._colorInput.text)this.drawBlock(this._colorInput.text);else this.drawBlock("#FFFFFF")};i.onColorTilesClick=function(t){this.selectedColor=this.getColorByMouse();this.close()};i.onColorTilesMouseMove=function(t){this._colorInput.focus=false;var e=this.getColorByMouse();this._colorInput.text=e;this.drawBlock(e)};i.getColorByMouse=function(){var t=this._colorTiles.getMousePoint();var e=Math.floor(t.x/this._gridSize);var i=Math.floor(t.y/this._gridSize);return this._colors[i*20+e]};i.drawBlock=function(t){var e=this._colorBlock.graphics;e.clear();var i=t?t:"#ffffff";e.drawRect(0,0,50,20,i,this._borderColor);t||e.drawLine(0,0,50,20,"#ff0000")};i.changeColor=function(){var t=this.graphics;t.clear();var e=this._selectedColor||"#000000";t.drawRect(0,0,this._colorButton.width,this._colorButton.height,e)};i._setPanelChanged=function(){if(!this._panelChanged){this._panelChanged=true;this.callLater(this.changePanel)}};r(0,i,"inputBgColor",function(){return this._inputBgColor},function(t){this._inputBgColor=t;this._setPanelChanged()});r(0,i,"selectedColor",function(){return this._selectedColor},function(t){if(this._selectedColor!=t){this._selectedColor=this._colorInput.text=t;this.drawBlock(t);this.changeColor();this.changeHandler&&this.changeHandler.runWith(this._selectedColor);this.event("change",f.EMPTY.setTo("change",this,this))}});r(0,i,"skin",function(){return this._colorButton.skin},function(t){this._colorButton.skin=t;this.changeColor()});r(0,i,"bgColor",function(){return this._bgColor},function(t){this._bgColor=t;this._setPanelChanged()});r(0,i,"borderColor",function(){return this._borderColor},function(t){this._borderColor=t;this._setPanelChanged()});r(0,i,"inputColor",function(){return this._inputColor},function(t){this._inputColor=t;this._setPanelChanged()});return t}(F);var Y=function(e){function i(t,e){this._visibleNum=6;this._button=null;this._list=null;this._isOpen=false;this._itemSize=12;this._labels=[];this._selectedIndex=-1;this._selectHandler=null;this._itemHeight=NaN;this._listHeight=NaN;this._listChanged=false;this._itemChanged=false;this._scrollBarSkin=null;this._isCustomList=false;this.itemRender=null;i.__super.call(this);this._itemColors=D.comboBoxItemColors;this.skin=t;this.labels=e}a(i,"laya.ui.ComboBox",e);var t=i.prototype;t.destroy=function(t){t===void 0&&(t=true);e.prototype.destroy.call(this,t);this._button&&this._button.destroy(t);this._list&&this._list.destroy(t);this._button=null;this._list=null;this._itemColors=null;this._labels=null;this._selectHandler=null};t.createChildren=function(){this.addChild(this._button=new W);this._button.text.align="left";this._button.labelPadding="0,0,0,5";this._button.on("mousedown",this,this.onButtonMouseDown)};t._createList=function(){this._list=new it;if(this._scrollBarSkin)this._list.vScrollBarSkin=this._scrollBarSkin;this._setListEvent(this._list)};t._setListEvent=function(t){this._list.selectEnable=true;this._list.on("mousedown",this,this.onListDown);this._list.mouseHandler=y.create(this,this.onlistItemMouse,null,false);if(this._list.scrollBar)this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)};t.onListDown=function(t){t.stopPropagation()};t.onScrollBarDown=function(t){t.stopPropagation()};t.onButtonMouseDown=function(t){this.callLater(this.switchTo,[!this._isOpen])};t.changeList=function(){this._listChanged=false;var t=this.width-2;var e=this._itemColors[2];this._itemHeight=this._itemSize+6;this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:t,height:this._itemHeight,fontSize:this._itemSize,color:e}}]};this._list.repeatY=this._visibleNum;this._list.refresh()};t.onlistItemMouse=function(t,e){var i=t.type;if(i==="mouseover"||i==="mouseout"){if(this._isCustomList)return;var n=this._list.getCell(e);if(!n)return;var r=n.getChildByName("label");if(r){if(i==="mouseover"){r.bgColor=this._itemColors[0];r.color=this._itemColors[1]}else{r.bgColor=null;r.color=this._itemColors[2]}}}else if(i==="click"){this.selectedIndex=e;this.isOpen=false}};t.switchTo=function(t){this.isOpen=t};t.changeOpen=function(){this.isOpen=!this._isOpen};t.changeItem=function(){this._itemChanged=false;this._listHeight=this._labels.length>0?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight;if(!this._isCustomList){var t=this._list.graphics;t.clear();t.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}var e=this._list.array||[];e.length=0;for(var i=0,n=this._labels.length;i<n;i++){e.push({label:this._labels[i]})}this._list.height=this._listHeight;this._list.array=e};t.changeSelected=function(){this._button.label=this.selectedLabel};t._onStageMouseWheel=function(t){if(!this._list||this._list.contains(t.target))return;this.removeList(null)};t.removeList=function(t){p.stage.off("mousedown",this,this.removeList);p.stage.off("mousewheel",this,this._onStageMouseWheel);this.isOpen=false};r(0,t,"selectedIndex",function(){return this._selectedIndex},function(t){if(this._selectedIndex!=t){this._selectedIndex=t;if(this._labels.length>0)this.changeSelected();else this.callLater(this.changeSelected);this.event("change",[f.EMPTY.setTo("change",this,this)]);this._selectHandler&&this._selectHandler.runWith(this._selectedIndex)}});r(0,t,"measureHeight",function(){return this._button.height});r(0,t,"skin",function(){return this._button.skin},function(t){if(this._button.skin!=t){this._button.skin=t;this._listChanged=true}});r(0,t,"measureWidth",function(){return this._button.width});r(0,t,"width",e.prototype._$get_width,function(t){p.superSet(F,this,"width",t);this._button.width=this._width;this._itemChanged=true;this._listChanged=true});r(0,t,"selectedLabel",function(){return this._selectedIndex>-1&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(t){this.selectedIndex=this._labels.indexOf(t)});r(0,t,"labels",function(){return this._labels.join(",")},function(t){if(this._labels.length>0)this.selectedIndex=-1;if(t)this._labels=t.split(",");else this._labels.length=0;this._itemChanged=true});r(0,t,"height",e.prototype._$get_height,function(t){p.superSet(F,this,"height",t);this._button.height=this._height});r(0,t,"selectHandler",function(){return this._selectHandler},function(t){this._selectHandler=t});r(0,t,"visibleNum",function(){return this._visibleNum},function(t){this._visibleNum=t;this._listChanged=true});r(0,t,"labelBold",function(){return this._button.text.bold},function(t){this._button.text.bold=t});r(0,t,"itemColors",function(){return String(this._itemColors)},function(t){this._itemColors=R.fillArray(this._itemColors,t,String);this._listChanged=true});r(0,t,"itemSize",function(){return this._itemSize},function(t){this._itemSize=t;this._listChanged=true});r(0,t,"scrollBar",function(){return this.list.scrollBar});r(0,t,"isOpen",function(){return this._isOpen},function(t){if(this._isOpen!=t){this._isOpen=t;this._button.selected=this._isOpen;if(this._isOpen){this._list||this._createList();this._listChanged&&!this._isCustomList&&this.changeList();this._itemChanged&&this.changeItem();var e=this.localToGlobal(T.TEMP.setTo(0,0));var i=e.y+this._button.height;i=i+this._listHeight<=p.stage.height?i:e.y-this._listHeight;this._list.pos(e.x,i);this._list.zOrder=1001;p._currentStage.addChild(this._list);p.stage.once("mousedown",this,this.removeList);p.stage.on("mousewheel",this,this._onStageMouseWheel);this._list.selectedIndex=this._selectedIndex}else{this._list&&this._list.removeSelf()}}});r(0,t,"scrollBarSkin",function(){return this._scrollBarSkin},function(t){this._scrollBarSkin=t});r(0,t,"sizeGrid",function(){return this._button.sizeGrid},function(t){this._button.sizeGrid=t});r(0,t,"button",function(){return this._button});r(0,t,"list",function(){this._list||this._createList();return this._list},function(t){if(t){t.removeSelf();this._isCustomList=true;this._list=t;this._setListEvent(t);this._itemHeight=t.getCell(0).height+t.spaceY}});r(0,t,"dataSource",e.prototype._$get_dataSource,function(t){this._dataSource=t;if(typeof t=="number"&&Math.floor(t)==t||typeof t=="string")this.selectedIndex=parseInt(t);else if(t instanceof Array)this.labels=t.join(",");else p.superSet(F,this,"dataSource",t)});r(0,t,"labelColors",function(){return this._button.labelColors},function(t){if(this._button.labelColors!=t){this._button.labelColors=t}});r(0,t,"labelPadding",function(){return this._button.text.padding.join(",")},function(t){this._button.text.padding=R.fillArray(D.labelPadding,t,Number)});r(0,t,"labelSize",function(){return this._button.text.fontSize},function(t){this._button.text.fontSize=t});r(0,t,"labelFont",function(){return this._button.text.font},function(t){this._button.text.font=t});r(0,t,"stateNum",function(){return this._button.stateNum},function(t){this._button.stateNum=t});return i}(F);var j=function(e){function i(t){this.rollRatio=.95;this.changeHandler=null;this.scaleBar=true;this.autoHide=false;this.elasticDistance=0;this.elasticBackTime=500;this.upButton=null;this.downButton=null;this.slider=null;this._scrollSize=1;this._skin=null;this._thumbPercent=1;this._target=null;this._lastPoint=null;this._lastOffset=0;this._checkElastic=false;this._isElastic=false;this._value=NaN;this._hide=false;this._clickOnly=true;this._offsets=null;i.__super.call(this);this._showButtons=N.showButtons;this._touchScrollEnable=N.touchScrollEnable;this._mouseWheelEnable=N.mouseWheelEnable;this.skin=t;this.max=1}a(i,"laya.ui.ScrollBar",e);var t=i.prototype;t.destroy=function(t){t===void 0&&(t=true);this.stopScroll();this.target=null;e.prototype.destroy.call(this,t);this.upButton&&this.upButton.destroy(t);this.downButton&&this.downButton.destroy(t);this.slider&&this.slider.destroy(t);this.upButton=this.downButton=null;this.slider=null;this.changeHandler=null;this._offsets=null};t.createChildren=function(){this.addChild(this.slider=new X);this.addChild(this.upButton=new W);this.addChild(this.downButton=new W)};t.initialize=function(){this.slider.showLabel=false;this.slider.on("change",this,this.onSliderChange);this.slider.setSlider(0,0,0);this.upButton.on("mousedown",this,this.onButtonMouseDown);this.downButton.on("mousedown",this,this.onButtonMouseDown)};t.onSliderChange=function(){if(this._value!=this.slider.value)this.value=this.slider.value};t.onButtonMouseDown=function(t){var e=t.currentTarget===this.upButton;this.slide(e);p.timer.once(D.scrollBarDelayTime,this,this.startLoop,[e]);p.stage.once("mouseup",this,this.onStageMouseUp)};t.startLoop=function(t){p.timer.frameLoop(1,this,this.slide,[t])};t.slide=function(t){if(t)this.value-=this._scrollSize;else this.value+=this._scrollSize};t.onStageMouseUp=function(t){p.timer.clear(this,this.startLoop);p.timer.clear(this,this.slide)};t.changeScrollBar=function(){this.upButton.visible=this._showButtons;this.downButton.visible=this._showButtons;if(this._showButtons){this.upButton.skin=this._skin.replace(".png","$up.png");this.downButton.skin=this._skin.replace(".png","$down.png")}if(this.slider.isVertical)this.slider.y=this._showButtons?this.upButton.height:0;else this.slider.x=this._showButtons?this.upButton.width:0;this.resetPositions();this.repaint()};t.changeSize=function(){e.prototype.changeSize.call(this);this.repaint();this.resetPositions();this.event("change");this.changeHandler&&this.changeHandler.runWith(this.value)};t.resetPositions=function(){if(this.slider.isVertical)this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0);else this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0);this.resetButtonPosition()};t.resetButtonPosition=function(){if(this.slider.isVertical)this.downButton.y=this.slider.y+this.slider.height;else this.downButton.x=this.slider.x+this.slider.width};t.setScroll=function(t,e,i){this.runCallLater(this.changeSize);this.slider.setSlider(t,e,i);this.slider.bar.visible=e>0;if(!this._hide&&this.autoHide)this.visible=false};t.onTargetMouseWheel=function(t){this.value-=t.delta*this._scrollSize;this.target=this._target};t.onTargetMouseDown=function(t){this._clickOnly=true;this._lastOffset=0;this._checkElastic=false;this._lastPoint||(this._lastPoint=new T);this._lastPoint.setTo(p.stage.mouseX,p.stage.mouseY);p.timer.clear(this,this.tweenMove);I.clearTween(this);p.stage.once("mouseup",this,this.onStageMouseUp2);p.stage.once("mouseout",this,this.onStageMouseUp2);p.timer.frameLoop(1,this,this.loop)};t.loop=function(){var t=p.stage.mouseY;var e=p.stage.mouseX;this._lastOffset=this.isVertical?t-this._lastPoint.y:e-this._lastPoint.x;if(this._clickOnly){if(Math.abs(this._lastOffset*(this.isVertical?p.stage._canvasTransform.getScaleY():p.stage._canvasTransform.getScaleX()))>1){this._clickOnly=false;this._offsets||(this._offsets=[]);this._offsets.length=0;this._target.mouseEnabled=false;if(!this.hide&&this.autoHide){this.alpha=1;this.visible=true}this.event("start")}else return}this._offsets.push(this._lastOffset);this._lastPoint.x=e;this._lastPoint.y=t;if(this._lastOffset===0)return;if(!this._checkElastic){if(this.elasticDistance>0){if(!this._checkElastic&&this._lastOffset!=0){if(this._lastOffset>0&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max){this._isElastic=true;this._checkElastic=true}else{this._isElastic=false}}}else{this._checkElastic=true}}if(this._isElastic){if(this._value<=this.min){this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance)}else if(this._value>=this.max){this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)}}else{this.value-=this._lastOffset}};t.onStageMouseUp2=function(t){p.stage.off("mouseup",this,this.onStageMouseUp2);p.stage.off("mouseout",this,this.onStageMouseUp2);p.timer.clear(this,this.loop);if(this._clickOnly){if(this._value>=this.min&&this._value<=this.max)return}this._target.mouseEnabled=true;if(this._isElastic){if(this._value<this.min){I.to(this,{value:this.min},this.elasticBackTime,c.sineOut,y.create(this,this.elasticOver))}else if(this._value>this.max){I.to(this,{value:this.max},this.elasticBackTime,c.sineOut,y.create(this,this.elasticOver))}}else{if(!this._offsets)return;if(this._offsets.length<1){this._offsets[0]=this.isVertical?p.stage.mouseY-this._lastPoint.y:p.stage.mouseX-this._lastPoint.x}var e=0;var i=Math.min(this._offsets.length,3);for(var n=0;n<i;n++){e+=this._offsets[this._offsets.length-1-n]}this._lastOffset=e/i;e=Math.abs(this._lastOffset);if(e<2){this.event("end");return}if(e>60)this._lastOffset=this._lastOffset>0?60:-60;var r=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));p.timer.frameLoop(1,this,this.tweenMove,[r])}};t.elasticOver=function(){this._isElastic=false;if(!this.hide&&this.autoHide){I.to(this,{alpha:0},500)}this.event("end")};t.tweenMove=function(t){this._lastOffset*=this.rollRatio;var e=NaN;if(t>0){if(this._lastOffset>0&&this.value<=this.min){this._isElastic=true;e=-(this.min-t-this.value)*.5;if(this._lastOffset>e)this._lastOffset=e}else if(this._lastOffset<0&&this.value>=this.max){this._isElastic=true;e=-(this.max+t-this.value)*.5;if(this._lastOffset<e)this._lastOffset=e}}this.value-=this._lastOffset;if(Math.abs(this._lastOffset)<1){p.timer.clear(this,this.tweenMove);if(this._isElastic){if(this._value<this.min){I.to(this,{value:this.min},this.elasticBackTime,c.sineOut,y.create(this,this.elasticOver))}else if(this._value>this.max){I.to(this,{value:this.max},this.elasticBackTime,c.sineOut,y.create(this,this.elasticOver))}else{this.elasticOver()}return}this.event("end");if(!this.hide&&this.autoHide){I.to(this,{alpha:0},500)}}};t.stopScroll=function(){this.onStageMouseUp2(null);p.timer.clear(this,this.tweenMove);I.clearTween(this)};r(0,t,"measureHeight",function(){if(this.slider.isVertical)return 100;return this.slider.height});r(0,t,"skin",function(){return this._skin},function(t){if(this._skin!=t){this._skin=t;this.slider.skin=this._skin;this.callLater(this.changeScrollBar)}});r(0,t,"max",function(){return this.slider.max},function(t){this.slider.max=t});r(0,t,"showButtons",function(){return this._showButtons},function(t){this._showButtons=t;this.callLater(this.changeScrollBar)});r(0,t,"measureWidth",function(){if(this.slider.isVertical)return this.slider.width;return 100});r(0,t,"min",function(){return this.slider.min},function(t){this.slider.min=t});r(0,t,"value",function(){return this._value},function(t){if(t!==this._value){this._value=t;if(!this._isElastic){if(this.slider._value!=t){this.slider._value=t;this.slider.changeValue()}this._value=this.slider._value}this.event("change");this.changeHandler&&this.changeHandler.runWith(this._value)}});r(0,t,"isVertical",function(){return this.slider.isVertical},function(t){this.slider.isVertical=t});r(0,t,"sizeGrid",function(){return this.slider.sizeGrid},function(t){this.slider.sizeGrid=t});r(0,t,"scrollSize",function(){return this._scrollSize},function(t){this._scrollSize=t});r(0,t,"dataSource",e.prototype._$get_dataSource,function(t){this._dataSource=t;if(typeof t=="number"||typeof t=="string")this.value=Number(t);else p.superSet(F,this,"dataSource",t)});r(0,t,"thumbPercent",function(){return this._thumbPercent},function(t){this.runCallLater(this.changeScrollBar);this.runCallLater(this.changeSize);t=t>=1?.99:t;this._thumbPercent=t;if(this.scaleBar){if(this.slider.isVertical)this.slider.bar.height=Math.max(this.slider.height*t,D.scrollBarMinNum);else this.slider.bar.width=Math.max(this.slider.width*t,D.scrollBarMinNum)}});r(0,t,"target",function(){return this._target},function(t){if(this._target){this._target.off("mousewheel",this,this.onTargetMouseWheel);this._target.off("mousedown",this,this.onTargetMouseDown)}this._target=t;if(t){this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel);this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown)}});r(0,t,"hide",function(){return this._hide},function(t){this._hide=t;this.visible=!t});r(0,t,"touchScrollEnable",function(){return this._touchScrollEnable},function(t){this._touchScrollEnable=t;this.target=this._target});r(0,t,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(t){this._mouseWheelEnable=t;this.target=this._target});r(0,t,"tick",function(){return this.slider.tick},function(t){this.slider.tick=t});return i}(F);var X=function(e){function i(t){this.changeHandler=null;this.isVertical=true;this.showLabel=true;this._allowClickBack=false;this._max=100;this._min=0;this._tick=1;this._value=0;this._skin=null;this._bg=null;this._progress=null;this._bar=null;this._tx=NaN;this._ty=NaN;this._maxMove=NaN;this._globalSacle=null;i.__super.call(this);this.skin=t}a(i,"laya.ui.Slider",e);var t=i.prototype;t.destroy=function(t){t===void 0&&(t=true);e.prototype.destroy.call(this,t);this._bg&&this._bg.destroy(t);this._bar&&this._bar.destroy(t);this._progress&&this._progress.destroy(t);this._bg=null;this._bar=null;this._progress=null;this.changeHandler=null};t.createChildren=function(){this.addChild(this._bg=new G);this.addChild(this._bar=new W)};t.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown);this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0";if(this._progress)this._progress.sizeGrid=this._bar.sizeGrid;this.allowClickBack=true};t.onBarMouseDown=function(t){this._globalSacle||(this._globalSacle=new T);this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01);this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width;this._tx=p.stage.mouseX;this._ty=p.stage.mouseY;p.stage.on("mousemove",this,this.mouseMove);p.stage.once("mouseup",this,this.mouseUp);p.stage.once("mouseout",this,this.mouseUp);this.showValueText()};t.showValueText=function(){if(this.showLabel){var t=laya.ui.Slider.label;this.addChild(t);t.textField.changeText(this._value+"");if(this.isVertical){t.x=this._bar.x+20;t.y=(this._bar.height-t.height)*.5+this._bar.y}else{t.y=this._bar.y-20;t.x=(this._bar.width-t.width)*.5+this._bar.x}}};t.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()};t.mouseUp=function(t){p.stage.off("mousemove",this,this.mouseMove);p.stage.off("mouseup",this,this.mouseUp);p.stage.off("mouseout",this,this.mouseUp);this.sendChangeEvent("changed");this.hideValueText()};t.mouseMove=function(t){var e=this._value;if(this.isVertical){this._bar.y+=(p.stage.mouseY-this._ty)/this._globalSacle.y;if(this._bar.y>this._maxMove)this._bar.y=this._maxMove;else if(this._bar.y<0)this._bar.y=0;this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min;if(this._progress)this._progress.height=this._bar.y+.5*this._bar.height}else{this._bar.x+=(p.stage.mouseX-this._tx)/this._globalSacle.x;if(this._bar.x>this._maxMove)this._bar.x=this._maxMove;else if(this._bar.x<0)this._bar.x=0;this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min;if(this._progress)this._progress.width=this._bar.x+.5*this._bar.width}this._tx=p.stage.mouseX;this._ty=p.stage.mouseY;var i=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*i)/i;if(this._value!=e){this.sendChangeEvent()}this.showValueText()};t.sendChangeEvent=function(t){t===void 0&&(t="change");this.event(t);this.changeHandler&&this.changeHandler.runWith(this._value)};t.setBarPoint=function(){if(this.isVertical)this._bar.x=Math.round((this._bg.width-this._bar.width)*.5);else this._bar.y=Math.round((this._bg.height-this._bar.height)*.5)};t.changeSize=function(){e.prototype.changeSize.call(this);if(this.isVertical)this._bg.height=this.height;else this._bg.width=this.width;this.setBarPoint();this.changeValue()};t.setSlider=function(t,e,i){this._value=-1;this._min=t;this._max=e>t?e:t;this.value=i<t?t:i>e?e:i};t.changeValue=function(){var t=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*t)/t;this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var e=this._max-this._min;if(e===0)e=1;if(this.isVertical){this._bar.y=(this._value-this._min)/e*(this.height-this._bar.height);if(this._progress)this._progress.height=this._bar.y+.5*this._bar.height}else{this._bar.x=(this._value-this._min)/e*(this.width-this._bar.width);if(this._progress)this._progress.width=this._bar.x+.5*this._bar.width}};t.onBgMouseDown=function(t){var e=this._bg.getMousePoint();if(this.isVertical)this.value=e.y/(this.height-this._bar.height)*(this._max-this._min)+this._min;else this.value=e.x/(this.width-this._bar.width)*(this._max-this._min)+this._min};r(0,t,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)});r(0,t,"skin",function(){return this._skin},function(t){if(this._skin!=t){this._skin=t;this._bg.skin=this._skin;this._bar.skin=this._skin.replace(".png","$bar.png");var e=this._skin.replace(".png","$progress.png");if(x.getRes(e)){if(!this._progress){this.addChild(this._progress=new G);this._progress.sizeGrid=this._bar.sizeGrid;this.setChildIndex(this._progress,1)}this._progress.skin=e}this.setBarPoint();this.callLater(this.changeValue)}});r(0,t,"allowClickBack",function(){return this._allowClickBack},function(t){if(this._allowClickBack!=t){this._allowClickBack=t;if(t)this._bg.on("mousedown",this,this.onBgMouseDown);else this._bg.off("mousedown",this,this.onBgMouseDown)}});r(0,t,"max",function(){return this._max},function(t){if(this._max!=t){this._max=t;this.callLater(this.changeValue)}});r(0,t,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)});r(0,t,"tick",function(){return this._tick},function(t){if(this._tick!=t){this._tick=t;this.callLater(this.changeValue)}});r(0,t,"sizeGrid",function(){return this._bg.sizeGrid},function(t){this._bg.sizeGrid=t;this._bar.sizeGrid=t;if(this._progress)this._progress.sizeGrid=this._bar.sizeGrid});r(0,t,"min",function(){return this._min},function(t){if(this._min!=t){this._min=t;this.callLater(this.changeValue)}});r(0,t,"value",function(){return this._value},function(t){if(this._value!=t){var e=this._value;this._value=t;this.changeValue();if(this._value!=e){this.sendChangeEvent()}}});r(0,t,"dataSource",e.prototype._$get_dataSource,function(t){this._dataSource=t;if(typeof t=="number"||typeof t=="string")this.value=Number(t);else p.superSet(F,this,"dataSource",t)});r(0,t,"bar",function(){return this._bar});s(i,["label",function(){return this.label=new $}]);return i}(F);var $=function(e){function i(t){this._tf=null;i.__super.call(this);t===void 0&&(t="");d.defaultColor=D.labelColor;this.text=t}a(i,"laya.ui.Label",e);var t=i.prototype;t.destroy=function(t){t===void 0&&(t=true);e.prototype.destroy.call(this,t);this._tf=null};t.createChildren=function(){this.addChild(this._tf=new A)};t.changeText=function(t){this._tf.changeText(t)};r(0,t,"padding",function(){return this._tf.padding.join(",")},function(t){this._tf.padding=R.fillArray(D.labelPadding,t,Number)});r(0,t,"bold",function(){return this._tf.bold},function(t){this._tf.bold=t});r(0,t,"align",function(){return this._tf.align},function(t){this._tf.align=t});r(0,t,"text",function(){return this._tf.text},function(t){if(this._tf.text!=t){if(t)t=R.adptString(t+"");this._tf.text=t;this.event("change");if(!this._width||!this._height)this.onCompResize()}});r(0,t,"italic",function(){return this._tf.italic},function(t){this._tf.italic=t});r(0,t,"wordWrap",function(){return this._tf.wordWrap},function(t){this._tf.wordWrap=t});r(0,t,"font",function(){return this._tf.font},function(t){this._tf.font=t});r(0,t,"dataSource",e.prototype._$get_dataSource,function(t){this._dataSource=t;if(typeof t=="number"||typeof t=="string")this.text=t+"";else p.superSet(F,this,"dataSource",t)});r(0,t,"color",function(){return this._tf.color},function(t){this._tf.color=t});r(0,t,"valign",function(){return this._tf.valign},function(t){this._tf.valign=t});r(0,t,"leading",function(){return this._tf.leading},function(t){this._tf.leading=t});r(0,t,"fontSize",function(){return this._tf.fontSize},function(t){this._tf.fontSize=t});r(0,t,"bgColor",function(){return this._tf.bgColor},function(t){this._tf.bgColor=t});r(0,t,"borderColor",function(){return this._tf.borderColor},function(t){this._tf.borderColor=t});r(0,t,"stroke",function(){return this._tf.stroke},function(t){this._tf.stroke=t});r(0,t,"strokeColor",function(){return this._tf.strokeColor},function(t){this._tf.strokeColor=t});r(0,t,"textField",function(){return this._tf});r(0,t,"measureWidth",function(){return this._tf.width});r(0,t,"measureHeight",function(){return this._tf.height});r(0,t,"width",function(){if(this._width||this._tf.text)return p.superGet(F,this,"width");return 0},function(t){p.superSet(F,this,"width",t);this._tf.width=t});r(0,t,"height",function(){if(this._height||this._tf.text)return p.superGet(F,this,"height");return 0},function(t){p.superSet(F,this,"height",t);this._tf.height=t});r(0,t,"overflow",function(){return this._tf.overflow},function(t){this._tf.overflow=t});r(0,t,"underline",function(){return this._tf.underline},function(t){this._tf.underline=t});r(0,t,"underlineColor",function(){return this._tf.underlineColor},function(t){this._tf.underlineColor=t});return i}(F);var K=function(e){function i(t){this.changeHandler=null;this.isTween=false;this.isTweenEnd=false;this._bg=null;this._bar=null;this._skin=null;this._value=.5;i.__super.call(this);this.skin=t}a(i,"laya.ui.ProgressBar",e);var t=i.prototype;t.destroy=function(t){t===void 0&&(t=true);e.prototype.destroy.call(this,t);this._bg&&this._bg.destroy(t);this._bar&&this._bar.destroy(t);this._bg=this._bar=null;this.changeHandler=null};t.createChildren=function(){this.addChild(this._bg=new G);this.addChild(this._bar=new G);this._bar._bitmap.autoCacheCmd=false};t.changeValue=function(){if(this.sizeGrid){var t=this.sizeGrid.split(",");var e=Number(t[3]);var i=Number(t[1]);var n=this.width-e-i;var r=n*this._value;var s=e+i+r;if(this.isTween&&s>this._bar.width){this.isTweenEnd=false;p.Tween.clearTween(this._bar);p.Tween.to(this._bar,{width:s},200,null,laya.utils.Handler.create(this,function(){this.isTweenEnd=true}))}else{this._bar.width=s}this._bar.visible=this._bar.width>e+i}else{this._bar.width=this.width*this._value}};r(0,t,"measureHeight",function(){return this._bg.height});r(0,t,"skin",function(){return this._skin},function(t){if(this._skin!=t){this._skin=t;this._bg.skin=this._skin;this._bar.skin=this._skin.replace(".png","$bar.png");this.callLater(this.changeValue)}});r(0,t,"measureWidth",function(){return this._bg.width});r(0,t,"height",e.prototype._$get_height,function(t){p.superSet(F,this,"height",t);this._bg.height=this._height;this._bar.height=this._height});r(0,t,"bar",function(){return this._bar});r(0,t,"value",function(){return this._value},function(t){if(this._value!=t){t=t>1?1:t<0?0:t;this._value=t;this.callLater(this.changeValue);this.event("change");this.changeHandler&&this.changeHandler.runWith(t)}});r(0,t,"bg",function(){return this._bg});r(0,t,"sizeGrid",function(){return this._bg.sizeGrid},function(t){this._bg.sizeGrid=this._bar.sizeGrid=t});r(0,t,"width",e.prototype._$get_width,function(t){p.superSet(F,this,"width",t);this._bg.width=this._width;this.callLater(this.changeValue)});r(0,t,"dataSource",e.prototype._$get_dataSource,function(t){this._dataSource=t;if(typeof t=="number"||typeof t=="string")this.value=Number(t);else p.superSet(F,this,"dataSource",t)});return i}(F);var q=function(t){function i(){this._tipBox=null;this._tipText=null;this._defaultTipHandler=null;i.__super.call(this);this._tipBox=new F;this._tipBox.addChild(this._tipText=new A);this._tipText.x=this._tipText.y=5;this._tipText.color=i.tipTextColor;this._defaultTipHandler=this._showDefaultTip;p.stage.on("showtip",this,this._onStageShowTip);p.stage.on("hidetip",this,this._onStageHideTip);this.zOrder=1100}a(i,"laya.ui.TipManager",t);var e=i.prototype;e._onStageHideTip=function(t){p.timer.clear(this,this._showTip);this.closeAll();this.removeSelf()};e._onStageShowTip=function(t){p.timer.once(i.tipDelay,this,this._showTip,[t],true)};e._showTip=function(t){if(typeof t=="string"){var e=String(t);if(Boolean(e)){this._defaultTipHandler(e)}}else if(t instanceof laya.utils.Handler){t.run()}else if(typeof t=="function"){t.apply()}if(true){p.stage.on("mousemove",this,this._onStageMouseMove);p.stage.on("mousedown",this,this._onStageMouseDown)}this._onStageMouseMove(null)};e._onStageMouseDown=function(t){this.closeAll()};e._onStageMouseMove=function(t){this._showToStage(this,i.offsetX,i.offsetY)};e._showToStage=function(t,e,i){e===void 0&&(e=0);i===void 0&&(i=0);var n=t.getBounds();t.x=p.stage.mouseX+e;t.y=p.stage.mouseY+i;if(t.x+n.width>p.stage.width){t.x-=n.width+e}if(t.y+n.height>p.stage.height){t.y-=n.height+i}};e.closeAll=function(){p.timer.clear(this,this._showTip);p.stage.off("mousemove",this,this._onStageMouseMove);p.stage.off("mousedown",this,this._onStageMouseDown);this.removeChildren()};e.showDislayTip=function(t){this.addChild(t);this._showToStage(this);p._currentStage.addChild(this)};e._showDefaultTip=function(t){this._tipText.text=t;var e=this._tipBox.graphics;e.clear();e.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,i.tipBackColor);this.addChild(this._tipBox);this._showToStage(this);p._currentStage.addChild(this)};r(0,e,"defaultTipHandler",function(){return this._defaultTipHandler},function(t){this._defaultTipHandler=t});i.offsetX=10;i.offsetY=15;i.tipTextColor="#ffffff";i.tipBackColor="#111111";i.tipDelay=200;return i}(F);var Z=function(e){function i(t){this.advsListArr=[];this.resUrl="https://unioncdn.layabox.com/config/iconlist.json";this._data=[];this._resquestTime=36e4;this._appid=null;this._appCodeImgStr=null;this._playIndex=0;this._lunboTime=5e3;i.__super.call(this);this._http=new l.window.XMLHttpRequest;this.skin=t;this.init();this.size(120,120)}a(i,"laya.ui.AdvImage",e);var t=i.prototype;t.init=function(){if(l.onMiniGame&&this.isSupportJump){p.timer.loop(this._resquestTime,this,this.onGetAdvsListData);this.onGetAdvsListData();this.initEvent()}else{this.visible=false}};t.initEvent=function(){this.on("click",this,this.onAdvsImgClick)};t.onAdvsImgClick=function(){var t=this.getCurrentAppidObj();if(t)this.jumptoGame()};t.revertAdvsData=function(){if(this.advsListArr[this._playIndex]){this.visible=true;this.skin=this.advsListArr[this._playIndex]}};t.jumptoGame=function(){var e=this;if(!l.onMiniGame)return;if(this.isSupportJump){wx.navigateToMiniProgram({appId:this._appid,path:"",extraData:"",envVersion:"release",success:function t(){console.log("-------------跳转成功--------------")},fail:function t(){console.log("-------------跳转失败--------------")},complete:function t(){console.log("-------------跳转接口调用成功--------------");e.updateAdvsInfo()}.bind(this)})}};t.updateAdvsInfo=function(){this.visible=false;this.onLunbo();p.timer.loop(this._lunboTime,this,this.onLunbo)};t.onLunbo=function(){if(this._playIndex>=this.advsListArr.length-1)this._playIndex=0;else this._playIndex+=1;this.visible=true;this.revertAdvsData()};t.getCurrentAppidObj=function(){return this.advsListArr[this._playIndex]};t.onGetAdvsListData=function(){var e=this;var t=this.randRange(1e4,1e6);var i=this.resUrl+"?"+t;this._http.open("get",i,true);this._http.setRequestHeader("Content-Type","application/x-www-form-urlencoded");this._http.responseType="text";this._http.onerror=function(t){e._onError(t)};this._http.onload=function(t){e._onLoad(t)};this._http.send(null)};t.randRange=function(t,e){return Math.floor(Math.random()*(e-t+1))+t};t._onError=function(t){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)};t._onLoad=function(t){var e=this._http;var i=e.status!==undefined?e.status:200;if(i===200||i===204||i===0){this.complete()}else{this.error("["+e.status+"]"+e.statusText+":"+e.responseURL)}};t.error=function(t){this.event("error",t)};t.complete=function(){var e=true;try{this._data=this._http.response||this._http.responseText;this._data=JSON.parse(this._data);this.advsListArr=this._data.list;this._appid=this._data.appid;this._appCodeImgStr=this._data.qrcode;this.updateAdvsInfo();this.revertAdvsData()}catch(t){e=false;this.error(t.message)}};t.clear=function(){var t=this._http;t.onerror=t.onabort=t.onprogress=t.onload=null};t.destroy=function(t){t===void 0&&(t=true);e.prototype.destroy.call(this,true);p.timer.clear(this,this.onLunbo);p.timer.clear(this,this.onGetAdvsListData);this.clear()};r(0,t,"isSupportJump",function(){if(l.onMiniGame){var t=typeof wx.navigateToMiniProgram=="function";return t}return false});return i}(G);var Q=function(t){var _;function d(){this._idMap=null;this._aniList=null;this._watchMap={};d.__super.call(this)}a(d,"laya.ui.View",t);var e=d.prototype;e.createView=function(t){if(t.animations&&!this._idMap)this._idMap={};d.createComp(t,this,this);if(t.animations){var e=[];var i=t.animations;var n=0,r=i.length;var s;var a;for(n=0;n<r;n++){s=new g;a=i[n];s._setUp(this._idMap,a);this[a.name]=s;s._setControlNode(this);switch(a.action){case 1:s.play(0,false);break;case 2:s.play(0,true);break}e.push(s)}this._aniList=e}if(this._width>0&&t.props.hitTestPrior==null&&!this.mouseThrough)this.hitTestPrior=true};e.onEvent=function(t,e){};e.loadUI=function(t){var e=d.uiMap[t];e&&this.createView(e)};e.destroy=function(t){t===void 0&&(t=true);if(this._aniList)this._aniList.length=0;this._idMap=null;this._aniList=null;this._watchMap=null;laya.ui.Component.prototype.destroy.call(this,t)};e.changeData=function(t){var e=this._watchMap[t];if(!e)return;console.log("change",t);for(var i=0,n=e.length;i<n;i++){var r=e[i];r.exe(this)}};d._regs=function(){for(var t in d.uiClassMap){v.regClass(t,d.uiClassMap[t])}};d.createComp=function(t,e,i,n){e=e||d.getCompInstance(t);if(!e){console.warn("can not create:"+t.type);return null}var r=t.child;if(r){var s=e instanceof laya.ui.List;for(var a=0,o=r.length;a<o;a++){var h=r[a];if(e.hasOwnProperty("itemRender")&&(h.props.name=="render"||h.props.renderType==="render")){e.itemRender=h}else if(h.type=="Graphic"){v.addGraphicsToSprite(h,e)}else if(v.isDrawType(h.type)){v.addGraphicToSprite(h,e,true)}else{if(s){var l=[];var u=d.createComp(h,null,i,l);if(l.length)u["_$bindData"]=l}else{u=d.createComp(h,null,i,n)}if(h.type=="Script"){if("owner"in u){u["owner"]=e}else if("target"in u){u["target"]=e}}else if(h.props.renderType=="mask"||h.props.name=="mask"){e.mask=u}else{u instanceof laya.display.Sprite&&e.addChild(u)}}}}var c=t.props;for(var f in c){var _=c[f];if(d.eventDic[f]){if(_&&i){e.on(f,i,i.onEvent,[_])}}else d.setCompValue(e,f,_,i,n)}if(p.__typeof(e,"laya.ui.IItem"))e.initItems();if(t.compId&&i&&i._idMap){i._idMap[t.compId]=e}return e};d.setCompValue=function(t,e,i,n,r){if(typeof i=="string"&&i.indexOf("${")>-1){d._sheet||(d._sheet=v.getClass("laya.data.Table"));if(!d._sheet){console.warn("Can not find class Sheet");return}if(r){r.push(t,e,i)}else if(n){if(i.indexOf("].")==-1){i=i.replace(".","[0].")}var s=new _(t,e,i);s.exe(n);var a,o;var h=i.replace(/\[.*?\]\./g,".");while((a=d._parseWatchData.exec(h))!=null){var l=a[1];while((o=d._parseKeyWord.exec(l))!=null){var u=o[0];var c=n._watchMap[u]||(n._watchMap[u]=[]);c.push(s);d._sheet.I.notifer.on(u,n,n.changeData,[u])}c=n._watchMap[l]||(n._watchMap[l]=[]);c.push(s);d._sheet.I.notifer.on(l,n,n.changeData,[l])}}return}if(e==="var"&&n){n[i]=t}else if(e=="onClick"){var f=p._runScript("(function(){"+i+"})");t.on("click",n,f)}else{t[e]=i==="true"?true:i==="false"?false:i}};d.getCompInstance=function(t){var e=t.props?t.props.runtime:null;var i;i=e?d.viewClassMap[e]||d.uiClassMap[e]||p["__classmap"][e]:d.uiClassMap[t.type];if(t.props&&t.props.hasOwnProperty("renderType")&&t.props["renderType"]=="instance")return i["instance"];return i?new i:null};d.regComponent=function(t,e){d.uiClassMap[t]=e;v.regClass(t,e)};d.regViewRuntime=function(t,e){d.viewClassMap[t]=e};d.uiMap={};d.viewClassMap={};d._sheet=null;s(d,["uiClassMap",function(){return this.uiClassMap={ViewStack:lt,LinkButton:W,TextArea:mt,ColorPicker:H,Box:V,Button:W,CheckBox:J,Clip:z,ComboBox:Y,Component:F,HScrollBar:nt,HSlider:at,Image:G,Label:$,List:it,Panel:rt,ProgressBar:K,Radio:st,RadioGroup:vt,ScrollBar:j,Slider:X,Tab:gt,TextInput:ct,View:d,VScrollBar:ut,VSlider:ft,Tree:ht,HBox:dt,VBox:pt,Sprite:E,Animation:h,Text:A,FontClip:et}},"eventDic",function(){return this.eventDic={mousedown:true,mouseup:true,mousemove:true,mouseover:true,mouseout:true,click:true,doubleclick:true,rightmousedown:true,rightmouseup:true,rightclick:true}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]);d.__init$=function(){d._regs();_=function(){function t(t,e,i){this.comp=null;this.prop=null;this.value=null;this.comp=t;this.prop=e;this.value=i}a(t,"");var e=t.prototype;e.exe=function(t){var e=R.getBindFun(this.value);this.comp[this.prop]=e.call(this,t)};return t}()};return d}(V);var J=function(t){function i(t,e){e===void 0&&(e="");i.__super.call(this,t,e)}a(i,"laya.ui.CheckBox",t);var e=i.prototype;e.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this);this.toggle=true;this._autoSize=false};e.initialize=function(){t.prototype.initialize.call(this);this.createText();this._text.align="left";this._text.valign="top";this._text.width=0};r(0,e,"dataSource",t.prototype._$get_dataSource,function(t){this._dataSource=t;if(typeof t=="boolean")this.selected=t;else if(typeof t=="string")this.selected=t==="true";else p.superSet(W,this,"dataSource",t)});return i}(W);var tt=function(t){function e(){this._space=0;this._align="none";this._itemChanged=false;e.__super.call(this)}a(e,"laya.ui.LayoutBox",t);var i=e.prototype;i.addChild=function(t){t.on("resize",this,this.onResize);this._setItemChanged();return laya.display.Node.prototype.addChild.call(this,t)};i.onResize=function(t){this._setItemChanged()};i.addChildAt=function(t,e){t.on("resize",this,this.onResize);this._setItemChanged();return laya.display.Node.prototype.addChildAt.call(this,t,e)};i.removeChildAt=function(t){this.getChildAt(t).off("resize",this,this.onResize);this._setItemChanged();return laya.display.Node.prototype.removeChildAt.call(this,t)};i.refresh=function(){this._setItemChanged()};i.changeItems=function(){this._itemChanged=false};i.sortItem=function(t){if(t)t.sort(function(t,e){return t.y-e.y})};i._setItemChanged=function(){if(!this._itemChanged){this._itemChanged=true;this.callLater(this.changeItems)}};r(0,i,"space",function(){return this._space},function(t){this._space=t;this._setItemChanged()});r(0,i,"align",function(){return this._align},function(t){this._align=t;this._setItemChanged()});return e}(V);var et=function(e){function i(t,e){this._valueArr=null;this._indexMap=null;this._sheet=null;this._direction="horizontal";this._spaceX=0;this._spaceY=0;this._align="left";this._wordsW=0;this._wordsH=0;i.__super.call(this);if(t)this.skin=t;if(e)this.sheet=e}a(i,"laya.ui.FontClip",e);var t=i.prototype;t.createChildren=function(){this._bitmap=new O;this.on("loaded",this,this._onClipLoaded)};t._onClipLoaded=function(){this.callLater(this.changeValue)};t.changeValue=function(){if(!this._sources)return;if(!this._valueArr)return;this.graphics.clear(true);var t;t=this._sources[0];if(!t)return;var e=this._direction==="horizontal";if(e){this._wordsW=this._valueArr.length*(t.sourceWidth+this.spaceX);this._wordsH=t.sourceHeight}else{this._wordsW=t.sourceWidth;this._wordsH=(t.sourceHeight+this.spaceY)*this._valueArr.length}var i=0;if(this._width){switch(this._align){case"center":i=.5*(this._width-this._wordsW);break;case"right":i=this._width-this._wordsW;break;default:i=0}}for(var n=0,r=this._valueArr.length;n<r;n++){var s=this._indexMap[this._valueArr.charAt(n)];if(!this.sources[s])continue;t=this.sources[s];if(e)this.graphics.drawTexture(t,i+n*(t.sourceWidth+this.spaceX),0,t.sourceWidth,t.sourceHeight);else this.graphics.drawTexture(t,0+i,n*(t.sourceHeight+this.spaceY),t.sourceWidth,t.sourceHeight)}if(!this._width){this.resetLayoutX();this.callLater(this.changeSize)}if(!this._height){this.resetLayoutY();this.callLater(this.changeSize)}};t.destroy=function(t){t===void 0&&(t=true);this._valueArr=null;this._indexMap=null;this.graphics.clear(true);this.removeSelf();this.off("loaded",this,this._onClipLoaded);e.prototype.destroy.call(this,t)};r(0,t,"sheet",function(){return this._sheet},function(t){t+="";this._sheet=t;var e=t.split(" ");this._clipX=String(e[0]).length;this.clipY=e.length;this._indexMap={};for(var i=0;i<this._clipY;i++){var n=e[i].split("");for(var r=0,s=n.length;r<s;r++){this._indexMap[n[r]]=i*this._clipX+r}}});r(0,t,"height",e.prototype._$get_height,function(t){p.superSet(z,this,"height",t);this.callLater(this.changeValue)});r(0,t,"direction",function(){return this._direction},function(t){this._direction=t;this.callLater(this.changeValue)});r(0,t,"value",function(){if(!this._valueArr)return"";return this._valueArr},function(t){t+="";this._valueArr=t;this.callLater(this.changeValue)});r(0,t,"width",e.prototype._$get_width,function(t){p.superSet(z,this,"width",t);this.callLater(this.changeValue)});r(0,t,"spaceX",function(){return this._spaceX},function(t){this._spaceX=t;if(this._direction==="horizontal")this.callLater(this.changeValue)});r(0,t,"spaceY",function(){return this._spaceY},function(t){this._spaceY=t;if(!(this._direction==="horizontal"))this.callLater(this.changeValue)});r(0,t,"align",function(){return this._align},function(t){this._align=t;this.callLater(this.changeValue)});r(0,t,"measureWidth",function(){return this._wordsW});r(0,t,"measureHeight",function(){return this._wordsH});return i}(z);var it=function(t){function e(){this.selectHandler=null;this.renderHandler=null;this.mouseHandler=null;this.selectEnable=false;this.totalPage=0;this._content=null;this._scrollBar=null;this._itemRender=null;this._repeatX=0;this._repeatY=0;this._repeatX2=0;this._repeatY2=0;this._spaceX=0;this._spaceY=0;this._array=null;this._startIndex=0;this._selectedIndex=-1;this._page=0;this._isVertical=true;this._cellSize=20;this._cellOffset=0;this._isMoved=false;this.cacheContent=false;this._createdLine=0;this._cellChanged=false;this._cells=[];this._offset=new T;e.__super.call(this)}a(e,"laya.ui.List",t);var i=e.prototype;p.imps(i,{"laya.ui.IRender":true,"laya.ui.IItem":true});i.destroy=function(t){t===void 0&&(t=true);this._content&&this._content.destroy(t);this._scrollBar&&this._scrollBar.destroy(t);laya.ui.Component.prototype.destroy.call(this,t);this._content=null;this._scrollBar=null;this._itemRender=null;this._cells=null;this._array=null;this.selectHandler=this.renderHandler=this.mouseHandler=null};i.createChildren=function(){this.addChild(this._content=new V)};i.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=p.superGet(V,this,"cacheAs"));p.superSet(V,this,"cacheAs","none");this._scrollBar.once("end",this,this.onScrollEnd)};i.onScrollEnd=function(){p.superSet(V,this,"cacheAs",this._$P.cacheAs)};i._removePreScrollBar=function(){var t=this.removeChildByName("scrollBar");if(t)t.destroy(true)};i.changeCells=function(){this._cellChanged=false;if(this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var t=this._getOneCell();var e=t.width+this._spaceX||1;var i=t.height+this._spaceY||1;if(this._width>0)this._repeatX2=this._isVertical?Math.round(this._width/e):Math.ceil(this._width/e);if(this._height>0)this._repeatY2=this._isVertical?Math.ceil(this._height/i):Math.round(this._height/i);var n=this._width?this._width:e*this.repeatX-this._spaceX;var r=this._height?this._height:i*this.repeatY-this._spaceY;this._cellSize=this._isVertical?i:e;this._cellOffset=this._isVertical?i*Math.max(this._repeatY2,this._repeatY)-r-this._spaceY:e*Math.max(this._repeatX2,this._repeatX)-n-this._spaceX;if(this._isVertical&&this._scrollBar)this._scrollBar.height=r;else if(!this._isVertical&&this._scrollBar)this._scrollBar.width=n;this.setContentSize(n,r);var s=this._isVertical?this.repeatX:this.repeatY;var a=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,s,a);this._createdLine=a;if(this._array){this.array=this._array;this.runCallLater(this.renderItems)}}};i._getOneCell=function(){if(this._cells.length===0){var t=this.createItem();this._offset.setTo(t.x,t.y);if(this.cacheContent)return t;this._cells.push(t)}return this._cells[0]};i._createItems=function(t,e,i){var n=this._content;var r=this._getOneCell();var s=r.width+this._spaceX;var a=r.height+this._spaceY;if(this.cacheContent){var o=new V;o.cacheAsBitmap=true;o.pos((this._isVertical?0:t)*s,(this._isVertical?t:0)*a);this._content.addChild(o);this._content.optimizeScrollRect=true;n=o}else{var h=[];for(var l=this._cells.length-1;l>-1;l--){var u=this._cells[l];u.removeSelf();h.push(u)}this._cells.length=0}for(var c=t;c<i;c++){for(var f=0;f<e;f++){if(h&&h.length){r=h.pop()}else{r=this.createItem()}r.x=(this._isVertical?f:c)*s-n.x;r.y=(this._isVertical?c:f)*a-n.y;r.name="item"+(c*e+f);n.addChild(r);this.addCell(r)}}};i.createItem=function(){var t=[];if(typeof this._itemRender=="function"){var e=new this._itemRender}else{e=Q.createComp(this._itemRender,null,null,t)}if(t.length==0&&e._watchMap){var i=e._watchMap;for(var n in i){var r=i[n];for(var s=0;s<r.length;s++){var a=r[s];t.push(a.comp,a.prop,a.value)}}}if(t.length)e["_$bindData"]=t;return e};i.addCell=function(t){t.on("click",this,this.onCellMouse);t.on("rightclick",this,this.onCellMouse);t.on("mouseover",this,this.onCellMouse);t.on("mouseout",this,this.onCellMouse);t.on("mousedown",this,this.onCellMouse);t.on("mouseup",this,this.onCellMouse);this._cells.push(t)};i.initItems=function(){if(!this._itemRender&&this.getChildByName("item0")!=null){this.repeatX=1;var t=0;t=0;for(var e=0;e<1e4;e++){var i=this.getChildByName("item"+e);if(i){this.addCell(i);t++;continue}break}this.repeatY=t}};i.setContentSize=function(t,e){this._content.width=t;this._content.height=e;if(this._scrollBar||this._offset.x!=0||this._offset.y!=0){this._content.scrollRect||(this._content.scrollRect=new S);this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,t,e);this._content.scrollRect=this._content.scrollRect}this.event("resize")};i.onCellMouse=function(t){if(t.type==="mousedown")this._isMoved=false;var e=t.currentTarget;var i=this._startIndex+this._cells.indexOf(e);if(i<0)return;if(t.type==="click"||t.type==="rightclick"){if(this.selectEnable&&!this._isMoved)this.selectedIndex=i;else this.changeCellState(e,true,0)}else if((t.type==="mouseover"||t.type==="mouseout")&&this._selectedIndex!==i){this.changeCellState(e,t.type==="mouseover",0)}this.mouseHandler&&this.mouseHandler.runWith([t,i])};i.changeCellState=function(t,e,i){var n=t.getChildByName("selectBox");if(n){this.selectEnable=true;n.visible=n.clipY==3?true:e;n.index=e?n.clipY==3?i+1:i:0}};i.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this);this.setContentSize(this.width,this.height);if(this._scrollBar)this.callLater(this.onScrollBarChange)};i.onScrollBarChange=function(t){this.runCallLater(this.changeCells);var e=this._scrollBar.value;var i=this._isVertical?this.repeatX:this.repeatY;var n=this._isVertical?this.repeatY:this.repeatX;var r=Math.floor(e/this._cellSize);if(!this.cacheContent){var s=r*i;var a=0;if(s>this._startIndex){a=s-this._startIndex;var o=true;var h=this._startIndex+i*(n+1);this._isMoved=true}else if(s<this._startIndex){a=this._startIndex-s;o=false;h=this._startIndex-1;this._isMoved=true}for(var l=0;l<a;l++){if(o){var u=this._cells.shift();this._cells[this._cells.length]=u;var c=h+l}else{u=this._cells.pop();this._cells.unshift(u);c=h-l}var f=Math.floor(c/i)*this._cellSize;this._isVertical?u.y=f:u.x=f;this.renderItem(u,c)}this._startIndex=s;this.changeSelectStatus()}else{a=n+1;if(this._createdLine-r<a){this._createItems(this._createdLine,i,this._createdLine+a);this.renderItems(this._createdLine*i,0);this._createdLine+=a}}var _=this._content.scrollRect;if(this._isVertical){_.y=e-this._offset.y;_.x=-this._offset.x}else{_.y=-this._offset.y;_.x=e-this._offset.x}this._content.scrollRect=_};i.posCell=function(t,e){if(!this._scrollBar)return;var i=this._isVertical?this.repeatX:this.repeatY;var n=this._isVertical?this.repeatY:this.repeatX;var r=Math.floor(e/i)*this._cellSize;this._isVertical?t.y=r:t.x=r};i.changeSelectStatus=function(){for(var t=0,e=this._cells.length;t<e;t++){this.changeCellState(this._cells[t],this._selectedIndex===this._startIndex+t,1)}};i.renderItems=function(t,e){t===void 0&&(t=0);e===void 0&&(e=0);for(var i=t,n=e||this._cells.length;i<n;i++){this.renderItem(this._cells[i],this._startIndex+i)}this.changeSelectStatus()};i.renderItem=function(t,e){if(this._array&&e>=0&&e<this._array.length){t.visible=true;if(t._$bindData){t._dataSource=this._array[e];this._bindData(t,this._array[e])}else t.dataSource=this._array[e];if(!this.cacheContent){this.posCell(t,e)}if(this.hasListener("render"))this.event("render",[t,e]);if(this.renderHandler)this.renderHandler.runWith([t,e])}else{t.visible=false;t.dataSource=null}};i._bindData=function(t,e){var i=t._$bindData;for(var n=0,r=i.length;n<r;n++){var s=i[n++];var a=i[n++];var o=i[n];var h=R.getBindFun(o);s[a]=h.call(this,e)}};i.refresh=function(){this.array=this._array};i.getItem=function(t){if(t>-1&&t<this._array.length){return this._array[t]}return null};i.changeItem=function(t,e){if(t>-1&&t<this._array.length){this._array[t]=e;if(t>=this._startIndex&&t<this._startIndex+this._cells.length){this.renderItem(this.getCell(t),t)}}};i.setItem=function(t,e){this.changeItem(t,e)};i.addItem=function(t){this._array.push(t);this.array=this._array};i.addItemAt=function(t,e){this._array.splice(e,0,t);this.array=this._array};i.deleteItem=function(t){this._array.splice(t,1);this.array=this._array};i.getCell=function(t){this.runCallLater(this.changeCells);if(t>-1&&this._cells){return this._cells[(t-this._startIndex)%this._cells.length]}return null};i.scrollTo=function(t){if(this._scrollBar){var e=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(t/e)*this._cellSize}else{this.startIndex=t}};i.tweenTo=function(t,e,i){e===void 0&&(e=200);if(this._scrollBar){var n=this._isVertical?this.repeatX:this.repeatY;I.to(this._scrollBar,{value:Math.floor(t/n)*this._cellSize},e,null,i,0,true)}else{this.startIndex=t;if(i)i.run()}};i._setCellChanged=function(){if(!this._cellChanged){this._cellChanged=true;this.callLater(this.changeCells)}};i.commitMeasure=function(){this.runCallLater(this.changeCells)};r(0,i,"cacheAs",t.prototype._$get_cacheAs,function(t){p.superSet(V,this,"cacheAs",t);if(this._scrollBar){this._$P.cacheAs=null;if(t!=="none")this._scrollBar.on("start",this,this.onScrollStart);else this._scrollBar.off("start",this,this.onScrollStart)}});r(0,i,"content",function(){return this._content});r(0,i,"height",t.prototype._$get_height,function(t){if(t!=this._height){p.superSet(V,this,"height",t);this._setCellChanged()}});r(0,i,"itemRender",function(){return this._itemRender},function(t){if(this._itemRender!=t){this._itemRender=t;for(var e=this._cells.length-1;e>-1;e--){this._cells[e].destroy()}this._cells.length=0;this._setCellChanged()}});r(0,i,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(t){this._removePreScrollBar();var e=new ut;e.name="scrollBar";e.right=0;if(t&&t!=" ")e.skin=t;this.scrollBar=e;this.addChild(e);this._setCellChanged()});r(0,i,"page",function(){return this._page},function(t){this._page=t;if(this._array){this._page=t>0?t:0;this._page=this._page<this.totalPage?this._page:this.totalPage-1;this.startIndex=this._page*this.repeatX*this.repeatY}});r(0,i,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(t){this._removePreScrollBar();var e=new nt;e.name="scrollBar";e.bottom=0;if(t&&t!=" ")e.skin=t;this.scrollBar=e;this.addChild(e);this._setCellChanged()});r(0,i,"repeatX",function(){return this._repeatX>0?this._repeatX:this._repeatX2>0?this._repeatX2:1},function(t){this._repeatX=t;this._setCellChanged()});r(0,i,"scrollBar",function(){return this._scrollBar},function(t){if(this._scrollBar!=t){this._scrollBar=t;if(t){this._isVertical=this._scrollBar.isVertical;this.addChild(this._scrollBar);this._scrollBar.on("change",this,this.onScrollBarChange)}}});r(0,i,"width",t.prototype._$get_width,function(t){if(t!=this._width){p.superSet(V,this,"width",t);this._setCellChanged()}});r(0,i,"repeatY",function(){return this._repeatY>0?this._repeatY:this._repeatY2>0?this._repeatY2:1},function(t){this._repeatY=t;this._setCellChanged()});r(0,i,"spaceX",function(){return this._spaceX},function(t){this._spaceX=t;this._setCellChanged()});r(0,i,"spaceY",function(){return this._spaceY},function(t){this._spaceY=t;this._setCellChanged()});r(0,i,"selectedIndex",function(){return this._selectedIndex},function(t){if(this._selectedIndex!=t){this._selectedIndex=t;this.changeSelectStatus();this.event("change");this.selectHandler&&this.selectHandler.runWith(t);this.startIndex=this._startIndex}});r(0,i,"selectedItem",function(){return this._selectedIndex!=-1?this._array[this._selectedIndex]:null},function(t){this.selectedIndex=this._array.indexOf(t)});r(0,i,"length",function(){return this._array?this._array.length:0});r(0,i,"selection",function(){return this.getCell(this._selectedIndex)},function(t){this.selectedIndex=this._startIndex+this._cells.indexOf(t)});r(0,i,"startIndex",function(){return this._startIndex},function(t){this._startIndex=t>0?t:0;this.callLater(this.renderItems)});r(0,i,"array",function(){return this._array},function(t){this.runCallLater(this.changeCells);this._array=t||[];var e=this._array.length;this.totalPage=Math.ceil(e/(this.repeatX*this.repeatY));this._selectedIndex=this._selectedIndex<e?this._selectedIndex:e-1;this.startIndex=this._startIndex;if(this._scrollBar){this._scrollBar.stopScroll();var i=this._isVertical?this.repeatX:this.repeatY;var n=this._isVertical?this.repeatY:this.repeatX;var r=Math.ceil(e/i);var s=this._cellOffset>0?this.totalPage+1:this.totalPage;if(s>1){this._scrollBar.scrollSize=this._cellSize;this._scrollBar.thumbPercent=n/r;this._scrollBar.setScroll(0,(r-n)*this._cellSize+this._cellOffset,this._scrollBar.value);this._scrollBar.target=this._content}else{this._scrollBar.setScroll(0,0,0);this._scrollBar.target=this._content}}});r(0,i,"dataSource",t.prototype._$get_dataSource,function(t){this._dataSource=t;if(typeof t=="number"&&Math.floor(t)==t||typeof t=="string")this.selectedIndex=parseInt(t);else if(t instanceof Array)this.array=t;else p.superSet(V,this,"dataSource",t)});r(0,i,"cells",function(){this.runCallLater(this.changeCells);return this._cells});return e}(V);var nt=function(t){function e(){e.__super.call(this)}a(e,"laya.ui.HScrollBar",t);var i=e.prototype;i.initialize=function(){t.prototype.initialize.call(this);this.slider.isVertical=false};return e}(j);var rt=function(t){function e(){this._content=null;this._vScrollBar=null;this._hScrollBar=null;this._scrollChanged=false;e.__super.call(this);this.width=this.height=100}a(e,"laya.ui.Panel",t);var i=e.prototype;i.destroy=function(t){t===void 0&&(t=true);laya.ui.Component.prototype.destroy.call(this,t);this._content&&this._content.destroy(t);this._vScrollBar&&this._vScrollBar.destroy(t);this._hScrollBar&&this._hScrollBar.destroy(t);this._vScrollBar=null;this._hScrollBar=null;this._content=null};i.destroyChildren=function(){this._content.destroyChildren()};i.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new V)};i.addChild=function(t){t.on("resize",this,this.onResize);this._setScrollChanged();return this._content.addChild(t)};i.onResize=function(){this._setScrollChanged()};i.addChildAt=function(t,e){t.on("resize",this,this.onResize);this._setScrollChanged();return this._content.addChildAt(t,e)};i.removeChild=function(t){t.off("resize",this,this.onResize);this._setScrollChanged();return this._content.removeChild(t)};i.removeChildAt=function(t){this.getChildAt(t).off("resize",this,this.onResize);this._setScrollChanged();return this._content.removeChildAt(t)};i.removeChildren=function(t,e){t===void 0&&(t=0);e===void 0&&(e=2147483647);this._content.removeChildren(t,e);this._setScrollChanged();return this};i.getChildAt=function(t){return this._content.getChildAt(t)};i.getChildByName=function(t){return this._content.getChildByName(t)};i.getChildIndex=function(t){return this._content.getChildIndex(t)};i.changeScroll=function(){this._scrollChanged=false;var t=this.contentWidth||1;var e=this.contentHeight||1;var i=this._vScrollBar;var n=this._hScrollBar;var r=i&&e>this._height;var s=n&&t>this._width;var a=r?this._width-i.width:this._width;var o=s?this._height-n.height:this._height;if(i){i.x=this._width-i.width;i.y=0;i.height=this._height-(s?n.height:0);i.scrollSize=Math.max(this._height*.033,1);i.thumbPercent=o/e;i.setScroll(0,e-o,i.value)}if(n){n.x=0;n.y=this._height-n.height;n.width=this._width-(r?i.width:0);n.scrollSize=Math.max(this._width*.033,1);n.thumbPercent=a/t;n.setScroll(0,t-a,n.value)}};i.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this);this.setContentSize(this._width,this._height)};i.setContentSize=function(t,e){var i=this._content;i.width=t;i.height=e;i.scrollRect||(i.scrollRect=new S);i.scrollRect.setTo(0,0,t,e);i.scrollRect=i.scrollRect};i.onScrollBarChange=function(t){var e=this._content.scrollRect;if(e){var i=Math.round(t.value);t.isVertical?e.y=i:e.x=i;this._content.scrollRect=e}};i.scrollTo=function(t,e){t===void 0&&(t=0);e===void 0&&(e=0);if(this.vScrollBar)this.vScrollBar.value=e;if(this.hScrollBar)this.hScrollBar.value=t};i.refresh=function(){this.changeScroll()};i.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=p.superGet(V,this,"cacheAs"));p.superSet(V,this,"cacheAs","none");this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd);this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)};i.onScrollEnd=function(){p.superSet(V,this,"cacheAs",this._$P.cacheAs)};i._setScrollChanged=function(){if(!this._scrollChanged){this._scrollChanged=true;this.callLater(this.changeScroll)}};r(0,i,"numChildren",function(){return this._content.numChildren});r(0,i,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(t){if(this._hScrollBar==null){laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new nt);this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]);this._hScrollBar.target=this._content;this._setScrollChanged()}this._hScrollBar.skin=t});r(0,i,"contentWidth",function(){var t=0;for(var e=this._content.numChildren-1;e>-1;e--){var i=this._content.getChildAt(e);t=Math.max(i.x+i.width*i.scaleX,t)}return t});r(0,i,"contentHeight",function(){var t=0;for(var e=this._content.numChildren-1;e>-1;e--){var i=this._content.getChildAt(e);t=Math.max(i.y+i.height*i.scaleY,t)}return t});r(0,i,"width",t.prototype._$get_width,function(t){p.superSet(V,this,"width",t);this._setScrollChanged()});r(0,i,"hScrollBar",function(){return this._hScrollBar});r(0,i,"content",function(){return this._content});r(0,i,"height",t.prototype._$get_height,function(t){p.superSet(V,this,"height",t);this._setScrollChanged()});r(0,i,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(t){if(this._vScrollBar==null){laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new ut);this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]);this._vScrollBar.target=this._content;this._setScrollChanged()}this._vScrollBar.skin=t});r(0,i,"vScrollBar",function(){return this._vScrollBar});r(0,i,"cacheAs",t.prototype._$get_cacheAs,function(t){p.superSet(V,this,"cacheAs",t);this._$P.cacheAs=null;if(t!=="none"){this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart);this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)}else{this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart);this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart)}});return e}(V);var st=function(e){function i(t,e){this._value=null;e===void 0&&(e="");i.__super.call(this,t,e)}a(i,"laya.ui.Radio",e);var t=i.prototype;t.destroy=function(t){t===void 0&&(t=true);e.prototype.destroy.call(this,t);this._value=null};t.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this);this.toggle=false;this._autoSize=false};t.initialize=function(){e.prototype.initialize.call(this);this.createText();this._text.align="left";this._text.valign="top";this._text.width=0;this.on("click",this,this.onClick)};t.onClick=function(t){this.selected=true};r(0,t,"value",function(){return this._value!=null?this._value:this.label},function(t){this._value=t});return i}(W);var at=function(t){function e(t){e.__super.call(this,t);this.isVertical=false}a(e,"laya.ui.HSlider",t);return e}(X);var ot=function(t){function i(t,e){this.selectHandler=null;this._items=null;this._selectedIndex=-1;this._skin=null;this._direction="horizontal";this._space=0;this._labels=null;this._labelColors=null;this._labelFont=null;this._labelStrokeColor=null;this._strokeColors=null;this._labelStroke=NaN;this._labelSize=0;this._labelBold=false;this._labelPadding=null;this._labelAlign=null;this._stateNum=0;this._labelChanged=false;i.__super.call(this);this.skin=e;this.labels=t}a(i,"laya.ui.UIGroup",t);var e=i.prototype;p.imps(e,{"laya.ui.IItem":true});e.preinitialize=function(){this.mouseEnabled=true};e.destroy=function(t){t===void 0&&(t=true);laya.ui.Component.prototype.destroy.call(this,t);this._items&&(this._items.length=0);this._items=null;this.selectHandler=null};e.addItem=function(t,e){e===void 0&&(e=true);var i=t;var n=this._items.length;i.name="item"+n;this.addChild(i);this.initItems();if(e&&n>0){var r=this._items[n-1];if(this._direction=="horizontal"){i.x=r.x+r.width+this._space}else{i.y=r.y+r.height+this._space}}else{if(e){i.x=0;i.y=0}}return n};e.delItem=function(t,e){e===void 0&&(e=true);var i=this._items.indexOf(t);if(i!=-1){var n=t;this.removeChild(n);for(var r=i+1,s=this._items.length;r<s;r++){var a=this._items[r];a.name="item"+(r-1);if(e){if(this._direction=="horizontal"){a.x-=n.width+this._space}else{a.y-=n.height+this._space}}}this.initItems();if(this._selectedIndex>-1){var o=0;o=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1;this._selectedIndex=-1;this.selectedIndex=o}}};e.initItems=function(){this._items||(this._items=[]);this._items.length=0;for(var t=0;t<1e4;t++){var e=this.getChildByName("item"+t);if(e==null)break;this._items.push(e);e.selected=t===this._selectedIndex;e.clickHandler=y.create(this,this.itemClick,[t],false)}};e.itemClick=function(t){this.selectedIndex=t};e.setSelect=function(t,e){if(this._items&&t>-1&&t<this._items.length)this._items[t].selected=e};e.createItem=function(t,e){return null};e.changeLabels=function(){this._labelChanged=false;if(this._items){var t=0;for(var e=0,i=this._items.length;e<i;e++){var n=this._items[e];this._skin&&(n.skin=this._skin);this._labelColors&&(n.labelColors=this._labelColors);this._labelSize&&(n.labelSize=this._labelSize);this._labelStroke&&(n.labelStroke=this._labelStroke);this._labelStrokeColor&&(n.labelStrokeColor=this._labelStrokeColor);this._strokeColors&&(n.strokeColors=this._strokeColors);this._labelBold&&(n.labelBold=this._labelBold);this._labelPadding&&(n.labelPadding=this._labelPadding);this._labelAlign&&(n.labelAlign=this._labelAlign);this._stateNum&&(n.stateNum=this._stateNum);this._labelFont&&(n.labelFont=this._labelFont);if(this._direction==="horizontal"){n.y=0;n.x=t;t+=n.width+this._space}else{n.x=0;n.y=t;t+=n.height+this._space}}}this.changeSize()};e.commitMeasure=function(){this.runCallLater(this.changeLabels)};e._setLabelChanged=function(){if(!this._labelChanged){this._labelChanged=true;this.callLater(this.changeLabels)}};r(0,e,"labelStrokeColor",function(){return this._labelStrokeColor},function(t){if(this._labelStrokeColor!=t){this._labelStrokeColor=t;this._setLabelChanged()}});r(0,e,"skin",function(){return this._skin},function(t){if(this._skin!=t){this._skin=t;this._setLabelChanged()}});r(0,e,"selectedIndex",function(){return this._selectedIndex},function(t){if(this._selectedIndex!=t){this.setSelect(this._selectedIndex,false);this._selectedIndex=t;this.setSelect(t,true);this.event("change");this.selectHandler&&this.selectHandler.runWith(this._selectedIndex)}});r(0,e,"labels",function(){return this._labels},function(t){if(this._labels!=t){this._labels=t;this.removeChildren();this._setLabelChanged();if(this._labels){var e=this._labels.split(",");for(var i=0,n=e.length;i<n;i++){var r=this.createItem(this._skin,e[i]);r.name="item"+i;this.addChild(r)}}this.initItems()}});r(0,e,"strokeColors",function(){return this._strokeColors},function(t){if(this._strokeColors!=t){this._strokeColors=t;this._setLabelChanged()}});r(0,e,"labelColors",function(){return this._labelColors},function(t){if(this._labelColors!=t){this._labelColors=t;this._setLabelChanged()}});r(0,e,"labelStroke",function(){return this._labelStroke},function(t){if(this._labelStroke!=t){this._labelStroke=t;this._setLabelChanged()}});r(0,e,"labelSize",function(){return this._labelSize},function(t){if(this._labelSize!=t){this._labelSize=t;this._setLabelChanged()}});r(0,e,"stateNum",function(){return this._stateNum},function(t){if(this._stateNum!=t){this._stateNum=t;this._setLabelChanged()}});r(0,e,"labelBold",function(){return this._labelBold},function(t){if(this._labelBold!=t){this._labelBold=t;this._setLabelChanged()}});r(0,e,"labelFont",function(){return this._labelFont},function(t){if(this._labelFont!=t){this._labelFont=t;this._setLabelChanged()}});r(0,e,"labelPadding",function(){return this._labelPadding},function(t){if(this._labelPadding!=t){this._labelPadding=t;this._setLabelChanged()}});r(0,e,"direction",function(){return this._direction},function(t){this._direction=t;this._setLabelChanged()});r(0,e,"space",function(){return this._space},function(t){this._space=t;this._setLabelChanged()});r(0,e,"items",function(){return this._items});r(0,e,"selection",function(){return this._selectedIndex>-1&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(t){this.selectedIndex=this._items.indexOf(t)});r(0,e,"dataSource",t.prototype._$get_dataSource,function(t){this._dataSource=t;if(typeof t=="number"&&Math.floor(t)==t||typeof t=="string")this.selectedIndex=parseInt(t);else if(t instanceof Array)this.labels=t.join(",");else p.superSet(V,this,"dataSource",t)});return i}(V);var ht=function(t){function e(){this._list=null;this._source=null;this._renderHandler=null;this._spaceLeft=10;this._spaceBottom=0;this._keepStatus=true;e.__super.call(this);this.width=this.height=200}a(e,"laya.ui.Tree",t);var i=e.prototype;p.imps(i,{"laya.ui.IRender":true});i.destroy=function(t){t===void 0&&(t=true);laya.ui.Component.prototype.destroy.call(this,t);this._list&&this._list.destroy(t);this._list=null;this._source=null;this._renderHandler=null};i.createChildren=function(){this.addChild(this._list=new it);this._list.renderHandler=y.create(this,this.renderItem,null,false);this._list.repeatX=1;this._list.on("change",this,this.onListChange)};i.onListChange=function(t){this.event("change")};i.getArray=function(){var t=[];var e;for(var i in this._source){e=this._source[i];if(this.getParentOpenStatus(e)){e.x=this._spaceLeft*this.getDepth(e);t.push(e)}}return t};i.getDepth=function(t,e){e===void 0&&(e=0);if(t.nodeParent==null)return e;else return this.getDepth(t.nodeParent,e+1)};i.getParentOpenStatus=function(t){var e=t.nodeParent;if(e==null){return true}else{if(e.isOpen){if(e.nodeParent!=null)return this.getParentOpenStatus(e);else return true}else{return false}}};i.renderItem=function(t,e){var i=t.dataSource;if(i){t.left=i.x;var n=t.getChildByName("arrow");if(n){if(i.hasChild){n.visible=true;n.index=i.isOpen?1:0;n.tag=e;n.off("click",this,this.onArrowClick);n.on("click",this,this.onArrowClick)}else{n.visible=false}}var r=t.getChildByName("folder");if(r){if(r.clipY==2){r.index=i.isDirectory?0:1}else{r.index=i.isDirectory?i.isOpen?1:0:2}}this._renderHandler&&this._renderHandler.runWith([t,e])}};i.onArrowClick=function(t){var e=t.currentTarget;var i=e.tag;this._list.array[i].isOpen=!this._list.array[i].isOpen;this.event("open");this._list.array=this.getArray()};i.setItemState=function(t,e){if(!this._list.array[t])return;this._list.array[t].isOpen=e;this._list.array=this.getArray()};i.fresh=function(){this._list.array=this.getArray();this.repaint()};i.parseXml=function(t,e,i,n){var r;var s=t.childNodes;var a=s.length;if(!n){r={};var o=t.attributes;var h;for(var l in o){h=o[l];var u=h.nodeName;var c=h.nodeValue;r[u]=c=="true"?true:c=="false"?false:c}r.nodeParent=i;if(a>0)r.isDirectory=true;r.hasChild=a>0;e.push(r)}for(var f=0;f<a;f++){var _=s[f];this.parseXml(_,e,r,false)}};i.parseOpenStatus=function(t,e){for(var i=0,n=e.length;i<n;i++){var r=e[i];if(r.isDirectory){for(var s=0,a=t.length;s<a;s++){var o=t[s];if(o.isDirectory&&this.isSameParent(o,r)&&r.label==o.label){r.isOpen=o.isOpen;break}}}}};i.isSameParent=function(t,e){if(t.nodeParent==null&&e.nodeParent==null)return true;else if(t.nodeParent==null||e.nodeParent==null)return false;else{if(t.nodeParent.label==e.nodeParent.label)return this.isSameParent(t.nodeParent,e.nodeParent);else return false}};i.filter=function(t){if(Boolean(t)){var e=[];this.getFilterSource(this._source,e,t);this._list.array=e}else{this._list.array=this.getArray()}};i.getFilterSource=function(t,e,i){i=i.toLocaleLowerCase();var n;for(var r in t){n=t[r];if(!n.isDirectory&&String(n.label).toLowerCase().indexOf(i)>-1){n.x=0;e.push(n)}if(n.child&&n.child.length>0){this.getFilterSource(n.child,e,i)}}};r(0,i,"spaceBottom",function(){return this._list.spaceY},function(t){this._list.spaceY=t});r(0,i,"keepStatus",function(){return this._keepStatus},function(t){this._keepStatus=t});r(0,i,"itemRender",function(){return this._list.itemRender},function(t){this._list.itemRender=t});r(0,i,"array",function(){return this._list.array},function(t){if(this._keepStatus&&this._list.array&&t){this.parseOpenStatus(this._list.array,t)}this._source=t;this._list.array=this.getArray()});r(0,i,"mouseHandler",function(){return this._list.mouseHandler},function(t){this._list.mouseHandler=t});r(0,i,"dataSource",t.prototype._$get_dataSource,function(t){this._dataSource=t;p.superSet(V,this,"dataSource",t)});r(0,i,"source",function(){return this._source});r(0,i,"scrollBar",function(){return this._list.scrollBar});r(0,i,"list",function(){return this._list});r(0,i,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(t){this._list.vScrollBarSkin=t});r(0,i,"renderHandler",function(){return this._renderHandler},function(t){this._renderHandler=t});r(0,i,"selectedIndex",function(){return this._list.selectedIndex},function(t){this._list.selectedIndex=t});r(0,i,"spaceLeft",function(){return this._spaceLeft},function(t){this._spaceLeft=t});r(0,i,"selectedItem",function(){return this._list.selectedItem},function(t){this._list.selectedItem=t});r(0,i,"width",t.prototype._$get_width,function(t){p.superSet(V,this,"width",t);this._list.width=t});r(0,i,"height",t.prototype._$get_height,function(t){p.superSet(V,this,"height",t);this._list.height=t});r(0,i,"xml",null,function(t){var e=[];this.parseXml(t.childNodes[0],e,null,true);this.array=e});r(0,i,"selectedPath",function(){if(this._list.selectedItem){return this._list.selectedItem.path}return null});return e}(V);var lt=function(t){function e(){this._items=null;this._selectedIndex=0;e.__super.call(this);this._setIndexHandler=y.create(this,this.setIndex,null,false)}a(e,"laya.ui.ViewStack",t);var i=e.prototype;p.imps(i,{"laya.ui.IItem":true});i.setItems=function(t){this.removeChildren();var e=0;for(var i=0,n=t.length;i<n;i++){var r=t[i];if(r){r.name="item"+e;this.addChild(r);e++}}this.initItems()};i.addItem=function(t){t.name="item"+this._items.length;this.addChild(t);this.initItems()};i.initItems=function(){this._items=[];for(var t=0;t<1e4;t++){var e=this.getChildByName("item"+t);if(e==null){break}this._items.push(e);e.visible=t==this._selectedIndex}};i.setSelect=function(t,e){if(this._items&&t>-1&&t<this._items.length){this._items[t].visible=e}};i.setIndex=function(t){this.selectedIndex=t};r(0,i,"dataSource",t.prototype._$get_dataSource,function(t){this._dataSource=t;if(typeof t=="number"&&Math.floor(t)==t||typeof t=="string"){this.selectedIndex=parseInt(t)}else{for(var e in this._dataSource){if(this.hasOwnProperty(e)){this[e]=this._dataSource[e]}}}});r(0,i,"selectedIndex",function(){return this._selectedIndex},function(t){if(this._selectedIndex!=t){this.setSelect(this._selectedIndex,false);this._selectedIndex=t;this.setSelect(this._selectedIndex,true)}});r(0,i,"selection",function(){return this._selectedIndex>-1&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(t){this.selectedIndex=this._items.indexOf(t)});r(0,i,"items",function(){return this._items});r(0,i,"setIndexHandler",function(){return this._setIndexHandler},function(t){this._setIndexHandler=t});return e}(V);var ut=function(t){function e(){e.__super.call(this)}a(e,"laya.ui.VScrollBar",t);return e}(j);var ct=function(e){function i(t){this._bg=null;this._skin=null;i.__super.call(this);t===void 0&&(t="");this.text=t;this.skin=this.skin}a(i,"laya.ui.TextInput",e);var t=i.prototype;t.preinitialize=function(){this.mouseEnabled=true};t.destroy=function(t){t===void 0&&(t=true);e.prototype.destroy.call(this,t);this._bg&&this._bg.destroy();this._bg=null};t.createChildren=function(){this.addChild(this._tf=new b);this._tf.padding=D.inputLabelPadding;this._tf.on("input",this,this._onInput);this._tf.on("enter",this,this._onEnter);this._tf.on("blur",this,this._onBlur);this._tf.on("focus",this,this._onFocus)};t._onFocus=function(){this.event("focus",this)};t._onBlur=function(){this.event("blur",this)};t._onInput=function(){this.event("input",this)};t._onEnter=function(){this.event("enter",this)};t.initialize=function(){this.width=128;this.height=22};t.select=function(){this._tf.select()};t.setSelection=function(t,e){this._tf.setSelection(t,e)};r(0,t,"text",e.prototype._$get_text,function(t){if(this._tf.text!=t){t=t+"";this._tf.text=t;this.event("change")}});r(0,t,"bg",function(){return this._bg},function(t){this.graphics=this._bg=t});r(0,t,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function(t){this._tf.inputElementYAdjuster=t});r(0,t,"multiline",function(){return this._tf.multiline},function(t){this._tf.multiline=t});r(0,t,"skin",function(){return this._skin},function(t){if(this._skin!=t){this._skin=t;this._bg||(this.graphics=this._bg=new O);this._bg.source=x.getRes(this._skin);this._width&&(this._bg.width=this._width);this._height&&(this._bg.height=this._height)}});r(0,t,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(t){this._bg||(this.graphics=this._bg=new O);this._bg.sizeGrid=R.fillArray(D.defaultSizeGrid,t,Number)});r(0,t,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function(t){this._tf.inputElementXAdjuster=t});r(0,t,"width",e.prototype._$get_width,function(t){p.superSet($,this,"width",t);this._bg&&(this._bg.width=t)});r(0,t,"height",e.prototype._$get_height,function(t){p.superSet($,this,"height",t);this._bg&&(this._bg.height=t)});r(0,t,"editable",function(){return this._tf.editable},function(t){this._tf.editable=t});r(0,t,"restrict",function(){return this._tf.restrict},function(t){this._tf.restrict=t});r(0,t,"prompt",function(){return this._tf.prompt},function(t){this._tf.prompt=t});r(0,t,"promptColor",function(){return this._tf.promptColor},function(t){this._tf.promptColor=t});r(0,t,"maxChars",function(){return this._tf.maxChars},function(t){this._tf.maxChars=t});r(0,t,"focus",function(){return this._tf.focus},function(t){this._tf.focus=t});r(0,t,"type",function(){return this._tf.type},function(t){this._tf.type=t});r(0,t,"asPassword",function(){return this._tf.asPassword},function(t){this._tf.asPassword=t});return i}($);var ft=function(t){function e(){e.__super.call(this)}a(e,"laya.ui.VSlider",t);return e}(X);var _t=function(t){function n(){this.popupCenter=true;this.closeHandler=null;this.popupEffect=null;this.closeEffect=null;this.group=null;this.isModal=false;this._dragArea=null;n.__super.call(this)}a(n,"laya.ui.Dialog",t);var e=n.prototype;e.initialize=function(){this.popupEffect=n.manager.popupEffectHandler;this.closeEffect=n.manager.closeEffectHandler;this._dealDragArea();this.on("click",this,this._onClick)};e._dealDragArea=function(){var t=this.getChildByName("drag");if(t){this.dragArea=t.x+","+t.y+","+t.width+","+t.height;t.removeSelf()}};e._onClick=function(t){var e=t.target;if(e){switch(e.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close(e.name);break}}};e.show=function(t,e){t===void 0&&(t=false);e===void 0&&(e=true);this._open(false,t,e)};e.popup=function(t,e){t===void 0&&(t=false);e===void 0&&(e=true);this._open(true,t,e)};e._open=function(t,e,i){n.manager.lock(false);this.isModal=t;n.manager.open(this,e,i)};e.onOpened=function(){};e.close=function(t,e){e===void 0&&(e=true);n.manager.close(this,t,e)};e.onClosed=function(t){};e._onMouseDown=function(t){var e=this.getMousePoint();if(this._dragArea.contains(e.x,e.y))this.startDrag();else this.stopDrag()};r(0,e,"dragArea",function(){if(this._dragArea)return this._dragArea.toString();return null},function(t){if(t){var e=R.fillArray([0,0,0,0],t,Number);this._dragArea=new S(e[0],e[1],e[2],e[3]);this.on("mousedown",this,this._onMouseDown)}else{this._dragArea=null;this.off("mousedown",this,this._onMouseDown)}});r(0,e,"isPopup",function(){return this.parent!=null});r(0,e,"zOrder",t.prototype._$get_zOrder,function(t){p.superSet(Q,this,"zOrder",t);n.manager._checkMask()});r(1,n,"manager",function(){return n._manager=n._manager||new U},function(t){n._manager=t});n.setLockView=function(t){n.manager.setLockView(t)};n.lock=function(t){n.manager.lock(t)};n.closeAll=function(){n.manager.closeAll()};n.getDialogsByGroup=function(t){return n.manager.getDialogsByGroup(t)};n.closeByGroup=function(t){return n.manager.closeByGroup(t)};n.CLOSE="close";n.CANCEL="cancel";n.SURE="sure";n.NO="no";n.OK="ok";n.YES="yes";n._manager=null;return n}(Q);var dt=function(t){function e(){e.__super.call(this)}a(e,"laya.ui.HBox",t);var i=e.prototype;i.sortItem=function(t){if(t)t.sort(function(t,e){return t.x-e.x})};i.changeItems=function(){this._itemChanged=false;var t=[];var e=0;for(var i=0,n=this.numChildren;i<n;i++){var r=this.getChildAt(i);if(r&&r.layoutEnabled){t.push(r);e=this._height?this._height:Math.max(e,r.height*r.scaleY)}}this.sortItem(t);var s=0;for(i=0,n=t.length;i<n;i++){r=t[i];r.x=s;s+=r.width*r.scaleX+this._space;if(this._align=="top"){r.y=0}else if(this._align=="middle"){r.y=(e-r.height*r.scaleY)*.5}else if(this._align=="bottom"){r.y=e-r.height*r.scaleY}}this.changeSize()};r(0,i,"height",t.prototype._$get_height,function(t){if(this._height!=t){p.superSet(tt,this,"height",t);this.callLater(this.changeItems)}});e.NONE="none";e.TOP="top";e.MIDDLE="middle";e.BOTTOM="bottom";return e}(tt);var pt=function(t){function e(){e.__super.call(this)}a(e,"laya.ui.VBox",t);var i=e.prototype;i.changeItems=function(){this._itemChanged=false;var t=[];var e=0;for(var i=0,n=this.numChildren;i<n;i++){var r=this.getChildAt(i);if(r&&r.layoutEnabled){t.push(r);e=this._width?this._width:Math.max(e,r.width*r.scaleX)}}this.sortItem(t);var s=0;for(i=0,n=t.length;i<n;i++){r=t[i];r.y=s;s+=r.height*r.scaleY+this._space;if(this._align=="left"){r.x=0}else if(this._align=="center"){r.x=(e-r.width*r.scaleX)*.5}else if(this._align=="right"){r.x=e-r.width*r.scaleX}}this.changeSize()};r(0,i,"width",t.prototype._$get_width,function(t){if(this._width!=t){p.superSet(tt,this,"width",t);this.callLater(this.changeItems)}});e.NONE="none";e.LEFT="left";e.CENTER="center";e.RIGHT="right";return e}(tt);var vt=function(t){function e(){e.__super.call(this)}a(e,"laya.ui.RadioGroup",t);var i=e.prototype;i.createItem=function(t,e){return new st(t,e)};return e}(ot);var gt=function(t){function e(){e.__super.call(this)}a(e,"laya.ui.Tab",t);var i=e.prototype;i.createItem=function(t,e){return new W(t,e)};return e}(ot);var mt=function(e){function i(t){this._vScrollBar=null;this._hScrollBar=null;t===void 0&&(t="");i.__super.call(this,t)}a(i,"laya.ui.TextArea",e);var t=i.prototype;t.destroy=function(t){t===void 0&&(t=true);e.prototype.destroy.call(this,t);this._vScrollBar&&this._vScrollBar.destroy();this._hScrollBar&&this._hScrollBar.destroy();this._vScrollBar=null;this._hScrollBar=null};t.initialize=function(){this.width=180;this.height=150;this._tf.wordWrap=true;this.multiline=true};t.onVBarChanged=function(t){if(this._tf.scrollY!=this._vScrollBar.value){this._tf.scrollY=this._vScrollBar.value}};t.onHBarChanged=function(t){if(this._tf.scrollX!=this._hScrollBar.value){this._tf.scrollX=this._hScrollBar.value}};t.changeScroll=function(){var t=this._vScrollBar&&this._tf.maxScrollY>0;var e=this._hScrollBar&&this._tf.maxScrollX>0;var i=t?this._width-this._vScrollBar.width:this._width;var n=e?this._height-this._hScrollBar.height:this._height;var r=this._tf.padding||D.labelPadding;this._tf.width=i;this._tf.height=n;if(this._vScrollBar){this._vScrollBar.x=this._width-this._vScrollBar.width-r[2];this._vScrollBar.y=r[1];this._vScrollBar.height=this._height-(e?this._hScrollBar.height:0)-r[1]-r[3];this._vScrollBar.scrollSize=1;this._vScrollBar.thumbPercent=n/Math.max(this._tf.textHeight,n);this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY);this._vScrollBar.visible=t}if(this._hScrollBar){this._hScrollBar.x=r[0];this._hScrollBar.y=this._height-this._hScrollBar.height-r[3];this._hScrollBar.width=this._width-(t?this._vScrollBar.width:0)-r[0]-r[2];this._hScrollBar.scrollSize=Math.max(i*.033,1);this._hScrollBar.thumbPercent=i/Math.max(this._tf.textWidth,i);this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX);this._hScrollBar.visible=e}};t.scrollTo=function(t){this.commitMeasure();this._tf.scrollY=t};r(0,t,"scrollY",function(){return this._tf.scrollY});r(0,t,"width",e.prototype._$get_width,function(t){p.superSet(ct,this,"width",t);this.callLater(this.changeScroll)});r(0,t,"hScrollBar",function(){return this._hScrollBar});r(0,t,"height",e.prototype._$get_height,function(t){p.superSet(ct,this,"height",t);this.callLater(this.changeScroll)});r(0,t,"maxScrollX",function(){return this._tf.maxScrollX});r(0,t,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(t){if(this._vScrollBar==null){this.addChild(this._vScrollBar=new ut);this._vScrollBar.on("change",this,this.onVBarChanged);this._vScrollBar.target=this._tf;this.callLater(this.changeScroll)}this._vScrollBar.skin=t});r(0,t,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(t){if(this._hScrollBar==null){this.addChild(this._hScrollBar=new nt);this._hScrollBar.on("change",this,this.onHBarChanged);this._hScrollBar.mouseWheelEnable=false;this._hScrollBar.target=this._tf;this.callLater(this.changeScroll)}this._hScrollBar.skin=t});r(0,t,"vScrollBar",function(){return this._vScrollBar});r(0,t,"maxScrollY",function(){return this._tf.maxScrollY});r(0,t,"scrollX",function(){return this._tf.scrollX});return i}(ct);var yt=function(t){function e(){this._uiView=null;this.isCloseOther=false;e.__super.call(this)}a(e,"laya.ui.AsynDialog",t);var i=e.prototype;i.createView=function(t){this._uiView=t};i._open=function(t,e,i){this.isModal=t;this.isCloseOther=e;_t.manager.lock(true);if(this._uiView)this.onCreated();else this.onOpen()};i.onCreated=function(){this.createUI();this.onOpen()};i.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView);this._uiView=null;this._dealDragArea()};i.onOpen=function(){_t.manager.open(this,this.isCloseOther);_t.manager.lock(false)};i.close=function(t,e){e===void 0&&(e=true);_t.manager.close(this);this.onClose()};i.onClose=function(){};i.destroy=function(t){t===void 0&&(t=true);laya.ui.View.prototype.destroy.call(this,t);this._uiView=null;this.onDestroy()};i.onDestroy=function(){};return e}(_t);p.__init([Q])})(window,document,Laya);if(typeof define==="function"&&define.amd){define("laya.core",["require","exports"],function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:true});for(var i in Laya){var n=Laya[i];n&&n.__isclass&&(e[i]=n)}})}(function(){"use strict";function rt(t){throw t}var st=void 0,at=!0,s=this;function a(t,e){var i=t.split("."),n=s;!(i[0]in n)&&n.execScript&&n.execScript("var "+i[0]);for(var r;i.length&&(r=i.shift());)!i.length&&e!==st?n[r]=e:n=n[r]?n[r]:n[r]={}}var ot="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Uint32Array&&"undefined"!==typeof DataView;function ht(t,e){this.index="number"===typeof e?e:0;this.i=0;this.buffer=t instanceof(ot?Uint8Array:Array)?t:new(ot?Uint8Array:Array)(32768);2*this.buffer.length<=this.index&&rt(Error("invalid index"));this.buffer.length<=this.index&&this.f()}ht.prototype.f=function(){var t=this.buffer,e,i=t.length,n=new(ot?Uint8Array:Array)(i<<1);if(ot)n.set(t);else for(e=0;e<i;++e)n[e]=t[e];return this.buffer=n};ht.prototype.d=function(t,e,i){var n=this.buffer,r=this.index,s=this.i,a=n[r],o;i&&1<e&&(t=8<e?(h[t&255]<<24|h[t>>>8&255]<<16|h[t>>>16&255]<<8|h[t>>>24&255])>>32-e:h[t]>>8-e);if(8>e+s)a=a<<e|t,s+=e;else for(o=0;o<e;++o)a=a<<1|t>>e-o-1&1,8===++s&&(s=0,n[r++]=h[a],a=0,r===n.length&&(n=this.f()));n[r]=a;this.buffer=n;this.i=s;this.index=r};ht.prototype.finish=function(){var t=this.buffer,e=this.index,i;0<this.i&&(t[e]<<=8-this.i,t[e]=h[t[e]],e++);ot?i=t.subarray(0,e):(t.length=e,i=t);return i};var t=new(ot?Uint8Array:Array)(256),e;for(e=0;256>e;++e){for(var i=e,n=i,r=7,i=i>>>1;i;i>>>=1)n<<=1,n|=i&1,--r;t[e]=(n<<r&255)>>>0}var h=t;function u(t){this.buffer=new(ot?Uint16Array:Array)(2*t);this.length=0}u.prototype.getParent=function(t){return 2*((t-2)/4|0)};u.prototype.push=function(t,e){var i,n,r=this.buffer,s;i=this.length;r[this.length++]=e;for(r[this.length++]=t;0<i;)if(n=this.getParent(i),r[i]>r[n])s=r[i],r[i]=r[n],r[n]=s,s=r[i+1],r[i+1]=r[n+1],r[n+1]=s,i=n;else break;return this.length};u.prototype.pop=function(){var t,e,i=this.buffer,n,r,s;e=i[0];t=i[1];this.length-=2;i[0]=i[this.length];i[1]=i[this.length+1];for(s=0;;){r=2*s+2;if(r>=this.length)break;r+2<this.length&&i[r+2]>i[r]&&(r+=2);if(i[r]>i[s])n=i[s],i[s]=i[r],i[r]=n,n=i[s+1],i[s+1]=i[r+1],i[r+1]=n;else break;s=r}return{index:t,value:e,length:this.length}};function c(t){var e=t.length,i=0,n=Number.POSITIVE_INFINITY,r,s,a,o,h,l,u,c,f,_;for(c=0;c<e;++c)t[c]>i&&(i=t[c]),t[c]<n&&(n=t[c]);r=1<<i;s=new(ot?Uint32Array:Array)(r);a=1;o=0;for(h=2;a<=i;){for(c=0;c<e;++c)if(t[c]===a){l=0;u=o;for(f=0;f<a;++f)l=l<<1|u&1,u>>=1;_=a<<16|c;for(f=l;f<r;f+=h)s[f]=_;++o}++a;o<<=1;h<<=1}return[s,i,n]}function o(t,e){this.h=lt;this.w=0;this.input=ot&&t instanceof Array?new Uint8Array(t):t;this.b=0;e&&(e.lazy&&(this.w=e.lazy),"number"===typeof e.compressionType&&(this.h=e.compressionType),e.outputBuffer&&(this.a=ot&&e.outputBuffer instanceof Array?new Uint8Array(e.outputBuffer):e.outputBuffer),"number"===typeof e.outputIndex&&(this.b=e.outputIndex));this.a||(this.a=new(ot?Uint8Array:Array)(32768))}var lt=2,l={NONE:0,r:1,k:lt,O:3},ut=[],f;for(f=0;288>f;f++)switch(at){case 143>=f:ut.push([f+48,8]);break;case 255>=f:ut.push([f-144+400,9]);break;case 279>=f:ut.push([f-256+0,7]);break;case 287>=f:ut.push([f-280+192,8]);break;default:rt("invalid literal: "+f)}o.prototype.j=function(){var t,e,i,n,r=this.input;switch(this.h){case 0:i=0;for(n=r.length;i<n;){e=ot?r.subarray(i,i+65535):r.slice(i,i+65535);i+=e.length;var s=e,a=i===n,o=st,h=st,l=st,u=st,c=st,f=this.a,_=this.b;if(ot){for(f=new Uint8Array(this.a.buffer);f.length<=_+s.length+5;)f=new Uint8Array(f.length<<1);f.set(this.a)}o=a?1:0;f[_++]=o|0;h=s.length;l=~h+65536&65535;f[_++]=h&255;f[_++]=h>>>8&255;f[_++]=l&255;f[_++]=l>>>8&255;if(ot)f.set(s,_),_+=s.length,f=f.subarray(0,_);else{u=0;for(c=s.length;u<c;++u)f[_++]=s[u];f.length=_}this.b=_;this.a=f}break;case 1:var d=new ht(ot?new Uint8Array(this.a.buffer):this.a,this.b);d.d(1,1,at);d.d(1,2,at);var p=ct(this,r),v,g,m;v=0;for(g=p.length;v<g;v++)if(m=p[v],ht.prototype.d.apply(d,ut[m]),256<m)d.d(p[++v],p[++v],at),d.d(p[++v],5),d.d(p[++v],p[++v],at);else if(256===m)break;this.a=d.finish();this.b=this.a.length;break;case lt:var y=new ht(ot?new Uint8Array(this.a.buffer):this.a,this.b),b,x,w,T,S,C=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],E,A,M,I,L,P=Array(19),k,D,R,N,O;b=lt;y.d(1,1,at);y.d(b,2,at);x=ct(this,r);E=ft(this.M,15);A=_t(E);M=ft(this.L,7);I=_t(M);for(w=286;257<w&&0===E[w-1];w--);for(T=30;1<T&&0===M[T-1];T--);var B=w,F=T,U=new(ot?Uint32Array:Array)(B+F),G,V,W,z,H=new(ot?Uint32Array:Array)(316),Y,j,X=new(ot?Uint8Array:Array)(19);for(G=V=0;G<B;G++)U[V++]=E[G];for(G=0;G<F;G++)U[V++]=M[G];if(!ot){G=0;for(z=X.length;G<z;++G)X[G]=0}G=Y=0;for(z=U.length;G<z;G+=V){for(V=1;G+V<z&&U[G+V]===U[G];++V);W=V;if(0===U[G])if(3>W)for(;0<W--;)H[Y++]=0,X[0]++;else for(;0<W;)j=138>W?W:138,j>W-3&&j<W&&(j=W-3),10>=j?(H[Y++]=17,H[Y++]=j-3,X[17]++):(H[Y++]=18,H[Y++]=j-11,X[18]++),W-=j;else if(H[Y++]=U[G],X[U[G]]++,W--,3>W)for(;0<W--;)H[Y++]=U[G],X[U[G]]++;else for(;0<W;)j=6>W?W:6,j>W-3&&j<W&&(j=W-3),H[Y++]=16,H[Y++]=j-3,X[16]++,W-=j}t=ot?H.subarray(0,Y):H.slice(0,Y);L=ft(X,7);for(N=0;19>N;N++)P[N]=L[C[N]];for(S=19;4<S&&0===P[S-1];S--);k=_t(L);y.d(w-257,5,at);y.d(T-1,5,at);y.d(S-4,4,at);for(N=0;N<S;N++)y.d(P[N],3,at);N=0;for(O=t.length;N<O;N++)if(D=t[N],y.d(k[D],L[D],at),16<=D){N++;switch(D){case 16:R=2;break;case 17:R=3;break;case 18:R=7;break;default:rt("invalid code: "+D)}y.d(t[N],R,at)}var $=[A,E],K=[I,M],q,Z,Q,J,tt,et,it,nt;tt=$[0];et=$[1];it=K[0];nt=K[1];q=0;for(Z=x.length;q<Z;++q)if(Q=x[q],y.d(tt[Q],et[Q],at),256<Q)y.d(x[++q],x[++q],at),J=x[++q],y.d(it[J],nt[J],at),y.d(x[++q],x[++q],at);else if(256===Q)break;this.a=y.finish();this.b=this.a.length;break;default:rt("invalid compression type")}return this.a};function _(t,e){this.length=t;this.H=e}var d=function(){function t(t){switch(at){case 3===t:return[257,t-3,0];case 4===t:return[258,t-4,0];case 5===t:return[259,t-5,0];case 6===t:return[260,t-6,0];case 7===t:return[261,t-7,0];case 8===t:return[262,t-8,0];case 9===t:return[263,t-9,0];case 10===t:return[264,t-10,0];case 12>=t:return[265,t-11,1];case 14>=t:return[266,t-13,1];case 16>=t:return[267,t-15,1];case 18>=t:return[268,t-17,1];case 22>=t:return[269,t-19,2];case 26>=t:return[270,t-23,2];case 30>=t:return[271,t-27,2];case 34>=t:return[272,t-31,2];case 42>=t:return[273,t-35,3];case 50>=t:return[274,t-43,3];case 58>=t:return[275,t-51,3];case 66>=t:return[276,t-59,3];case 82>=t:return[277,t-67,4];case 98>=t:return[278,t-83,4];case 114>=t:return[279,t-99,4];case 130>=t:return[280,t-115,4];case 162>=t:return[281,t-131,5];case 194>=t:return[282,t-163,5];case 226>=t:return[283,t-195,5];case 257>=t:return[284,t-227,5];case 258===t:return[285,t-258,0];default:rt("invalid length: "+t)}}var e=[],i,n;for(i=3;258>=i;i++)n=t(i),e[i]=n[2]<<24|n[1]<<16|n[0];return e}(),y=ot?new Uint32Array(d):d;function ct(t,e){function i(t,e){var i=t.H,n=[],r=0,s;s=y[t.length];n[r++]=s&65535;n[r++]=s>>16&255;n[r++]=s>>24;var a;switch(at){case 1===i:a=[0,i-1,0];break;case 2===i:a=[1,i-2,0];break;case 3===i:a=[2,i-3,0];break;case 4===i:a=[3,i-4,0];break;case 6>=i:a=[4,i-5,1];break;case 8>=i:a=[5,i-7,1];break;case 12>=i:a=[6,i-9,2];break;case 16>=i:a=[7,i-13,2];break;case 24>=i:a=[8,i-17,3];break;case 32>=i:a=[9,i-25,3];break;case 48>=i:a=[10,i-33,4];break;case 64>=i:a=[11,i-49,4];break;case 96>=i:a=[12,i-65,5];break;case 128>=i:a=[13,i-97,5];break;case 192>=i:a=[14,i-129,6];break;case 256>=i:a=[15,i-193,6];break;case 384>=i:a=[16,i-257,7];break;case 512>=i:a=[17,i-385,7];break;case 768>=i:a=[18,i-513,8];break;case 1024>=i:a=[19,i-769,8];break;case 1536>=i:a=[20,i-1025,9];break;case 2048>=i:a=[21,i-1537,9];break;case 3072>=i:a=[22,i-2049,10];break;case 4096>=i:a=[23,i-3073,10];break;case 6144>=i:a=[24,i-4097,11];break;case 8192>=i:a=[25,i-6145,11];break;case 12288>=i:a=[26,i-8193,12];break;case 16384>=i:a=[27,i-12289,12];break;case 24576>=i:a=[28,i-16385,13];break;case 32768>=i:a=[29,i-24577,13];break;default:rt("invalid distance")}s=a;n[r++]=s[0];n[r++]=s[1];n[r++]=s[2];var o,h;o=0;for(h=n.length;o<h;++o)f[_++]=n[o];p[n[0]]++;v[n[3]]++;d=t.length+e-1;c=null}var n,r,s,a,o,h={},l,u,c,f=ot?new Uint16Array(2*e.length):[],_=0,d=0,p=new(ot?Uint32Array:Array)(286),v=new(ot?Uint32Array:Array)(30),g=t.w,m;if(!ot){for(s=0;285>=s;)p[s++]=0;for(s=0;29>=s;)v[s++]=0}p[256]=1;n=0;for(r=e.length;n<r;++n){s=o=0;for(a=3;s<a&&n+s!==r;++s)o=o<<8|e[n+s];h[o]===st&&(h[o]=[]);l=h[o];if(!(0<d--)){for(;0<l.length&&32768<n-l[0];)l.shift();if(n+3>=r){c&&i(c,-1);s=0;for(a=r-n;s<a;++s)m=e[n+s],f[_++]=m,++p[m];break}0<l.length?(u=b(e,n,l),c?c.length<u.length?(m=e[n-1],f[_++]=m,++p[m],i(u,0)):i(c,-1):u.length<g?c=u:i(u,0)):c?i(c,-1):(m=e[n],f[_++]=m,++p[m])}l.push(n)}f[_++]=256;p[256]++;t.M=p;t.L=v;return ot?f.subarray(0,_):f}function b(t,e,i){var n,r,s=0,a,o,h,l,u=t.length;o=0;l=i.length;t:for(;o<l;o++){n=i[l-o-1];a=3;if(3<s){for(h=s;3<h;h--)if(t[n+h-1]!==t[e+h-1])continue t;a=s}for(;258>a&&e+a<u&&t[n+a]===t[e+a];)++a;a>s&&(r=n,s=a);if(258===a)break}return new _(s,e-r)}function ft(t,e){var i=t.length,n=new u(572),r=new(ot?Uint8Array:Array)(i),s,a,o,h,l;if(!ot)for(h=0;h<i;h++)r[h]=0;for(h=0;h<i;++h)0<t[h]&&n.push(h,t[h]);s=Array(n.length/2);a=new(ot?Uint32Array:Array)(n.length/2);if(1===s.length)return r[n.pop().index]=1,r;h=0;for(l=n.length/2;h<l;++h)s[h]=n.pop(),a[h]=s[h].value;o=p(a,a.length,e);h=0;for(l=s.length;h<l;++h)r[s[h].index]=o[h];return r}function p(t,i,e){function n(t){var e=h[t][l[t]];e===i?(n(t+1),n(t+1)):--a[e];++l[t]}var r=new(ot?Uint16Array:Array)(e),s=new(ot?Uint8Array:Array)(e),a=new(ot?Uint8Array:Array)(i),o=Array(e),h=Array(e),l=Array(e),u=(1<<e)-i,c=1<<e-1,f,_,d,p,v;r[e-1]=i;for(_=0;_<e;++_)u<c?s[_]=0:(s[_]=1,u-=c),u<<=1,r[e-2-_]=(r[e-1-_]/2|0)+i;r[0]=s[0];o[0]=Array(r[0]);h[0]=Array(r[0]);for(_=1;_<e;++_)r[_]>2*r[_-1]+s[_]&&(r[_]=2*r[_-1]+s[_]),o[_]=Array(r[_]),h[_]=Array(r[_]);for(f=0;f<i;++f)a[f]=e;for(d=0;d<r[e-1];++d)o[e-1][d]=t[d],h[e-1][d]=d;for(f=0;f<e;++f)l[f]=0;1===s[e-1]&&(--a[0],++l[e-1]);for(_=e-2;0<=_;--_){p=f=0;v=l[_+1];for(d=0;d<r[_];d++)p=o[_+1][v]+o[_+1][v+1],p>t[f]?(o[_][d]=p,h[_][d]=i,v+=2):(o[_][d]=t[f],h[_][d]=f,++f);l[_]=0;1===s[_]&&n(_)}return a}function _t(t){var e=new(ot?Uint16Array:Array)(t.length),i=[],n=[],r=0,s,a,o,h;s=0;for(a=t.length;s<a;s++)i[t[s]]=(i[t[s]]|0)+1;s=1;for(a=16;s<=a;s++)n[s]=r,r+=i[s]|0,r<<=1;s=0;for(a=t.length;s<a;s++){r=n[t[s]];n[t[s]]+=1;o=e[s]=0;for(h=t[s];o<h;o++)e[s]=e[s]<<1|r&1,r>>>=1}return e}function v(t,e){this.l=[];this.m=32768;this.e=this.g=this.c=this.q=0;this.input=ot?new Uint8Array(t):t;this.s=!1;this.n=m;this.C=!1;if(e||!(e={}))e.index&&(this.c=e.index),e.bufferSize&&(this.m=e.bufferSize),e.bufferType&&(this.n=e.bufferType),e.resize&&(this.C=e.resize);switch(this.n){case g:this.b=32768;this.a=new(ot?Uint8Array:Array)(32768+this.m+258);break;case m:this.b=0;this.a=new(ot?Uint8Array:Array)(this.m);this.f=this.K;this.t=this.I;this.o=this.J;break;default:rt(Error("invalid inflate mode"))}}var g=0,m=1,x={F:g,D:m};v.prototype.p=function(){for(;!this.s;){var t=G(this,3);t&1&&(this.s=at);t>>>=1;switch(t){case 0:var e=this.input,i=this.c,n=this.a,r=this.b,s=e.length,a=st,o=st,h=n.length,l=st;this.e=this.g=0;i+1>=s&&rt(Error("invalid uncompressed block header: LEN"));a=e[i++]|e[i++]<<8;i+1>=s&&rt(Error("invalid uncompressed block header: NLEN"));o=e[i++]|e[i++]<<8;a===~o&&rt(Error("invalid uncompressed block header: length verify"));i+a>e.length&&rt(Error("input buffer is broken"));switch(this.n){case g:for(;r+a>n.length;){l=h-r;a-=l;if(ot)n.set(e.subarray(i,i+l),r),r+=l,i+=l;else for(;l--;)n[r++]=e[i++];this.b=r;n=this.f();r=this.b}break;case m:for(;r+a>n.length;)n=this.f({v:2});break;default:rt(Error("invalid inflate mode"))}if(ot)n.set(e.subarray(i,i+a),r),r+=a,i+=a;else for(;a--;)n[r++]=e[i++];this.c=i;this.b=r;this.a=n;break;case 1:this.o(N,U);break;case 2:W(this);break;default:rt(Error("unknown BTYPE: "+t))}}return this.t()};var w=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],T=ot?new Uint16Array(w):w,S=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],C=ot?new Uint16Array(S):S,E=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],A=ot?new Uint8Array(E):E,M=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],I=ot?new Uint16Array(M):M,L=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],P=ot?new Uint8Array(L):L,k=new(ot?Uint8Array:Array)(288),D,R;D=0;for(R=k.length;D<R;++D)k[D]=143>=D?8:255>=D?9:279>=D?7:8;var N=c(k),O=new(ot?Uint8Array:Array)(30),B,F;B=0;for(F=O.length;B<F;++B)O[B]=5;var U=c(O);function G(t,e){for(var i=t.g,n=t.e,r=t.input,s=t.c,a=r.length,o;n<e;)s>=a&&rt(Error("input buffer is broken")),i|=r[s++]<<n,n+=8;o=i&(1<<e)-1;t.g=i>>>e;t.e=n-e;t.c=s;return o}function V(t,e){for(var i=t.g,n=t.e,r=t.input,s=t.c,a=r.length,o=e[0],h=e[1],l,u;n<h&&!(s>=a);)i|=r[s++]<<n,n+=8;l=o[i&(1<<h)-1];u=l>>>16;t.g=i>>u;t.e=n-u;t.c=s;return l&65535}function W(t){function e(t,e,i){var n,r=this.z,s,a;for(a=0;a<t;)switch(n=V(this,e),n){case 16:for(s=3+G(this,2);s--;)i[a++]=r;break;case 17:for(s=3+G(this,3);s--;)i[a++]=0;r=0;break;case 18:for(s=11+G(this,7);s--;)i[a++]=0;r=0;break;default:r=i[a++]=n}this.z=r;return i}var i=G(t,5)+257,n=G(t,5)+1,r=G(t,4)+4,s=new(ot?Uint8Array:Array)(T.length),a,o,h,l;for(l=0;l<r;++l)s[T[l]]=G(t,3);if(!ot){l=r;for(r=s.length;l<r;++l)s[T[l]]=0}a=c(s);o=new(ot?Uint8Array:Array)(i);h=new(ot?Uint8Array:Array)(n);t.z=0;t.o(c(e.call(t,i,a,o)),c(e.call(t,n,a,h)))}v.prototype.o=function(t,e){var i=this.a,n=this.b;this.u=t;for(var r=i.length-258,s,a,o,h;256!==(s=V(this,t));)if(256>s)n>=r&&(this.b=n,i=this.f(),n=this.b),i[n++]=s;else{a=s-257;h=C[a];0<A[a]&&(h+=G(this,A[a]));s=V(this,e);o=I[s];0<P[s]&&(o+=G(this,P[s]));n>=r&&(this.b=n,i=this.f(),n=this.b);for(;h--;)i[n]=i[n++-o]}for(;8<=this.e;)this.e-=8,this.c--;this.b=n};v.prototype.J=function(t,e){var i=this.a,n=this.b;this.u=t;for(var r=i.length,s,a,o,h;256!==(s=V(this,t));)if(256>s)n>=r&&(i=this.f(),r=i.length),i[n++]=s;else{a=s-257;h=C[a];0<A[a]&&(h+=G(this,A[a]));s=V(this,e);o=I[s];0<P[s]&&(o+=G(this,P[s]));n+h>r&&(i=this.f(),r=i.length);for(;h--;)i[n]=i[n++-o]}for(;8<=this.e;)this.e-=8,this.c--;this.b=n};v.prototype.f=function(){var t=new(ot?Uint8Array:Array)(this.b-32768),e=this.b-32768,i,n,r=this.a;if(ot)t.set(r.subarray(32768,t.length));else{i=0;for(n=t.length;i<n;++i)t[i]=r[i+32768]}this.l.push(t);this.q+=t.length;if(ot)r.set(r.subarray(e,e+32768));else for(i=0;32768>i;++i)r[i]=r[e+i];this.b=32768;return r};v.prototype.K=function(t){var e,i=this.input.length/this.c+1|0,n,r,s,a=this.input,o=this.a;t&&("number"===typeof t.v&&(i=t.v),"number"===typeof t.G&&(i+=t.G));2>i?(n=(a.length-this.c)/this.u[2],s=258*(n/2)|0,r=s<o.length?o.length+s:o.length<<1):r=o.length*i;ot?(e=new Uint8Array(r),e.set(o)):e=o;return this.a=e};v.prototype.t=function(){var t=0,e=this.a,i=this.l,n,r=new(ot?Uint8Array:Array)(this.q+(this.b-32768)),s,a,o,h;if(0===i.length)return ot?this.a.subarray(32768,this.b):this.a.slice(32768,this.b);s=0;for(a=i.length;s<a;++s){n=i[s];o=0;for(h=n.length;o<h;++o)r[t++]=n[o]}s=32768;for(a=this.b;s<a;++s)r[t++]=e[s];this.l=[];return this.buffer=r};v.prototype.I=function(){var t,e=this.b;ot?this.C?(t=new Uint8Array(e),t.set(this.a.subarray(0,e))):t=this.a.subarray(0,e):(this.a.length>e&&(this.a.length=e),t=this.a);return this.buffer=t};function z(t){if("string"===typeof t){var e=t.split(""),i,n;i=0;for(n=e.length;i<n;i++)e[i]=(e[i].charCodeAt(0)&255)>>>0;t=e}for(var r=1,s=0,a=t.length,o,h=0;0<a;){o=1024<a?1024:a;a-=o;do{r+=t[h++],s+=r}while(--o);r%=65521;s%=65521}return(s<<16|r)>>>0}function H(t,e){var i,n;this.input=t;this.c=0;if(e||!(e={}))e.index&&(this.c=e.index),e.verify&&(this.N=e.verify);i=t[this.c++];n=t[this.c++];switch(i&15){case Y:this.method=Y;break;default:rt(Error("unsupported compression method"))}0!==((i<<8)+n)%31&&rt(Error("invalid fcheck flag:"+((i<<8)+n)%31));n&32&&rt(Error("fdict flag is not supported"));this.B=new v(t,{index:this.c,bufferSize:e.bufferSize,bufferType:e.bufferType,resize:e.resize})}H.prototype.p=function(){var t=this.input,e,i;e=this.B.p();this.c=this.B.c;this.N&&(i=(t[this.c++]<<24|t[this.c++]<<16|t[this.c++]<<8|t[this.c++])>>>0,i!==z(e)&&rt(Error("invalid adler-32 checksum")));return e};var Y=8;function j(t,e){this.input=t;this.a=new(ot?Uint8Array:Array)(32768);this.h=X.k;var i={},n;if((e||!(e={}))&&"number"===typeof e.compressionType)this.h=e.compressionType;for(n in e)i[n]=e[n];i.outputBuffer=this.a;this.A=new o(this.input,i)}var X=l;j.prototype.j=function(){var t,e,i,n,r,s,a,o=0;a=this.a;t=Y;switch(t){case Y:e=Math.LOG2E*Math.log(32768)-8;break;default:rt(Error("invalid compression method"))}i=e<<4|t;a[o++]=i;switch(t){case Y:switch(this.h){case X.NONE:r=0;break;case X.r:r=1;break;case X.k:r=2;break;default:rt(Error("unsupported compression type"))}break;default:rt(Error("invalid compression method"))}n=r<<6|0;a[o++]=n|31-(256*i+n)%31;s=z(this.input);this.A.b=o;a=this.A.j();o=a.length;ot&&(a=new Uint8Array(a.buffer),a.length<=o+4&&(this.a=new Uint8Array(a.length+4),this.a.set(a),a=this.a),a=a.subarray(0,o+4));a[o++]=s>>24&255;a[o++]=s>>16&255;a[o++]=s>>8&255;a[o++]=s&255;return a};function $(t,e){var i,n,r,s;if(Object.keys)i=Object.keys(e);else for(n in i=[],r=0,e)i[r++]=n;r=0;for(s=i.length;r<s;++r)n=i[r],a(t+"."+n,e[n])}a("Zlib.Inflate",H);a("Zlib.Inflate.prototype.decompress",H.prototype.p);$("Zlib.Inflate.BufferType",{ADAPTIVE:x.D,BLOCK:x.F});a("Zlib.Deflate",j);a("Zlib.Deflate.compress",function(t,e){return new j(t,e).j()});a("Zlib.Deflate.prototype.compress",j.prototype.j);$("Zlib.Deflate.CompressionType",{NONE:X.NONE,FIXED:X.r,DYNAMIC:X.k})}).call(this);var web;(function(t){var e;(function(t){var b=Laya.HttpRequest;var x=Laya.Event;var e=function(){function t(t,e,i,n){this._game_id=t;this._mgr=e;this._url=i;this._onNotLogin=n;this._httpRquestPool=[]}Object.defineProperty(t.prototype,"url",{get:function(){return this._url},enumerable:true,configurable:true});t.prototype.popRequest=function(){if(this._httpRquestPool.length>0){return this._httpRquestPool.pop()}return new b};t.prototype.pushRequest=function(t){if(!t)return;t.offAll();this._httpRquestPool.push(t)};t.prototype.OnComplete=function(t,e,i){var n=i?JSON.parse(i):null;if(!n){e&&e(i);return}if(n.success!=0){n.is_notlogin&&this._onNotLogin&&this._onNotLogin();e&&e(i);return}if(n.change_data){this._mgr.ReadMsg(n.change_data)}t&&t(n)};t.prototype.login=function(t,e,i,n){var r=this;this._httpRequest=this._httpRequest||new b;var s=this._url+"/login";var a="invite="+t+"&game_id="+this._game_id+"&code="+e;var o=function(t){r._unionid=t.unionid;i&&i(t)};this._httpRequest.send(s,a,"post");this._httpRequest.once(x.COMPLETE,this,this.OnComplete,[o,n]);this._httpRequest.once(x.ERROR,this,n)};t.prototype.loginTest=function(t,e,i,n){var r=this;this._httpRequest=this._httpRequest||new b;var s=this._url+"/login_test";var a="invite="+t+"&game_id="+this._game_id+"&code="+e;var o=function(t){r._unionid=t.unionid;i&&i(t)};this._httpRequest.send(s,a,"post");this._httpRequest.once(x.COMPLETE,this,this.OnComplete,[o,n]);this._httpRequest.once(x.ERROR,this,n)};t.prototype.getAccessToken=function(t,e,i,n){this._httpRequest=this._httpRequest||new b;var r=this._url+"/get_access_token";var s="unionid="+this._unionid+"&game_id="+this._game_id+"&path="+t+"&width="+e;r=r+s;this._httpRequest.send(r,"","get");this._httpRequest.once(x.COMPLETE,this,this.OnComplete,[i,n]);this._httpRequest.once(x.ERROR,this,n)};t.prototype.loginCrazy=function(t,e,i,n){var r=this;this._httpRequest=this._httpRequest||new b;var s=this._url+"/login_crazy";var a="invite="+t+"&game_id="+this._game_id+"&code="+e;var o=function(t){r._unionid=t.unionid;i&&i(t)};this._httpRequest.send(s,a,"post");this._httpRequest.once(x.COMPLETE,this,this.OnComplete,[o,n]);this._httpRequest.once(x.ERROR,this,n)};t.prototype.GetLoginInfo=function(t,e,i,n,r,s){var a=this;this._httpRequest=this._httpRequest||new b;var o=t+"/get_login_info";var h="game_id="+this._game_id+"&code="+e+"&encrypted_data="+i+"&iv="+n;var l=function(t){a._unionid=t.unionid;a._login_str=t.login_str;a._url=t.url;r&&r(t)};this._httpRequest.send(o,h,"post");this._httpRequest.once(x.COMPLETE,this,this.OnComplete,[l,s]);this._httpRequest.once(x.ERROR,this,s)};t.prototype.GetLoginInfoH5=function(t,e,i,n,r,s,a,o,h,l,u,c,f,_,d,p){var v=this;this._httpRequest=this._httpRequest||new b;var g=t+"/get_login_info_h5";var m="game_id="+this._game_id+"&channelExt="+e+"&email="+i+"&game_appid="+n+"&new_time="+r+"&loginplatform2cp="+s+"&user_id="+a+"&sdklogindomain="+o+"&openid="+f+"&sex="+_+"&sdkloginmodel="+h+"&sign="+l+"&icon="+u+"&nickname="+c;var y=function(t){v._unionid=t.unionid;v._login_str=t.login_str;v._url=t.url;d&&d(t)};this._httpRequest.send(g,m,"post");this._httpRequest.once(x.COMPLETE,this,this.OnComplete,[y,p]);this._httpRequest.once(x.ERROR,this,p)};t.prototype.GetLoginInfoTest=function(t,e,i,n){var r=this;this._httpRequest=this._httpRequest||new b;var s=t;var a="account="+e;var o=function(t){r._unionid=t.unionid;r._login_str=t.login_str;r._url=t.url;i&&i(t)};this._httpRequest.send(s,a,"post");this._httpRequest.once(x.COMPLETE,this,this.OnComplete,[o,n]);this._httpRequest.once(x.ERROR,this,n)};t.prototype.ShardsLogin=function(t,e,i,n,r){this._httpRequest=this._httpRequest||new b;var s=this._url+"/shards_login";var a="invite="+t+"&game_id="+this._game_id+"&login_str="+e;if(i==null)i="";a=a+"&qd_id="+i;this._httpRequest.send(s,a,"post");this._httpRequest.once(x.COMPLETE,this,this.OnComplete,[n,r]);this._httpRequest.once(x.ERROR,this,r)};return t}();t.WebProtocolsBase=e})(e=t.libs||(t.libs={}))})(web||(web={}));var web;(function(t){var e;(function(t){var e=function(){function t(){this._objMap=new Object;this._eventDip=new Laya.EventDispatcher}Object.defineProperty(t.prototype,"eventDip",{get:function(){return this._eventDip},enumerable:true,configurable:true});t.prototype.on=function(t,e,i,n){this._eventDip.on(t,e,i,n)};t.prototype.off=function(t,e,i,n){this._eventDip.off(t,e,i,n)};t.prototype.GetObj=function(t){return this._objMap[t]};t.prototype.ReadMsg=function(t){for(var e=0;e<t.all_data.length;e++){var i=t.all_data[e];var n=i[1]+","+i[0];var r=i[1];var s=this.GetObj(n);if(s==null){s=this.createObject(r,n);this._objMap[n]=s}if(t.createBlock){s.ReadCreate(i[2])}else{s.ReadUpdate(i[2])}}};t.prototype.createObject=function(t,e){throw"not implement"};return t}();t.WebObjectMgrBase=e})(e=t.libs||(t.libs={}))})(web||(web={}));var web;(function(t){var e;(function(t){var e=function(){function t(t){this._guid=t;this._numbers=new Array;this._bits=new Array;this._strs=new Array;this._intEventFun=[];this._bitEventFun=[];this._strEventFun=[];this._eventDip=new Laya.EventDispatcher}t.prototype.on=function(t,e,i,n){this._eventDip.on(t,e,i,n)};t.prototype.off=function(t,e,i,n){this._eventDip.off(t,e,i,n)};t.prototype.GetGuid=function(){return this._guid};t.prototype.SetNumber=function(t,e){var i=this._numbers[t];this._numbers[t]=e;if(i!=e){this.onCallFun(this._intEventFun,t)}};t.prototype.GetNumber=function(t){return this._numbers[t]||0};t.prototype.setBitValue=function(t,e){var i=this.GetBit(t);if(e){this.SetBit(t)}else{this.UnSetBit(t)}if(i!=e){this.onCallFun(this._bitEventFun,t)}};t.prototype.SetBit=function(t){this._bits[t]=true};t.prototype.UnSetBit=function(t){this._bits[t]=false};t.prototype.GetBit=function(t){return this._bits[t]||false};t.prototype.SetStr=function(t,e){var i=this._strs[t];this._strs[t]=e;if(i!=e){this.onCallFun(this._strEventFun,t)}};t.prototype.GetStr=function(t){return this._strs[t]||""};t.prototype.readValues=function(t,e){for(var i=0;i<t.length;i++){var n=t[i];if(n!=null){e(i+1,n)}}};t.prototype.ReadCreate=function(t){var i=this;this.readValues(t.numbers,function(t,e){i.SetNumber(t,e)});this.readValues(t.bits,function(t,e){i.setBitValue(t,e!=0)});this.readValues(t.strs,function(t,e){i.SetStr(t,e)})};t.prototype.readUpdateValues=function(t,e){for(var i=0;i<t.length;i++){var n=t[i];e(n[0],n[1])}};t.prototype.ReadUpdate=function(t){var i=this;this.readUpdateValues(t[0],function(t,e){i.SetNumber(t,e)});this.readUpdateValues(t[1],function(t,e){i.setBitValue(t,e!=0)});this.readUpdateValues(t[2],function(t,e){i.SetStr(t,e)})};t.prototype.AddListen=function(t,e,i){this.addFun(this._intEventFun,t,e,i)};t.prototype.removeListene=function(t,e,i){if(i===void 0){i=null}this.removeFun(this._intEventFun,t,e,i)};t.prototype.AddListenString=function(t,e,i){this.addFun(this._strEventFun,t,e,i)};t.prototype.removeListeneString=function(t,e,i){this.removeFun(this._strEventFun,t,e,i)};t.prototype.AddListenBit=function(t,e,i){this.addFun(this._bitEventFun,t,e,i)};t.prototype.removeListeneBit=function(t,e,i){this.removeFun(this._bitEventFun,t,e,i)};t.prototype.AddListensSeq=function(t,e,i,n){var r=ObjectPools.malloc(core.obj.HanlderStruct);r.caller=i;r.method=n;for(var s=t;s<=e;s++)this.addFun(this._intEventFun,s,i,n,r)};t.prototype.removeListenesSeq=function(t,e,i,n){if(i===void 0){i=null}if(n===void 0){n=null}for(var r=t;r<=e;r++)this.removeFun(this._intEventFun,r,i,n,r==0)};t.prototype.addFun=function(t,e,i,n,r){var s=t[e];if(!s)s=[];var a=s.length;for(var o=0;o<a;o++){var h=s[o];if(h&&h.caller==i&&h.method==n){return}}if(!r){r=ObjectPools.malloc(core.obj.HanlderStruct);r.caller=i;r.method=n}s.push(r);t[e]=s};t.prototype.removeFun=function(t,e,i,n,r){if(r===void 0){r=true}var s=t[e];if(!s||!s.length)return;var a=s.length;for(var o=0;o<a;o++){var h=s[o];if(!h)continue;if(n==null||h.caller==i&&h.method==n){s.splice(o);o=o<=1?0:o-1;if(r)ObjectPools.free(h)}}t[e]=s};t.prototype.onCallFun=function(t,e){var i=t[e];if(!i||!i.length)return;var n=i.length;for(var r=0;r<n;r++){var s=i[r];if(s&&s.caller&&s.method){s.method.call(s.caller,null)}}};return t}();t.WebObjectBase=e})(e=t.libs||(t.libs={}))})(web||(web={}));function extend(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);var n=t.ExtendInit;n&&n.call(t)}function applog(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];window.android&&window.android.print&&window.android.print(t),window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.logger&&window.webkit.messageHandlers.logger.postMessage(t)}function logd(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];core.utils.Log.LEVEL<4||(core.utils.Log.DATE.setTime(Date.now()),t.unshift(core.utils.Log.DATE.getHours()+":"+(core.utils.Log.DATE.getMinutes()+1)+":"+core.utils.Log.DATE.getSeconds()+":"+core.utils.Log.DATE.getMilliseconds()),t.unshift("[D]"),console.debug(t.join(" ")),applog(t.join(" ")))}function logl(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];core.utils.Log.LEVEL<3||(core.utils.Log.DATE.setTime(Date.now()),t.unshift(core.utils.Log.DATE.getHours()+":"+(core.utils.Log.DATE.getMinutes()+1)+":"+core.utils.Log.DATE.getSeconds()+":"+core.utils.Log.DATE.getMilliseconds()),t.unshift("[L]"),console.log(t.join(" ")),applog(t.join(" ")))}function logw(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];core.utils.Log.LEVEL<2||(core.utils.Log.DATE.setTime(Date.now()),t.unshift(core.utils.Log.DATE.getHours()+":"+(core.utils.Log.DATE.getMinutes()+1)+":"+core.utils.Log.DATE.getSeconds()+":"+core.utils.Log.DATE.getMilliseconds()),t.unshift("[W]"),console.warn(t.join(" ")),applog(t.join(" ")))}function loge(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];core.utils.Log.LEVEL<1||(core.utils.Log.DATE.setTime(Date.now()),t.unshift(core.utils.Log.DATE.getHours()+":"+(core.utils.Log.DATE.getMinutes()+1)+":"+core.utils.Log.DATE.getSeconds()+":"+core.utils.Log.DATE.getMilliseconds()),t.unshift("[E]"),console.log(t.join(" ")),applog(t.join(" ")))}function getPrefix(t){var e=t.indexOf(".");return-1==e?"":t.substr(0,e)}function makeGuid(t,e){return t+"."+e}!function(t){var o,h,e;function i(){}o=t.utils||(t.utils={}),h=Laya.Handler,Object.defineProperty(i,"eventDispatcher",{get:function(){return this._eventDispatcher||(this._eventDispatcher=new EventDispatcher),this._eventDispatcher},enumerable:!0,configurable:!0}),i.on=function(t,e,i,n){return this.eventDispatcher.on(t,e,i,n)},i.once=function(t,e,i,n){return this.eventDispatcher.once(t,e,i,n)},i.off=function(t,e,i,n){return this.eventDispatcher.off(t,e,i,n)},i.event=function(t,e){return this.eventDispatcher.event(t,e)},i.addSearchPath=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=!1),this._searchPathFiels?loge("Vesion.addSearchPath mast before Vesion.loadVesionFile"):i?(this._searchPaths.unshift(t),this._searchPathLangRes.unshift(e)):(this._searchPaths.push(t),this._searchPathLangRes.push(e))},i.foreachSearchPath=function(t){for(var e=this._searchPaths.length,i=0;i<e;i++)if(t(this._searchPaths[i],e==i+1))return},i.loadVesionFile=function(i){var n=this;void 0===i&&(i="version.bin"),i&&""!=i?Laya.loader.load(i,h.create(this,function(t){var e=t?o.StringU.readZlibData(new o.ByteArray(t)):null;Laya.loader.clearRes(i,!0),n.initVesionFiles(e)},null,!0)):(Laya.loader.clearRes(i,!0),this.initVesionFiles(null))},i.initVesionFiles=function(t){var i=this;if(t){var e=t.split("\n");this._defaultVesion=e[1];for(var n=0;n<e.length;n++)if(e[n]&&0!=e[n].length){var r=e[n].split(" ");2==r.length&&(this._VESION_FILES[r[0]]=r[1])}}this.baseFormatURL=Laya.URL.formatURL,Laya.URL.formatURL=function(t,e){return i.formatURL(t,e)},this.loadLangRes(function(){i.event(i.LOAD_VESION_COMPLETE)})},i.addNotNeetSearchPath=function(t){-1==this._notNeetSearchPaths.indexOf(t)&&this._notNeetSearchPaths.push(t)},i.removeNotNeetSearchPath=function(t){var e=this._notNeetSearchPaths.indexOf(t);-1!=e&&this._notNeetSearchPaths.splice(e,1)},i.formatURL=function(t,e){if(!t||-1!=t.indexOf("?v="))return t;e=e||Laya.URL.basePath,0==t.indexOf(e)&&(t=t.replace(e,"")),0==t.indexOf(this._assetUrl)&&(e=this._assetUrl,t=t.replace(this._assetUrl,"")),t=t.split("\\").join("/");for(var i=null,n=0,r=this._notNeetSearchPaths;n<r.length;n++){var s=r[n];if(0==t.indexOf(s)){i="";break}}if(null==i&&(null!=this.defaultPath&&0==t.indexOf(this.defaultPath)&&(i=""),null==i))for(var a=0;a<this._searchPaths.length;a++){if(0==t.indexOf(this._searchPaths[a])){i="";break}var o=this._searchPathFiels[this._searchPaths[a]];if(o&&o[t]){i=this._searchPaths[a];break}}return null==i&&(i=this.defaultPath),null!=i&&(t=i+t),t=this.createVersion(t),e==this._assetUrl&&0==t.indexOf(e)&&(e=""),t=this.baseFormatURL(t,e)},i.loadLangRes=function(e,t){var i=this;if(void 0===t&&(t=0),t>=this._searchPathLangRes.length)null!=e&&e();else{var n=t,r=this._searchPathLangRes[n],s=++t;if(r&&""!=r){var a=this._searchPaths[n];Laya.loader.load(this.createVersion(a+r),h.create(this,function(t){i.initLang(new o.ByteArray(t),a),i.loadLangRes(e,s)},null,!0))}else this.loadLangRes(e,s)}},i.initLang=function(t,e,i){void 0===i&&(i=!1),this._searchPathFiels=this._searchPathFiels||{};var n=this._searchPathFiels[e];n={},this._searchPathFiels[e]=n,t.endian=o.Endian.LITTLE_ENDIAN;for(var r=o.StringU.readZlibData(t).split("\r\n"),s=0;s<r.length;s++)r[s]&&0!=r[s].length&&(n[r[s].split(" ")[0]]=!0);o.L.loadOprates(o.StringU.readZlibData(t),i),o.L.loadLangs(o.StringU.readZlibData(t),i)},Object.defineProperty(i,"assetUrl",{set:function(t){this._assetUrl=t},enumerable:!0,configurable:!0}),i.createVersion=function(t){if(this._assetUrl){var e=null;if(this._VESION_FILES&&(e=this._VESION_FILES[t]),e){var i=t.lastIndexOf("/")+1;t=this._assetUrl+t.substring(0,i)+e+"_"+t.substring(i)+"?v="}}return t},i.LOAD_VESION_COMPLETE="LOAD_VESION_COMPLETE",i._searchPaths=[],i._searchPathLangRes=[],i._VESION_FILES={},i._notNeetSearchPaths=["http://","https://"],e=i,o.Vesion=e}(core=core||{}),function(t){var e,i;function a(t,e){this.x=t||0,this.y=e||0}e=t.utils||(t.utils={}),Object.defineProperty(a.prototype,"len",{get:function(){var t=this.x,e=this.y;return Math.sqrt(t*t+e*e)},set:function(t){this.normalize(),this.mul(t)},enumerable:!0,configurable:!0}),a.prototype.normalize=function(){var t=this.len;return 0<t&&(this.x=this.x/t,this.y=this.y/t),this},a.prototype.equal=function(t){var e=this.x>t.x?this.x-t.x:t.x-this.x;return(this.y>t.y?this.y-t.y:t.y-this.y)<1e-6&&e<1e-6},a.prototype.dist=function(t){var e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)},a.prototype.add=function(t){var e=this.x+t.x,i=this.y+t.y;return this.x=e,this.y=i,this},a.prototype.sub=function(t){var e=this.x-t.x,i=this.y-t.y;return this.x=e,this.y=i,this},a.sub=function(t,e,i){var n=e.x-i.x,r=e.y-i.y;return(t=t||a.vec2).x=n,t.y=r,t},a.prototype.mul=function(t){return this.x=this.x*t,this.y=this.y*t,this},a.prototype.set=function(t){return this.x=t.x,this.y=t.y,this},a.prototype.lerp=function(t,e){var i=1-e;return this.x=this.x*i+t.x*e,this.y=this.y*i+t.y*e,this},a.prototype.fromToward=function(t,e){e=e||a.TowardCount;var i=2*Math.PI*t/e,n=Math.cos(i),r=Math.sin(i);return this.x=n,this.y=r,this.normalize(),this},a.prototype.getToward=function(t){t=t||a.TowardCount;var e=this.x,i=this.y,n=Math.atan2(i,e);n<0&&(n+=2*Math.PI);var r=n/(2*Math.PI/t),s=Math.floor(.5+r);return s==t?0:s},a.prototype.clone=function(){return new a(this.x,this.y)},a.prototype.angle=function(t){var e=Math.atan2(t.y,t.x)-Math.atan2(this.x,this.y);return e>Math.PI&&(e-=2*Math.PI),e<-Math.PI&&(e+=2*Math.PI),e},a.prototype.toString=function(t){return"{"+this.x.toFixed(t||4)+","+this.y.toFixed(t||4)+"}"},a.TowardCount=8,a.zero=new a(0,0),a.right=new a(1,0),a.upRight=new a(1,1).normalize(),a.left=new a(-1,0),a.up=new a(0,1),a.down=new a(0,-1),a.temp=new a(0,0),a.vec2=new a,i=a,e.Vector2=i,e.float2Byte=function(t){var e=127*(t=(t=1<t?1:t)<-1?-1:t);return(e=Math.floor(e+.5))<0?128-e:e},e.byte2Float=function(t){var e=(t=128<t?-(t-128):t)/127;return 1<e?e-1:e}}(core=core||{}),function(t){var e,i;function n(){}e=t.utils||(t.utils={}),n.LEVEL=n.MAX_LOG_LEVEL=4,n.DATE=new Date,i=n,e.Log=i}(core=core||{}),null==console.assert&&(console.assert=function(t,e){if(!t)throw e}),function(t){var r,e;function i(){}r=t.utils||(t.utils={}),i.substitute=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(null==t)return"";var n,r=e.length;1==r&&e[0]instanceof Array?r=(n=e[0]).length:n=e;for(var s=0;s<r;s++)t=t.replace(new RegExp("\\{"+s+"\\}","g"),n[s]);return t},i.isEmpty=function(t){return null==t||0==t.length},i.trim=function(t){return null==t?null:this.rtrim(this.ltrim(t))},i.ltrim=function(t){return null==t?null:t.replace(/^\s*/,"")},i.rtrim=function(t){return null==t?null:t.replace(/\s*$/,"")},i.beginsWith=function(t,e){return e==t.substring(0,e.length)},i.endsWith=function(t,e){return e==t.substring(t.length-e.length)},i.getParameter=function(t,e){if(!t||0==t.length)return"";for(var i=t.substring(t.indexOf("?")+1,t.length).split("&"),n={},r=0;r<i.length;r++){var s=i[r];n[s.substring(0,s.indexOf("=")).toLowerCase()]=s.substring(s.indexOf("=")+1,s.length)}var a=n[e.toLowerCase()];return a&&void 0!==a?a:""},i.parameterToObj=function(t){for(var e=t.substring(t.indexOf("?")+1,t.length).split("&"),i={},n=0;n<e.length;n++){var r=e[n];i[r.substring(0,r.indexOf("=")).toLowerCase()]=r.substring(r.indexOf("=")+1,r.length)}return i},i.paddingLeft=function(t,e,i){var n=i-t.length;if(n<=0)return t;t=String(t);for(var r=0;r<n;r++)t=e+t;return t},i.readZlibData=function(t){var e=t.readUnsignedInt();this._tempBytesArray||(this._tempBytesArray=new r.ByteArray);var i=this._tempBytesArray;i.length=e,t.readBytes(i,0,e),i.uncompress();var n=i.readUTFBytes(i.length);return i.clear(),n},i.formatDiff=function(t,e){if(!t)return null;var i=t/1e3,n=Math.floor(i/86400/365);i%=31536e3;var r=Math.floor(i/86400/30);i%=2592e3;var s=Math.floor(i/86400);i%=86400;var a=Math.floor(i/3600);i%=3600;var o=Math.floor(i/60);i%=60;var h={"y+":n,"M+":r,"d+":s,"h+":a,"m+":o,"s+":Math.floor(i)};return this.format(h,e)},i.formatDate=function(t,e){if(!t)return null;var i={"y+":t.getFullYear(),"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),"S+":t.getMilliseconds()};return this.format(i,e)},i.format=function(t,e){for(var i in""==e&&(e=1<=t["d+"]?"dd天hh小时":t["d+"]<1&&1<t["h+"]?"hh:mm分":"mm:ss秒"),t)new RegExp("("+i+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[i]:("00"+t[i]).substr((""+t[i]).length)));return e},e=i,r.StringU=e}(core=core||{}),function(t){var i,e;function n(t){this.seed=0,this.m=Math.pow(2,32),this.a=1664525,this.c=1013904223,this.seed=t}i=t.utils||(t.utils={}),Object.defineProperty(n,"instance",{get:function(){return this._instance||(this._instance=new n(0)),this._instance},enumerable:!0,configurable:!0}),n.scand=function(t){this.instance.scand(t)},n.rand=function(){return this.instance.rand()},n.randFloat=function(){return this.instance.randFloat()},n.randInt=function(t,e){return this.instance.randInt(t,e)},n.prototype.scand=function(t){this.seed=i.MathU.parseInt(t)},n.prototype.rand=function(){return this.seed=(this.seed*this.a+this.c)%this.m,this.seed},n.prototype.randFloat=function(){return this.rand()/(this.m+1)},n.prototype.randInt=function(t,e){return t=i.MathU.parseInt(t),e=i.MathU.parseInt(e),Math.min(t,e)+i.MathU.parseInt((Math.abs(t-e)+1)*this.randFloat())},e=n,i.Random=e}(core=core||{}),function(t){!function(t){var i=(e.malloc=function(t,e){void 0===e&&(e=null);for(var i,n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var s=this._pools[t.name];if(s&&(i=s.pull()),!i)if(e)switch(e.length){case 0:i=new t;break;case 1:i=new t(e[0]);break;case 2:i=new t(e[0],e[1]);break;case 3:i=new t(e[0],e[1],e[2]);break;case 4:i=new t(e[0],e[1],e[2],e[3]);break;case 5:i=new t(e[0],e[1],e[2],e[3],e[4]);break;case 6:i=new t(e[0],e[1],e[2],e[3],e[4],e[5]);break;case 7:i=new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6]);break;case 8:i=new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]);break;case 9:i=new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]);break;case 10:i=new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9])}else i=new t;return i.outPool.apply(i,n),i},e.free=function(t){var e=t.poolName,i=this._pools[e];i||(i=new n(e),this._pools[e]=i),t.intoPool(),i.push(t)},e.update=function(t){if(0<this._nextUpdateTime)this._nextUpdateTime-=t;else for(var e in this._nextUpdateTime=2e4,this._pools)this._pools[e].adaptSize()},e.MOLD_DEBUG_STRICT=0,e.mold=e.MOLD_RELEASE_FAIL_SAFE=1,e._pools={},e._nextUpdateTime=0,e);function e(){}t.ObjectPools=i;var n=(r.prototype.push=function(t){var e=this._list.length;-1==this._list.indexOf(t)?this._list[e]=t:i.mold==i.MOLD_DEBUG_STRICT&&loge("error: free IPoolsObject in pool "+this._key)},r.prototype.pull=function(){var t,e=this._list.length-1;return 0<=e&&(t=this._list[e],this._list.length=e,this._minSize=Math.min(this._minSize,e),this._maxSize=Math.max(this._maxSize,e),this._mask=0),t},r.prototype.adaptSize=function(){this._mask++;var t=this._maxSize-this._minSize;this._mask<3&&(t+=2),this._list.length>t&&(this._list.length=t),this._minSize=this._maxSize=0},r);function r(t){this._list=[],this._minSize=0,this._maxSize=0,this._mask=0,this._key=t}}(t.utils||(t.utils={}))}(core=core||{}),function(t){var o,e;function i(){}o=t.utils||(t.utils={}),i.addFirstname=function(t){for(var e=0,i=t.split(",");e<i.length;e++){var n=i[e];this._firstname.push(n)}},i.addManSecondname=function(t){for(var e=0,i=t.split(",");e<i.length;e++){var n=i[e];this._manSecondname.push(n)}},i.addWomanSecondname=function(t){for(var e=0,i=t.split(",");e<i.length;e++){var n=i[e];this._womanSecondname.push(n)}},i.getRandomNickname=function(t){var e=this._firstname,i=t==this.SEX_MAN?this._manSecondname:this._womanSecondname,n=o.MathU.randomRange(0,e.length-1),r=o.MathU.randomRange(0,i.length-1),s=e[n];s=s||"";var a=i[r];return a=a||"我是无名氏",s.trim()+a.trim()},i.SEX_MAN=1,i._firstname=[],i._manSecondname=[],i._womanSecondname=[],e=i,o.RandNickname=e}(core=core||{}),function(t){!function(_){var t=(e.hash=function(t){var e=new _.ByteArray;return e.writeUTFBytes(t),this.hashBinary(e)},e.hashBytes=function(t){return this.hashBinary(t)},e.hashBinary=function(t){for(var e,i,n,r,s=1732584193,a=-271733879,o=-1732584194,h=271733878,l=this.createBlocks(t),u=l.length,c=0;c<u;c+=16)e=s,i=a,n=o,r=h,s=this.ff(s,a,o,h,l[c+0],7,-680876936),h=this.ff(h,s,a,o,l[c+1],12,-389564586),o=this.ff(o,h,s,a,l[c+2],17,606105819),a=this.ff(a,o,h,s,l[c+3],22,-1044525330),s=this.ff(s,a,o,h,l[c+4],7,-176418897),h=this.ff(h,s,a,o,l[c+5],12,1200080426),o=this.ff(o,h,s,a,l[c+6],17,-1473231341),a=this.ff(a,o,h,s,l[c+7],22,-45705983),s=this.ff(s,a,o,h,l[c+8],7,1770035416),h=this.ff(h,s,a,o,l[c+9],12,-1958414417),o=this.ff(o,h,s,a,l[c+10],17,-42063),a=this.ff(a,o,h,s,l[c+11],22,-1990404162),s=this.ff(s,a,o,h,l[c+12],7,1804603682),h=this.ff(h,s,a,o,l[c+13],12,-40341101),o=this.ff(o,h,s,a,l[c+14],17,-1502002290),a=this.ff(a,o,h,s,l[c+15],22,1236535329),s=this.gg(s,a,o,h,l[c+1],5,-165796510),h=this.gg(h,s,a,o,l[c+6],9,-1069501632),o=this.gg(o,h,s,a,l[c+11],14,643717713),a=this.gg(a,o,h,s,l[c+0],20,-373897302),s=this.gg(s,a,o,h,l[c+5],5,-701558691),h=this.gg(h,s,a,o,l[c+10],9,38016083),o=this.gg(o,h,s,a,l[c+15],14,-660478335),a=this.gg(a,o,h,s,l[c+4],20,-405537848),s=this.gg(s,a,o,h,l[c+9],5,568446438),h=this.gg(h,s,a,o,l[c+14],9,-1019803690),o=this.gg(o,h,s,a,l[c+3],14,-187363961),a=this.gg(a,o,h,s,l[c+8],20,1163531501),s=this.gg(s,a,o,h,l[c+13],5,-1444681467),h=this.gg(h,s,a,o,l[c+2],9,-51403784),o=this.gg(o,h,s,a,l[c+7],14,1735328473),a=this.gg(a,o,h,s,l[c+12],20,-1926607734),s=this.hh(s,a,o,h,l[c+5],4,-378558),h=this.hh(h,s,a,o,l[c+8],11,-2022574463),o=this.hh(o,h,s,a,l[c+11],16,1839030562),a=this.hh(a,o,h,s,l[c+14],23,-35309556),s=this.hh(s,a,o,h,l[c+1],4,-1530992060),h=this.hh(h,s,a,o,l[c+4],11,1272893353),o=this.hh(o,h,s,a,l[c+7],16,-155497632),a=this.hh(a,o,h,s,l[c+10],23,-1094730640),s=this.hh(s,a,o,h,l[c+13],4,681279174),h=this.hh(h,s,a,o,l[c+0],11,-358537222),o=this.hh(o,h,s,a,l[c+3],16,-722521979),a=this.hh(a,o,h,s,l[c+6],23,76029189),s=this.hh(s,a,o,h,l[c+9],4,-640364487),h=this.hh(h,s,a,o,l[c+12],11,-421815835),o=this.hh(o,h,s,a,l[c+15],16,530742520),a=this.hh(a,o,h,s,l[c+2],23,-995338651),s=this.ii(s,a,o,h,l[c+0],6,-198630844),h=this.ii(h,s,a,o,l[c+7],10,1126891415),o=this.ii(o,h,s,a,l[c+14],15,-1416354905),a=this.ii(a,o,h,s,l[c+5],21,-57434055),s=this.ii(s,a,o,h,l[c+12],6,1700485571),h=this.ii(h,s,a,o,l[c+3],10,-1894986606),o=this.ii(o,h,s,a,l[c+10],15,-1051523),a=this.ii(a,o,h,s,l[c+1],21,-2054922799),s=this.ii(s,a,o,h,l[c+8],6,1873313359),h=this.ii(h,s,a,o,l[c+15],10,-30611744),o=this.ii(o,h,s,a,l[c+6],15,-1560198380),a=this.ii(a,o,h,s,l[c+13],21,1309151649),s=this.ii(s,a,o,h,l[c+4],6,-145523070),h=this.ii(h,s,a,o,l[c+11],10,-1120210379),o=this.ii(o,h,s,a,l[c+2],15,718787259),a=this.ii(a,o,h,s,l[c+9],21,-343485551),s+=e,a+=i,o+=n,h+=r;var f=new _.ByteArray;return(this.digest=f).writeInt(s),f.writeInt(a),f.writeInt(o),f.writeInt(h),f.position=0,d.toHex(s)+d.toHex(a)+d.toHex(o)+d.toHex(h)},e.f=function(t,e,i){return t&e|~t&i},e.g=function(t,e,i){return t&i|e&~i},e.h=function(t,e,i){return t^e^i},e.i=function(t,e,i){return e^(t|~i)},e.transform=function(t,e,i,n,r,s,a,o){var h=Number(t(i,n,r)),l=_.MathU.toInt(e+h+s+o);return d.rol(l,a)+i},e.ff=function(t,e,i,n,r,s,a){return this.transform(this.f,t,e,i,n,r||0,s,a)},e.gg=function(t,e,i,n,r,s,a){return this.transform(this.g,t,e,i,n,r||0,s,a)},e.hh=function(t,e,i,n,r,s,a){return this.transform(this.h,t,e,i,n,r||0,s,a)},e.ii=function(t,e,i,n,r,s,a){return this.transform(this.i,t,e,i,n,r||0,s,a)},e.createBlocks=function(t){for(var e=new Array,i=t.length,n=t.position=0;n<i;n++){var r=8*n,s=(255&t.readByte())<<r%32;e[Number(r>>5)]|=s}return i*=8,e[Number(i>>5)]|=128<<i%32,e[Number(14+(i+64>>>9<<4))]=i,e},e);function e(){}_.MD5=t;var d=(i.rol=function(t,e){return t<<e|t>>>32-e},i.ror=function(t,e){var i=32-e;return t<<i|t>>>32-i},i.toHex=function(t,e){void 0===e&&(e=!1);var i="";if(e)for(var n=0;n<4;n++)i+=this.hexChars.charAt(t>>8*(3-n)+4&15)+this.hexChars.charAt(t>>8*(3-n)&15);else for(var r=0;r<4;r++)i+=this.hexChars.charAt(t>>8*r+4&15)+this.hexChars.charAt(t>>8*r&15);return i},i.hexChars="0123456789abcdef",i);function i(){}_.IntUtil=d}(t.utils||(t.utils={}))}(core=core||{}),function(t){var a,e;function o(){}a=t.utils||(t.utils={}),o.randomRange=function(t,e){return Math.floor((e-t+1)*Math.random())+t},o.randomPointInCicle=function(t,e,i){var n=o.randomRange(e,i),r=360*Math.random(),s=new a.Vector2;return s.x=t.x+Math.sin(r*Math.PI/180)*n,s.y=t.y+Math.cos(r*Math.PI/180)*n,s},o.getDistance=function(t,e,i,n){var r=t-i,s=e-n;return Math.sqrt(r*r+s*s)},o.getAngleTimeT=function(t){return Number(Laya.timer.currTimer%t/t)*Math.PI},o.getAngleByRotaion=function(t){return t%=360,Math.PI*Number(t/180)},o.getAngle=function(t,e,i,n){i-=t,n-=e;var r=Math.atan2(n,i);return r=0<=r?r:2*Math.PI+r},o.getRotation=function(t){return Math.round(180*Number(t/Math.PI))},o.randomBoolen=function(){return 0==Math.round(Math.random())},o.colorMatrix_adjust=function(t,e){var i=t+1,n=128*(1-i);return o.colorMatrix_concat([i,0,0,0,n,0,i,0,0,n,0,0,i,0,n,0,0,0,1,0],[1,0,0,0,e*=255,0,1,0,0,e,0,0,1,0,e,0,0,0,1,0])},o.colorMatrix_concat=function(t,e){for(var i=new Array(20),n=0,r=0;r<4;++r){for(var s=0;s<5;++s)i[n+s]=t[n]*e[s]+t[n+1]*e[s+5]+t[n+2]*e[s+10]+t[n+3]*e[s+15]+(4==s?t[n+4]:0);n+=5}return i},o.parseInt=function(t){return 0<=t?Math.floor(t):Math.ceil(t)},o.toInt=function(t){return this._byteArray||(this._byteArray=new a.ByteArray),this._byteArray.position=0,this._byteArray.writeInt(t),this._byteArray.position=0,this._byteArray.readInt()},o.lerp=function(t,e,i){return 1<i&&(i=1),i<0&&(i=0),t*(1-i)+e*i},e=o,a.MathU=e}(core=core||{}),function(t){var a,e;function i(){}a=t.utils||(t.utils={}),i.loadLangs=function(t,e){for(var i=t.split("\r\n"),n=0;n<i.length;n++){var r=i[n].replace(/\\r/g,"\r"),s=r.indexOf(this.FH_0);if(-1!=s){var a=Number(r.substr(0,s));!e&&this._langs[a]||(this._langs[a]=r.substr(s+1))}}this._langInitial=!0},i.GetLang=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(this._langInitial){var n=this._langs[t];return n?e.length?(e.unshift(n),a.StringU.substitute.apply(null,e)):n:""}loge("lang not initial please check")},i.loadOprates=function(t,e){for(var i=t.split("\r\n"),n=0;n<i.length;n++){var r=i[n].replace(/\\r/g,"\r"),s=r.indexOf(this.FH_0);if(-1!=s){var a=r.substr(0,s),o=a.indexOf("_");if(-1!=o){var h=Number(a.substr(0,o))<<16|Number(a.substr(o+1));!e&&this._oprates[h]||(this._oprates[h]=r.substr(s+1))}}}this._oprateInitial=!0},i.GetOprate=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];if(this._oprateInitial){var r=t<<16|e,s=this._oprates[r];return s?i.length?(i.unshift(s),a.StringU.substitute.apply(null,i)):s:""}loge("oprate not initial please check")},i.FH_0=":",i._langs={},i._langInitial=!1,i._oprates={},i._oprateInitial=!1,e=i,a.L=e}(core=core||{}),function(t){var e,i;function s(){}e=t.utils||(t.utils={}),s.GetDirect=function(t){var e=t/45;return Math.round(e)%s.MAX_DIRECT},s.GetDirect2=function(t){switch(t){case 0:return s.UP;case 1:return s.UPPER_RIGHT;case 2:return s.RIGHT;case 3:return s.BOTTOM_RIGHT;case 4:return s.BOTTOM;case 5:return s.BOTTOM_LEFT;case 6:return s.LEFT;case 7:return s.UPPER_LEFT}return t},s.AbsDirect=function(t){return(t+8)%s.MAX_DIRECT},s.GetAngle=function(t){return(t+6)%s.MAX_DIRECT*s.ANGLE_RADIANS_45},s.ATan2=function(t,e,i,n){i-=t,n-=e;var r=Math.atan2(n,i);return r=0<=r?r:2*Math.PI+r,r=Math.round(100*r)/100,s.GetDirect(r)},s.RIGHT=0,s.BOTTOM_RIGHT=1,s.BOTTOM=2,s.BOTTOM_LEFT=3,s.LEFT=4,s.UPPER_LEFT=5,s.UP=6,s.UPPER_RIGHT=7,s.MAX_DIRECT=8,s.ANGLE_RADIANS_90=Math.PI/2,s.ANGLE_RADIANS_45=Math.PI/4,s.ANGLE_RADIANS_30=Math.PI/6,s.ANGLE_RADIANS_15=Math.PI/12,s.ANGLE_RADIANS_120=s.ANGLE_RADIANS_90+s.ANGLE_RADIANS_30,s.ANGLE_RADIANS_360=2*Math.PI,i=s,e.Direct=i}(core=core||{}),function(t){!function(t){var n=(e.LITTLE_ENDIAN="littleEndian",e.BIG_ENDIAN="bigEndian",e);function e(){}t.Endian=n;var i=(r.prototype._setArrayBuffer=function(t){this.write_position=t.byteLength,this.data=new DataView(t),this._position=0},r.prototype.setdata=function(t){t instanceof r?this._setArrayBuffer(t.buffer):t instanceof ArrayBuffer&&this._setArrayBuffer(t)},Object.defineProperty(r.prototype,"buffer",{get:function(){return this.data.buffer},set:function(t){this.data=new DataView(t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"dataView",{get:function(){return this.data},set:function(t){this.data=t,this.write_position=t.byteLength},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bufferOffset",{get:function(){return this.data.byteOffset},enumerable:!0,configurable:!0}),r.prototype.getByte=function(t){return this.data.getUint8(t)},r.prototype.setByte=function(t,e){this.data.setUint8(t,e)},Object.defineProperty(r.prototype,"position",{get:function(){return this._position},set:function(t){this._position=t,this.write_position=t>this.write_position?t:this.write_position},enumerable:!0,configurable:!0}),r.prototype.reset=function(){this.clear()},Object.defineProperty(r.prototype,"length",{get:function(){return this.write_position},set:function(t){this.validateBuffer(t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bytesAvailable",{get:function(){return this.data.byteLength-this._position},enumerable:!0,configurable:!0}),r.prototype.clear=function(){this._setArrayBuffer(new ArrayBuffer(this.BUFFER_EXT_SIZE))},r.prototype.readBoolean=function(){return 0!=this.data.getUint8(this.position++)},r.prototype.readByte=function(){return this.data.getInt8(this.position++)},r.prototype.readBytes=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);for(var n=0;n<i;n++)t.data.setUint8(n+e,this.data.getUint8(this.position++))},r.prototype.readDouble=function(){var t=this.data.getFloat64(this.position,this.endian==n.LITTLE_ENDIAN);return this.position+=r.SIZE_OF_FLOAT64,t},r.prototype.readFloat=function(){var t=this.data.getFloat32(this.position,this.endian==n.LITTLE_ENDIAN);return this.position+=r.SIZE_OF_FLOAT32,t},r.prototype.readInt=function(){var t=this.data.getInt32(this.position,this.endian==n.LITTLE_ENDIAN);return this.position+=r.SIZE_OF_INT32,t},r.prototype.readInt32=function(){return this.readInt()},r.prototype.getInt32=function(t){return this.data.getInt32(4*t,this.endian==n.LITTLE_ENDIAN)},r.prototype.readShort=function(){var t=this.data.getInt16(this.position,this.endian==n.LITTLE_ENDIAN);return this.position+=r.SIZE_OF_INT16,t},r.prototype.readInt16=function(){return this.readShort()},r.prototype.readFloatTwoByte=function(t){return this.readShort()/t},r.prototype.readFloatOneByte=function(){return(this.readByte()+128)/256},r.prototype.readUnsignedByte=function(){return this.data.getUint8(this.position++)},r.prototype.readUint8=function(){return this.readUnsignedByte()},r.prototype.readInt8=function(){return this.readByte()},r.prototype.readUnsignedInt=function(){var t=this.data.getUint32(this.position,this.endian==n.LITTLE_ENDIAN);return this.position+=r.SIZE_OF_UINT32,t},r.prototype.readUint32=function(){return this.readUnsignedInt()},r.prototype.readUint64=function(){return this.readDouble()},r.prototype.readUnsignedShort=function(){var t=this.data.getUint16(this.position,this.endian==n.LITTLE_ENDIAN);return this.position+=r.SIZE_OF_UINT16,t},r.prototype.readUint16=function(){return this.readUnsignedShort()},r.prototype.readUTF=function(){var t=this.data.getUint16(this.position,this.endian==n.LITTLE_ENDIAN);return this.position+=r.SIZE_OF_UINT16,0<t?this.readUTFBytes(t):""},r.prototype.readString=function(){return this.readUTF()},r.prototype.readUTFBytes=function(t){var e=new Uint8Array(this.buffer,this.bufferOffset+this.position,t);return this.position+=t,this.decodeUTF8(e)},r.prototype.readStringByLen=function(t){return this.readUTFBytes(t)},r.prototype.writeBoolean=function(t){this.validateBuffer(r.SIZE_OF_BOOLEAN),this.data.setUint8(this.position++,t?1:0)},r.prototype.writeByte=function(t){this.validateBuffer(r.SIZE_OF_INT8),this.data.setInt8(this.position++,t)},r.prototype.writeUint8=function(t){this.writeByte(t)},r.prototype.writeInt8=function(t){this.writeByte(t)},r.prototype.writeBytes=function(t,e,i){var n;if(void 0===e&&(e=0),void 0===i&&(i=0),!(e<0)&&!(i<0)&&0<(n=0==i?t.length-e:Math.min(t.length-e,i))){this.validateBuffer(n);for(var r=new DataView(t.buffer),s=e;s<n+e;s++)this.data.setUint8(this.position++,r.getUint8(s))}},r.prototype.writeDouble=function(t){this.validateBuffer(r.SIZE_OF_FLOAT64),this.data.setFloat64(this.position,t,this.endian==n.LITTLE_ENDIAN),this.position+=r.SIZE_OF_FLOAT64},r.prototype.writeFloat=function(t){this.validateBuffer(r.SIZE_OF_FLOAT32),this.data.setFloat32(this.position,t,this.endian==n.LITTLE_ENDIAN),this.position+=r.SIZE_OF_FLOAT32},r.prototype.writeInt=function(t){this.validateBuffer(r.SIZE_OF_INT32),this.data.setInt32(this.position,t,this.endian==n.LITTLE_ENDIAN),this.position+=r.SIZE_OF_INT32},r.prototype.writeInt32=function(t){this.writeInt(t)},r.prototype.setInt32=function(t,e){this.data.setInt32(4*t,e,this.endian==n.LITTLE_ENDIAN)},r.prototype.writeUnsignedShort=function(t){this.validateBuffer(r.SIZE_OF_INT16),this.data.setInt16(this.position,t,this.endian==n.LITTLE_ENDIAN),this.position+=r.SIZE_OF_INT16},r.prototype.writeUint16=function(t){this.writeUnsignedShort(t)},r.prototype.writeUint64=function(t){this.validateBuffer(r.SIZE_OF_FLOAT64),this.data.setFloat64(this.position,t,this.endian==n.LITTLE_ENDIAN),this.position+=r.SIZE_OF_FLOAT64},r.prototype.writeShort=function(t){this.validateBuffer(r.SIZE_OF_INT16),this.data.setUint16(this.position,t,this.endian==n.LITTLE_ENDIAN),this.position+=r.SIZE_OF_INT16},r.prototype.writeInt16=function(t){this.writeShort(t)},r.prototype.writeUnsignedInt=function(t){this.validateBuffer(r.SIZE_OF_UINT32),this.data.setUint32(this.position,t,this.endian==n.LITTLE_ENDIAN),this.position+=r.SIZE_OF_UINT32},r.prototype.writeUint32=function(t){this.writeUnsignedInt(t)},r.prototype.writeUTF=function(t){var e=this.encodeUTF8(t),i=e.length;this.validateBuffer(r.SIZE_OF_UINT16+i),this.data.setUint16(this.position,i,this.endian===n.LITTLE_ENDIAN),this.position+=r.SIZE_OF_UINT16,this._writeUint8Array(e,!1)},r.prototype.writeString=function(t){var e=new r;e.writeUTFBytes(t),this.writeUint16(e.length+1),this.writeBytes(e,0,e.length),this.writeByte(0)},r.prototype.writeStringByLen=function(t,e){var i=this.position;this.writeUTFBytes(t),this.position=i+e,this.length=this.position+1},r.prototype.writeUTFBytes=function(t){this._writeUint8Array(this.encodeUTF8(t))},r.prototype.toString=function(){return"[ByteArray] length:"+this.length+", bytesAvailable:"+this.bytesAvailable},r.prototype._writeUint8Array=function(t,e){void 0===e&&(e=!0),e&&this.validateBuffer(this.position+t.length);for(var i=0;i<t.length;i++)this.data.setUint8(this.position++,t[i])},r.prototype.validate=function(t){if(0<this.data.byteLength&&this._position+t<=this.data.byteLength)return!0},r.prototype.validateBuffer=function(t,e){if(void 0===e&&(e=!1),this.write_position=t>this.write_position?t:this.write_position,t+=this._position,this.data.byteLength<t||e){var i=new Uint8Array(new ArrayBuffer(t+this.BUFFER_EXT_SIZE)),n=Math.min(this.data.buffer.byteLength,t+this.BUFFER_EXT_SIZE);i.set(new Uint8Array(this.data.buffer,0,n)),this.buffer=i.buffer}},r.prototype.encodeUTF8=function(t){for(var e=0,i=this.stringToCodePoints(t),n=[];i.length>e;){var r=i[e++];if(this.inRange(r,55296,57343))this.encoderError(r);else if(this.inRange(r,0,127))n.push(r);else{var s,a;for(this.inRange(r,128,2047)?(s=1,a=192):this.inRange(r,2048,65535)?(s=2,a=224):this.inRange(r,65536,1114111)&&(s=3,a=240),n.push(this.div(r,Math.pow(64,s))+a);0<s;){var o=this.div(r,Math.pow(64,s-1));n.push(128+o%64),s-=1}}}return new Uint8Array(n)},r.prototype.decodeUTF8=function(t){for(var e,i=0,n="",r=0,s=0,a=0,o=0;t.length>i;){var h=t[i++];if(h===this.EOF_byte)e=0!==s?this.decoderError(!1):this.EOF_code_point;else if(0===s)e=this.inRange(h,0,127)?h:(this.inRange(h,194,223)?(s=1,o=128,r=h-192):this.inRange(h,224,239)?(s=2,o=2048,r=h-224):this.inRange(h,240,244)?(s=3,o=65536,r=h-240):this.decoderError(!1),r*=Math.pow(64,s),null);else if(this.inRange(h,128,191))if(a+=1,r+=(h-128)*Math.pow(64,s-a),a!==s)e=null;else{var l=r,u=o;o=a=s=r=0,e=this.inRange(l,u,1114111)&&!this.inRange(l,55296,57343)?l:this.decoderError(!1,h)}else o=a=s=r=0,i--,e=this.decoderError(!1,h);null!==e&&e!==this.EOF_code_point&&(e<=65535?0<e&&(n+=String.fromCharCode(e)):(e-=65536,n+=String.fromCharCode(55296+(e>>10&1023)),n+=String.fromCharCode(56320+(1023&e))))}return n},r.prototype.encoderError=function(t){},r.prototype.decoderError=function(t,e){return e||65533},r.prototype.inRange=function(t,e,i){return e<=t&&t<=i},r.prototype.div=function(t,e){return Math.floor(t/e)},r.prototype.stringToCodePoints=function(t){for(var e=[],i=0,n=t.length;i<t.length;){var r=t.charCodeAt(i);if(this.inRange(r,55296,57343))if(this.inRange(r,56320,57343))e.push(65533);else if(i===n-1)e.push(65533);else{var s=t.charCodeAt(i+1);if(this.inRange(s,56320,57343)){var a=1023&r,o=1023&s;i+=1,e.push(65536+(a<<10)+o)}else e.push(65533)}else e.push(r);i+=1}return e},Object.defineProperty(r.prototype,"stringValue",{get:function(){var t=[],e=this.length,i=0,n=this.position;for(this.position=i;i<e;)t[i]=this.readByte(),i++;return this.position=n,t.join(",")},set:function(t){this.clear();for(var e=t.split(","),i=e.length,n=0;n<i;)this.writeByte(Number(e[n])),n++;this.position=0},enumerable:!0,configurable:!0}),r.prototype.compress=function(t){void 0===t&&(t="zlib");var e=new Uint8Array(this.buffer),i=new Zlib.Deflate(e).compress();this.buffer=i.buffer,this.position=this.write_position=0,this.length=i.byteLength},r.prototype.uncompress=function(t){void 0===t&&(t="zlib");var e=new Uint8Array(this.buffer),i=new Zlib.Inflate(e).decompress();this.buffer=i.buffer,this.position=this.write_position=0,this.length=i.byteLength},r.SIZE_OF_BOOLEAN=1,r.SIZE_OF_INT8=1,r.SIZE_OF_INT16=2,r.SIZE_OF_INT32=4,r.SIZE_OF_UINT8=1,r.SIZE_OF_UINT16=2,r.SIZE_OF_UINT32=4,r.SIZE_OF_FLOAT32=4,r.SIZE_OF_FLOAT64=8,r);function r(t){this.BUFFER_EXT_SIZE=0,this.optcode=0,this.EOF_byte=-1,this.EOF_code_point=-1,this._setArrayBuffer(t||new ArrayBuffer(this.BUFFER_EXT_SIZE)),this.endian=n.LITTLE_ENDIAN}t.ByteArray=i}(t.utils||(t.utils={}))}(core=core||{}),function(t){var e,i;function n(){}e=t.utils||(t.utils={}),n.encode=function(t){if(!t||0==t.length)return null;var e,i,n,r,s,a,o,h="",l=0;for(t=this._utf8_encode(t);l<t.length;)r=(e=t.charCodeAt(l++))>>2,s=(3&e)<<4|(i=t.charCodeAt(l++))>>4,a=(15&i)<<2|(n=t.charCodeAt(l++))>>6,o=63&n,isNaN(i)?a=o=64:isNaN(n)&&(o=64),h=h+this._keyStr.charAt(r)+this._keyStr.charAt(s)+this._keyStr.charAt(a)+this._keyStr.charAt(o);return h},n.decode=function(t){if(!t||0==t.length)return null;var e,i,n,r,s,a,o="",h=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");h<t.length;)e=this._keyStr.indexOf(t.charAt(h++))<<2|(r=this._keyStr.indexOf(t.charAt(h++)))>>4,i=(15&r)<<4|(s=this._keyStr.indexOf(t.charAt(h++)))>>2,n=(3&s)<<6|(a=this._keyStr.indexOf(t.charAt(h++))),o+=String.fromCharCode(e),64!=s&&(o+=String.fromCharCode(i)),64!=a&&(o+=String.fromCharCode(n));return o=this._utf8_decode(o)},n._utf8_encode=function(t){t=t.replace(/\r\n/g,"\n");for(var e="",i=0;i<t.length;i++){var n=t.charCodeAt(i);n<128?e+=String.fromCharCode(n):(127<n&&n<2048?e+=String.fromCharCode(n>>6|192):(e+=String.fromCharCode(n>>12|224),e+=String.fromCharCode(n>>6&63|128)),e+=String.fromCharCode(63&n|128))}return e},n._utf8_decode=function(t){for(var e="",i=0,n=0,r=0,s=0;i<t.length;)(n=t.charCodeAt(i))<128?(e+=String.fromCharCode(n),i++):191<n&&n<224?(r=t.charCodeAt(i+1),e+=String.fromCharCode((31&n)<<6|63&r),i+=2):(r=t.charCodeAt(i+1),s=t.charCodeAt(i+2),e+=String.fromCharCode((15&n)<<12|(63&r)<<6|63&s),i+=3);return e},n._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n.encodeBytes=function(t){var e,i=new Uint8Array(t),n=i.length,r="";for(e=0;e<n;e+=3)r+=this.chars[i[e]>>2],r+=this.chars[(3&i[e])<<4|i[e+1]>>4],r+=this.chars[(15&i[e+1])<<2|i[e+2]>>6],r+=this.chars[63&i[e+2]];return n%3==2?r=r.substring(0,r.length-1)+"=":n%3==1&&(r=r.substring(0,r.length-2)+"=="),r},n.decodeBytes=function(t){var e,i,n,r,s,a=.75*t.length,o=t.length,h=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var l=new ArrayBuffer(a),u=new Uint8Array(l);for(e=0;e<o;e+=4)i=this.chars.indexOf(t[e]),n=this.chars.indexOf(t[e+1]),r=this.chars.indexOf(t[e+2]),s=this.chars.indexOf(t[e+3]),u[h++]=i<<2|n>>4,u[h++]=(15&n)<<4|r>>2,u[h++]=(3&r)<<6|63&s;return l},i=n,e.Base64=i}(core=core||{}),function(t){var e,i;function n(){this._bytes=new ByteArray,this._bytes.endian=Endian.LITTLE_ENDIAN}e=t.obj||(t.obj={}),Object.defineProperty(n.prototype,"baseByteArray",{get:function(){return this._bytes},enumerable:!0,configurable:!0}),n.prototype.Clear=function(){this._bytes.clear()},n.prototype.GetBits=function(t,e){void 0===e&&(e=1);for(var i=0;i<e;i++)if(this.GetBit(t+i))return!0;return!1},n.prototype.GetBit=function(t){var e=t>>3;return e<this._bytes.length&&0!=(this._bytes.getByte(e)&1<<(7&t))},n.prototype.SetBit=function(t){var e=t>>3;e>=this._bytes.length&&(this._bytes.length=1+e),this._bytes.setByte(e,this._bytes.getByte(e)|1<<(7&t))},n.prototype.WriteTo=function(t){return this._bytes.position=0,t.writeShort(this._bytes.length),this._bytes.length&&t.writeBytes(this._bytes),!0},n.prototype.ReadFrom=function(t){this._bytes.clear();var e=t.readUnsignedShort();return(this._bytes.length=e)&&t.readBytes(this._bytes,0,e),!0},n.prototype.GetCount=function(){return this._bytes.length<<3},n.prototype.SetCount=function(t){this._bytes.length=t+7>>3},n.prototype.empty=function(){for(var t=0;t<this._bytes.length;t++)if(0!=this._bytes.getByte(t))return!1;return!0},n.prototype.or=function(t){var e=t._bytes.length;this._bytes.length<e&&(this._bytes.length=e);for(var i=0;i<e;i++)this._bytes[i]|=t._bytes[i]},n.prototype.test=function(t){for(var e=this._bytes.length>t._bytes.length?t._bytes.length:this._bytes.length,i=0;i<e;i++)if(this._bytes.getByte(i)&t._bytes.getByte(i))return!0;return!1},n.prototype.condense=function(){for(var t=this._bytes.length;0<t&&(t--,0==this._bytes[t]);)this._bytes.length--},n.prototype.equals=function(t){if(this.condense(),t.condense(),this._bytes.length!=t._bytes.length)return!1;for(var e=0;e<this._bytes.length;e++)if(this._bytes[e]!=t._bytes[e])return!1;return!0},n.prototype.clone=function(){var t=new n;t._bytes.length=this._bytes.length;for(var e=0;e<this._bytes.length;e++)t._bytes.setByte(e,this._bytes.getByte(e));return t},n.prototype.setInt=function(t,e){this._bytes.position=t<<2,this._bytes.writeInt(e)},n.prototype.getInt=function(t){return this._bytes.position=t<<2,this._bytes.readInt()},i=n,e.UpdateMask=i}(core=core||{}),function(t){var e,i;function n(){this._indexerExp=new Array,this._objs=new Array}e=t.obj||(t.obj={}),n.prototype.createIndex=function(t){var e=this.getIndex(t);return-1==e&&(e=this._indexerExp.length,this._indexerExp[e]=new RegExp(t,"g"),this._objs[e]=new Array),e},n.prototype.getIndex=function(t){var e=-1;for(var i in this._indexerExp)if(e++,this._indexerExp[i].source==t)return e;return-1},n.prototype.releaseIndex=function(t){var e=this.getIndex(t);-1!=e&&(this._indexerExp.splice(e,1),this._objs.splice(e,1))},n.prototype.test=function(t){for(var e=0;e<this._indexerExp.length;e++)if(this._indexerExp[e].lastIndex=0,this._indexerExp[e].test(t))return e;return-1},n.prototype.insert=function(t){var e=this.test(t.guid);0<=e&&this._objs[e]&&-1==this._objs[e].indexOf(t)&&(this._objs[e][this._objs[e].length]=t)},n.prototype.remove=function(t){var e=this.test(t);if(-1!=e)for(var i=0;i<this._objs[e].length;i++)if(this._objs[e][i].guid==t)return void this._objs[e].splice(i,1)},n.prototype.query=function(t){var e=this.getIndex(t);return-1==e?null:this._objs[e]},n.prototype.get=function(t){return t<0||t>=this._objs.length?null:this._objs[t]},n.prototype.Clear=function(){this._indexerExp&&(this._indexerExp.length=0,this._indexerExp=null),this._objs&&(this._objs.length=0,this._objs=null)},i=n,e.StringIndexer=i}(core=core||{}),function(t){var e,i;function n(){this.PROTO_TEA_C2S="2f651cbf85539c977da645a90cbd6b62",this.PROTO_MD5_KEY="40f09aa5ff525e8cc3a9d16bf1abc3c1",this.encipher_init(this.PROTO_TEA_C2S)}e=t.net||(t.net={}),n.prototype.encipher_init=function(t){var e=MD5.hash(t),i=new ByteArray;i.writeString(e),i.position=2,this.xor_key_c2s=i.readInt()},n.prototype.encipher_reset=function(t){var e=MD5.hashBinary(t);e+=this.PROTO_MD5_KEY,this.encipher_init(e)},n.prototype.encipher_encode=function(t){if(2==t.length)return 0;var e,i;for(i=t.length>>2,e=0;e<i;e++)t.getInt32(e),t.setInt32(e,t.getInt32(e)^this.xor_key_c2s);return this.xor_key_c2s=MathU.toInt(this.xor_key_c2s+286331153),0},i=n,e.Encipher=i}(core=core||{});var __extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){!function(i){var n=Laya.Event;i.EV_CONNECT=-100,i.EV_CLOSED=-200,i.EV_ERROR=-300;var e=(t.prototype.add=function(t,e){if(e instanceof ArrayBuffer){var i=e.byteLength;this.total+=i,this.codes[t]|=0,this.codes[t]+=i}},t);function t(){this.codes=[],this.total=0}i.FlowInfo=e;var r,s=(r=Laya.Socket,__extends(a,r),Object.defineProperty(a.prototype,"name",{get:function(){return this._name},set:function(t){this._name=t},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"sendFlowInfo",{get:function(){return this._sendFlowInfo},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"receiveFlowInfo",{get:function(){return this._receiveFlowInfo},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"sendRecordData",{get:function(){return this._sendRecordData},enumerable:!0,configurable:!0}),a.prototype.addCmdFilter=function(t){this._cmdFilter||(this._cmdFilter=[]),-1==this._cmdFilter.indexOf(t)&&this._cmdFilter.push(t)},a.prototype.removeCmdFilter=function(t){if(this._cmdFilter){var e=this._cmdFilter.indexOf(t);-1!=e&&this._cmdFilter.splice(e,1),this._cmdFilter.length||(this._cmdFilter=null)}},Object.defineProperty(a.prototype,"flowStatistics",{set:function(t){t?(this._sendFlowInfo=new e,this._receiveFlowInfo=new e):(this._sendFlowInfo=null,this._receiveFlowInfo=null)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"url",{get:function(){return this._socket?this._socket.url:""},enumerable:!0,configurable:!0}),a.prototype.setRemotePoint=function(t,e){this._address=t,this._port=e},a.prototype.addHanlder=function(t,e,i,n){var r=this._hanlders[t];null==r&&(r=[],this._hanlders[t]=r);for(var s=0,a=r;s<a.length;s++){var o=a[s];if(o.caller==e&&o.method==i)return void(o.dispose=!1)}var h=ObjectPools.malloc(HanlderStruct);h.caller=e,h.method=i,h.args=n,r.push(h)},a.prototype.removeHanlder=function(t,e,i){var n=this._hanlders[t];if(null!=n)for(var r=n.length,s=0;s<r;s++){var a=n[s];a.caller==e&&a.method==i&&(a.dispose=!0)}},a.prototype.isWss=function(){return"https:"==location.href.split("//")[0]},a.prototype.connect=function(){if(!this.connected){if(!this._address||!this._port)return void loge("请先设置IP及端口");if(this.encipher=new i.Encipher,this.isWss()){var t=this._port+1,e=this._address+":"+t;-1==e.indexOf("wss")&&(e="wss://"+this._address+":"+t),this.connectByUrl(e)}else r.prototype.connect.call(this,this._address,this._port)}},a.prototype.sendMsg=function(t,e){this.connected?this._cmdFilter&&-1==this._cmdFilter.indexOf(t)||(this.encipher.encipher_encode(e),this.send(e.buffer),this._sendFlowInfo&&(this._sendFlowInfo.add(t,e.buffer),this._sendRecordData||(this._sendRecordData=[]),10<=this._sendRecordData.length&&this._sendRecordData.shift(),this._sendRecordData.push(t))):this.event(a.SEND_MSG_NOT_CONNECTED,this)},a.prototype.onMessageReveived=function(t){if(t instanceof ArrayBuffer){var e=this._tempBytes;e.setdata(t);var i=e.readUint16();this._receiveFlowInfo&&this._receiveFlowInfo.add(i,t);var n=this.readPacket(i,e);null==n?this.disptchHanlder(i,e):this.disptchHanlder(i,n)}else logd("string"==typeof t?"Network:onMessageReveived "+t:"Network:onMessageReveived msg type unknow");this.input.clear()},a.prototype.readPacket=function(t,e){},a.prototype.disptchHanlder=function(t,e){var i=this._hanlders[t];if(null!=i)for(var n=0;n<i.length;n++){var r=i[n],s=r.dispose;if(!s){var a=void 0;e instanceof ByteArray&&(a=e.position),s=r.method.apply(r.caller,[t,e].concat(r.args)),a&&(e.position=a)}s&&(i.splice(n,1),ObjectPools.free(r),n--)}},a.SEND_MSG_NOT_CONNECTED="SEND_MSG_NOT_CONNECTED",a);function a(t){void 0===t&&(t="");var e=r.call(this)||this;return e._hanlders=[],e._name=t,e._tempBytes=new ByteArray,e.disableInput=!0,e.on(n.OPEN,e,e.disptchHanlder,[i.EV_CONNECT]),e.on(n.CLOSE,e,e.disptchHanlder,[i.EV_CLOSED]),e.on(n.ERROR,e,e.disptchHanlder,[i.EV_ERROR]),e.on(n.MESSAGE,e,e.onMessageReveived),e}i.Network=s}(t.net||(t.net={}))}(core=core||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){!function(t){t.OBJ_OPT_NEW=1,t.OBJ_OPT_DELETE=2,t.OBJ_OPT_UPDATE=4,t.OBJ_OPT_BINLOG=8,t.OBJ_OPT_U_GUID=16,t.OPT_SET=1,t.OPT_UNSET=2,t.OPT_ADD=4,t.OPT_SUB=8,t.TYPE_UINT32=0,t.TYPE_UINT16=1,t.TYPE_UINT8=2,t.TYPE_BIT=3,t.TYPE_UINT64=4,t.TYPE_INT32=5,t.TYPE_STRING=6,t.TYPE_INT16=7,t.TYPE_INT8=8,t.TYPE_FLOAT=9,t.TYPE_DOUBLE=10,t.ATOMIC_OPT_RESULT_NO=0,t.ATOMIC_OPT_RESULT_TRY=1,t.ATOMIC_OPT_RESULT_OK=2,t.ATOMIC_OPT_RESULT_FAILED=-1;var e,i=(e=Laya.EventDispatcher,__extends(n,e),n.init=function(){(n.tmpValueBytes=new ByteArray).endian=Endian.LITTLE_ENDIAN},n.OBJ_OPT_NEW=1,n.OBJ_OPT_DELETE=2,n.OBJ_OPT_UPDATE=4,n.OBJ_OPT_BINLOG=8,n.OBJ_OPT_U_GUID=16,n.OPT_SET=1,n.OPT_UNSET=2,n.OPT_ADD=4,n.OPT_SUB=8,n.TYPE_UINT32=0,n.TYPE_UINT16=1,n.TYPE_UINT8=2,n.TYPE_BIT=3,n.TYPE_UINT64=4,n.TYPE_INT32=5,n.TYPE_STRING=6,n.TYPE_INT16=7,n.TYPE_INT8=8,n.TYPE_FLOAT=9,n.TYPE_DOUBLE=10,n.ATOMIC_OPT_RESULT_NO=0,n.ATOMIC_OPT_RESULT_TRY=1,n.ATOMIC_OPT_RESULT_OK=2,n.ATOMIC_OPT_RESULT_FAILED=-1,n);function n(){return e.call(this)||this}t.SyncEvent=i}(t.obj||(t.obj={}))}(core=core||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,i,n;function r(){var t=null!==i&&i.apply(this,arguments)||this;return t._value_u32_buffer=new DataView(new ArrayBuffer(4)),t._old_value_u32_buffer=new DataView(new ArrayBuffer(4)),t}e=t.obj||(t.obj={}),i=e.SyncEvent,__extends(r,i),r.malloc=function(){return 0==r._pool.length?new r:r._pool.pop()},r.free=function(t){t.Clear(),r._pool[r._pool.length]=t},r.prototype.BinLogStru=function(){this.Clear()},Object.defineProperty(r.prototype,"opt",{get:function(){return this._opt},set:function(t){this._opt=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"index",{get:function(){return this._index},set:function(t){this._index=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"offset",{get:function(){return this._value_u32_buffer.getUint8(0)},set:function(t){this._value_u32_buffer.setUint8(0,t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"typ",{get:function(){return this._typ},set:function(t){this._typ=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"atomic_opt",{get:function(){return this._atomic_opt},set:function(t){this._atomic_opt=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"callback_idx",{get:function(){return this._callback_index},set:function(t){this._callback_index=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"uint32",{get:function(){return this._value_u32_buffer.getUint32(0,!0)},set:function(t){this._typ=e.SyncEvent.TYPE_UINT32,this._value_u32_buffer.setUint32(0,t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"int32",{get:function(){if(this._typ!=e.SyncEvent.TYPE_INT32)throw new Error("get int32 but _typ != SyncEvent.TYPE_INT32!");return this._value_u32_buffer.getInt32(0,!0)},set:function(t){this._typ=e.SyncEvent.TYPE_INT32,this._value_u32_buffer.setInt32(0,t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bit",{get:function(){if(this._typ!=e.SyncEvent.TYPE_BIT)throw new Error("get bit but _typ != SyncEvent.TYPE_BIT");return this._value_u32_buffer.getUint32(0,!0)},set:function(t){this._typ=e.SyncEvent.TYPE_BIT,this._value_u32_buffer.setUint32(0,t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"old_int32",{get:function(){if(this._typ!=e.SyncEvent.TYPE_INT32)throw new Error("get int32 but _typ != SyncEvent.TYPE_INT32!");return this._old_value_u32_buffer.getInt32(0,!0)},set:function(t){if(this._typ!=e.SyncEvent.TYPE_INT32)throw new Error("get int32 but _typ != SyncEvent.TYPE_INT32!");this._old_value_u32_buffer.setInt32(0,t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"uint16",{get:function(){if(this._typ!=e.SyncEvent.TYPE_UINT16)throw new Error("get uint16 but _typ != SyncEvent.TYPE_UINT16!");return this._value_u32_buffer.getUint16(2,!0)},set:function(t){this._typ=e.SyncEvent.TYPE_UINT16,this._value_u32_buffer.setUint16(2,t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"int16",{get:function(){if(this._typ!=e.SyncEvent.TYPE_INT16)throw new Error("get int16 but _typ != SyncEvent.TYPE_INT16!");return this._value_u32_buffer.getInt16(2,!0)},set:function(t){this._typ=e.SyncEvent.TYPE_INT16,this._value_u32_buffer.setInt16(2,t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"byte",{get:function(){if(this._typ!=e.SyncEvent.TYPE_UINT8)throw new Error("get uint8 but _typ != SyncEvent.TYPE_UINT8!");return this._value_u32_buffer.getInt8(2)},set:function(t){this._typ=e.SyncEvent.TYPE_UINT8,this._value_u32_buffer.setInt8(2,t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"double",{get:function(){return this._value_dbe},set:function(t){this._value_dbe=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"float",{get:function(){return this._value_u32_buffer.getFloat32(0,!0)},set:function(t){this._value_u32_buffer.setFloat32(0,t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"str",{get:function(){if(this._typ!=e.SyncEvent.TYPE_STRING)throw new Error("get str but _typ != SyncEvent.TYPE_STRING!");return this._value_str},set:function(t){this._typ=e.SyncEvent.TYPE_STRING,this._value_str=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"old_str",{get:function(){if(this._typ!=e.SyncEvent.TYPE_STRING)throw new Error("get old_str but _typ != SyncEvent.TYPE_STRING!");return this._old_value_str},set:function(t){if(this._typ!=e.SyncEvent.TYPE_STRING)throw new Error("set old_str but _typ != SyncEvent.TYPE_STRING!");this._old_value_str=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"value",{get:function(){return this._value_u32_buffer.getUint32(0,!0)},set:function(t){this._value_u32_buffer.setUint32(0,t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"old_value",{get:function(){return this._old_value_u32_buffer.getUint32(0,!0)},set:function(t){this._old_value_u32_buffer.setUint32(0,t,!0)},enumerable:!0,configurable:!0}),r.prototype.Clear=function(){this._opt=0,this._typ=0,this._index=0,this._atomic_opt=e.SyncEvent.ATOMIC_OPT_RESULT_NO,this._value_u32_buffer.setUint32(0,0,!0),this._value_dbe=0,this._value_str="",this._callback_index=0,this._old_value_u32_buffer.setUint32(0,0,!0),this._old_value_dbe=0,this._old_value_str=""},r.prototype.ReadFrom=function(t){return this._opt=t.readUnsignedByte(),this._typ=t.readUnsignedByte(),this._index=t.readShort(),this._atomic_opt=t.readByte(),this._typ==e.SyncEvent.TYPE_STRING?this._value_str=t.readUTF():this._typ==e.SyncEvent.TYPE_DOUBLE?this._value_dbe=t.readDouble():this.value=t.readUnsignedInt(),this._atomic_opt&&(this._callback_index=t.readUnsignedInt(),this._typ==e.SyncEvent.TYPE_STRING?this._old_value_str=t.readUTF():this._typ==e.SyncEvent.TYPE_DOUBLE?this._old_value_dbe=t.readDouble():this.old_value=t.readUnsignedInt()),!0},r.prototype.WriteTo=function(t){t.writeByte(this._opt),t.writeByte(this._typ),t.writeShort(this._index),t.writeByte(this._atomic_opt),this._typ==e.SyncEvent.TYPE_STRING?t.writeUTF(this._value_str?this._value_str:""):this._typ==e.SyncEvent.TYPE_DOUBLE?t.writeDouble(this._value_dbe):t.writeUnsignedInt(this.value),this._atomic_opt&&(t.writeUnsignedInt(this._callback_index),this._typ==e.SyncEvent.TYPE_STRING?t.writeUTF(this._old_value_str?this._old_value_str:""):this._typ==e.SyncEvent.TYPE_DOUBLE?t.writeDouble(this._old_value_dbe):t.writeUnsignedInt(this.old_value))},r.prototype.clone=function(){var t=r.malloc();return t._opt=this._opt,t._typ=this._typ,t._index=this._index,t._atomic_opt=this._atomic_opt,t.value=this.value,t._value_dbe=this._value_dbe,t._value_str=this._value_str,t._callback_index=this._callback_index,t.old_value=this.old_value,t._old_value_dbe=this._old_value_dbe,t._old_value_str=this._old_value_str,t},r._pool=new Array,n=r,e.BinLogStru=n}(core=core||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var o,e,i;function a(){var t=e.call(this)||this;return t._int_binlog_array=new Array,t._str_binlog_array=new Array,t._uint32_values_len=0,t._str_values_len=0,t._str_values=new Array,t._guid="",t._u_guid=0,t._tmpBinlog=new o.BinLogStru,a.addListens_mask||(a.addListens_mask=new o.UpdateMask),a.tmpIntMask||(a.tmpIntMask=new o.UpdateMask),a.tmpStrMask||(a.tmpStrMask=new o.UpdateMask),t._events_value=new o.NetEventDispatcher,t._events_str_values=new o.NetEventDispatcher,t._events_mask=new o.NetEventDispatcher(o.NetEventDispatcher.KEY_TYPE_INT_MASK),t._events_callback=new o.NetEventDispatcher,t._uint32_values_buffer=new DataView(new ArrayBuffer(0)),t}o=t.obj||(t.obj={}),e=o.SyncEvent,__extends(a,e),Object.defineProperty(a.prototype,"guid",{get:function(){return this._guid},set:function(t){this._guid=t},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"oid",{get:function(){return this._u_guid},set:function(t){this._u_guid=t},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"fieldCountOpen",{set:function(t){this.fieldChangeData=t?new Object:null},enumerable:!0,configurable:!0}),a.prototype.Reset=function(){this._events_value.Clear(),this._events_str_values.Clear(),this._events_callback.Clear(),this.clearValues()},a.prototype.clearValues=function(){this._uint32_values_len=0,this._uint32_values_buffer=new DataView(new ArrayBuffer(0)),this._str_values_len=0,this._str_values.length=this._str_values_len},a.prototype.checkIntSize=function(t){for(var e=!1;t>=this._uint32_values_len;)this._uint32_values_len+=8,e=!0;if(e){var i=new Uint8Array(new ArrayBuffer(this._uint32_values_len<<2));i.set(new Uint8Array(this._uint32_values_buffer.buffer,0,this._uint32_values_buffer.buffer.byteLength)),this._uint32_values_buffer=new DataView(i.buffer)}},a.prototype.checkStrSize=function(t){for(;t>=this._str_values_len;)this._str_values_len+=8,this._str_values.length=this._str_values_len},a.prototype.OnEventSyncBinLog=function(t){this._after_update&&(t.typ==o.SyncEvent.TYPE_STRING?a.tmpStrMask.SetBit(t.index):a.tmpIntMask.SetBit(t.index)),t.atomic_opt?this._events_callback.DispatchInt(t.callback_idx,t):t.typ==o.SyncEvent.TYPE_STRING?this._events_str_values.DispatchInt(t.index,t):this._events_value.DispatchInt(t.index,t)},a.prototype.AddListen=function(t,e,i){this._events_value.AddListenInt(t,e,i)},a.prototype.AddListens=function(t,e,i){for(var n=[],r=3;r<arguments.length;r++)n[r-3]=arguments[r];a.addListens_mask.Clear();for(var s=0;s<n.length;s++)a.addListens_mask.SetBit(t+n[s]);this._events_mask.AddListenIntMask(a.addListens_mask,e,i)},a.prototype.AddListensSeq=function(t,e,i,n){a.addListens_mask.Clear();for(var r=t;r<=e;r++)a.addListens_mask.SetBit(r);this._events_mask.AddListenIntMask(a.addListens_mask,i,n)},a.prototype.removeListene=function(t,e,i){void 0===i&&(i=null),this._events_value.removeListenerInt(t,e,i)},a.prototype.removeListenes=function(t,e,i){void 0===i&&(i=null);for(var n=[],r=3;r<arguments.length;r++)n[r-3]=arguments[r];a.addListens_mask.Clear();for(var s=0;s<n.length;s++)a.addListens_mask.SetBit(t+n[s]);this._events_mask.removeListenerUpdateMask(a.addListens_mask,e,i)},a.prototype.removeListenesSeq=function(t,e,i,n){void 0===i&&(i=null),void 0===n&&(n=null),a.addListens_mask.Clear();for(var r=t;r<=e;r++)a.addListens_mask.SetBit(r);this._events_mask.removeListenerUpdateMask(a.addListens_mask,i,n)},a.prototype.AddListenString=function(t,e,i){this._events_str_values.AddListenInt(t,e,i)},a.prototype.removeListeneString=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null),this._events_str_values.removeListenerInt(t,e,i)},a.prototype.GetDouble=function(t){return t+1<this._uint32_values_len?this._uint32_values_buffer.getFloat64(t<<2,!0):0},a.prototype.GetUInt32=function(t){return t<this._uint32_values_len?this._uint32_values_buffer.getUint32(t<<2,!0):0},a.prototype.GetInt32=function(t){return t<this._uint32_values_len?this._uint32_values_buffer.getInt32(t<<2,!0):0},a.prototype.GetUInt16=function(t,e){return t<this._uint32_values_len?this._uint32_values_buffer.getUint16((t<<2)+(e<<1),!0):0},a.prototype.GetInt16=function(t,e){return t<this._uint32_values_len?this._uint32_values_buffer.getInt16((t<<2)+(e<<1),!0):0},a.prototype.GetFloat=function(t){return t<this._uint32_values_len?this._uint32_values_buffer.getFloat32(t<<2,!0):0},a.prototype.GetByte=function(t,e){return t<this._uint32_values_len?this._uint32_values_buffer.getUint8((t<<2)+e):0},a.prototype.GetUInt8=function(t,e){return t<this._uint32_values_len?this._uint32_values_buffer.getUint8((t<<2)+e):0},a.prototype.GetBit=function(t,e){return(t+=e>>5)<this._uint32_values_len&&Boolean(this._uint32_values_buffer.getUint32(t<<2,!0)>>(31&e)&1)},a.prototype.GetStr=function(t){return t<this._str_values_len&&this._str_values[t]||""},a.prototype.SetDouble=function(t,e){this.checkIntSize(t+1),this._uint32_values_buffer.setFloat64(t<<2,e,!0)},a.prototype.AddDouble=function(t,e){this.checkIntSize(t+1),this.SetDouble(t,this.GetDouble(t)+e)},a.prototype.SubDouble=function(t,e){this.checkIntSize(t+1),this.SetDouble(t,this.GetDouble(t)-e)},a.prototype.SetUInt32=function(t,e){this.checkIntSize(t),this._uint32_values_buffer.setUint32(t<<2,e,!0)},a.prototype.AddUInt32=function(t,e){this.SetUInt32(t,this.GetUInt32(t)+e)},a.prototype.SubUInt32=function(t,e){this.SetUInt32(t,this.GetUInt32(t)-e)},a.prototype.SetInt32=function(t,e){this.checkIntSize(t),this._uint32_values_buffer.setInt32(t<<2,e,!0)},a.prototype.AddInt32=function(t,e){this.SetInt32(t,this.GetInt32(t)+e)},a.prototype.SubInt32=function(t,e){this.SetInt32(t,this.GetInt32(t)-e)},a.prototype.SetUInt16=function(t,e,i){this.checkIntSize(t),this._uint32_values_buffer.setUint16((t<<2)+(e<<1),i,!0)},a.prototype.AddUInt16=function(t,e,i){this.checkIntSize(t),this.SetUInt16(t,e,this.GetUInt16(t,e)+i)},a.prototype.SubUInt16=function(t,e,i){this.checkIntSize(t),this.SetUInt16(t,e,this.GetUInt16(t,e)-i)},a.prototype.SetInt16=function(t,e,i){this.checkIntSize(t),this._uint32_values_buffer.setInt16((t<<2)+(e<<1),i,!0)},a.prototype.AddInt16=function(t,e,i){this.SetInt16(t,e,this.GetInt16(t,e)+i)},a.prototype.SubInt16=function(t,e,i){this.SetInt16(t,e,this.GetInt16(t,e)-i)},a.prototype.SetFloat=function(t,e){this.checkIntSize(t),this._uint32_values_buffer.setFloat32(t<<2,e,!0)},a.prototype.SetByte=function(t,e,i){this.checkIntSize(t),this._uint32_values_buffer.setInt8((t<<2)+e,i)},a.prototype.AddByte=function(t,e,i){this.SetByte(t,e,this.GetByte(t,e)+i)},a.prototype.SubByte=function(t,e,i){this.SetByte(t,e,this.GetByte(t,e)-i)},a.prototype.SetStr=function(t,e){this.checkStrSize(t),this._str_values[t]=e},a.prototype.SetBit=function(t,e){t+=e>>5,e&=31,this.checkIntSize(t);var i=this._uint32_values_buffer.getUint32(t<<2,!0);i|=1<<e,this._uint32_values_buffer.setUint32(t<<2,i,!0)},a.prototype.UnSetBit=function(t,e){t+=e>>5,e&=31,this.checkIntSize(t);var i=this._uint32_values_buffer.getUint32(t<<2,!0);i&=~(1<<e),this._uint32_values_buffer.setUint32(t<<2,i,!0)},a.prototype.ReadValues=function(t,e,i){for(var n=t.GetCount(),r=0;r<n;r++)if(t.GetBit(r)){this.checkIntSize(r);var s=i?null:o.BinLogStru.malloc();s&&(s.typ=o.SyncEvent.TYPE_UINT32,s.index=r,s.old_value=this.GetUInt32(r));var a=e.readUnsignedInt();this.SetUInt32(r,a),s&&(s.value=this.GetUInt32(r),this.AddBinlogStru(this._int_binlog_array,s))}return!0},a.prototype.ReadStringValues=function(t,e,i){for(var n=t.GetCount(),r=0;r<n;r++)if(t.GetBit(r)){this.checkStrSize(r);var s=i?null:o.BinLogStru.malloc();s&&(s.index=r,s.typ=o.SyncEvent.TYPE_STRING,s.old_str=this._str_values[r]),this._str_values[r]=e.readUTF(),s&&(s.str=this._str_values[r],this.AddBinlogStru(this._str_binlog_array,s))}return!0},a.prototype.GetCreateMask=function(t){t.Clear();for(var e=0;e<this._uint32_values_len;e++)this.GetUInt32(e)&&t.SetBit(e)},a.prototype.GetCreateStringMask=function(t){t.Clear();for(var e=0;e<this._str_values_len;e++)this._str_values[e]&&0<this._str_values[e].length&&t.SetBit(e)},a.prototype.ApplyAtomicBinLog=function(t){if(t.atomic_opt!=o.SyncEvent.ATOMIC_OPT_RESULT_FAILED&&t.atomic_opt!=o.SyncEvent.ATOMIC_OPT_RESULT_OK){if(t._typ==o.SyncEvent.TYPE_STRING)return this.checkStrSize(t._index),void(t._old_value_str!=this._str_values[t._index]?(t._old_value_str=t._value_str,t._value_str=this._str_values[t._index],t._atomic_opt=o.SyncEvent.ATOMIC_OPT_RESULT_FAILED):(t._atomic_opt=o.SyncEvent.ATOMIC_OPT_RESULT_OK,this.ApplyBinLog(t)));this.checkIntSize(t._index);var e=this.GetUInt32(t.index);t.old_value!=e?(t.old_value=t.value,t.value=e,t._atomic_opt=o.SyncEvent.ATOMIC_OPT_RESULT_FAILED):(t._atomic_opt=o.SyncEvent.ATOMIC_OPT_RESULT_OK,this.ApplyBinLog(t))}else this._events_callback.DispatchInt(t.callback_idx,t)},a.prototype.ApplyBinLog=function(t){var e=t.index;if(t._typ==o.SyncEvent.TYPE_STRING)return this.checkStrSize(e),t.old_str=this._str_values[e]?this._str_values[e]:"",this._str_values[e]=t._value_str,this.AddBinlogStru(this._str_binlog_array,t.clone()),void a.tmpStrMask.SetBit(t.index);if(this.AddBinlogStru(this._int_binlog_array,t.clone()),a.tmpIntMask.SetBit(t.index),t.typ==o.SyncEvent.TYPE_DOUBLE?(this._uint32_values_len>e+1&&(t._old_value_dbe=this.GetDouble(e)),this.checkIntSize(e+1)):(t.typ!=o.SyncEvent.TYPE_BIT&&this._uint32_values_len>e&&(t.old_value=this.GetUInt32(e)),this.checkIntSize(e)),t.typ==o.SyncEvent.TYPE_UINT32||t.typ==o.SyncEvent.TYPE_INT32||t.typ==o.SyncEvent.TYPE_FLOAT)switch(t.opt){case o.SyncEvent.OPT_SET:this.SetUInt32(e,t.uint32);break;case o.SyncEvent.OPT_ADD:this.AddUInt32(e,t.uint32);break;case o.SyncEvent.OPT_SUB:this.SubUInt32(e,t.uint32)}else if(t.typ==o.SyncEvent.TYPE_DOUBLE)switch(t.opt){case o.SyncEvent.OPT_SET:this.SetDouble(e,t.double);break;case o.SyncEvent.OPT_ADD:this.AddDouble(e,t.double);break;case o.SyncEvent.OPT_SUB:this.SubDouble(e,t.double)}else if(t.typ==o.SyncEvent.TYPE_BIT)switch(t.opt){case o.SyncEvent.OPT_SET:this.SetBit(e,t.uint32);break;case o.SyncEvent.OPT_UNSET:this.UnSetBit(e,t.uint32);break;default:throw Error("BinLogObject_BIT:op type is error.")}else switch(t.typ){case o.SyncEvent.TYPE_UINT16:switch(t.opt){case o.SyncEvent.OPT_SET:this.SetUInt16(e,t.offset,t.uint16);break;case o.SyncEvent.OPT_ADD:this.AddUInt16(e,t.offset,t.uint16);break;case o.SyncEvent.OPT_SUB:this.SubUInt16(e,t.offset,t.uint16);break;default:throw Error("BinLogObject_UINT16:unknow OP type")}break;case o.SyncEvent.TYPE_INT16:switch(t.opt){case o.SyncEvent.OPT_SET:this.SetInt16(e,t.offset,t.int16);break;case o.SyncEvent.OPT_ADD:this.AddInt16(e,t.offset,t.int16);break;case o.SyncEvent.OPT_SUB:this.SubInt16(e,t.offset,t.int16);break;default:throw Error("BinLogObject_UINT16:unknow OP type")}break;case o.SyncEvent.TYPE_UINT8:switch(t.opt){case o.SyncEvent.OPT_SET:this.SetByte(e,t.offset,t.byte);break;case o.SyncEvent.OPT_ADD:this.AddByte(e,t.offset,t.byte);break;case o.SyncEvent.OPT_SUB:this.SubByte(e,t.offset,t.byte);break;default:throw Error("BinLogObject_UINT8:op type is error.")}break;default:throw Error("BinLogObject:op type is error.")}},a.prototype.AddBinlogStru=function(t,e){for(var i=0;i<t.length;i++){var n=t[i];if(n.index==e.index)return t[i]=e,void o.BinLogStru.free(n)}t.push(e)},a.prototype.DispatchIndex=function(t,e){for(var i=0;i<e.length;i++){var n=e[i];t.DispatchInt(n.index,n),o.BinLogStru.free(n)}e.length=0},a.prototype.ReadFrom=function(t,e){var i=Boolean(t&o.SyncEvent.OBJ_OPT_NEW);if(i&&this.clearValues(),(i||t&o.SyncEvent.OBJ_OPT_UPDATE)&&(a.tmpIntMask.ReadFrom(e),a.tmpStrMask.ReadFrom(e),this.ReadValues(a.tmpIntMask,e,i),this.ReadStringValues(a.tmpStrMask,e,i),null!=this._after_update&&this._after_update(t,a.tmpIntMask,a.tmpStrMask),this.DispatchIndex(this._events_value,this._int_binlog_array),this.DispatchIndex(this._events_str_values,this._str_binlog_array),this._events_mask.DispatchIntMask(a.tmpIntMask,this)),t&o.SyncEvent.OBJ_OPT_BINLOG){a.tmpIntMask.Clear(),a.tmpStrMask.Clear();for(var n=e.readUnsignedShort(),r=0;r<n;r++)this._tmpBinlog.ReadFrom(e),this._tmpBinlog._atomic_opt?this.ApplyAtomicBinLog(this._tmpBinlog):this.ApplyBinLog(this._tmpBinlog);null!=this._after_update&&this._after_update(t,a.tmpIntMask,a.tmpStrMask),this.DispatchIndex(this._events_value,this._int_binlog_array),this.DispatchIndex(this._events_str_values,this._str_binlog_array),this._events_mask.DispatchIntMask(a.tmpIntMask,this)}return i&&this.onBaseCreated(),!0},a.prototype.onBaseCreated=function(){},a.prototype.WriteCreateBlock=function(t,e,i){var n=o.OBJ_OPT_NEW;this._u_guid&&(n|=o.OBJ_OPT_U_GUID),t.writeByte(n),n&o.OBJ_OPT_U_GUID&&t.writeUnsignedInt(this._u_guid),t.writeUTF(this._guid);var r=e||new o.UpdateMask,s=i||new o.UpdateMask;this.GetCreateMask(r),r.WriteTo(t),this.GetCreateStringMask(s),s.WriteTo(t),this.WriteValues(r,t),this.WriteStringValues(s,t)},a.prototype.WriteValues=function(t,e){for(var i=t.GetCount(),n=0;n<i;n++)t.GetBit(n)&&e.writeInt(this._uint32_values_buffer.getInt32(n<<2,!0))},a.prototype.WriteStringValues=function(t,e){for(var i=t.GetCount(),n=0;n<i;n++)t.GetBit(n)&&e.writeUTF(this._str_values[n])},a.prototype.GetHashCode=function(){for(var t=2166136261,e=16777619,i=t,n=0;n<this._uint32_values_len;n++)i^=this.GetUInt32(n),i*=e;var r=new ByteArray;r.endian=Endian.LITTLE_ENDIAN;var s=t;for(r.writeUTFBytes(this._guid),n=0;n<r.length;n++)s^=r.getByte(n),s*=e;for(var a in this._str_values)for(r.clear(),r.writeUTFBytes(a||""),n=0;n<r.length;n++)s^=r[n],s*=e;return i^s<<1},a.prototype.Equals=function(t){return this._uint32_values_len>t._uint32_values_len?t.checkIntSize(this._uint32_values_len):this._uint32_values_len<t._uint32_values_len&&this.checkIntSize(t._uint32_values_len),this._str_values_len>t._str_values_len?t.checkStrSize(this._str_values_len):this._str_values_len>t._str_values_len&&this.checkStrSize(t._str_values_len),this.GetHashCode()==t.GetHashCode()},a.prototype.tostring=function(){for(var t="",e=0;e<this._uint32_values_len;e++)t=t+this.GetUInt32(e)+" ";var i="";for(e=0;e<this._str_values_len;e++)i=i+this.GetStr(e)+" ";return[this.guid,t,i]},a.prototype.dispose=function(){this.clearValues(),this._events_value.Clear(),this._events_str_values.Clear(),this._events_mask.Clear(),this._events_callback.Clear(),this._after_update=null},i=a,o.GuidObject=i}(core=core||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var s,e,i;function a(){var t=e.call(this)||this;return t._objs=new Object,t._hashGUID=null,t._u_2_guid=new Object,t._packet_pool=new Array,a.applyBlock_tmp_obj||(a.applyBlock_tmp_obj=new s.GuidObject),t._newEvent=new s.NetEventDispatcher(s.NetEventDispatcher.KEY_TYPE_STRING),t._delEvent=new s.NetEventDispatcher(s.NetEventDispatcher.KEY_TYPE_STRING),t._indexer=new s.StringIndexer,t}s=t.obj||(t.obj={}),e=s.SyncEvent,__extends(a,e),a.prototype.Get=function(t){return this._objs[t]},Object.defineProperty(a.prototype,"indexer",{get:function(){return this._indexer},enumerable:!0,configurable:!0}),a.prototype.CreateObject=function(t,e){var i=this._objs[t];return i||((i=new s.GuidObject).guid=t,i.oid=e),this.AttachObject(i),i},a.prototype.ReleaseObject=function(t){this.DetachObject(t),t.dispose()},a.prototype.ReleaseKey=function(t){var e=this._objs[t];e?this.ReleaseObject(e):logw("GuidObjectTable.ReleaseKey p is null")},a.prototype.AttachObject=function(t){null==t&&loge("AttachObject,o==null"),this._objs[t.guid]=t,this._indexer.insert(t),0!=t.oid&&(this._u_2_guid[t.oid]=t.guid)},a.prototype.DetachObject=function(t){this._indexer.remove(t.guid),delete this._objs[t.guid];var e=t.oid;0!=e&&delete this._u_2_guid[e]},a.prototype.ApplyBlock=function(t){for(;t.bytesAvailable;){var e,i=t.readUnsignedByte(),n=0;e=i&s.SyncEvent.OBJ_OPT_U_GUID?(n=t.readUnsignedShort(),i&s.SyncEvent.OBJ_OPT_NEW?t.readUTF():this._u_2_guid[n]?this._u_2_guid[n]:""):t.readUTF();var r=this.Get(e);i&s.SyncEvent.OBJ_OPT_DELETE?this.removeObject(e,r):((r=r||(i&s.SyncEvent.OBJ_OPT_NEW?this.CreateObject(e,n):a.applyBlock_tmp_obj))!=a.applyBlock_tmp_obj&&(r.oid=n),r.ReadFrom(i,t),i&s.SyncEvent.OBJ_OPT_NEW&&this._newEvent.DispatchString(r.guid.charAt(0),r))}return!0},a.prototype.SearchObject=function(t,e){var i=new RegExp(t);for(var n in e.length=0,this._objs)i.test(n)&&e.push(n)},a.prototype.ForEachObject=function(t){for(var e in this._objs)t(this._objs[e])},a.prototype.RegisterCreateEvent=function(t,e,i){this._newEvent.AddListenString(t,e,i)},a.prototype.RegisterReleaseEvent=function(t,e,i){this._delEvent.AddListenString(t,e,i)},a.prototype.newPacket=function(t){void 0===t&&(t=0);var e=null;return 0==this._packet_pool.length?(e=new ByteArray).endian=Endian.LITTLE_ENDIAN:(e=this._packet_pool.shift()).clear(),t&&e.writeShort(t),e},a.prototype.freePacket=function(t){t.clear(),this._packet_pool.push(t)},a.prototype.clearObjs=function(){for(var t in this._objs){if(this._objs[t]instanceof s.GuidObject){var e=this._objs[t];this.removeObject(e.guid,e)}delete this._objs[t]}},a.prototype.removeObject=function(t,e){this._delEvent.DispatchString(t,e),this.ReleaseKey(t)},a.prototype.saveObjsToString=function(){var t=new ByteArray;for(var e in this._objs)this._objs[e].WriteCreateBlock(t);return t.stringValue},a.prototype.loadObjsFormString=function(t){var e=new ByteArray;e.stringValue=t,this.ApplyBlock(e)},a.prototype.dispose=function(){for(var t in this._newEvent.Clear(),this._delEvent.Clear(),this._indexer.Clear(),this._objs){var e=this._objs[t];e&&e.dispose()}},i=a,s.GuidObjectTable=i}(core=core||{}),function(t){!function(t){var s=(e.prototype.intoPool=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.caller=null,this.method=null,this.args=null,this.dispose=!1},e.prototype.outPool=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e);function e(){this.dispose=!1,this.poolName="HanlderStruct"}t.HanlderStruct=s;var i=(a.prototype.DispatchIndex=function(t){var e;if(this._event_key_type==a.KEY_TYPE_STRING||this._event_key_type==a.KEY_TYPE_INT||this._event_key_type==a.KEY_TYPE_INT_MASK)for(e in this._event_index){var i=this._event_callback[this._event_index[e]];i.method.call(i.caller,t)}},a.prototype.DispatchString=function(t,e){if(this._event_key_type!=a.KEY_TYPE_STRING)throw new Error("this.DispatchIndex/this._event_key_type != NetEventDispatcher.KEY_TYPE_STRING");this._event_index.length=0;for(var i=this._event_callback.length,n=0;n<i;n++)t==this._event_id_str[n]&&this._event_index.unshift(n);this._event_index.length&&this.DispatchIndex(e)},a.prototype.DispatchInt=function(t,e){if(this._event_key_type!=a.KEY_TYPE_INT)throw new Error("this.DispatchIndex/this._event_key_type != NetEventDispatcher.KEY_TYPE_INT");this._event_index.length=0;for(var i=this._event_callback.length,n=0;n<i;n++)t==this._event_id_int[n]&&this._event_index.unshift(n);this._event_index.length&&this.DispatchIndex(e)},a.prototype.DispatchIntMask=function(t,e){if(this._event_key_type!=a.KEY_TYPE_INT_MASK)throw new Error("this.DispatchIndex/this._event_key_type != NetEventDispatcher.KEY_TYPE_INT_MASK");this._event_index.length=0;for(var i=this._event_callback.length,n=0;n<i;n++)this._event_id_int_mask[n].test(t)&&this._event_index.unshift(n);this._event_index.length&&this.DispatchIndex(e)},a.prototype.Dispatch=function(t,e){this._event_index.length=0;for(var i=this._event_callback.length,n=0;n<i;n++)e(this._event_id_int[n],t)&&this._event_index.unshift(n);this._event_index.length&&this.DispatchIndex(t)},a.prototype.AddListenInt=function(t,e,i){if(this._event_key_type!=a.KEY_TYPE_INT)throw new Error("AddListenInt but (this._event_key_type != NetEventDispatcher.KEY_TYPE_INT)");for(var n=0;n<this._event_id_int.length;n++)if(this._event_id_int[n]==t&&this._event_callback[n].caller==e&&this._event_callback[n].method==i)return;this._event_id_int.push(t);var r=ObjectPools.malloc(s);r.caller=e,r.method=i,this._event_callback.push(r)},a.prototype.AddListenString=function(t,e,i){if(this._event_key_type!=a.KEY_TYPE_STRING)throw new Error("AddListenString but (this._event_key_type != NetEventDispatcher.KEY_TYPE_STRING)");for(var n=0;n<this._event_id_str.length;n++)if(this._event_id_str[n]==t&&this._event_callback[n].caller==e&&this._event_callback[n].method==i)return;this._event_id_str.push(t);var r=ObjectPools.malloc(s);r.caller=e,r.method=i,this._event_callback.push(r)},a.prototype.AddListenIntMask=function(t,e,i){if(this._event_key_type!=a.KEY_TYPE_INT_MASK)throw new Error("AddListenString but (this._event_key_type != NetEventDispatcher.KEY_TYPE_INT_MASK)");for(var n=0;n<this._event_id_int_mask.length;n++)if(this._event_id_int_mask[n].equals(t)&&this._event_callback[n].caller==e&&this._event_callback[n].method==i)return;this._event_id_int_mask.push(t.clone());var r=ObjectPools.malloc(s);r.caller=e,r.method=i,this._event_callback.push(r)},a.prototype.removeListenerInt=function(t,e,i){if(void 0===i&&(i=null),this._event_key_type!=a.KEY_TYPE_INT)throw new Error("removeListenerInt but (this._event_key_type != NetEventDispatcher.KEY_TYPE_INT)");for(var n=0;n<this._event_id_int.length;){if(this._event_id_int[n]==t){var r=this._event_callback[n];if(null==i||r.caller==e&&r.method==i){this._event_id_int.splice(n,1),this._event_callback.splice(n,1),ObjectPools.free(r);continue}}n++}},a.prototype.removeListenerString=function(t,e,i){if(void 0===i&&(i=null),this._event_key_type!=a.KEY_TYPE_STRING)throw new Error("removeListenerString but (this._event_key_type != NetEventDispatcher.KEY_TYPE_STRING)");for(var n=0;n<this._event_id_str.length;){if(this._event_id_str[n]==t){var r=this._event_callback[n];if(null==i||r.caller==e&&r.method==i){this._event_id_str.splice(n,1),this._event_callback.splice(n,1),ObjectPools.free(r);continue}}n++}},a.prototype.removeListenerUpdateMask=function(t,e,i){if(void 0===i&&(i=null),this._event_key_type!=a.KEY_TYPE_INT_MASK)throw new Error("removeListenerUpdateMask but ()");for(var n=0;n<this._event_id_int_mask.length;){if(this._event_id_int_mask[n].equals(t)){var r=this._event_callback[n];if(null==i||r.caller==e&&r.method==i){this._event_id_int_mask.splice(n,1),this._event_callback.splice(n,1),ObjectPools.free(r);continue}}n++}},a.prototype.AddCallback=function(t,e){if(this._event_key_type==a.KEY_TYPE_STRING)throw new Error("AddCallback but (this._event_key_type == NetEventDispatcher.KEY_TYPE_STRING)");var i=this._callback_index+1;for(var n in i=this._callback_index+1,this._event_id_int)0!=i&&Number(n);return this._callback_index=i,this.AddListenInt(i,t,e),i},a.prototype.Clear=function(){this._event_callback&&(this._event_callback.length=0),this._event_id_int&&(this._event_id_int.length=0),this._event_id_str&&(this._event_id_str.length=0),this._event_index&&(this._event_index.length=0),this._event_id_int_mask&&(this._event_id_int_mask.length=0)},a.KEY_TYPE_INT=0,a.KEY_TYPE_STRING=1,a.KEY_TYPE_INT_MASK=2,a);function a(t){void 0===t&&(t=0),this._callback_index=0,(this._event_key_type=t)==a.KEY_TYPE_STRING?this._event_id_str=new Array:t==a.KEY_TYPE_INT?this._event_id_int=new Array:t==a.KEY_TYPE_INT_MASK&&(this._event_id_int_mask=new Array),this._event_callback=new Array,this._event_index=new Array}t.NetEventDispatcher=i}(t.obj||(t.obj={}))}(core=core||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var u,e,c,i;function n(){var t=null!==e&&e.apply(this,arguments)||this;return t._list=[],t}u=t.resource||(t.resource={}),c=Laya.Event,e=Laya.EventDispatcher,__extends(n,e),n.prototype.load=function(t,e,i,n,r){void 0===i&&(i=!1),this.clear();var s=!0;if(t)for(var a=0,o=t;a<o.length;a++){var h=o[a],l=u.RefAsset.Get(h,!0,i,n,r);l.retain(),this._list.push(l),l.parseComplete||(s=!1,l.on(c.PROGRESS,this,this.onAssetLoadProgress),l.once(c.COMPLETE,this,this.onAssetParseComplete))}s?e.run():this._handler=e},n.prototype.onAssetLoadProgress=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.event(c.PROGRESS,t)},n.prototype.onAssetParseComplete=function(t){if(t.off(c.PROGRESS,this,this.onAssetLoadProgress),this._handler){for(var e=!0,i=0,n=this._list;i<n.length;i++)if(!n[i].parseComplete){e=!1;break}e&&(this._handler.run(),this._handler=null)}},n.prototype.release=function(t,e){void 0===e&&(e=!1),t=Laya.URL.formatURL(t);for(var i=0;i<this._list.length;i++){var n=this._list[i];n.url==t&&(n.release(e),n.off(c.COMPLETE,this,this.onAssetParseComplete),this._list.splice(i,1),i--)}},n.prototype.clear=function(t){void 0===t&&(t=!1);for(var e=0,i=this._list;e<i.length;e++){var n=i[e];n.release(t),n.off(c.COMPLETE,this,this.onAssetParseComplete)}this._list.length=0},i=n,u.AssetsLoader=i}(core=core||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var r,e,s,i;function n(){var t=e.call(this)||this;return t._loadMap={},t._loadCount=0,t._totalCount=0,t}r=t.resource||(t.resource={}),s=Laya.Event,e=Laya.EventDispatcher,__extends(n,e),Object.defineProperty(n.prototype,"totalCount",{get:function(){return this._totalCount},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"loadCount",{get:function(){return this._loadCount},enumerable:!0,configurable:!0}),n.prototype.load=function(t,e){var i=this,n=this._loadMap[t];if(n)window.showStatInfo&&logd("加载重复资源",t);else{switch(e){case r.RefAsset.GENRAL:n=r.RefAsset.Get(t);break;case r.RefAsset.TEMPLET:n=r.RefTemplet.Get(t);break;default:return}n.retain(),n.parseComplete?this._loadCount++:n.once(s.COMPLETE,this,function(){i._loadCount++,i.event(s.CHANGED)}),this._loadMap[t]=n,this._totalCount++}},n.prototype.clear=function(t,e){void 0===e&&(e=!1);var i=this._loadMap[t];i&&(i.parseComplete&&this._loadCount--,i.release(e),delete this._loadMap[t],this._totalCount--)},i=n,r.PreLoad=i}(core=core||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var e,s,i,n,r,a;function l(t,e,i,n){void 0===e&&(e=!1);var r=s.call(this)||this;return r._refCount=0,r._timeOut=0,r._addTimeOut=0,r._parseComplete=!1,r._parseError=!1,r._isEventProgress=!1,r._timeCount=0,r._url=t,r._isEventProgress=e,r.init(n,i),r}e=t.resource||(t.resource={}),i=Laya.Handler,n=Laya.Event,r=Laya.Loader,s=Laya.EventDispatcher,__extends(l,s),l.Get=function(t,e,i,n,r){if(void 0===e&&(e=!0),void 0===i&&(i=!1),!t||!t.length)return null;if(window.showStatInfo&&!this._INIT){var s=Laya.LocalStorage.getItem("RefAsset_keys"),a=s&&JSON.parse(s)||[];this._refAsset_keys=a,this._INIT=!0}var o=t;t=Laya.URL.formatURL(t);var h=this._refMap[t];return e&&!h&&((h=new l(t,i,n,r)).addTimeOut=this.MAX_FREE_TIME,this.Set(t,h,o)),h},l.Set=function(t,e,i){this._refMap[t]=e,i&&(this._refAsset_objs[i]=i)},l.update=function(t){var e=Laya.timer.currTimer;if(!(-1!=t&&e<this._nextTimer)){this._nextTimer=e+1e3;var i=this._refMap;for(var n in i)i[n].update(e)&&(delete i[n],delete this._refAsset_objs[n])}},Object.defineProperty(l.prototype,"addTimeOut",{set:function(t){this._addTimeOut=t},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"parseComplete",{get:function(){return this._parseComplete},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"parseError",{get:function(){return this._parseError},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"url",{get:function(){return this._url},enumerable:!0,configurable:!0}),l.prototype.init=function(t,e){Laya.loader.getRes(this._url)?this.complete():(this._onProgressHandler=this._isEventProgress?i.create(this,this.onProgress,null,!1):null,Laya.loader.load(this._url,i.create(this,this.onComplete,[!0]),this._onProgressHandler,t,e))},l.prototype.onProgress=function(t){this.event(n.PROGRESS,[this,t])},l.prototype.onComplete=function(){var t=r.getRes(this._url);t?t.loadByRefAsset=!0:this._parseError=!0,this.complete()},l.prototype.complete=function(){this.onProgress(1),this._onProgressHandler&&(this._onProgressHandler.recover(),this._onProgressHandler=null),this._parseComplete=!0,this.setLocalStorage(),window.showStatInfo&&logd("加载完成",this._url),this.event(n.COMPLETE,this)},l.prototype.setLocalStorage=function(){if(window.showStatInfo){for(var t in l._refAsset_objs)t&&-1==l._refAsset_keys.indexOf(t)&&l._refAsset_keys.push(t);Laya.LocalStorage.setItem("RefAsset_keys",JSON.stringify(l._refAsset_keys))}},l.prototype.retain=function(){this._refCount++,this._timeOut=0},l.prototype.release=function(t){void 0===t&&(t=!1),this._refCount<=0||(this._refCount--,t?this.checkNow():0==this._refCount&&(this._timeOut=Laya.timer.currTimer+this._addTimeOut))},l.prototype.forceMoveRef=function(){this._refCount=0,this._timeOut=Laya.timer.currTimer+this._addTimeOut},l.prototype.update=function(t){var e=this._timeOut&&t>this._timeOut;return e&&(window.showStatInfo&&logd("清理资源"+this._url),this.destroy()),e},l.prototype.checkNow=function(){0==this._refCount&&(this._timeOut=Laya.timer.currTimer-1)},l.prototype.destroy=function(){this._onProgressHandler&&(this._onProgressHandler.recover(),this._onProgressHandler=null),Laya.loader.cancelLoadByUrl(this._url),Laya.loader.clearRes(this._url,!0)},l.GENRAL=1,l.BUFFER=2,l.TEMPLET=3,l.MAX_FREE_TIME=5e3,l._refMap={},l._refAsset_objs={},l._refAsset_keys=[],l._nextTimer=0,a=l,e.RefAsset=a}(core=core||{});__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var a,e,i;function o(t){return e.call(this,t)||this}a=t.resource||(t.resource={}),e=a.RefAsset,__extends(o,e),o.Get=function(t,e,i,n,r){void 0===e&&(e=!1),void 0===i&&(i=!1),t=Laya.URL.formatURL(t);var s=a.RefAsset.Get(t,!1,i,n,r);return s||(s=new o(t),a.RefAsset.Set(t,s)),s},o.prototype.init=function(){},o.prototype.playSound=function(t,e,i,n){Laya.SoundManager.playSound(t,e,void 0,i,n),this._timeOut=Laya.timer.currTimer+o.MAX_FREE_TIME1},o.prototype.stopSound=function(){Laya.SoundManager.stopSound(this.url),this.forceMoveRef()},o.prototype.destroy=function(){Laya.SoundManager.destroySound(this.url)},o.MAX_FREE_TIME1=2e4,i=o,a.RefSound=i}(core=core||{});var core;__extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var a,e,i,n,r;function o(t){return e.call(this,t)||this}a=t.resource||(t.resource={}),i=Laya.Event,n=laya.ani.bone.Templet,e=t.resource.RefAsset,__extends(o,e),o.Get=function(t,e,i,n,r){void 0===e&&(e=!1),void 0===i&&(i=!1),t=Laya.URL.formatURL(t);var s=a.RefAsset.Get(t,!1,i,n,r);return s||(s=new o(t),a.RefAsset.Set(t,s)),s},o.prototype.init=function(){var t=this;this._factory=new n,this._factory.once(i.COMPLETE,this,function(){t._parseComplete=!0,t.event(i.COMPLETE)}),this._factory.loadAni(this._url)},o.prototype.buildArmature=function(t){return this._factory.buildArmature(t)},o.prototype.destroy=function(){this._factory.destroy(),this._factory=null,e.prototype.destroy.call(this)},r=o,a.RefTemplet=r}(core=core||{});var EventDispatcher=Laya.EventDispatcher,MD5=core.utils.MD5,MathU=core.utils.MathU,ObjectPools=core.utils.ObjectPools,Endian=core.utils.Endian,ByteArray=core.utils.ByteArray,HanlderStruct=core.obj.HanlderStruct,AssetsLoader=core.resource.AssetsLoader,UnitTesting=function(){window.onload=function(){new core.obj.GuidObjectTable,new core.net.Network}};new UnitTesting,function(){"use strict";function rt(t){throw t}var st=void 0,at=!0,s=this;function a(t,e){var i,n=t.split("."),r=s;n[0]in r||!r.execScript||r.execScript("var "+n[0]);for(;n.length&&(i=n.shift());)n.length||e===st?r=r[i]?r[i]:r[i]={}:r[i]=e}var ot="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array&&"undefined"!=typeof DataView;function ht(t,e){this.index="number"==typeof e?e:0,this.i=0,this.buffer=t instanceof(ot?Uint8Array:Array)?t:new(ot?Uint8Array:Array)(32768),2*this.buffer.length<=this.index&&rt(Error("invalid index")),this.buffer.length<=this.index&&this.f()}ht.prototype.f=function(){var t,e=this.buffer,i=e.length,n=new(ot?Uint8Array:Array)(i<<1);if(ot)n.set(e);else for(t=0;t<i;++t)n[t]=e[t];return this.buffer=n},ht.prototype.d=function(t,e,i){var n,r=this.buffer,s=this.index,a=this.i,o=r[s];if(i&&1<e&&(t=8<e?(h[255&t]<<24|h[t>>>8&255]<<16|h[t>>>16&255]<<8|h[t>>>24&255])>>32-e:h[t]>>8-e),e+a<8)o=o<<e|t,a+=e;else for(n=0;n<e;++n)o=o<<1|t>>e-n-1&1,8==++a&&(a=0,r[s++]=h[o],o=0,s===r.length&&(r=this.f()));r[s]=o,this.buffer=r,this.i=a,this.index=s},ht.prototype.finish=function(){var t=this.buffer,e=this.index;return 0<this.i&&(t[e]<<=8-this.i,t[e]=h[t[e]],e++),ot?t.subarray(0,e):(t.length=e,t)};var t,e=new(ot?Uint8Array:Array)(256);for(t=0;t<256;++t){for(var i=r=t,n=7,r=r>>>1;r;r>>>=1)i<<=1,i|=1&r,--n;e[t]=(i<<n&255)>>>0}var h=e;function u(t){this.buffer=new(ot?Uint16Array:Array)(2*t),this.length=0}function c(t){var e,i,n,r,s,a,o,h,l,u,c=t.length,f=0,_=Number.POSITIVE_INFINITY;for(h=0;h<c;++h)t[h]>f&&(f=t[h]),t[h]<_&&(_=t[h]);for(e=1<<f,i=new(ot?Uint32Array:Array)(e),n=1,r=0,s=2;n<=f;){for(h=0;h<c;++h)if(t[h]===n){for(o=r,l=a=0;l<n;++l)a=a<<1|1&o,o>>=1;for(u=n<<16|h,l=a;l<e;l+=s)i[l]=u;++r}++n,r<<=1,s<<=1}return[i,f,_]}function o(t,e){this.h=lt,this.w=0,this.input=ot&&t instanceof Array?new Uint8Array(t):t,this.b=0,e&&(e.lazy&&(this.w=e.lazy),"number"==typeof e.compressionType&&(this.h=e.compressionType),e.outputBuffer&&(this.a=ot&&e.outputBuffer instanceof Array?new Uint8Array(e.outputBuffer):e.outputBuffer),"number"==typeof e.outputIndex&&(this.b=e.outputIndex)),this.a||(this.a=new(ot?Uint8Array:Array)(32768))}u.prototype.getParent=function(t){return 2*((t-2)/4|0)},u.prototype.push=function(t,e){var i,n,r,s=this.buffer;for(i=this.length,s[this.length++]=e,s[this.length++]=t;0<i&&(n=this.getParent(i),s[i]>s[n]);)r=s[i],s[i]=s[n],s[n]=r,r=s[i+1],s[i+1]=s[n+1],s[n+1]=r,i=n;return this.length},u.prototype.pop=function(){var t,e,i,n,r,s=this.buffer;for(e=s[0],t=s[1],this.length-=2,s[0]=s[this.length],s[1]=s[this.length+1],r=0;!((n=2*r+2)>=this.length)&&(n+2<this.length&&s[n+2]>s[n]&&(n+=2),s[n]>s[r]);)i=s[r],s[r]=s[n],s[n]=i,i=s[r+1],s[r+1]=s[n+1],s[n+1]=i,r=n;return{index:t,value:e,length:this.length}};var l,lt=2,f={NONE:0,r:1,k:lt,O:3},ut=[];for(l=0;l<288;l++)switch(at){case l<=143:ut.push([l+48,8]);break;case l<=255:ut.push([l-144+400,9]);break;case l<=279:ut.push([l-256+0,7]);break;case l<=287:ut.push([l-280+192,8]);break;default:rt("invalid literal: "+l)}function _(t,e){this.length=t,this.H=e}o.prototype.j=function(){var t,e,i,n,r=this.input;switch(this.h){case 0:for(i=0,n=r.length;i<n;){var s,a,o,h=e=ot?r.subarray(i,i+65535):r.slice(i,i+65535),l=(i+=e.length)===n,u=st,c=st,f=this.a,_=this.b;if(ot){for(f=new Uint8Array(this.a.buffer);f.length<=_+h.length+5;)f=new Uint8Array(f.length<<1);f.set(this.a)}if(s=l?1:0,f[_++]=0|s,o=65536+~(a=h.length)&65535,f[_++]=255&a,f[_++]=a>>>8&255,f[_++]=255&o,f[_++]=o>>>8&255,ot)f.set(h,_),_+=h.length,f=f.subarray(0,_);else{for(u=0,c=h.length;u<c;++u)f[_++]=h[u];f.length=_}this.b=_,this.a=f}break;case 1:var d=new ht(ot?new Uint8Array(this.a.buffer):this.a,this.b);d.d(1,1,at),d.d(1,2,at);var p,v,g,m=ct(this,r);for(p=0,v=m.length;p<v;p++)if(g=m[p],ht.prototype.d.apply(d,ut[g]),256<g)d.d(m[++p],m[++p],at),d.d(m[++p],5),d.d(m[++p],m[++p],at);else if(256===g)break;this.a=d.finish(),this.b=this.a.length;break;case lt:var y,b,x,w,T,S,C,E,A,M,I,L,P,k,D,R=new ht(ot?new Uint8Array(this.a.buffer):this.a,this.b),N=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],O=Array(19);for(y=lt,R.d(1,1,at),R.d(y,2,at),b=ct(this,r),C=_t(S=ft(this.M,15)),A=_t(E=ft(this.L,7)),x=286;257<x&&0===S[x-1];x--);for(w=30;1<w&&0===E[w-1];w--);var B,F,U,G,V,W,z=x,H=w,Y=new(ot?Uint32Array:Array)(z+H),j=new(ot?Uint32Array:Array)(316),X=new(ot?Uint8Array:Array)(19);for(B=F=0;B<z;B++)Y[F++]=S[B];for(B=0;B<H;B++)Y[F++]=E[B];if(!ot)for(B=0,G=X.length;B<G;++B)X[B]=0;for(B=V=0,G=Y.length;B<G;B+=F){for(F=1;B+F<G&&Y[B+F]===Y[B];++F);if(U=F,0===Y[B])if(U<3)for(;0<U--;)X[j[V++]=0]++;else for(;0<U;)U-3<(W=U<138?U:138)&&W<U&&(W=U-3),W<=10?(j[V++]=17,j[V++]=W-3,X[17]++):(j[V++]=18,j[V++]=W-11,X[18]++),U-=W;else if(j[V++]=Y[B],X[Y[B]]++,--U<3)for(;0<U--;)j[V++]=Y[B],X[Y[B]]++;else for(;0<U;)U-3<(W=U<6?U:6)&&W<U&&(W=U-3),j[V++]=16,j[V++]=W-3,X[16]++,U-=W}for(t=ot?j.subarray(0,V):j.slice(0,V),M=ft(X,7),k=0;k<19;k++)O[k]=M[N[k]];for(T=19;4<T&&0===O[T-1];T--);for(I=_t(M),R.d(x-257,5,at),R.d(w-1,5,at),R.d(T-4,4,at),k=0;k<T;k++)R.d(O[k],3,at);for(k=0,D=t.length;k<D;k++)if(L=t[k],R.d(I[L],M[L],at),16<=L){switch(k++,L){case 16:P=2;break;case 17:P=3;break;case 18:P=7;break;default:rt("invalid code: "+L)}R.d(t[k],P,at)}var $,K,q,Z,Q,J,tt,et,it=[C,S],nt=[A,E];for(Q=it[0],J=it[1],tt=nt[0],et=nt[1],$=0,K=b.length;$<K;++$)if(q=b[$],R.d(Q[q],J[q],at),256<q)R.d(b[++$],b[++$],at),Z=b[++$],R.d(tt[Z],et[Z],at),R.d(b[++$],b[++$],at);else if(256===q)break;this.a=R.finish(),this.b=this.a.length;break;default:rt("invalid compression type")}return this.a};var d=function(){function t(t){switch(at){case 3===t:return[257,t-3,0];case 4===t:return[258,t-4,0];case 5===t:return[259,t-5,0];case 6===t:return[260,t-6,0];case 7===t:return[261,t-7,0];case 8===t:return[262,t-8,0];case 9===t:return[263,t-9,0];case 10===t:return[264,t-10,0];case t<=12:return[265,t-11,1];case t<=14:return[266,t-13,1];case t<=16:return[267,t-15,1];case t<=18:return[268,t-17,1];case t<=22:return[269,t-19,2];case t<=26:return[270,t-23,2];case t<=30:return[271,t-27,2];case t<=34:return[272,t-31,2];case t<=42:return[273,t-35,3];case t<=50:return[274,t-43,3];case t<=58:return[275,t-51,3];case t<=66:return[276,t-59,3];case t<=82:return[277,t-67,4];case t<=98:return[278,t-83,4];case t<=114:return[279,t-99,4];case t<=130:return[280,t-115,4];case t<=162:return[281,t-131,5];case t<=194:return[282,t-163,5];case t<=226:return[283,t-195,5];case t<=257:return[284,t-227,5];case 258===t:return[285,t-258,0];default:rt("invalid length: "+t)}}var e,i,n=[];for(e=3;e<=258;e++)i=t(e),n[e]=i[2]<<24|i[1]<<16|i[0];return n}(),y=ot?new Uint32Array(d):d;function ct(t,e){function i(t,e){var i,n,r,s,a=t.H,o=[],h=0;switch(i=y[t.length],o[h++]=65535&i,o[h++]=i>>16&255,o[h++]=i>>24,at){case 1===a:n=[0,a-1,0];break;case 2===a:n=[1,a-2,0];break;case 3===a:n=[2,a-3,0];break;case 4===a:n=[3,a-4,0];break;case a<=6:n=[4,a-5,1];break;case a<=8:n=[5,a-7,1];break;case a<=12:n=[6,a-9,2];break;case a<=16:n=[7,a-13,2];break;case a<=24:n=[8,a-17,3];break;case a<=32:n=[9,a-25,3];break;case a<=48:n=[10,a-33,4];break;case a<=64:n=[11,a-49,4];break;case a<=96:n=[12,a-65,5];break;case a<=128:n=[13,a-97,5];break;case a<=192:n=[14,a-129,6];break;case a<=256:n=[15,a-193,6];break;case a<=384:n=[16,a-257,7];break;case a<=512:n=[17,a-385,7];break;case a<=768:n=[18,a-513,8];break;case a<=1024:n=[19,a-769,8];break;case a<=1536:n=[20,a-1025,9];break;case a<=2048:n=[21,a-1537,9];break;case a<=3072:n=[22,a-2049,10];break;case a<=4096:n=[23,a-3073,10];break;case a<=6144:n=[24,a-4097,11];break;case a<=8192:n=[25,a-6145,11];break;case a<=12288:n=[26,a-8193,12];break;case a<=16384:n=[27,a-12289,12];break;case a<=24576:n=[28,a-16385,13];break;case a<=32768:n=[29,a-24577,13];break;default:rt("invalid distance")}for(i=n,o[h++]=i[0],o[h++]=i[1],o[h++]=i[2],r=0,s=o.length;r<s;++r)_[d++]=o[r];v[o[0]]++,g[o[3]]++,p=t.length+e-1,u=null}var n,r,s,a,o,h,l,u,c,f={},_=ot?new Uint16Array(2*e.length):[],d=0,p=0,v=new(ot?Uint32Array:Array)(286),g=new(ot?Uint32Array:Array)(30),m=t.w;if(!ot){for(s=0;s<=285;)v[s++]=0;for(s=0;s<=29;)g[s++]=0}for(v[256]=1,n=0,r=e.length;n<r;++n){for(s=o=0,a=3;s<a&&n+s!==r;++s)o=o<<8|e[n+s];if(f[o]===st&&(f[o]=[]),h=f[o],!(0<p--)){for(;0<h.length&&32768<n-h[0];)h.shift();if(r<=n+3){for(u&&i(u,-1),s=0,a=r-n;s<a;++s)c=e[n+s],_[d++]=c,++v[c];break}0<h.length?(l=b(e,n,h),u?u.length<l.length?(c=e[n-1],_[d++]=c,++v[c],i(l,0)):i(u,-1):l.length<m?u=l:i(l,0)):u?i(u,-1):(c=e[n],_[d++]=c,++v[c])}h.push(n)}return _[d++]=256,v[256]++,t.M=v,t.L=g,ot?_.subarray(0,d):_}function b(t,e,i){var n,r,s,a,o,h,l=0,u=t.length;a=0,h=i.length;t:for(;a<h;a++){if(n=i[h-a-1],(s=3)<l){for(o=l;3<o;o--)if(t[n+o-1]!==t[e+o-1])continue t;s=l}for(;s<258&&e+s<u&&t[n+s]===t[e+s];)++s;if(l<s&&(r=n,l=s),258===s)break}return new _(l,e-r)}function ft(t,e){var i,n,r,s,a,o=t.length,h=new u(572),l=new(ot?Uint8Array:Array)(o);if(!ot)for(s=0;s<o;s++)l[s]=0;for(s=0;s<o;++s)0<t[s]&&h.push(s,t[s]);if(i=Array(h.length/2),n=new(ot?Uint32Array:Array)(h.length/2),1===i.length)return l[h.pop().index]=1,l;for(s=0,a=h.length/2;s<a;++s)i[s]=h.pop(),n[s]=i[s].value;for(r=function(t,i,e){function n(t){var e=_[t][d[t]];e===i?(n(t+1),n(t+1)):--c[e],++d[t]}var r,s,a,o,h,l=new(ot?Uint16Array:Array)(e),u=new(ot?Uint8Array:Array)(e),c=new(ot?Uint8Array:Array)(i),f=Array(e),_=Array(e),d=Array(e),p=(1<<e)-i,v=1<<e-1;for(l[e-1]=i,s=0;s<e;++s)p<v?u[s]=0:(u[s]=1,p-=v),p<<=1,l[e-2-s]=(l[e-1-s]/2|0)+i;for(l[0]=u[0],f[0]=Array(l[0]),_[0]=Array(l[0]),s=1;s<e;++s)l[s]>2*l[s-1]+u[s]&&(l[s]=2*l[s-1]+u[s]),f[s]=Array(l[s]),_[s]=Array(l[s]);for(r=0;r<i;++r)c[r]=e;for(a=0;a<l[e-1];++a)f[e-1][a]=t[a],_[e-1][a]=a;for(r=0;r<e;++r)d[r]=0;for(1===u[e-1]&&(--c[0],++d[e-1]),s=e-2;0<=s;--s){for(o=r=0,h=d[s+1],a=0;a<l[s];a++)(o=f[s+1][h]+f[s+1][h+1])>t[r]?(f[s][a]=o,_[s][a]=i,h+=2):(f[s][a]=t[r],_[s][a]=r,++r);d[s]=0,1===u[s]&&n(s)}return c}(n,n.length,e),s=0,a=i.length;s<a;++s)l[i[s].index]=r[s];return l}function _t(t){var e,i,n,r,s=new(ot?Uint16Array:Array)(t.length),a=[],o=[],h=0;for(e=0,i=t.length;e<i;e++)a[t[e]]=1+(0|a[t[e]]);for(e=1,i=16;e<=i;e++)o[e]=h,h+=0|a[e],h<<=1;for(e=0,i=t.length;e<i;e++)for(h=o[t[e]],o[t[e]]+=1,n=s[e]=0,r=t[e];n<r;n++)s[e]=s[e]<<1|1&h,h>>>=1;return s}function p(t,e){switch(this.l=[],this.m=32768,this.e=this.g=this.c=this.q=0,this.input=ot?new Uint8Array(t):t,this.s=!1,this.n=g,this.C=!1,(e||(e={},0))&&(e.index&&(this.c=e.index),e.bufferSize&&(this.m=e.bufferSize),e.bufferType&&(this.n=e.bufferType),e.resize&&(this.C=e.resize)),this.n){case v:this.b=32768,this.a=new(ot?Uint8Array:Array)(32768+this.m+258);break;case g:this.b=0,this.a=new(ot?Uint8Array:Array)(this.m),this.f=this.K,this.t=this.I,this.o=this.J;break;default:rt(Error("invalid inflate mode"))}}var v=0,g=1,m=v,x=g;p.prototype.p=function(){for(;!this.s;){var t=G(this,3);switch(1&t&&(this.s=at),t>>>=1){case 0:var e=this.input,i=this.c,n=this.a,r=this.b,s=e.length,a=st,o=n.length,h=st;switch(this.e=this.g=0,s<=i+1&&rt(Error("invalid uncompressed block header: LEN")),a=e[i++]|e[i++]<<8,s<=i+1&&rt(Error("invalid uncompressed block header: NLEN")),a===~(e[i++]|e[i++]<<8)&&rt(Error("invalid uncompressed block header: length verify")),i+a>e.length&&rt(Error("input buffer is broken")),this.n){case v:for(;r+a>n.length;){if(a-=h=o-r,ot)n.set(e.subarray(i,i+h),r),r+=h,i+=h;else for(;h--;)n[r++]=e[i++];this.b=r,n=this.f(),r=this.b}break;case g:for(;r+a>n.length;)n=this.f({v:2});break;default:rt(Error("invalid inflate mode"))}if(ot)n.set(e.subarray(i,i+a),r),r+=a,i+=a;else for(;a--;)n[r++]=e[i++];this.c=i,this.b=r,this.a=n;break;case 1:this.o(B,U);break;case 2:W(this);break;default:rt(Error("unknown BTYPE: "+t))}}return this.t()};var w,T,S=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],C=ot?new Uint16Array(S):S,E=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],A=ot?new Uint16Array(E):E,M=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],I=ot?new Uint8Array(M):M,L=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],P=ot?new Uint16Array(L):L,k=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],D=ot?new Uint8Array(k):k,R=new(ot?Uint8Array:Array)(288);for(w=0,T=R.length;w<T;++w)R[w]=w<=143?8:w<=255?9:w<=279?7:8;var N,O,B=c(R),F=new(ot?Uint8Array:Array)(30);for(N=0,O=F.length;N<O;++N)F[N]=5;var U=c(F);function G(t,e){for(var i,n=t.g,r=t.e,s=t.input,a=t.c,o=s.length;r<e;)o<=a&&rt(Error("input buffer is broken")),n|=s[a++]<<r,r+=8;return i=n&(1<<e)-1,t.g=n>>>e,t.e=r-e,t.c=a,i}function V(t,e){for(var i,n,r=t.g,s=t.e,a=t.input,o=t.c,h=a.length,l=e[0],u=e[1];s<u&&!(h<=o);)r|=a[o++]<<s,s+=8;return n=(i=l[r&(1<<u)-1])>>>16,t.g=r>>n,t.e=s-n,t.c=o,65535&i}function W(t){function e(t,e,i){var n,r,s,a=this.z;for(s=0;s<t;)switch(n=V(this,e),n){case 16:for(r=3+G(this,2);r--;)i[s++]=a;break;case 17:for(r=3+G(this,3);r--;)i[s++]=0;a=0;break;case 18:for(r=11+G(this,7);r--;)i[s++]=0;a=0;break;default:a=i[s++]=n}return this.z=a,i}var i,n,r,s,a=G(t,5)+257,o=G(t,5)+1,h=G(t,4)+4,l=new(ot?Uint8Array:Array)(C.length);for(s=0;s<h;++s)l[C[s]]=G(t,3);if(!ot)for(s=h,h=l.length;s<h;++s)l[C[s]]=0;i=c(l),n=new(ot?Uint8Array:Array)(a),r=new(ot?Uint8Array:Array)(o),t.z=0,t.o(c(e.call(t,a,i,n)),c(e.call(t,o,i,r)))}function z(t){if("string"==typeof t){var e,i,n=t.split("");for(e=0,i=n.length;e<i;e++)n[e]=(255&n[e].charCodeAt(0))>>>0;t=n}for(var r,s=1,a=0,o=t.length,h=0;0<o;){for(o-=r=1024<o?1024:o;a+=s+=t[h++],--r;);s%=65521,a%=65521}return(a<<16|s)>>>0}function H(t,e){var i,n;switch(this.input=t,this.c=0,(e||(e={},0))&&(e.index&&(this.c=e.index),e.verify&&(this.N=e.verify)),i=t[this.c++],n=t[this.c++],15&i){case Y:this.method=Y;break;default:rt(Error("unsupported compression method"))}0!=((i<<8)+n)%31&&rt(Error("invalid fcheck flag:"+((i<<8)+n)%31)),32&n&&rt(Error("fdict flag is not supported")),this.B=new p(t,{index:this.c,bufferSize:e.bufferSize,bufferType:e.bufferType,resize:e.resize})}p.prototype.o=function(t,e){var i=this.a,n=this.b;this.u=t;for(var r,s,a,o,h=i.length-258;256!==(r=V(this,t));)if(r<256)h<=n&&(this.b=n,i=this.f(),n=this.b),i[n++]=r;else for(o=A[s=r-257],0<I[s]&&(o+=G(this,I[s])),r=V(this,e),a=P[r],0<D[r]&&(a+=G(this,D[r])),h<=n&&(this.b=n,i=this.f(),n=this.b);o--;)i[n]=i[n++-a];for(;8<=this.e;)this.e-=8,this.c--;this.b=n},p.prototype.J=function(t,e){var i=this.a,n=this.b;this.u=t;for(var r,s,a,o,h=i.length;256!==(r=V(this,t));)if(r<256)h<=n&&(h=(i=this.f()).length),i[n++]=r;else for(o=A[s=r-257],0<I[s]&&(o+=G(this,I[s])),r=V(this,e),a=P[r],0<D[r]&&(a+=G(this,D[r])),h<n+o&&(h=(i=this.f()).length);o--;)i[n]=i[n++-a];for(;8<=this.e;)this.e-=8,this.c--;this.b=n},p.prototype.f=function(){var t,e,i=new(ot?Uint8Array:Array)(this.b-32768),n=this.b-32768,r=this.a;if(ot)i.set(r.subarray(32768,i.length));else for(t=0,e=i.length;t<e;++t)i[t]=r[t+32768];if(this.l.push(i),this.q+=i.length,ot)r.set(r.subarray(n,32768+n));else for(t=0;t<32768;++t)r[t]=r[n+t];return this.b=32768,r},p.prototype.K=function(t){var e,i,n,r=this.input.length/this.c+1|0,s=this.input,a=this.a;return t&&("number"==typeof t.v&&(r=t.v),"number"==typeof t.G&&(r+=t.G)),i=r<2?(n=(s.length-this.c)/this.u[2]/2*258|0)<a.length?a.length+n:a.length<<1:a.length*r,ot?(e=new Uint8Array(i)).set(a):e=a,this.a=e},p.prototype.t=function(){var t,e,i,n,r,s=0,a=this.a,o=this.l,h=new(ot?Uint8Array:Array)(this.q+(this.b-32768));if(0===o.length)return ot?this.a.subarray(32768,this.b):this.a.slice(32768,this.b);for(e=0,i=o.length;e<i;++e)for(n=0,r=(t=o[e]).length;n<r;++n)h[s++]=t[n];for(e=32768,i=this.b;e<i;++e)h[s++]=a[e];return this.l=[],this.buffer=h},p.prototype.I=function(){var t,e=this.b;return ot?this.C?(t=new Uint8Array(e)).set(this.a.subarray(0,e)):t=this.a.subarray(0,e):(this.a.length>e&&(this.a.length=e),t=this.a),this.buffer=t},H.prototype.p=function(){var t,e=this.input;return t=this.B.p(),this.c=this.B.c,this.N&&((e[this.c++]<<24|e[this.c++]<<16|e[this.c++]<<8|e[this.c++])>>>0!==z(t)&&rt(Error("invalid adler-32 checksum"))),t};var Y=8;function j(t,e){this.input=t,this.a=new(ot?Uint8Array:Array)(32768),this.h=X.k;var i,n={};for(i in(e||(e={},0))&&"number"==typeof e.compressionType&&(this.h=e.compressionType),e)n[i]=e[i];n.outputBuffer=this.a,this.A=new o(this.input,n)}var X=f;function $(t,e){var i,n,r,s;if(Object.keys)i=Object.keys(e);else for(n in i=[],r=0,e)i[r++]=n;for(r=0,s=i.length;r<s;++r)a(t+"."+(n=i[r]),e[n])}j.prototype.j=function(){var t,e,i,n,r,s,a,o=0;switch(a=this.a,t=Y){case Y:e=Math.LOG2E*Math.log(32768)-8;break;default:rt(Error("invalid compression method"))}switch(i=e<<4|t,a[o++]=i,t){case Y:switch(this.h){case X.NONE:r=0;break;case X.r:r=1;break;case X.k:r=2;break;default:rt(Error("unsupported compression type"))}break;default:rt(Error("invalid compression method"))}return n=r<<6|0,a[o++]=n|31-(256*i+n)%31,s=z(this.input),this.A.b=o,o=(a=this.A.j()).length,ot&&((a=new Uint8Array(a.buffer)).length<=o+4&&(this.a=new Uint8Array(a.length+4),this.a.set(a),a=this.a),a=a.subarray(0,o+4)),a[o++]=s>>24&255,a[o++]=s>>16&255,a[o++]=s>>8&255,a[o++]=255&s,a},a("Zlib.Inflate",H),a("Zlib.Inflate.prototype.decompress",H.prototype.p),$("Zlib.Inflate.BufferType",{ADAPTIVE:x,BLOCK:m}),a("Zlib.Deflate",j),a("Zlib.Deflate.compress",function(t,e){return new j(t,e).j()}),a("Zlib.Deflate.prototype.compress",j.prototype.j),$("Zlib.Deflate.CompressionType",{NONE:X.NONE,FIXED:X.r,DYNAMIC:X.k})}.call(this);!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("VConsole",[],e):"object"==typeof exports?exports.VConsole=e():t.VConsole=e()}(window,function(){return function(i){var n={};function r(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}return r.m=i,r.c=n,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=6)}([function(t,e,i){var n,r,s;r=[e],void 0===(s="function"==typeof(n=function(t){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function e(t){return"[object Number]"==Object.prototype.toString.call(t)}function i(t){return"[object String]"==Object.prototype.toString.call(t)}function h(t){return"[object Array]"==Object.prototype.toString.call(t)}function r(t){return"[object Boolean]"==Object.prototype.toString.call(t)}function s(t){return void 0===t}function a(t){return null===t}function l(t){return"[object Symbol]"==Object.prototype.toString.call(t)}function u(t){return!("[object Object]"!=Object.prototype.toString.call(t)&&(e(t)||i(t)||r(t)||h(t)||a(t)||c(t)||s(t)||l(t)))}function c(t){return"[object Function]"==Object.prototype.toString.call(t)}function o(t){var e=Object.prototype.toString.call(t);return"[object global]"==e||"[object Window]"==e||"[object DOMWindow]"==e}function f(t){if(!u(t)&&!h(t))return[];if(h(t)){var i=[];return t.forEach(function(t,e){i.push(e)}),i}return Object.getOwnPropertyNames(t).sort()}Object.defineProperty(t,"__esModule",{value:!0}),t.getDate=function(t){var e=t>0?new Date(t):new Date,i=e.getDate()<10?"0"+e.getDate():e.getDate(),n=e.getMonth()<9?"0"+(e.getMonth()+1):e.getMonth()+1,r=e.getFullYear(),s=e.getHours()<10?"0"+e.getHours():e.getHours(),a=e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),o=e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds(),h=e.getMilliseconds()<10?"0"+e.getMilliseconds():e.getMilliseconds();return h<100&&(h="0"+h),{time:+e,year:r,month:n,day:i,hour:s,minute:a,second:o,millisecond:h}},t.isNumber=e,t.isString=i,t.isArray=h,t.isBoolean=r,t.isUndefined=s,t.isNull=a,t.isSymbol=l,t.isObject=u,t.isFunction=c,t.isElement=function(t){return"object"===("undefined"==typeof HTMLElement?"undefined":n(HTMLElement))?t instanceof HTMLElement:t&&"object"===n(t)&&null!==t&&1===t.nodeType&&"string"==typeof t.nodeName},t.isWindow=o,t.isPlainObject=function(t){var e,i=Object.prototype.hasOwnProperty;if(!t||"object"!==n(t)||t.nodeType||o(t))return!1;try{if(t.constructor&&!i.call(t,"constructor")&&!i.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}for(e in t);return void 0===e||i.call(t,e)},t.htmlEncode=function(t){return document.createElement("a").appendChild(document.createTextNode(t)).parentNode.innerHTML},t.JSONStringify=function(t){if(!u(t)&&!h(t))return JSON.stringify(t);var e="{",i="}";h(t)&&(e="[",i="]");for(var n=e,r=f(t),s=0;s<r.length;s++){var a=r[s],o=t[a];try{h(t)||(u(a)||h(a)||l(a)?n+=Object.prototype.toString.call(a):n+=a,n+=": "),h(o)?n+="Array["+o.length+"]":u(o)||l(o)||c(o)?n+=Object.prototype.toString.call(o):n+=JSON.stringify(o),s<r.length-1&&(n+=", ")}catch(t){continue}}return n+=i},t.getObjAllKeys=f,t.getObjName=function(t){return Object.prototype.toString.call(t).replace("[object ","").replace("]","")},t.setStorage=function(t,e){window.localStorage&&(t="vConsole_"+t,localStorage.setItem(t,e))},t.getStorage=function(t){if(window.localStorage)return t="vConsole_"+t,localStorage.getItem(t)}})?n.apply(e,r):n)||(t.exports=s)},function(r,a,t){var e,i,n;i=[a,t(0),t(10)],void 0===(n="function"==typeof(e=function(t,s,e){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,e=(i=e)&&i.__esModule?i:{default:i};var o={one:function(t,e){return e?e.querySelector(t):document.querySelector(t)},all:function(t,e){var i,n=[];return(i=e?e.querySelectorAll(t):document.querySelectorAll(t))&&i.length>0&&(n=Array.prototype.slice.call(i)),n},addClass:function(t,e){if(t){(0,s.isArray)(t)||(t=[t]);for(var i=0;i<t.length;i++){var n=t[i].className||"",r=n.split(" ");r.indexOf(e)>-1||(r.push(e),t[i].className=r.join(" "))}}},removeClass:function(t,e){if(t){(0,s.isArray)(t)||(t=[t]);for(var i=0;i<t.length;i++){for(var n=t[i].className.split(" "),r=0;r<n.length;r++)n[r]==e&&(n[r]="");t[i].className=n.join(" ").trim()}}},hasClass:function(t,e){if(!t)return!1;for(var i=t.className.split(" "),n=0;n<i.length;n++)if(i[n]==e)return!0;return!1},bind:function(t,e,i,n){if(t){void 0===n&&(n=!1),(0,s.isArray)(t)||(t=[t]);for(var r=0;r<t.length;r++)t[r].addEventListener(e,i,n)}},delegate:function(r,t,s,a){r&&r.addEventListener(t,function(t){var e=o.all(s,r);if(e)t:for(var i=0;i<e.length;i++)for(var n=t.target;n;){if(n==e[i]){a.call(n,t);break t}if((n=n.parentNode)==r)break}},!1)}};o.render=e.default;var n=o;t.default=n,r.exports=a.default})?e.apply(a,i):e)||(r.exports=n)},function(i,n,t){var e,r,s;r=[n],void 0===(s="function"==typeof(e=function(t){"use strict";function r(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e=function(){function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"newPlugin";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),this.id=t,this.name=e,this.isReady=!1,this.eventList={}}return t=i,(e=[{key:"on",value:function(t,e){return this.eventList[t]=e,this}},{key:"trigger",value:function(t,e){if("function"==typeof this.eventList[t])this.eventList[t].call(this,e);else{var i="on"+t.charAt(0).toUpperCase()+t.slice(1);"function"==typeof this[i]&&this[i].call(this,e)}return this}},{key:"id",get:function(){return this._id},set:function(t){if(!t)throw"Plugin ID cannot be empty";this._id=t.toLowerCase()}},{key:"name",get:function(){return this._name},set:function(t){if(!t)throw"Plugin name cannot be empty";this._name=t}},{key:"vConsole",get:function(){return this._vConsole||void 0},set:function(t){if(!t)throw"vConsole cannot be empty";this._vConsole=t}}])&&r(t.prototype,e),n&&r(t,n),i;var t,e,n}();t.default=e,i.exports=n.default})?e.apply(n,r):e)||(i.exports=s)},function(t,e,i){"use strict";t.exports=function(i){var a=[];return a.toString=function(){return this.map(function(t){var e=function(t,e){var i=t[1]||"",n=t[3];if(!n)return i;if(e&&"function"==typeof btoa){var r=(a=n,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"),s=n.sources.map(function(t){return"/*# sourceURL="+n.sourceRoot+t+" */"});return[i].concat(s).concat([r]).join("\n")}var a;return[i].join("\n")}(t,i);return t[2]?"@media "+t[2]+"{"+e+"}":e}).join("")},a.i=function(t,e){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},n=0;n<this.length;n++){var r=this[n][0];null!=r&&(i[r]=!0)}for(n=0;n<t.length;n++){var s=t[n];null!=s[0]&&i[s[0]]||(e&&!s[2]?s[2]=e:e&&(s[2]="("+s[2]+") and ("+e+")"),a.push(s))}},a}},function(t,e,n){var i,r,h={},s=(i=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===r&&(r=i.apply(this,arguments)),r}),a=function(t){var n={};return function(t,e){if("function"==typeof t)return t();if(void 0===n[t]){var i=function(t,e){return e?e.querySelector(t):document.querySelector(t)}.call(this,t,e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}n[t]=i}return n[t]}}(),o=null,l=0,u=[],c=n(13);function f(t,e){for(var i=0;i<t.length;i++){var n=t[i],r=h[n.id];if(r){r.refs++;for(var s=0;s<r.parts.length;s++)r.parts[s](n.parts[s]);for(;s<n.parts.length;s++)r.parts.push(m(n.parts[s],e))}else{var a=[];for(s=0;s<n.parts.length;s++)a.push(m(n.parts[s],e));h[n.id]={id:n.id,refs:1,parts:a}}}}function _(t,e){for(var i=[],n={},r=0;r<t.length;r++){var s=t[r],a=e.base?s[0]+e.base:s[0],o={css:s[1],media:s[2],sourceMap:s[3]};n[a]?n[a].parts.push(o):i.push(n[a]={id:a,parts:[o]})}return i}function d(t,e){var i=a(t.insertInto);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=u[u.length-1];if("top"===t.insertAt)n?n.nextSibling?i.insertBefore(e,n.nextSibling):i.appendChild(e):i.insertBefore(e,i.firstChild),u.push(e);else if("bottom"===t.insertAt)i.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var r=a(t.insertAt.before,i);i.insertBefore(e,r)}}function p(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=u.indexOf(t);e>=0&&u.splice(e,1)}function v(t){var e=document.createElement("style");if(void 0===t.attrs.type&&(t.attrs.type="text/css"),void 0===t.attrs.nonce){var i=function(){0;return n.nc}();i&&(t.attrs.nonce=i)}return g(e,t.attrs),d(t,e),e}function g(e,i){Object.keys(i).forEach(function(t){e.setAttribute(t,i[t])})}function m(e,t){var i,n,r,s;if(t.transform&&e.css){if(!(s="function"==typeof t.transform?t.transform(e.css):t.transform.default(e.css)))return function(){};e.css=s}if(t.singleton){var a=l++;i=o||(o=v(t)),n=x.bind(null,i,a,!1),r=x.bind(null,i,a,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(i=function(t){var e=document.createElement("link");return void 0===t.attrs.type&&(t.attrs.type="text/css"),t.attrs.rel="stylesheet",g(e,t.attrs),d(t,e),e}(t),n=function(t,e,i){var n=i.css,r=i.sourceMap,s=void 0===e.convertToAbsoluteUrls&&r;(e.convertToAbsoluteUrls||s)&&(n=c(n));r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var a=new Blob([n],{type:"text/css"}),o=t.href;t.href=URL.createObjectURL(a),o&&URL.revokeObjectURL(o)}.bind(null,i,t),r=function(){p(i),i.href&&URL.revokeObjectURL(i.href)}):(i=v(t),n=function(t,e){var i=e.css,n=e.media;n&&t.setAttribute("media",n);if(t.styleSheet)t.styleSheet.cssText=i;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(i))}}.bind(null,i),r=function(){p(i)});return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else r()}}t.exports=function(t,a){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(a=a||{}).attrs="object"==typeof a.attrs?a.attrs:{},a.singleton||"boolean"==typeof a.singleton||(a.singleton=s()),a.insertInto||(a.insertInto="head"),a.insertAt||(a.insertAt="bottom");var o=_(t,a);return f(o,a),function(t){for(var e=[],i=0;i<o.length;i++){var n=o[i];(r=h[n.id]).refs--,e.push(r)}t&&f(_(t,a),a);for(i=0;i<e.length;i++){var r;if(0===(r=e[i]).refs){for(var s=0;s<r.parts.length;s++)r.parts[s]();delete h[r.id]}}}};var y,b=(y=[],function(t,e){return y[t]=e,y.filter(Boolean).join("\n")});function x(t,e,i,n){var r=i?"":n.css;if(t.styleSheet)t.styleSheet.cssText=b(e,r);else{var s=document.createTextNode(r),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(s,a[e]):t.appendChild(s)}}},function(m,y,t){var e,i,n;i=[y,t(0),t(1),t(2),t(20),t(21),t(22)],void 0===(n="function"==typeof(e=function(t,d,p,e,a,v,g){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function h(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,d=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,i):{};n.get||n.set?Object.defineProperty(e,i,n):e[i]=t[i]}return e.default=t,e}(d),p=i(p),e=i(e),a=i(a),v=i(v),g=i(g);var c=1e3,f=[],_={},n=function(t){function s(){var t,e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s);for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return e=h(this,(t=l(s)).call.apply(t,[this].concat(n))),f.push(e.id),e.tplTabbox="",e.allowUnformattedLog=!0,e.isReady=!1,e.isShow=!1,e.$tabbox=null,e.console={},e.logList=[],e.isInBottom=!0,e.maxLogNumber=c,e.logNumber=0,e.mockConsole(),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(s,t),e=s,(i=[{key:"onInit",value:function(){this.$tabbox=p.default.render(this.tplTabbox,{}),this.updateMaxLogNumber()}},{key:"onRenderTab",value:function(t){t(this.$tabbox)}},{key:"onAddTopBar",value:function(t){for(var e=this,i=["All","Log","Info","Warn","Error"],n=[],r=0;r<i.length;r++)n.push({name:i[r],data:{type:i[r].toLowerCase()},className:"",onClick:function(){if(p.default.hasClass(this,"vc-actived"))return!1;e.showLogType(this.dataset.type||"all")}});n[0].className="vc-actived",t(n)}},{key:"onAddTool",value:function(t){var e=this,i=[{name:"Clear",global:!1,onClick:function(){e.clearLog(),e.vConsole.triggerEvent("clearLog")}}];t(i)}},{key:"onReady",value:function(){var n=this;n.isReady=!0;var r=p.default.all(".vc-subtab",n.$tabbox);p.default.bind(r,"click",function(t){if(t.preventDefault(),p.default.hasClass(this,"vc-actived"))return!1;p.default.removeClass(r,"vc-actived"),p.default.addClass(this,"vc-actived");var e=this.dataset.type,i=p.default.one(".vc-log",n.$tabbox);p.default.removeClass(i,"vc-log-partly-log"),p.default.removeClass(i,"vc-log-partly-info"),p.default.removeClass(i,"vc-log-partly-warn"),p.default.removeClass(i,"vc-log-partly-error"),"all"==e?p.default.removeClass(i,"vc-log-partly"):(p.default.addClass(i,"vc-log-partly"),p.default.addClass(i,"vc-log-partly-"+e))});var e=p.default.one(".vc-content");p.default.bind(e,"scroll",function(t){n.isShow&&(e.scrollTop+e.offsetHeight>=e.scrollHeight?n.isInBottom=!0:n.isInBottom=!1)});for(var t=0;t<n.logList.length;t++)n.printLog(n.logList[t]);n.logList=[]}},{key:"onRemove",value:function(){window.console.log=this.console.log,window.console.info=this.console.info,window.console.warn=this.console.warn,window.console.debug=this.console.debug,window.console.error=this.console.error,window.console.time=this.console.time,window.console.timeEnd=this.console.timeEnd,window.console.clear=this.console.clear,this.console={};var t=f.indexOf(this.id);t>-1&&f.splice(t,1)}},{key:"onShow",value:function(){this.isShow=!0,1==this.isInBottom&&this.autoScrollToBottom()}},{key:"onHide",value:function(){this.isShow=!1}},{key:"onShowConsole",value:function(){1==this.isInBottom&&this.autoScrollToBottom()}},{key:"onUpdateOption",value:function(){this.vConsole.option.maxLogNumber!=this.maxLogNumber&&(this.updateMaxLogNumber(),this.limitMaxLogs())}},{key:"updateMaxLogNumber",value:function(){this.maxLogNumber=this.vConsole.option.maxLogNumber||c,this.maxLogNumber=Math.max(1,this.maxLogNumber)}},{key:"limitMaxLogs",value:function(){if(this.isReady)for(;this.logNumber>this.maxLogNumber;){var t=p.default.one(".vc-item",this.$tabbox);if(!t)break;t.parentNode.removeChild(t),this.logNumber--}}},{key:"showLogType",value:function(t){var e=p.default.one(".vc-log",this.$tabbox);p.default.removeClass(e,"vc-log-partly-log"),p.default.removeClass(e,"vc-log-partly-info"),p.default.removeClass(e,"vc-log-partly-warn"),p.default.removeClass(e,"vc-log-partly-error"),"all"==t?p.default.removeClass(e,"vc-log-partly"):(p.default.addClass(e,"vc-log-partly"),p.default.addClass(e,"vc-log-partly-"+t))}},{key:"autoScrollToBottom",value:function(){this.vConsole.option.disableLogScrolling||this.scrollToBottom()}},{key:"scrollToBottom",value:function(){var t=p.default.one(".vc-content");t&&(t.scrollTop=t.scrollHeight-t.offsetHeight)}},{key:"mockConsole",value:function(){var r=this,n=this,t=["log","info","warn","debug","error"];window.console?(t.map(function(t){n.console[t]=window.console[t]}),n.console.time=window.console.time,n.console.timeEnd=window.console.timeEnd,n.console.clear=window.console.clear):window.console={},t.map(function(n){window.console[n]=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];r.printLog({logType:n,logs:e})}});var i={};window.console.time=function(t){i[t]=Date.now()},window.console.timeEnd=function(t){var e=i[t];e?(console.log(t+":",Date.now()-e+"ms"),delete i[t]):console.log(t+": 0ms")},window.console.clear=function(){n.clearLog();for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];n.console.clear.apply(window.console,e)}}},{key:"clearLog",value:function(){p.default.one(".vc-log",this.$tabbox).innerHTML="",this.logNumber=0,_={}}},{key:"printOriginLog",value:function(t){"function"==typeof this.console[t.logType]&&this.console[t.logType].apply(window.console,t.logs)}},{key:"printLog",value:function(t){var e=t.logs||[];if(e.length||t.content){e=[].slice.call(e||[]);var i=/^\[(\w+)\]$/i,n="",r=!1;if(d.isString(e[0])){var s=e[0].match(i);null!==s&&s.length>0&&(n=s[1].toLowerCase(),r=f.indexOf(n)>-1)}if(n===this.id||!0!==r&&"default"===this.id)if(t._id||(t._id="__vc_"+Math.random().toString(36).substring(2,8)),t.date||(t.date=+new Date),this.isReady){d.isString(e[0])&&r&&(e[0]=e[0].replace(i,""),""===e[0]&&e.shift());for(var a={_id:t._id,logType:t.logType,logText:[],hasContent:!!t.content,count:1},o=0;o<e.length;o++)d.isFunction(e[o])?a.logText.push(e[o].toString()):d.isObject(e[o])||d.isArray(e[o])?a.logText.push(d.JSONStringify(e[o])):a.logText.push(e[o]);a.logText=a.logText.join(" "),a.hasContent||_.logType!==a.logType||_.logText!==a.logText?(this.printNewLog(t,e),_=a):this.printRepeatLog(),this.isInBottom&&this.autoScrollToBottom(),t.noOrigin||this.printOriginLog(t)}else this.logList.push(t);else t.noOrigin||this.printOriginLog(t)}}},{key:"printRepeatLog",value:function(){var t=p.default.one("#"+_._id),e=p.default.one(".vc-item-repeat",t);e||((e=document.createElement("i")).className="vc-item-repeat",t.insertBefore(e,t.lastChild)),_.count,_.count++,e.innerHTML=_.count}},{key:"printNewLog",value:function(t,e){for(var i=p.default.render(a.default,{_id:t._id,logType:t.logType,style:t.style||""}),n=p.default.one(".vc-item-content",i),r=0;r<e.length;r++){var s=void 0;try{if(""===e[r])continue;s=d.isFunction(e[r])?"<span> "+e[r].toString()+"</span>":d.isObject(e[r])||d.isArray(e[r])?this.getFoldedLine(e[r]):"<span> "+d.htmlEncode(e[r]).replace(/\n/g,"<br/>")+"</span>"}catch(t){s="<span> ["+o(e[r])+"]</span>"}s&&("string"==typeof s?n.insertAdjacentHTML("beforeend",s):n.insertAdjacentElement("beforeend",s))}d.isObject(t.content)&&n.insertAdjacentElement("beforeend",t.content),p.default.one(".vc-log",this.$tabbox).insertAdjacentElement("beforeend",i),this.logNumber++,this.limitMaxLogs()}},{key:"getFoldedLine",value:function(f,t){var _=this;if(!t){var e=d.JSONStringify(f),i=e.substr(0,36);t=d.getObjName(f),e.length>36&&(i+="..."),t+=" "+i}var n=p.default.render(v.default,{outer:t,lineType:"obj"});return p.default.bind(p.default.one(".vc-fold-outer",n),"click",function(t){t.preventDefault(),t.stopPropagation(),p.default.hasClass(n,"vc-toggle")?(p.default.removeClass(n,"vc-toggle"),p.default.removeClass(p.default.one(".vc-fold-inner",n),"vc-toggle"),p.default.removeClass(p.default.one(".vc-fold-outer",n),"vc-toggle")):(p.default.addClass(n,"vc-toggle"),p.default.addClass(p.default.one(".vc-fold-inner",n),"vc-toggle"),p.default.addClass(p.default.one(".vc-fold-outer",n),"vc-toggle"));var c=p.default.one(".vc-fold-inner",n);return setTimeout(function(){if(0==c.children.length&&f){for(var t=d.getObjAllKeys(f),e=0;e<t.length;e++){var i=void 0,n="undefined",r="";try{i=f[t[e]]}catch(t){continue}d.isString(i)?(n="string",i='"'+i+'"'):d.isNumber(i)?n="number":d.isBoolean(i)?n="boolean":d.isNull(i)?(n="null",i="null"):d.isUndefined(i)?(n="undefined",i="undefined"):d.isFunction(i)?(n="function",i="function()"):d.isSymbol(i)&&(n="symbol");var s=void 0;if(d.isArray(i)){var a=d.getObjName(i)+"["+i.length+"]";s=_.getFoldedLine(i,p.default.render(g.default,{key:t[e],keyType:r,value:a,valueType:"array"},!0))}else if(d.isObject(i)){var o=d.getObjName(i);s=_.getFoldedLine(i,p.default.render(g.default,{key:d.htmlEncode(t[e]),keyType:r,value:o,valueType:"object"},!0))}else{f.hasOwnProperty&&!f.hasOwnProperty(t[e])&&(r="private");var h={lineType:"kv",key:d.htmlEncode(t[e]),keyType:r,value:d.htmlEncode(i),valueType:n};s=p.default.render(v.default,h)}c.insertAdjacentElement("beforeend",s)}if(d.isObject(f)){var l,u=f.__proto__;l=d.isObject(u)?_.getFoldedLine(u,p.default.render(g.default,{key:"__proto__",keyType:"private",value:d.getObjName(u),valueType:"object"},!0)):p.default.render(g.default,{key:"__proto__",keyType:"private",value:"null",valueType:"null"}),c.insertAdjacentElement("beforeend",l)}}}),!1}),n}}])&&r(e.prototype,i),n&&r(e,n),s;var e,i,n}(e.default);n.AddedLogID=[];var s=n;t.default=s,m.exports=y.default})?e.apply(y,i):e)||(m.exports=n)},function(a,o,t){var e,i,n;i=[o,t(7),t(8),t(2)],void 0===(n="function"==typeof(e=function(t,e,i,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i=r(i),n=r(n),i.default.VConsolePlugin=n.default;var s=i.default;t.default=s,a.exports=o.default})?e.apply(o,i):e)||(a.exports=n)},function(t,e,i){var n,r,s;r=[],void 0===(s="function"==typeof(n=function(){"use strict";if("undefined"==typeof Symbol){window.Symbol=function(){};var t="__symbol_iterator_key";window.Symbol.iterator=t,Array.prototype[t]=function(){var t=this,e=0;return{next:function(){return{done:t.length===e,value:t.length===e?void 0:t[e++]}}}}}})?n.apply(e,r):n)||(t.exports=s)},function(y,b,t){var e,i,n;i=[b,t(9),t(0),t(1),t(11),t(14),t(15),t(16),t(17),t(18),t(19),t(25),t(27),t(31),t(38)],void 0===(n="function"==typeof(e=function(t,a,h,l,e,u,n,r,c,f,o,_,d,p,v){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function g(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a=i(a),h=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,i):{};n.get||n.set?Object.defineProperty(e,i,n):e[i]=t[i]}return e.default=t,e}(h),l=i(l),u=i(u),n=i(n),r=i(r),c=i(c),f=i(f),o=i(o),_=i(_),d=i(d),p=i(p),v=i(v);var m="#__vconsole",s=function(){function s(t){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),l.default.one(m))console.debug("vConsole is already exists.");else{var e=this;if(this.version=a.default.version,this.$dom=null,this.isInited=!1,this.option={defaultPlugins:["system","network","element","storage"]},this.activedTab="",this.tabList=[],this.pluginList={},this.switchPos={x:10,y:10,startX:0,startY:0,endX:0,endY:0},this.tool=h,this.$=l.default,h.isObject(t))for(var i in t)this.option[i]=t[i];this._addBuiltInPlugins();var n,r=function(){e.isInited||(e._render(),e._mockTap(),e._bindEvent(),e._autoRun())};if(void 0!==document)"complete"==document.readyState?r():l.default.bind(window,"load",r);else n=setTimeout(function t(){document&&"complete"==document.readyState?(n&&clearTimeout(n),r()):n=setTimeout(t,1)},1)}}return t=s,(e=[{key:"_addBuiltInPlugins",value:function(){this.addPlugin(new o.default("default","Log"));var t=this.option.defaultPlugins,e={system:{proto:_.default,name:"System"},network:{proto:d.default,name:"Network"},element:{proto:p.default,name:"Element"},storage:{proto:v.default,name:"Storage"}};if(t&&h.isArray(t))for(var i=0;i<t.length;i++){var n=e[t[i]];n?this.addPlugin(new n.proto(t[i],n.name)):console.debug("Unrecognized default plugin ID:",t[i])}}},{key:"_render",value:function(){if(!l.default.one(m)){var t=document.createElement("div");t.innerHTML=u.default,document.documentElement.insertAdjacentElement("beforeend",t.children[0])}this.$dom=l.default.one(m);var e=l.default.one(".vc-switch",this.$dom),i=1*h.getStorage("switch_x"),n=1*h.getStorage("switch_y");(i||n)&&(i+e.offsetWidth>document.documentElement.offsetWidth&&(i=document.documentElement.offsetWidth-e.offsetWidth),n+e.offsetHeight>document.documentElement.offsetHeight&&(n=document.documentElement.offsetHeight-e.offsetHeight),i<0&&(i=0),n<0&&(n=0),this.switchPos.x=i,this.switchPos.y=n,l.default.one(".vc-switch").style.right=i+"px",l.default.one(".vc-switch").style.bottom=n+"px");var r=window.devicePixelRatio||1,s=document.querySelector('[name="viewport"]');if(s&&s.content){var a=s.content.match(/initial\-scale\=\d+(\.\d+)?/),o=a?parseFloat(a[0].split("=")[1]):1;o<1&&(this.$dom.style.fontSize=13*r+"px")}l.default.one(".vc-mask",this.$dom).style.display="none"}},{key:"_mockTap",value:function(){var s,i,n,a=!1,o=null;this.$dom.addEventListener("touchstart",function(t){if(void 0===s){var e=t.targetTouches[0];i=e.pageX,n=e.pageY,s=t.timeStamp,o=t.target.nodeType===Node.TEXT_NODE?t.target.parentNode:t.target}},!1),this.$dom.addEventListener("touchmove",function(t){var e=t.changedTouches[0];(Math.abs(e.pageX-i)>10||Math.abs(e.pageY-n)>10)&&(a=!0)}),this.$dom.addEventListener("touchend",function(t){if(!1===a&&t.timeStamp-s<700&&null!=o){var e=o.tagName.toLowerCase(),i=!1;switch(e){case"textarea":i=!0;break;case"input":switch(o.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":i=!1;break;default:i=!o.disabled&&!o.readOnly}}i?o.focus():t.preventDefault();var n=t.changedTouches[0],r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),r.forwardedTouchEvent=!0,r.initEvent("click",!0,!0),o.dispatchEvent(r)}s=void 0,a=!1,o=null},!1)}},{key:"_bindEvent",value:function(){var s=this,a=l.default.one(".vc-switch",s.$dom);l.default.bind(a,"touchstart",function(t){s.switchPos.startX=t.touches[0].pageX,s.switchPos.startY=t.touches[0].pageY}),l.default.bind(a,"touchend",function(t){s.switchPos.x=s.switchPos.endX,s.switchPos.y=s.switchPos.endY,s.switchPos.startX=0,s.switchPos.startY=0,s.switchPos.endX=0,s.switchPos.endY=0,h.setStorage("switch_x",s.switchPos.x),h.setStorage("switch_y",s.switchPos.y)}),l.default.bind(a,"touchmove",function(t){if(t.touches.length>0){var e=t.touches[0].pageX-s.switchPos.startX,i=t.touches[0].pageY-s.switchPos.startY,n=s.switchPos.x-e,r=s.switchPos.y-i;n+a.offsetWidth>document.documentElement.offsetWidth&&(n=document.documentElement.offsetWidth-a.offsetWidth),r+a.offsetHeight>document.documentElement.offsetHeight&&(r=document.documentElement.offsetHeight-a.offsetHeight),n<0&&(n=0),r<0&&(r=0),a.style.right=n+"px",a.style.bottom=r+"px",s.switchPos.endX=n,s.switchPos.endY=r,t.preventDefault()}}),l.default.bind(l.default.one(".vc-switch",s.$dom),"click",function(){s.show()}),l.default.bind(l.default.one(".vc-hide",s.$dom),"click",function(){s.hide()}),l.default.bind(l.default.one(".vc-mask",s.$dom),"click",function(t){if(t.target!=l.default.one(".vc-mask"))return!1;s.hide()}),l.default.delegate(l.default.one(".vc-tabbar",s.$dom),"click",".vc-tab",function(t){var e=this.dataset.tab;e!=s.activedTab&&s.showTab(e)}),l.default.bind(l.default.one(".vc-panel",s.$dom),"transitionend webkitTransitionEnd oTransitionEnd otransitionend",function(t){if(t.target!=l.default.one(".vc-panel"))return!1;l.default.hasClass(s.$dom,"vc-toggle")||(t.target.style.display="none")});var r=l.default.one(".vc-content",s.$dom),o=!1;l.default.bind(r,"touchstart",function(t){var e=r.scrollTop,i=r.scrollHeight,n=e+r.offsetHeight;0===e?(r.scrollTop=1,0===r.scrollTop&&(l.default.hasClass(t.target,"vc-cmd-input")||(o=!0))):n===i&&(r.scrollTop=e-1,r.scrollTop===e&&(l.default.hasClass(t.target,"vc-cmd-input")||(o=!0)))}),l.default.bind(r,"touchmove",function(t){o&&t.preventDefault()}),l.default.bind(r,"touchend",function(t){o=!1})}},{key:"_autoRun",value:function(){for(var t in this.isInited=!0,this.pluginList)this._initPlugin(this.pluginList[t]);this.tabList.length>0&&this.showTab(this.tabList[0]),this.triggerEvent("ready")}},{key:"triggerEvent",value:function(t,e){t="on"+t.charAt(0).toUpperCase()+t.slice(1),h.isFunction(this.option[t])&&this.option[t].apply(this,e)}},{key:"_initPlugin",value:function(a){var o=this;a.vConsole=this,a.trigger("init"),a.trigger("renderTab",function(t){o.tabList.push(a.id);var e=l.default.render(n.default,{id:a.id,name:a.name});l.default.one(".vc-tabbar",o.$dom).insertAdjacentElement("beforeend",e);var i=l.default.render(r.default,{id:a.id});t&&(h.isString(t)?i.innerHTML+=t:h.isFunction(t.appendTo)?t.appendTo(i):h.isElement(t)&&i.insertAdjacentElement("beforeend",t)),l.default.one(".vc-content",o.$dom).insertAdjacentElement("beforeend",i)}),a.trigger("addTopBar",function(r){if(r)for(var s=l.default.one(".vc-topbar",o.$dom),t=function(t){var i=r[t],n=l.default.render(c.default,{name:i.name||"Undefined",className:i.className||"",pluginID:a.id});if(i.data)for(var e in i.data)n.dataset[e]=i.data[e];h.isFunction(i.onClick)&&l.default.bind(n,"click",function(t){var e=i.onClick.call(n);!1===e||(l.default.removeClass(l.default.all(".vc-topbar-"+a.id),"vc-actived"),l.default.addClass(n,"vc-actived"))}),s.insertAdjacentElement("beforeend",n)},e=0;e<r.length;e++)t(e)}),a.trigger("addTool",function(n){if(n)for(var r=l.default.one(".vc-tool-last",o.$dom),t=function(t){var e=n[t],i=l.default.render(f.default,{name:e.name||"Undefined",pluginID:a.id});1==e.global&&l.default.addClass(i,"vc-global-tool"),h.isFunction(e.onClick)&&l.default.bind(i,"click",function(t){e.onClick.call(i)}),r.parentNode.insertBefore(i,r)},e=0;e<n.length;e++)t(e)}),a.isReady=!0,a.trigger("ready")}},{key:"_triggerPluginsEvent",value:function(t){for(var e in this.pluginList)this.pluginList[e].isReady&&this.pluginList[e].trigger(t)}},{key:"_triggerPluginEvent",value:function(t,e){var i=this.pluginList[t];i&&i.isReady&&i.trigger(e)}},{key:"addPlugin",value:function(t){return void 0!==this.pluginList[t.id]?(console.debug("Plugin "+t.id+" has already been added."),!1):(this.pluginList[t.id]=t,this.isInited&&(this._initPlugin(t),1==this.tabList.length&&this.showTab(this.tabList[0])),!0)}},{key:"removePlugin",value:function(t){t=(t+"").toLowerCase();var e=this.pluginList[t];if(void 0===e)return console.debug("Plugin "+t+" does not exist."),!1;if(e.trigger("remove"),this.isInited){var i=l.default.one("#__vc_tab_"+t);i&&i.parentNode.removeChild(i);for(var n=l.default.all(".vc-topbar-"+t,this.$dom),r=0;r<n.length;r++)n[r].parentNode.removeChild(n[r]);var s=l.default.one("#__vc_log_"+t);s&&s.parentNode.removeChild(s);for(var a=l.default.all(".vc-tool-"+t,this.$dom),o=0;o<a.length;o++)a[o].parentNode.removeChild(a[o])}var h=this.tabList.indexOf(t);h>-1&&this.tabList.splice(h,1);try{delete this.pluginList[t]}catch(e){this.pluginList[t]=void 0}return this.activedTab==t&&this.tabList.length>0&&this.showTab(this.tabList[0]),!0}},{key:"show",value:function(){if(this.isInited){var e=this,t=l.default.one(".vc-panel",this.$dom);t.style.display="block",setTimeout(function(){l.default.addClass(e.$dom,"vc-toggle"),e._triggerPluginsEvent("showConsole");var t=l.default.one(".vc-mask",e.$dom);t.style.display="block"},10)}}},{key:"hide",value:function(){if(this.isInited){l.default.removeClass(this.$dom,"vc-toggle"),this._triggerPluginsEvent("hideConsole");var e=l.default.one(".vc-mask",this.$dom),i=l.default.one(".vc-panel",this.$dom);l.default.bind(e,"transitionend",function(t){e.style.display="none",i.style.display="none"})}}},{key:"showSwitch",value:function(){if(this.isInited){var t=l.default.one(".vc-switch",this.$dom);t.style.display="block"}}},{key:"hideSwitch",value:function(){if(this.isInited){var t=l.default.one(".vc-switch",this.$dom);t.style.display="none"}}},{key:"showTab",value:function(t){if(this.isInited){var e=l.default.one("#__vc_log_"+t);l.default.removeClass(l.default.all(".vc-tab",this.$dom),"vc-actived"),l.default.addClass(l.default.one("#__vc_tab_"+t),"vc-actived"),l.default.removeClass(l.default.all(".vc-logbox",this.$dom),"vc-actived"),l.default.addClass(e,"vc-actived");var i=l.default.all(".vc-topbar-"+t,this.$dom);l.default.removeClass(l.default.all(".vc-toptab",this.$dom),"vc-toggle"),l.default.addClass(i,"vc-toggle"),i.length>0?l.default.addClass(l.default.one(".vc-content",this.$dom),"vc-has-topbar"):l.default.removeClass(l.default.one(".vc-content",this.$dom),"vc-has-topbar"),l.default.removeClass(l.default.all(".vc-tool",this.$dom),"vc-toggle"),l.default.addClass(l.default.all(".vc-tool-"+t,this.$dom),"vc-toggle"),this.activedTab&&this._triggerPluginEvent(this.activedTab,"hide"),this.activedTab=t,this._triggerPluginEvent(this.activedTab,"show")}}},{key:"setOption",value:function(t,e){if(h.isString(t))this.option[t]=e,this._triggerPluginsEvent("updateOption");else if(h.isObject(t)){for(var i in t)this.option[i]=t[i];this._triggerPluginsEvent("updateOption")}else console.debug("The first parameter of vConsole.setOption() must be a string or an object.")}},{key:"destroy",value:function(){if(this.isInited){for(var t=Object.keys(this.pluginList),e=t.length-1;e>=0;e--)this.removePlugin(t[e]);this.$dom.parentNode.removeChild(this.$dom)}}}])&&g(t.prototype,e),i&&g(t,i),s;var t,e,i}();t.default=s,y.exports=b.default})?e.apply(b,i):e)||(y.exports=n)},function(t){t.exports={name:"vconsole",version:"3.3.0",description:"A lightweight, extendable front-end developer tool for mobile web page.",homepage:"https://github.com/Tencent/vConsole",main:"dist/vconsole.min.js",scripts:{test:"mocha",dist:"webpack"},keywords:["console","debug","mobile"],repository:{type:"git",url:"git+https://github.com/Tencent/vConsole.git"},dependencies:{},devDependencies:{"@babel/core":"^7.2.2","@babel/plugin-proposal-class-properties":"^7.3.0","@babel/plugin-proposal-export-namespace-from":"^7.2.0","@babel/plugin-proposal-object-rest-spread":"^7.3.1","@babel/preset-env":"^7.3.1","babel-loader":"^8.0.4","babel-plugin-add-module-exports":"^1.0.0",chai:"^4.2.0","css-loader":"^2.1.0","html-loader":"^0.5.5",jsdom:"^13.2.0","json-loader":"^0.5.7",less:"^3.9.0","less-loader":"^4.1.0",mocha:"^5.2.0","style-loader":"^0.23.1",webpack:"^4.29.0","webpack-cli":"^3.2.1"},author:"Tencent",license:"MIT"}},function(e,i,t){var n,r,s;r=[i],void 0===(s="function"==typeof(n=function(t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(t,e,i){var n=/\{\{([^\}]+)\}\}/g,r="",s="",a=0,o=[],h=function(t,e){""!==t&&(e?t.match(/^ ?else/g)?r+="} "+t+" {\n":t.match(/\/(if|for|switch)/g)?r+="}\n":t.match(/^ ?if|for|switch/g)?r+=t+" {\n":t.match(/^ ?(break|continue) ?$/g)?r+=t+";\n":t.match(/^ ?(case|default)/g)?r+=t+":\n":r+="arr.push("+t+");\n":r+='arr.push("'+t.replace(/"/g,'\\"')+'");\n')};for(window.__mito_data=e,window.__mito_code="",window.__mito_result="",t=(t=t.replace(/(\{\{ ?switch(.+?)\}\})[\r\n\t ]+\{\{/g,"$1{{")).replace(/^[\r\n]/,"").replace(/\n/g,"\\\n").replace(/\r/g,"\\\r"),s="(function(){\n",r="var arr = [];\n";o=n.exec(t);)h(t.slice(a,o.index),!1),h(o[1],!0),a=o.index+o[0].length;h(t.substr(a,t.length-a),!1),s+=r="with (__mito_data) {\n"+(r+='__mito_result = arr.join("");')+"\n}",s+="})();";var l=document.getElementsByTagName("script"),u="";l.length>0&&(u=l[0].nonce||"");var c=document.createElement("SCRIPT");c.innerHTML=s,c.setAttribute("nonce",u),document.documentElement.appendChild(c);var f=__mito_result;if(document.documentElement.removeChild(c),!i){var _=document.createElement("DIV");_.innerHTML=f,f=_.children[0]}return f},e.exports=i.default})?n.apply(i,r):n)||(e.exports=s)},function(t,e,i){var n=i(12);"string"==typeof n&&(n=[[t.i,n,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};i(4)(n,r);n.locals&&(t.exports=n.locals)},function(t,e,i){(t.exports=i(3)(!1)).push([t.i,'#__vconsole {\n  color: #000;\n  font-size: 13px;\n  font-family: Helvetica Neue, Helvetica, Arial, sans-serif;\n  /* global */\n  /* compoment */\n}\n#__vconsole .vc-max-height {\n  max-height: 19.23076923em;\n}\n#__vconsole .vc-max-height-line {\n  max-height: 3.38461538em;\n}\n#__vconsole .vc-min-height {\n  min-height: 3.07692308em;\n}\n#__vconsole dd,\n#__vconsole dl,\n#__vconsole pre {\n  margin: 0;\n}\n#__vconsole .vc-switch {\n  display: block;\n  position: fixed;\n  right: 0.76923077em;\n  bottom: 0.76923077em;\n  color: #FFF;\n  background-color: #04BE02;\n  line-height: 1;\n  font-size: 1.07692308em;\n  padding: 0.61538462em 1.23076923em;\n  z-index: 10000;\n  border-radius: 0.30769231em;\n  box-shadow: 0 0 0.61538462em rgba(0, 0, 0, 0.4);\n}\n#__vconsole .vc-mask {\n  display: none;\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0);\n  z-index: 10001;\n  transition: background 0.3s;\n  -webkit-tap-highlight-color: transparent;\n  overflow-y: scroll;\n}\n#__vconsole .vc-panel {\n  display: none;\n  position: fixed;\n  min-height: 85%;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  z-index: 10002;\n  background-color: #EFEFF4;\n  -webkit-transition: -webkit-transform 0.3s;\n  transition: -webkit-transform 0.3s;\n  transition: transform 0.3s;\n  transition: transform 0.3s, -webkit-transform 0.3s;\n  -webkit-transform: translate(0, 100%);\n  transform: translate(0, 100%);\n}\n#__vconsole .vc-tabbar {\n  border-bottom: 1px solid #D9D9D9;\n  overflow-x: auto;\n  height: 3em;\n  width: auto;\n  white-space: nowrap;\n}\n#__vconsole .vc-tabbar .vc-tab {\n  display: inline-block;\n  line-height: 3em;\n  padding: 0 1.15384615em;\n  border-right: 1px solid #D9D9D9;\n  text-decoration: none;\n  color: #000;\n  -webkit-tap-highlight-color: transparent;\n  -webkit-touch-callout: none;\n}\n#__vconsole .vc-tabbar .vc-tab:active {\n  background-color: rgba(0, 0, 0, 0.15);\n}\n#__vconsole .vc-tabbar .vc-tab.vc-actived {\n  background-color: #FFF;\n}\n#__vconsole .vc-content {\n  background-color: #FFF;\n  overflow-x: hidden;\n  overflow-y: auto;\n  position: absolute;\n  top: 3.07692308em;\n  left: 0;\n  right: 0;\n  bottom: 3.07692308em;\n  -webkit-overflow-scrolling: touch;\n  margin-bottom: constant(safe-area-inset-bottom);\n  margin-bottom: env(safe-area-inset-bottom);\n}\n#__vconsole .vc-content.vc-has-topbar {\n  top: 5.46153846em;\n}\n#__vconsole .vc-topbar {\n  background-color: #FBF9FE;\n  display: flex;\n  display: -webkit-box;\n  flex-direction: row;\n  flex-wrap: wrap;\n  -webkit-box-direction: row;\n  -webkit-flex-wrap: wrap;\n  width: 100%;\n}\n#__vconsole .vc-topbar .vc-toptab {\n  display: none;\n  flex: 1;\n  -webkit-box-flex: 1;\n  line-height: 2.30769231em;\n  padding: 0 1.15384615em;\n  border-bottom: 1px solid #D9D9D9;\n  text-decoration: none;\n  text-align: center;\n  color: #000;\n  -webkit-tap-highlight-color: transparent;\n  -webkit-touch-callout: none;\n}\n#__vconsole .vc-topbar .vc-toptab.vc-toggle {\n  display: block;\n}\n#__vconsole .vc-topbar .vc-toptab:active {\n  background-color: rgba(0, 0, 0, 0.15);\n}\n#__vconsole .vc-topbar .vc-toptab.vc-actived {\n  border-bottom: 1px solid #3e82f7;\n}\n#__vconsole .vc-logbox {\n  display: none;\n  position: relative;\n  min-height: 100%;\n}\n#__vconsole .vc-logbox i {\n  font-style: normal;\n}\n#__vconsole .vc-logbox .vc-log {\n  padding-bottom: 3em;\n  -webkit-tap-highlight-color: transparent;\n}\n#__vconsole .vc-logbox .vc-log:empty:before {\n  content: "Empty";\n  color: #999;\n  position: absolute;\n  top: 45%;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  font-size: 1.15384615em;\n  text-align: center;\n}\n#__vconsole .vc-logbox .vc-item {\n  margin: 0;\n  padding: 0.46153846em 0.61538462em;\n  overflow: hidden;\n  line-height: 1.3;\n  border-bottom: 1px solid #EEE;\n  word-break: break-word;\n}\n#__vconsole .vc-logbox .vc-item-info {\n  color: #6A5ACD;\n}\n#__vconsole .vc-logbox .vc-item-debug {\n  color: #DAA520;\n}\n#__vconsole .vc-logbox .vc-item-warn {\n  color: #FFA500;\n  border-color: #FFB930;\n  background-color: #FFFACD;\n}\n#__vconsole .vc-logbox .vc-item-error {\n  color: #DC143C;\n  border-color: #F4A0AB;\n  background-color: #FFE4E1;\n}\n#__vconsole .vc-logbox .vc-log.vc-log-partly .vc-item {\n  display: none;\n}\n#__vconsole .vc-logbox .vc-log.vc-log-partly-log .vc-item-log,\n#__vconsole .vc-logbox .vc-log.vc-log-partly-info .vc-item-info,\n#__vconsole .vc-logbox .vc-log.vc-log-partly-warn .vc-item-warn,\n#__vconsole .vc-logbox .vc-log.vc-log-partly-error .vc-item-error {\n  display: block;\n}\n#__vconsole .vc-logbox .vc-item .vc-item-content {\n  margin-right: 4.61538462em;\n  display: inline-block;\n}\n#__vconsole .vc-logbox .vc-item .vc-item-repeat {\n  display: inline-block;\n  margin-right: 0.30769231em;\n  padding: 0 6.5px;\n  color: #D7E0EF;\n  background-color: #42597F;\n  border-radius: 8.66666667px;\n}\n#__vconsole .vc-logbox .vc-item.vc-item-error .vc-item-repeat {\n  color: #901818;\n  background-color: #DC2727;\n}\n#__vconsole .vc-logbox .vc-item.vc-item-warn .vc-item-repeat {\n  color: #987D20;\n  background-color: #F4BD02;\n}\n#__vconsole .vc-logbox .vc-item .vc-item-code {\n  display: block;\n  white-space: pre-wrap;\n  overflow: auto;\n  position: relative;\n}\n#__vconsole .vc-logbox .vc-item .vc-item-code.vc-item-code-input,\n#__vconsole .vc-logbox .vc-item .vc-item-code.vc-item-code-output {\n  padding-left: 0.92307692em;\n}\n#__vconsole .vc-logbox .vc-item .vc-item-code.vc-item-code-input:before,\n#__vconsole .vc-logbox .vc-item .vc-item-code.vc-item-code-output:before {\n  content: "›";\n  position: absolute;\n  top: -0.23076923em;\n  left: 0;\n  font-size: 1.23076923em;\n  color: #6A5ACD;\n}\n#__vconsole .vc-logbox .vc-item .vc-item-code.vc-item-code-output:before {\n  content: "‹";\n}\n#__vconsole .vc-logbox .vc-item .vc-fold {\n  display: block;\n  overflow: auto;\n  -webkit-overflow-scrolling: touch;\n}\n#__vconsole .vc-logbox .vc-item .vc-fold .vc-fold-outer {\n  display: block;\n  font-style: italic;\n  padding-left: 0.76923077em;\n  position: relative;\n}\n#__vconsole .vc-logbox .vc-item .vc-fold .vc-fold-outer:active {\n  background-color: #E6E6E6;\n}\n#__vconsole .vc-logbox .vc-item .vc-fold .vc-fold-outer:before {\n  content: "";\n  position: absolute;\n  top: 0.30769231em;\n  left: 0.15384615em;\n  width: 0;\n  height: 0;\n  border: transparent solid 0.30769231em;\n  border-left-color: #000;\n}\n#__vconsole .vc-logbox .vc-item .vc-fold .vc-fold-outer.vc-toggle:before {\n  top: 0.46153846em;\n  left: 0;\n  border-top-color: #000;\n  border-left-color: transparent;\n}\n#__vconsole .vc-logbox .vc-item .vc-fold .vc-fold-inner {\n  display: none;\n  margin-left: 0.76923077em;\n}\n#__vconsole .vc-logbox .vc-item .vc-fold .vc-fold-inner.vc-toggle {\n  display: block;\n}\n#__vconsole .vc-logbox .vc-item .vc-fold .vc-fold-inner .vc-code-key {\n  margin-left: 0.76923077em;\n}\n#__vconsole .vc-logbox .vc-item .vc-fold .vc-fold-outer .vc-code-key {\n  margin-left: 0;\n}\n#__vconsole .vc-logbox .vc-code-key {\n  color: #905;\n}\n#__vconsole .vc-logbox .vc-code-private-key {\n  color: #D391B5;\n}\n#__vconsole .vc-logbox .vc-code-function {\n  color: #905;\n  font-style: italic;\n}\n#__vconsole .vc-logbox .vc-code-number,\n#__vconsole .vc-logbox .vc-code-boolean {\n  color: #0086B3;\n}\n#__vconsole .vc-logbox .vc-code-string {\n  color: #183691;\n}\n#__vconsole .vc-logbox .vc-code-null,\n#__vconsole .vc-logbox .vc-code-undefined {\n  color: #666;\n}\n#__vconsole .vc-logbox .vc-cmd {\n  position: absolute;\n  height: 3.07692308em;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  border-top: 1px solid #D9D9D9;\n  display: block!important;\n}\n#__vconsole .vc-logbox .vc-cmd .vc-cmd-input-wrap {\n  display: block;\n  height: 2.15384615em;\n  margin-right: 3.07692308em;\n  padding: 0.46153846em 0.61538462em;\n}\n#__vconsole .vc-logbox .vc-cmd .vc-cmd-input {\n  width: 100%;\n  border: none;\n  resize: none;\n  outline: none;\n  padding: 0;\n  font-size: 0.92307692em;\n}\n#__vconsole .vc-logbox .vc-cmd .vc-cmd-input::-webkit-input-placeholder {\n  line-height: 2.15384615em;\n}\n#__vconsole .vc-logbox .vc-cmd .vc-cmd-btn {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  width: 3.07692308em;\n  border: none;\n  background-color: #EFEFF4;\n  outline: none;\n  -webkit-touch-callout: none;\n  font-size: 1em;\n}\n#__vconsole .vc-logbox .vc-cmd .vc-cmd-btn:active {\n  background-color: rgba(0, 0, 0, 0.15);\n}\n#__vconsole .vc-logbox .vc-cmd .vc-cmd-prompted {\n  position: fixed;\n  width: 100%;\n  background-color: #FBF9FE;\n  border: 1px solid #D9D9D9;\n  overflow-x: scroll;\n  display: none;\n}\n#__vconsole .vc-logbox .vc-cmd .vc-cmd-prompted li {\n  list-style: none;\n  line-height: 30px;\n  padding: 0 0.46153846em;\n  border-bottom: 1px solid #D9D9D9;\n}\n#__vconsole .vc-logbox .vc-group .vc-group-preview {\n  -webkit-touch-callout: none;\n}\n#__vconsole .vc-logbox .vc-group .vc-group-preview:active {\n  background-color: #E6E6E6;\n}\n#__vconsole .vc-logbox .vc-group .vc-group-detail {\n  display: none;\n  padding: 0 0 0.76923077em 1.53846154em;\n  border-bottom: 1px solid #EEE;\n}\n#__vconsole .vc-logbox .vc-group.vc-actived .vc-group-detail {\n  display: block;\n  background-color: #FBF9FE;\n}\n#__vconsole .vc-logbox .vc-group.vc-actived .vc-table-row {\n  background-color: #FFF;\n}\n#__vconsole .vc-logbox .vc-group.vc-actived .vc-group-preview {\n  background-color: #FBF9FE;\n}\n#__vconsole .vc-logbox .vc-table .vc-table-row {\n  display: flex;\n  display: -webkit-flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  -webkit-box-direction: row;\n  -webkit-flex-wrap: wrap;\n  overflow: hidden;\n  border-bottom: 1px solid #EEE;\n}\n#__vconsole .vc-logbox .vc-table .vc-table-row.vc-left-border {\n  border-left: 1px solid #EEE;\n}\n#__vconsole .vc-logbox .vc-table .vc-table-col {\n  flex: 1;\n  -webkit-box-flex: 1;\n  padding: 0.23076923em 0.30769231em;\n  border-left: 1px solid #EEE;\n  overflow: auto;\n  white-space: pre-wrap;\n  word-break: break-word;\n  /*white-space: nowrap;\n        text-overflow: ellipsis;*/\n  -webkit-overflow-scrolling: touch;\n}\n#__vconsole .vc-logbox .vc-table .vc-table-col:first-child {\n  border: none;\n}\n#__vconsole .vc-logbox .vc-table .vc-small .vc-table-col {\n  padding: 0 0.30769231em;\n  font-size: 0.92307692em;\n}\n#__vconsole .vc-logbox .vc-table .vc-table-col-2 {\n  flex: 2;\n  -webkit-box-flex: 2;\n}\n#__vconsole .vc-logbox .vc-table .vc-table-col-3 {\n  flex: 3;\n  -webkit-box-flex: 3;\n}\n#__vconsole .vc-logbox .vc-table .vc-table-col-4 {\n  flex: 4;\n  -webkit-box-flex: 4;\n}\n#__vconsole .vc-logbox .vc-table .vc-table-col-5 {\n  flex: 5;\n  -webkit-box-flex: 5;\n}\n#__vconsole .vc-logbox .vc-table .vc-table-col-6 {\n  flex: 6;\n  -webkit-box-flex: 6;\n}\n#__vconsole .vc-logbox .vc-table .vc-table-row-error {\n  border-color: #F4A0AB;\n  background-color: #FFE4E1;\n}\n#__vconsole .vc-logbox .vc-table .vc-table-row-error .vc-table-col {\n  color: #DC143C;\n  border-color: #F4A0AB;\n}\n#__vconsole .vc-logbox .vc-table .vc-table-col-title {\n  font-weight: bold;\n}\n#__vconsole .vc-logbox.vc-actived {\n  display: block;\n}\n#__vconsole .vc-toolbar {\n  border-top: 1px solid #D9D9D9;\n  line-height: 3em;\n  position: absolute;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  display: -webkit-box;\n  flex-direction: row;\n  -webkit-box-direction: row;\n}\n#__vconsole .vc-toolbar .vc-tool {\n  display: none;\n  text-decoration: none;\n  color: #000;\n  width: 50%;\n  flex: 1;\n  -webkit-box-flex: 1;\n  text-align: center;\n  position: relative;\n  -webkit-touch-callout: none;\n}\n#__vconsole .vc-toolbar .vc-tool.vc-toggle,\n#__vconsole .vc-toolbar .vc-tool.vc-global-tool {\n  display: block;\n}\n#__vconsole .vc-toolbar .vc-tool:active {\n  background-color: rgba(0, 0, 0, 0.15);\n}\n#__vconsole .vc-toolbar .vc-tool:after {\n  content: " ";\n  position: absolute;\n  top: 0.53846154em;\n  bottom: 0.53846154em;\n  right: 0;\n  border-left: 1px solid #D9D9D9;\n}\n#__vconsole .vc-toolbar .vc-tool-last:after {\n  border: none;\n}\n@supports (bottom: constant(safe-area-inset-bottom)) or (bottom: env(safe-area-inset-bottom)) {\n  #__vconsole .vc-toolbar,\n  #__vconsole .vc-switch {\n    bottom: constant(safe-area-inset-bottom);\n    bottom: env(safe-area-inset-bottom);\n  }\n}\n#__vconsole.vc-toggle .vc-switch {\n  display: none;\n}\n#__vconsole.vc-toggle .vc-mask {\n  background: rgba(0, 0, 0, 0.6);\n  display: block;\n}\n#__vconsole.vc-toggle .vc-panel {\n  -webkit-transform: translate(0, 0);\n  transform: translate(0, 0);\n}\n',""])},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var r=e.protocol+"//"+e.host,s=r+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,e){var i,n=e.trim().replace(/^"(.*)"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(n)?t:(i=0===n.indexOf("//")?n:0===n.indexOf("/")?r+n:s+n.replace(/^\.\//,""),"url("+JSON.stringify(i)+")")})}},function(t,e){t.exports='<div id="__vconsole" class="">\n  <div class="vc-switch">vConsole</div>\n  <div class="vc-mask">\n  </div>\n  <div class="vc-panel">\n    <div class="vc-tabbar">\n    </div>\n    <div class="vc-topbar">\n    </div>\n    <div class="vc-content">\n    </div>\n    <div class="vc-toolbar">\n      <a class="vc-tool vc-global-tool vc-tool-last vc-hide">Hide</a>\n    </div>\n  </div>\n</div>'},function(t,e){t.exports='<a class="vc-tab" data-tab="{{id}}" id="__vc_tab_{{id}}">{{name}}</a>'},function(t,e){t.exports='<div class="vc-logbox" id="__vc_log_{{id}}">\n  \n</div>'},function(t,e){t.exports='<a class="vc-toptab vc-topbar-{{pluginID}}{{if (className)}} {{className}}{{/if}}">{{name}}</a>'},function(t,e){t.exports='<a class="vc-tool vc-tool-{{pluginID}}">{{name}}</a>'},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__,factory;factory=function(_exports,_query,tool,_log,_tabbox_default,_item_code){"use strict";function _interopRequireWildcard(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,i):{};n.get||n.set?Object.defineProperty(e,i,n):e[i]=t[i]}return e.default=t,e}function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _get(t,e,i){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=_superPropBase(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(i):r.value}})(t,e,i||t)}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_query=_interopRequireDefault(_query),tool=_interopRequireWildcard(tool),_log=_interopRequireDefault(_log),_tabbox_default=_interopRequireDefault(_tabbox_default),_item_code=_interopRequireDefault(_item_code);var VConsoleDefaultTab=function(_VConsoleLogTab){function VConsoleDefaultTab(){var t,e;_classCallCheck(this,VConsoleDefaultTab);for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return(e=_possibleConstructorReturn(this,(t=_getPrototypeOf(VConsoleDefaultTab)).call.apply(t,[this].concat(n)))).tplTabbox=_tabbox_default.default,e}return _inherits(VConsoleDefaultTab,_VConsoleLogTab),_createClass(VConsoleDefaultTab,[{key:"onReady",value:function onReady(){var that=this;_get(_getPrototypeOf(VConsoleDefaultTab.prototype),"onReady",this).call(this),window.winKeys=Object.getOwnPropertyNames(window).sort(),window.keyTypes={};for(var i=0;i<winKeys.length;i++)keyTypes[winKeys[i]]=_typeof(window[winKeys[i]]);var cacheObj={},ID_REGEX=/[a-zA-Z_0-9\$\-\u00A2-\uFFFF]/,retrievePrecedingIdentifier=function(t,e,i){i=i||ID_REGEX;for(var n=[],r=e-1;r>=0&&i.test(t[r]);r--)n.push(t[r]);if(0==n.length){i=/\./;for(var s=e-1;s>=0&&i.test(t[s]);s--)n.push(t[s])}if(0===n.length){var a=t.match(/[\(\)\[\]\{\}]/gi)||[];return a[a.length-1]}return n.reverse().join("")};_query.default.bind(_query.default.one(".vc-cmd-input"),"keyup",function(e){var isDeleteKeyCode=8===e.keyCode||46===e.keyCode,$prompted=_query.default.one(".vc-cmd-prompted");$prompted.style.display="none",$prompted.innerHTML="";var tempValue=this.value,value=retrievePrecedingIdentifier(this.value,this.value.length);if(value&&value.length>0){if(/\(/.test(value)&&!isDeleteKeyCode)return void(_query.default.one(".vc-cmd-input").value+=")");if(/\[/.test(value)&&!isDeleteKeyCode)return void(_query.default.one(".vc-cmd-input").value+="]");if(/\{/.test(value)&&!isDeleteKeyCode)return void(_query.default.one(".vc-cmd-input").value+="}");if("."===value){var key=retrievePrecedingIdentifier(tempValue,tempValue.length-1);if(!cacheObj[key])try{cacheObj[key]=Object.getOwnPropertyNames(eval("("+key+")")).sort()}catch(e){}try{for(var _i3=0;_i3<cacheObj[key].length;_i3++){var $li=document.createElement("li"),_key=cacheObj[key][_i3];$li.innerHTML=_key,$li.onclick=function(){_query.default.one(".vc-cmd-input").value="",_query.default.one(".vc-cmd-input").value=tempValue+this.innerHTML,$prompted.style.display="none"},$prompted.appendChild($li)}}catch(e){}}else if("."!==value.substring(value.length-1)&&value.indexOf(".")<0){for(var _i4=0;_i4<winKeys.length;_i4++)if(winKeys[_i4].toLowerCase().indexOf(value.toLowerCase())>=0){var _$li=document.createElement("li");_$li.innerHTML=winKeys[_i4],_$li.onclick=function(){_query.default.one(".vc-cmd-input").value="",_query.default.one(".vc-cmd-input").value=this.innerHTML,"function"==keyTypes[this.innerHTML]&&(_query.default.one(".vc-cmd-input").value+="()"),$prompted.style.display="none"},$prompted.appendChild(_$li)}}else{var arr=value.split(".");if(cacheObj[arr[0]]){cacheObj[arr[0]].sort();for(var _i5=0;_i5<cacheObj[arr[0]].length;_i5++){var _$li2=document.createElement("li"),_key3=cacheObj[arr[0]][_i5];_key3.indexOf(arr[1])>=0&&(_$li2.innerHTML=_key3,_$li2.onclick=function(){_query.default.one(".vc-cmd-input").value="",_query.default.one(".vc-cmd-input").value=tempValue+this.innerHTML,$prompted.style.display="none"},$prompted.appendChild(_$li2))}}}if($prompted.children.length>0){var m=Math.min(200,31*$prompted.children.length);$prompted.style.display="block",$prompted.style.height=m+"px",$prompted.style.marginTop=-m+"px"}}else $prompted.style.display="none"}),_query.default.bind(_query.default.one(".vc-cmd",this.$tabbox),"submit",function(t){t.preventDefault();var e=_query.default.one(".vc-cmd-input",t.target),i=e.value;e.value="",""!==i&&that.evalCommand(i);var n=_query.default.one(".vc-cmd-prompted");n&&(n.style.display="none")});var code="";code+="if (!!window) {",code+="window.__vConsole_cmd_result = undefined;",code+="window.__vConsole_cmd_error = false;",code+="}";var scriptList=document.getElementsByTagName("script"),nonce="";scriptList.length>0&&(nonce=scriptList[0].nonce||"");var script=document.createElement("SCRIPT");script.innerHTML=code,script.setAttribute("nonce",nonce),document.documentElement.appendChild(script),document.documentElement.removeChild(script)}},{key:"mockConsole",value:function(){_get(_getPrototypeOf(VConsoleDefaultTab.prototype),"mockConsole",this).call(this);var o=this;tool.isFunction(window.onerror)&&(this.windowOnError=window.onerror),window.onerror=function(t,e,i,n,r){var s=t;e&&(s+="\n"+e.replace(location.origin,"")),(i||n)&&(s+=":"+i+":"+n);var a=!!r&&!!r.stack&&r.stack.toString()||"";o.printLog({logType:"error",logs:[s,a],noOrigin:!0}),tool.isFunction(o.windowOnError)&&o.windowOnError.call(window,t,e,i,n,r)}}},{key:"evalCommand",value:function(t){this.printLog({logType:"log",content:_query.default.render(_item_code.default,{content:t,type:"input"}),style:""});var e,i=void 0;try{i=eval.call(window,"("+t+")")}catch(e){try{i=eval.call(window,t)}catch(t){}}tool.isArray(i)||tool.isObject(i)?e=this.getFoldedLine(i):(tool.isNull(i)?i="null":tool.isUndefined(i)?i="undefined":tool.isFunction(i)?i="function()":tool.isString(i)&&(i='"'+i+'"'),e=_query.default.render(_item_code.default,{content:i,type:"output"})),this.printLog({logType:"log",content:e,style:""}),window.winKeys=Object.getOwnPropertyNames(window).sort()}}]),VConsoleDefaultTab}(_log.default),_default=VConsoleDefaultTab;_exports.default=_default,module.exports=exports.default},__WEBPACK_AMD_DEFINE_ARRAY__=[exports,__webpack_require__(1),__webpack_require__(0),__webpack_require__(5),__webpack_require__(23),__webpack_require__(24)],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=factory)?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},function(t,e){t.exports='<div id="{{_id}}" class="vc-item vc-item-{{logType}} {{style}}">\n\t<div class="vc-item-content"></div>\n</div>'},function(t,e){t.exports='<div class="vc-fold">\n  {{if (lineType == \'obj\')}}\n    <i class="vc-fold-outer">{{outer}}</i>\n    <div class="vc-fold-inner"></div>\n  {{else if (lineType == \'value\')}}\n    <i class="vc-code-{{valueType}}">{{value}}</i>\n  {{else if (lineType == \'kv\')}}\n    <i class="vc-code-key{{if (keyType)}} vc-code-{{keyType}}-key{{/if}}">{{key}}</i>: <i class="vc-code-{{valueType}}">{{value}}</i>\n  {{/if}}\n</div>'},function(t,e){t.exports='<span>\n  <i class="vc-code-key{{if (keyType)}} vc-code-{{keyType}}-key{{/if}}">{{key}}</i>: <i class="vc-code-{{valueType}}">{{value}}</i>\n</span>'},function(t,e){t.exports='<div>\n  <div class="vc-log"></div>\n  <form class="vc-cmd">\n    <button class="vc-cmd-btn" type="submit">OK</button>\n    <ul class=\'vc-cmd-prompted\'></ul>\n    <div class="vc-cmd-input-wrap">\n      <textarea class="vc-cmd-input" placeholder="command..."></textarea>\n    </div>\n  </form>\n</div>'},function(t,e){t.exports='<pre class="vc-item-code vc-item-code-{{type}}">{{content}}</pre>'},function(c,f,t){var e,i,n;i=[f,t(5),t(26)],void 0===(n="function"==typeof(e=function(t,e,a){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(t,e){return!e||"object"!==n(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function h(t,e,i){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(i):r.value}})(t,e,i||t)}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,e=i(e),a=i(a);var s=function(t){function s(){var t,e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s);for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return(e=o(this,(t=l(s)).call.apply(t,[this].concat(n)))).tplTabbox=a.default,e.allowUnformattedLog=!1,e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(s,t),e=s,(i=[{key:"onInit",value:function(){h(l(s.prototype),"onInit",this).call(this),this.printSystemInfo()}},{key:"printSystemInfo",value:function(){var t=navigator.userAgent,e="",i=t.match(/(ipod).*\s([\d_]+)/i),n=t.match(/(ipad).*\s([\d_]+)/i),r=t.match(/(iphone)\sos\s([\d_]+)/i),s=t.match(/(android)\s([\d\.]+)/i);e="Unknown",s?e="Android "+s[2]:r?e="iPhone, iOS "+r[2].replace(/_/g,"."):n?e="iPad, iOS "+n[2].replace(/_/g,"."):i&&(e="iPod, iOS "+i[2].replace(/_/g,"."));var a=e,o=t.match(/MicroMessenger\/([\d\.]+)/i);e="Unknown",o&&o[1]?(e=o[1],a+=", WeChat "+e,console.info("[system]","System:",a)):console.info("[system]","System:",a),e="Unknown",e="https:"==location.protocol?"HTTPS":"http:"==location.protocol?"HTTP":location.protocol.replace(":",""),a=e;var h=t.toLowerCase().match(/ nettype\/([^ ]+)/g);e="Unknown",h&&h[0]?(h=h[0].split("/"),e=h[1],a+=", "+e,console.info("[system]","Network:",a)):console.info("[system]","Protocol:",a),console.info("[system]","UA:",t),setTimeout(function(){var t=window.performance||window.msPerformance||window.webkitPerformance;if(t&&t.timing){var e=t.timing;e.navigationStart&&console.info("[system]","navigationStart:",e.navigationStart),e.navigationStart&&e.domainLookupStart&&console.info("[system]","navigation:",e.domainLookupStart-e.navigationStart+"ms"),e.domainLookupEnd&&e.domainLookupStart&&console.info("[system]","dns:",e.domainLookupEnd-e.domainLookupStart+"ms"),e.connectEnd&&e.connectStart&&(e.connectEnd&&e.secureConnectionStart?console.info("[system]","tcp (ssl):",e.connectEnd-e.connectStart+"ms ("+(e.connectEnd-e.secureConnectionStart)+"ms)"):console.info("[system]","tcp:",e.connectEnd-e.connectStart+"ms")),e.responseStart&&e.requestStart&&console.info("[system]","request:",e.responseStart-e.requestStart+"ms"),e.responseEnd&&e.responseStart&&console.info("[system]","response:",e.responseEnd-e.responseStart+"ms"),e.domComplete&&e.domLoading&&(e.domContentLoadedEventStart&&e.domLoading?console.info("[system]","domComplete (domLoaded):",e.domComplete-e.domLoading+"ms ("+(e.domContentLoadedEventStart-e.domLoading)+"ms)"):console.info("[system]","domComplete:",e.domComplete-e.domLoading+"ms")),e.loadEventEnd&&e.loadEventStart&&console.info("[system]","loadEvent:",e.loadEventEnd-e.loadEventStart+"ms"),e.navigationStart&&e.loadEventEnd&&console.info("[system]","total (DOM):",e.loadEventEnd-e.navigationStart+"ms ("+(e.domComplete-e.navigationStart)+"ms)")}},0)}}])&&r(e.prototype,i),n&&r(e,n),s;var e,i,n}(e.default);t.default=s,c.exports=f.default})?e.apply(f,i):e)||(c.exports=n)},function(t,e){t.exports='<div>\n  <div class="vc-log"></div>\n</div>'},function(_,d,t){var e,i,n;i=[d,t(1),t(0),t(2),t(28),t(29),t(30)],void 0===(n="function"==typeof(e=function(t,l,y,e,a,r,u){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function h(t,e){return!e||"object"!==n(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,l=i(l),y=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,i):{};n.get||n.set?Object.defineProperty(e,i,n):e[i]=t[i]}return e.default=t,e}(y),e=i(e),a=i(a),r=i(r),u=i(u);var s=function(t){function s(){var t,e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s);for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return(e=h(this,(t=c(s)).call.apply(t,[this].concat(n)))).$tabbox=l.default.render(a.default,{}),e.$header=null,e.reqList={},e.domList={},e.isReady=!1,e.isShow=!1,e.isInBottom=!0,e._open=void 0,e._send=void 0,e.mockAjax(),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(s,t),e=s,(i=[{key:"onRenderTab",value:function(t){t(this.$tabbox)}},{key:"onAddTool",value:function(t){var e=this,i=[{name:"Clear",global:!1,onClick:function(t){e.clearLog()}}];t(i)}},{key:"onReady",value:function(){var n=this;n.isReady=!0,this.renderHeader(),l.default.delegate(l.default.one(".vc-log",this.$tabbox),"click",".vc-group-preview",function(t){var e=this.dataset.reqid,i=this.parentNode;l.default.hasClass(i,"vc-actived")?(l.default.removeClass(i,"vc-actived"),n.updateRequest(e,{actived:!1})):(l.default.addClass(i,"vc-actived"),n.updateRequest(e,{actived:!0})),t.preventDefault()});var e=l.default.one(".vc-content");for(var t in l.default.bind(e,"scroll",function(t){n.isShow&&(e.scrollTop+e.offsetHeight>=e.scrollHeight?n.isInBottom=!0:n.isInBottom=!1)}),n.reqList)n.updateRequest(t,{})}},{key:"onRemove",value:function(){window.XMLHttpRequest&&(window.XMLHttpRequest.prototype.open=this._open,window.XMLHttpRequest.prototype.send=this._send,this._open=void 0,this._send=void 0)}},{key:"onShow",value:function(){this.isShow=!0,1==this.isInBottom&&this.scrollToBottom()}},{key:"onHide",value:function(){this.isShow=!1}},{key:"onShowConsole",value:function(){1==this.isInBottom&&this.scrollToBottom()}},{key:"scrollToBottom",value:function(){var t=l.default.one(".vc-content");t.scrollTop=t.scrollHeight-t.offsetHeight}},{key:"clearLog",value:function(){for(var t in this.reqList={},this.domList)this.domList[t].remove(),this.domList[t]=void 0;this.domList={},this.renderHeader()}},{key:"renderHeader",value:function(){var t=Object.keys(this.reqList).length,e=l.default.render(r.default,{count:t}),i=l.default.one(".vc-log",this.$tabbox);this.$header?this.$header.parentNode.replaceChild(e,this.$header):i.parentNode.insertBefore(e,i),this.$header=e}},{key:"updateRequest",value:function(t,e){var i=Object.keys(this.reqList).length,n=this.reqList[t]||{};for(var r in e)n[r]=e[r];if(this.reqList[t]=n,this.isReady){var s={id:t,url:n.url,status:n.status,method:n.method||"-",costTime:n.costTime>0?n.costTime+"ms":"-",header:n.header||null,getData:n.getData||null,postData:n.postData||null,response:null,actived:!!n.actived};switch(n.responseType){case"":case"text":if(y.isString(n.response))try{s.response=JSON.parse(n.response),s.response=JSON.stringify(s.response,null,1),s.response=y.htmlEncode(s.response)}catch(t){s.response=y.htmlEncode(n.response)}else void 0!==n.response&&(s.response=Object.prototype.toString.call(n.response));break;case"json":void 0!==n.response&&(s.response=JSON.stringify(n.response,null,1),s.response=y.htmlEncode(s.response));break;case"blob":case"document":case"arraybuffer":default:void 0!==n.response&&(s.response=Object.prototype.toString.call(n.response))}0==n.readyState||1==n.readyState?s.status="Pending":2==n.readyState||3==n.readyState?s.status="Loading":4==n.readyState||(s.status="Unknown");var a=l.default.render(u.default,s),o=this.domList[t];n.status>=400&&l.default.addClass(l.default.one(".vc-group-preview",a),"vc-table-row-error"),o?o.parentNode.replaceChild(a,o):l.default.one(".vc-log",this.$tabbox).insertAdjacentElement("beforeend",a),this.domList[t]=a;var h=Object.keys(this.reqList).length;h!=i&&this.renderHeader(),this.isInBottom&&this.scrollToBottom()}}},{key:"mockAjax",value:function(){var t=window.XMLHttpRequest;if(t){var g=this,s=window.XMLHttpRequest.prototype.open,m=window.XMLHttpRequest.prototype.send;g._open=s,g._send=m,window.XMLHttpRequest.prototype.open=function(){var h=this,t=[].slice.call(arguments),e=t[0],i=t[1],l=g.getUniqueID(),u=null;h._requestID=l,h._method=e,h._url=i;var c=h.onreadystatechange||function(){},n=function(){var t=g.reqList[l]||{};if(t.readyState=h.readyState,t.status=0,h.readyState>1&&(t.status=h.status),t.responseType=h.responseType,0==h.readyState)t.startTime||(t.startTime=+new Date);else if(1==h.readyState)t.startTime||(t.startTime=+new Date);else if(2==h.readyState){t.header={};for(var e=h.getAllResponseHeaders()||"",i=e.split("\n"),n=0;n<i.length;n++){var r=i[n];if(r){var s=r.split(": "),a=s[0],o=s.slice(1).join(": ");t.header[a]=o}}}else 3==h.readyState||(4==h.readyState?(clearInterval(u),t.endTime=+new Date,t.costTime=t.endTime-(t.startTime||t.endTime),t.response=h.response):clearInterval(u));return h._noVConsole||g.updateRequest(l,t),c.apply(h,arguments)};h.onreadystatechange=n;var r=-1;return u=setInterval(function(){r!=h.readyState&&(r=h.readyState,n.call(h))},10),s.apply(h,t)},window.XMLHttpRequest.prototype.send=function(){var t=[].slice.call(arguments),e=t[0],i=g.reqList[this._requestID]||{};i.method=this._method.toUpperCase();var n=this._url.split("?");if(i.url=n.shift(),n.length>0){i.getData={},n=(n=n.join("?")).split("&");var r=!0,s=!1,a=void 0;try{for(var o,h=n[Symbol.iterator]();!(r=(o=h.next()).done);r=!0){var l=o.value;l=l.split("="),i.getData[l[0]]=l[1]}}catch(t){s=!0,a=t}finally{try{r||null==h.return||h.return()}finally{if(s)throw a}}}if("POST"==i.method)if(y.isString(e)){var u=e.split("&");i.postData={};var c=!0,f=!1,_=void 0;try{for(var d,p=u[Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var v=d.value;v=v.split("="),i.postData[v[0]]=v[1]}}catch(t){f=!0,_=t}finally{try{c||null==p.return||p.return()}finally{if(f)throw _}}}else y.isPlainObject(e)&&(i.postData=e);return this._noVConsole||g.updateRequest(this._requestID,i),m.apply(this,t)}}}},{key:"getUniqueID",value:function(){var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,i="x"==t?e:3&e|8;return i.toString(16)});return t}}])&&o(e.prototype,i),n&&o(e,n),s;var e,i,n}(e.default);t.default=s,_.exports=d.default})?e.apply(d,i):e)||(_.exports=n)},function(t,e){t.exports='<div class="vc-table">\n  <div class="vc-log"></div>\n</div>'},function(t,e){t.exports='<dl class="vc-table-row">\n  <dd class="vc-table-col vc-table-col-4">Name {{if (count > 0)}}({{count}}){{/if}}</dd>\n  <dd class="vc-table-col">Method</dd>\n  <dd class="vc-table-col">Status</dd>\n  <dd class="vc-table-col">Time</dd>\n</dl>'},function(t,e){t.exports='<div class="vc-group {{actived ? \'vc-actived\' : \'\'}}">\n  <dl class="vc-table-row vc-group-preview" data-reqid="{{id}}">\n    <dd class="vc-table-col vc-table-col-4">{{url}}</dd>\n    <dd class="vc-table-col">{{method}}</dd>\n    <dd class="vc-table-col">{{status}}</dd>\n    <dd class="vc-table-col">{{costTime}}</dd>\n  </dl>\n  <div class="vc-group-detail">\n    {{if (header !== null)}}\n    <div>\n      <dl class="vc-table-row vc-left-border">\n        <dt class="vc-table-col vc-table-col-title">Headers</dt>\n      </dl>\n      {{for (var key in header)}}\n      <div class="vc-table-row vc-left-border vc-small">\n        <div class="vc-table-col vc-table-col-2">{{key}}</div>\n        <div class="vc-table-col vc-table-col-4 vc-max-height-line">{{header[key]}}</div>\n      </div>\n      {{/for}}\n    </div>\n    {{/if}}\n    {{if (getData !== null)}}\n    <div>\n      <dl class="vc-table-row vc-left-border">\n        <dt class="vc-table-col vc-table-col-title">Query String Parameters</dt>\n      </dl>\n      {{for (var key in getData)}}\n      <div class="vc-table-row vc-left-border vc-small">\n        <div class="vc-table-col vc-table-col-2">{{key}}</div>\n        <div class="vc-table-col vc-table-col-4 vc-max-height-line">{{getData[key]}}</div>\n      </div>\n      {{/for}}\n    </div>\n    {{/if}}\n    {{if (postData !== null)}}\n    <div>\n      <dl class="vc-table-row vc-left-border">\n        <dt class="vc-table-col vc-table-col-title">Form Data</dt>\n      </dl>\n      {{for (var key in postData)}}\n      <div class="vc-table-row vc-left-border vc-small">\n        <div class="vc-table-col vc-table-col-2">{{key}}</div>\n        <div class="vc-table-col vc-table-col-4 vc-max-height-line">{{postData[key]}}</div>\n      </div>\n      {{/for}}\n    </div>\n    {{/if}}\n    <div>\n      <dl class="vc-table-row vc-left-border">\n        <dt class="vc-table-col vc-table-col-title">Response</dt>\n      </dl>\n      <div class="vc-table-row vc-left-border vc-small">\n        <pre class="vc-table-col vc-max-height vc-min-height">{{response || \'\'}}</pre>\n      </div>\n    </div>\n  </div>\n</div>'},function(l,p,t){var e,i,n;i=[p,t(32),t(2),t(34),t(35),t(0),t(1)],void 0===(n="function"==typeof(e=function(t,e,i,u,r,n,c){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _(t){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i=s(i),u=s(u),r=s(r),n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,i):{};n.get||n.set?Object.defineProperty(e,i,n):e[i]=t[i]}return e.default=t,e}(n),c=s(c);var h=function(t){function l(){var t,e,i,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l);for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];i=this,n=(t=_(l)).call.apply(t,[this].concat(s)),e=!n||"object"!==f(n)&&"function"!=typeof n?d(i):n;var o=d(d(e));o.isInited=!1,o.node={},o.$tabbox=c.default.render(u.default,{}),o.nodes=[],o.activedElem={};var h=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;return o.observer=new h(function(t){for(var e=0;e<t.length;e++){var i=t[e];o._isInVConsole(i.target)||o.onMutation(i)}}),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(l,t),e=l,(i=[{key:"onRenderTab",value:function(t){t(this.$tabbox)}},{key:"onAddTool",value:function(t){var n=this,e=[{name:"Expand",global:!1,onClick:function(t){if(n.activedElem)if(c.default.hasClass(n.activedElem,"vc-toggle"))for(var e=0;e<n.activedElem.childNodes.length;e++){var i=n.activedElem.childNodes[e];if(c.default.hasClass(i,"vcelm-l")&&!c.default.hasClass(i,"vcelm-noc")&&!c.default.hasClass(i,"vc-toggle")){c.default.one(".vcelm-node",i).click();break}}else c.default.one(".vcelm-node",n.activedElem).click()}},{name:"Collapse",global:!1,onClick:function(t){n.activedElem&&(c.default.hasClass(n.activedElem,"vc-toggle")?c.default.one(".vcelm-node",n.activedElem).click():n.activedElem.parentNode&&c.default.hasClass(n.activedElem.parentNode,"vcelm-l")&&c.default.one(".vcelm-node",n.activedElem.parentNode).click())}}];t(e)}},{key:"onShow",value:function(){if(!this.isInited){this.isInited=!0,this.node=this.getNode(document.documentElement);var t=this.renderView(this.node,c.default.one(".vc-log",this.$tabbox)),e=c.default.one(".vcelm-node",t);e&&e.click(),this.observer.observe(document.documentElement,{attributes:!0,childList:!0,characterData:!0,subtree:!0})}}},{key:"onRemove",value:function(){this.observer.disconnect()}},{key:"onMutation",value:function(t){switch(t.type){case"childList":t.removedNodes.length>0&&this.onChildRemove(t),t.addedNodes.length>0&&this.onChildAdd(t);break;case"attributes":this.onAttributesChange(t);break;case"characterData":this.onCharacterDataChange(t)}}},{key:"onChildRemove",value:function(t){var e=t.target,i=e.__vconsole_node;if(i){for(var n=0;n<t.removedNodes.length;n++){var r=t.removedNodes[n],s=r.__vconsole_node;s&&s.view&&s.view.parentNode.removeChild(s.view)}this.getNode(e)}}},{key:"onChildAdd",value:function(t){var e=t.target,i=e.__vconsole_node;if(i){this.getNode(e),i.view&&c.default.removeClass(i.view,"vcelm-noc");for(var n=0;n<t.addedNodes.length;n++){var r=t.addedNodes[n],s=r.__vconsole_node;if(s)if(null!==t.nextSibling){var a=t.nextSibling.__vconsole_node;a.view&&this.renderView(s,a.view,"insertBefore")}else i.view&&(i.view.lastChild?this.renderView(s,i.view.lastChild,"insertBefore"):this.renderView(s,i.view))}}}},{key:"onAttributesChange",value:function(t){var e=t.target.__vconsole_node;e&&(e=this.getNode(t.target)).view&&this.renderView(e,e.view,!0)}},{key:"onCharacterDataChange",value:function(t){var e=t.target.__vconsole_node;e&&(e=this.getNode(t.target)).view&&this.renderView(e,e.view,!0)}},{key:"renderView",value:function(s,t,e){var a=this,i=new r.default(s).get();switch(s.view=i,c.default.delegate(i,"click",".vcelm-node",function(t){t.stopPropagation();var e=this.parentNode;if(!c.default.hasClass(e,"vcelm-noc")){a.activedElem=e,c.default.hasClass(e,"vc-toggle")?c.default.removeClass(e,"vc-toggle"):c.default.addClass(e,"vc-toggle");for(var i=-1,n=0;n<e.children.length;n++){var r=e.children[n];c.default.hasClass(r,"vcelm-l")&&(i++,r.children.length>0||(s.childNodes[i]?a.renderView(s.childNodes[i],r,"replace"):r.style.display="none"))}}}),e){case"replace":t.parentNode.replaceChild(i,t);break;case"insertBefore":t.parentNode.insertBefore(i,t);break;default:t.appendChild(i)}return i}},{key:"getNode",value:function(t){if(!this._isIgnoredElement(t)){var e=t.__vconsole_node||{};if(e.nodeType=t.nodeType,e.nodeName=t.nodeName,e.tagName=t.tagName||"",e.textContent="",e.nodeType!=t.TEXT_NODE&&e.nodeType!=t.DOCUMENT_TYPE_NODE||(e.textContent=t.textContent),e.id=t.id||"",e.className=t.className||"",e.attributes=[],t.hasAttributes&&t.hasAttributes())for(var i=0;i<t.attributes.length;i++)e.attributes.push({name:t.attributes[i].name,value:t.attributes[i].value||""});if(e.childNodes=[],t.childNodes.length>0)for(var n=0;n<t.childNodes.length;n++){var r=this.getNode(t.childNodes[n]);r&&e.childNodes.push(r)}return t.__vconsole_node=e,e}}},{key:"_isIgnoredElement",value:function(t){return t.nodeType==t.TEXT_NODE&&""==t.textContent.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$|\n+/g,"")}},{key:"_isInVConsole",value:function(t){for(var e=t;null!=e;){if("__vconsole"==e.id)return!0;e=e.parentNode||void 0}return!1}}])&&a(e.prototype,i),n&&a(e,n),l;var e,i,n}(i.default);t.default=h,l.exports=p.default})?e.apply(p,i):e)||(l.exports=n)},function(t,e,i){var n=i(33);"string"==typeof n&&(n=[[t.i,n,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};i(4)(n,r);n.locals&&(t.exports=n.locals)},function(t,e,i){(t.exports=i(3)(!1)).push([t.i,'/* color */\n.vcelm-node {\n  color: #183691;\n}\n.vcelm-k {\n  color: #0086B3;\n}\n.vcelm-v {\n  color: #905;\n}\n/* layout */\n.vcelm-l {\n  padding-left: 8px;\n  position: relative;\n  word-wrap: break-word;\n  line-height: 1;\n}\n/*.vcelm-l.vcelm-noc {\n  padding-left: 0;\n}*/\n.vcelm-l.vc-toggle > .vcelm-node {\n  display: block;\n}\n.vcelm-l .vcelm-node:active {\n  background-color: rgba(0, 0, 0, 0.15);\n}\n.vcelm-l.vcelm-noc .vcelm-node:active {\n  background-color: transparent;\n}\n.vcelm-t {\n  white-space: pre-wrap;\n  word-wrap: break-word;\n}\n/* level */\n.vcelm-l .vcelm-l {\n  display: none;\n}\n.vcelm-l.vc-toggle > .vcelm-l {\n  margin-left: 4px;\n  display: block;\n}\n/* arrow */\n.vcelm-l:before {\n  content: "";\n  display: block;\n  position: absolute;\n  top: 6px;\n  left: 3px;\n  width: 0;\n  height: 0;\n  border: transparent solid 3px;\n  border-left-color: #000;\n}\n.vcelm-l.vc-toggle:before {\n  display: block;\n  top: 6px;\n  left: 0;\n  border-top-color: #000;\n  border-left-color: transparent;\n}\n.vcelm-l.vcelm-noc:before {\n  display: none;\n}\n',""])},function(t,e){t.exports='<div>\n  <div class="vc-log"></div>\n</div>'},function(s,a,t){var e,i,n;i=[a,t(36),t(37),t(0),t(1)],void 0===(n="function"==typeof(e=function(t,l,u,e,c){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,l=i(l),u=i(u),e=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,i):{};n.get||n.set?Object.defineProperty(e,i,n):e[i]=t[i]}return e.default=t,e}(e),c=i(c);var n=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.node=t,this.view=this._create(this.node)}return t=e,(i=[{key:"get",value:function(){return this.view}},{key:"_create",value:function(t,e){var i=document.createElement("DIV");switch(c.default.addClass(i,"vcelm-l"),t.nodeType){case i.ELEMENT_NODE:this._createElementNode(t,i);break;case i.TEXT_NODE:this._createTextNode(t,i);break;case i.COMMENT_NODE:case i.DOCUMENT_NODE:case i.DOCUMENT_TYPE_NODE:case i.DOCUMENT_FRAGMENT_NODE:}return i}},{key:"_createTextNode",value:function(t,e){c.default.addClass(e,"vcelm-t vcelm-noc"),t.textContent&&e.appendChild(function(t){return document.createTextNode(t)}(t.textContent.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")))}},{key:"_createElementNode",value:function(t,e){var i,n=(i=(i=t.tagName)?i.toLowerCase():"",["br","hr","img","input","link","meta"].indexOf(i)>-1),r=n;0==t.childNodes.length&&(r=!0);var s=c.default.render(l.default,{node:t}),a=c.default.render(u.default,{node:t});if(r)c.default.addClass(e,"vcelm-noc"),e.appendChild(s),n||e.appendChild(a);else{e.appendChild(s);for(var o=0;o<t.childNodes.length;o++){var h=document.createElement("DIV");c.default.addClass(h,"vcelm-l"),e.appendChild(h)}n||e.appendChild(a)}}}])&&r(t.prototype,i),n&&r(t,n),e;var t,i,n}();t.default=n,s.exports=a.default})?e.apply(a,i):e)||(s.exports=n)},function(t,e){t.exports='<span class="vcelm-node">&lt;{{node.tagName.toLowerCase()}}{{if (node.className || node.attributes.length)}}\n  <i class="vcelm-k">\n    {{for (var i = 0; i < node.attributes.length; i++)}}\n      {{if (node.attributes[i].value !== \'\')}}\n        {{node.attributes[i].name}}="<i class="vcelm-v">{{node.attributes[i].value}}</i>"{{else}}\n        {{node.attributes[i].name}}{{/if}}{{/for}}</i>{{/if}}&gt;</span>'},function(t,e){t.exports='<span class="vcelm-node">&lt;/{{node.tagName.toLowerCase()}}&gt;</span>'},function(_,d,t){var e,i,n;i=[d,t(2),t(39),t(40),t(0),t(1)],void 0===(n="function"==typeof(e=function(t,e,a,r,o,h){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e){return!e||"object"!==n(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,e=i(e),a=i(a),r=i(r),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,i):{};n.get||n.set?Object.defineProperty(e,i,n):e[i]=t[i]}return e.default=t,e}(o),h=i(h);var s=function(t){function s(){var t,e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s);for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return(e=u(this,(t=c(s)).call.apply(t,[this].concat(n)))).$tabbox=h.default.render(a.default,{}),e.currentType="",e.typeNameMap={cookies:"Cookies",localstorage:"LocalStorage",sessionstorage:"SessionStorage"},e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(s,t),e=s,(i=[{key:"onRenderTab",value:function(t){t(this.$tabbox)}},{key:"onAddTopBar",value:function(t){for(var e=this,i=["Cookies","LocalStorage","SessionStorage"],n=[],r=0;r<i.length;r++)n.push({name:i[r],data:{type:i[r].toLowerCase()},className:"",onClick:function(){if(h.default.hasClass(this,"vc-actived"))return!1;e.currentType=this.dataset.type,e.renderStorage()}});n[0].className="vc-actived",t(n)}},{key:"onAddTool",value:function(t){var e=this,i=[{name:"Refresh",global:!1,onClick:function(t){e.renderStorage()}},{name:"Clear",global:!1,onClick:function(t){e.clearLog()}}];t(i)}},{key:"onReady",value:function(){}},{key:"onShow",value:function(){""==this.currentType&&(this.currentType="cookies",this.renderStorage())}},{key:"clearLog",value:function(){if(this.currentType&&window.confirm){var t=window.confirm("Remove all "+this.typeNameMap[this.currentType]+"?");if(!t)return!1}switch(this.currentType){case"cookies":this.clearCookieList();break;case"localstorage":this.clearLocalStorageList();break;case"sessionstorage":this.clearSessionStorageList();break;default:return!1}this.renderStorage()}},{key:"renderStorage",value:function(){var t=[];switch(this.currentType){case"cookies":t=this.getCookieList();break;case"localstorage":t=this.getLocalStorageList();break;case"sessionstorage":t=this.getSessionStorageList();break;default:return!1}var e=h.default.one(".vc-log",this.$tabbox);if(0==t.length)e.innerHTML="";else{for(var i=0;i<t.length;i++)t[i].name=o.htmlEncode(t[i].name),t[i].value=o.htmlEncode(t[i].value);e.innerHTML=h.default.render(r.default,{list:t},!0)}}},{key:"getCookieList",value:function(){if(!document.cookie||!navigator.cookieEnabled)return[];for(var t=[],e=document.cookie.split(";"),i=0;i<e.length;i++){var n=e[i].split("="),r=n.shift().replace(/^ /,""),s=n.join("=");try{r=decodeURIComponent(r),s=decodeURIComponent(s)}catch(t){console.log(t,r,s)}t.push({name:r,value:s})}return t}},{key:"getLocalStorageList",value:function(){if(!window.localStorage)return[];try{for(var t=[],e=0;e<localStorage.length;e++){var i=localStorage.key(e),n=localStorage.getItem(i);t.push({name:i,value:n})}return t}catch(t){return[]}}},{key:"getSessionStorageList",value:function(){if(!window.sessionStorage)return[];try{for(var t=[],e=0;e<sessionStorage.length;e++){var i=sessionStorage.key(e),n=sessionStorage.getItem(i);t.push({name:i,value:n})}return t}catch(t){return[]}}},{key:"clearCookieList",value:function(){if(document.cookie&&navigator.cookieEnabled){for(var t=this.getCookieList(),e=0;e<t.length;e++)document.cookie=t[e].name+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT";this.renderStorage()}}},{key:"clearLocalStorageList",value:function(){if(window.localStorage)try{localStorage.clear(),this.renderStorage()}catch(t){alert("localStorage.clear() fail.")}}},{key:"clearSessionStorageList",value:function(){if(window.sessionStorage)try{sessionStorage.clear(),this.renderStorage()}catch(t){alert("sessionStorage.clear() fail.")}}}])&&l(e.prototype,i),n&&l(e,n),s;var e,i,n}(e.default);t.default=s,_.exports=d.default})?e.apply(d,i):e)||(_.exports=n)},function(t,e){t.exports='<div class="vc-table">\n  <div class="vc-log"></div>\n</div>'},function(t,e){t.exports='<div>\n  <dl class="vc-table-row">\n    <dd class="vc-table-col">Name</dd>\n    <dd class="vc-table-col vc-table-col-2">Value</dd>\n  </dl>\n  {{for (var i = 0; i < list.length; i++)}}\n  <dl class="vc-table-row">\n    <dd class="vc-table-col">{{list[i].name}}</dd>\n    <dd class="vc-table-col vc-table-col-2">{{list[i].value}}</dd>\n  </dl>\n  {{/for}}\n</div>'}])});